<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>mikuç§˜å¯†ã®å°å±‹ğŸ¥</title>
  
  
  <link href="https://liweierzzz.github.io/atom.xml" rel="self"/>
  
  <link href="https://liweierzzz.github.io/"/>
  <updated>2024-07-21T05:18:47.451Z</updated>
  <id>https://liweierzzz.github.io/</id>
  
  <author>
    <name>mikuğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å»¶è¿Ÿä»»åŠ¡ç²¾å‡†å‘å¸ƒæ–‡ç« </title>
    <link href="https://liweierzzz.github.io/posts/adfcc294.html"/>
    <id>https://liweierzzz.github.io/posts/adfcc294.html</id>
    <published>2024-07-20T15:11:55.000Z</published>
    <updated>2024-07-21T05:18:47.451Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å»¶è¿Ÿä»»åŠ¡ç²¾å‡†å‘å¸ƒæ–‡ç« ">å»¶è¿Ÿä»»åŠ¡ç²¾å‡†å‘å¸ƒæ–‡ç« </h2><h3 id="1-æ–‡ç« å®šæ—¶å‘å¸ƒ">1)æ–‡ç« å®šæ—¶å‘å¸ƒ</h3><h3 id="2-å»¶è¿Ÿä»»åŠ¡æ¦‚è¿°">2)å»¶è¿Ÿä»»åŠ¡æ¦‚è¿°</h3><h4 id="2-1-ä»€ä¹ˆæ˜¯å»¶è¿Ÿä»»åŠ¡">2.1)ä»€ä¹ˆæ˜¯å»¶è¿Ÿä»»åŠ¡</h4><ul><li>å®šæ—¶ä»»åŠ¡ï¼šæœ‰å›ºå®šå‘¨æœŸçš„ï¼Œæœ‰æ˜ç¡®çš„è§¦å‘æ—¶é—´</li><li>å»¶è¿Ÿé˜Ÿåˆ—ï¼šæ²¡æœ‰å›ºå®šçš„å¼€å§‹æ—¶é—´ï¼Œå®ƒå¸¸å¸¸æ˜¯ç”±ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„ï¼Œè€Œåœ¨è¿™ä¸ªäº‹ä»¶è§¦å‘ä¹‹åçš„ä¸€æ®µæ—¶é—´å†…è§¦å‘å¦ä¸€ä¸ªäº‹ä»¶ï¼Œä»»åŠ¡å¯ä»¥ç«‹å³æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å»¶è¿Ÿ</li></ul><p><a href="https://imgse.com/i/pkTTxeA"><img src="https://s21.ax1x.com/2024/07/20/pkTTxeA.png" alt="pkTTxeA.png"></a></p><p>åº”ç”¨åœºæ™¯ï¼š</p><p>åœºæ™¯ä¸€ï¼šè®¢å•ä¸‹å•ä¹‹å30åˆ†é’Ÿåï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ä»˜é’±ï¼Œåˆ™ç³»ç»Ÿè‡ªåŠ¨å–æ¶ˆè®¢å•ï¼›å¦‚æœæœŸé—´ä¸‹å•æˆåŠŸï¼Œä»»åŠ¡å–æ¶ˆ</p><p>åœºæ™¯äºŒï¼šæ¥å£å¯¹æ¥å‡ºç°ç½‘ç»œé—®é¢˜ï¼Œ1åˆ†é’Ÿåé‡è¯•ï¼Œå¦‚æœå¤±è´¥ï¼Œ2åˆ†é’Ÿé‡è¯•ï¼Œç›´åˆ°å‡ºç°é˜ˆå€¼ç»ˆæ­¢</p><h4 id="2-2-æŠ€æœ¯å¯¹æ¯”">2.2)æŠ€æœ¯å¯¹æ¯”</h4><h5 id="2-2-1-DelayQueue">2.2.1)DelayQueue</h5><p>JDKè‡ªå¸¦DelayQueue æ˜¯ä¸€ä¸ªæ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œ å†…éƒ¨é‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ— PriorityQueue å­˜å‚¨å…ƒç´ ï¼ŒåŒæ—¶å…ƒç´ å¿…é¡»å®ç° Delayed æ¥å£ï¼›åœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰å¯ä»¥ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ï¼Œåªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ </p><p><a href="https://imgse.com/i/pkT79FP"><img src="https://s21.ax1x.com/2024/07/20/pkT79FP.png" alt="pkT79FP.png"></a></p><p>DelayQueueå±äºæ’åºé˜Ÿåˆ—ï¼Œå®ƒçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºé˜Ÿåˆ—çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œè¯¥æ¥å£éœ€è¦å®ç°compareToå’ŒgetDelayæ–¹æ³•</p><p>getDelayæ–¹æ³•ï¼šè·å–å…ƒç´ åœ¨é˜Ÿåˆ—ä¸­çš„å‰©ä½™æ—¶é—´ï¼Œåªæœ‰å½“å‰©ä½™æ—¶é—´ä¸º0æ—¶å…ƒç´ æ‰å¯ä»¥å‡ºé˜Ÿåˆ—ã€‚</p><p>compareToæ–¹æ³•ï¼šç”¨äºæ’åºï¼Œç¡®å®šå…ƒç´ å‡ºé˜Ÿåˆ—çš„é¡ºåºã€‚</p><p><strong>å®ç°ï¼š</strong></p><p>1ï¼šåœ¨æµ‹è¯•åŒ…jdkä¸‹åˆ›å»ºå»¶è¿Ÿä»»åŠ¡å…ƒç´ å¯¹è±¡DelayedTaskï¼Œå®ç°compareToå’ŒgetDelayæ–¹æ³•ï¼Œ</p><p>2ï¼šåœ¨mainæ–¹æ³•ä¸­åˆ›å»ºDelayQueueå¹¶å‘å»¶è¿Ÿé˜Ÿåˆ—ä¸­æ·»åŠ ä¸‰ä¸ªå»¶è¿Ÿä»»åŠ¡ï¼Œ</p><p>3ï¼šå¾ªç¯çš„ä»å»¶è¿Ÿé˜Ÿåˆ—ä¸­æ‹‰å–ä»»åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelayedTask</span>  <span class="keyword">implements</span> <span class="title class_">Delayed</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">executeTime</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DelayedTask</span><span class="params">(<span class="type">int</span> delay)</span>&#123;</span><br><span class="line">        <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">        calendar.add(Calendar.SECOND,delay);</span><br><span class="line">        <span class="built_in">this</span>.executeTime = (<span class="type">int</span>)(calendar.getTimeInMillis() /<span class="number">1000</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…ƒç´ åœ¨é˜Ÿåˆ—ä¸­çš„å‰©ä½™æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">getDelay</span><span class="params">(TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> executeTime - (calendar.getTimeInMillis()/<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…ƒç´ æ’åº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Delayed o)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">val</span> <span class="operator">=</span> <span class="built_in">this</span>.getDelay(TimeUnit.NANOSECONDS) - o.getDelay(TimeUnit.NANOSECONDS);</span><br><span class="line">        <span class="keyword">return</span> val == <span class="number">0</span> ? <span class="number">0</span> : ( val &lt; <span class="number">0</span> ? -<span class="number">1</span>: <span class="number">1</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        DelayQueue&lt;DelayedTask&gt; queue = <span class="keyword">new</span> <span class="title class_">DelayQueue</span>&lt;DelayedTask&gt;();</span><br><span class="line">        </span><br><span class="line">        queue.add(<span class="keyword">new</span> <span class="title class_">DelayedTask</span>(<span class="number">5</span>));</span><br><span class="line">        queue.add(<span class="keyword">new</span> <span class="title class_">DelayedTask</span>(<span class="number">10</span>));</span><br><span class="line">        queue.add(<span class="keyword">new</span> <span class="title class_">DelayedTask</span>(<span class="number">15</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(System.currentTimeMillis()/<span class="number">1000</span>+<span class="string">&quot; start consume &quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(queue.size() != <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="type">DelayedTask</span> <span class="variable">delayedTask</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="keyword">if</span>(delayedTask !=<span class="literal">null</span> )&#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis()/<span class="number">1000</span>+<span class="string">&quot; cosume task&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æ¯éš”ä¸€ç§’æ¶ˆè´¹ä¸€æ¬¡</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DelayQueueå®ç°å®Œæˆä¹‹åæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š</p><p>ä½¿ç”¨çº¿ç¨‹æ± æˆ–è€…åŸç”ŸDelayQueueç¨‹åºæŒ‚æ‰ä¹‹åï¼Œä»»åŠ¡éƒ½æ˜¯æ”¾åœ¨å†…å­˜ï¼Œéœ€è¦è€ƒè™‘æœªå¤„ç†æ¶ˆæ¯çš„ä¸¢å¤±å¸¦æ¥çš„å½±å“ï¼Œå¦‚ä½•ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œéœ€è¦æŒä¹…åŒ–ï¼ˆç£ç›˜ï¼‰</p><h5 id="2-2-2-RabbitMQå®ç°å»¶è¿Ÿä»»åŠ¡">2.2.2)RabbitMQå®ç°å»¶è¿Ÿä»»åŠ¡</h5><ul><li><p>TTLï¼šTime To Live (æ¶ˆæ¯å­˜æ´»æ—¶é—´)</p></li><li><p>æ­»ä¿¡é˜Ÿåˆ—ï¼šDead Letter Exchange(æ­»ä¿¡äº¤æ¢æœº)ï¼Œå½“æ¶ˆæ¯æˆä¸ºDead messageåï¼Œå¯ä»¥é‡æ–°å‘é€å¦ä¸€ä¸ªäº¤æ¢æœºï¼ˆæ­»ä¿¡äº¤æ¢æœºï¼‰</p></li></ul><p><a href="https://imgse.com/i/pkT7CJf"><img src="https://s21.ax1x.com/2024/07/20/pkT7CJf.png" alt="pkT7CJf.png"></a></p><h5 id="2-2-3-rediså®ç°">2.2.3)rediså®ç°</h5><p>zsetæ•°æ®ç±»å‹çš„å»é‡æœ‰åºï¼ˆåˆ†æ•°æ’åºï¼‰ç‰¹ç‚¹è¿›è¡Œå»¶è¿Ÿã€‚ä¾‹å¦‚ï¼šæ—¶é—´æˆ³ä½œä¸ºscoreè¿›è¡Œæ’åº</p><p><a href="https://imgse.com/i/pkT7PW8"><img src="https://s21.ax1x.com/2024/07/20/pkT7PW8.png" alt="pkT7PW8.png"></a></p><h3 id="3-rediså®ç°å»¶è¿Ÿä»»åŠ¡">3)rediså®ç°å»¶è¿Ÿä»»åŠ¡</h3><p>å®ç°æ€è·¯</p><p><a href="https://imgse.com/i/pkT7FSS"><img src="https://s21.ax1x.com/2024/07/20/pkT7FSS.png" alt="pkT7FSS.png"></a></p><p>é—®é¢˜æ€è·¯</p><p>1.ä¸ºä»€ä¹ˆä»»åŠ¡éœ€è¦å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Ÿ</p><p>å»¶è¿Ÿä»»åŠ¡æ˜¯ä¸€ä¸ªé€šç”¨çš„æœåŠ¡ï¼Œä»»ä½•éœ€è¦å»¶è¿Ÿå¾—ä»»åŠ¡éƒ½å¯ä»¥è°ƒç”¨è¯¥æœåŠ¡ï¼Œéœ€è¦è€ƒè™‘æ•°æ®æŒä¹…åŒ–çš„é—®é¢˜ï¼Œå­˜å‚¨æ•°æ®åº“ä¸­æ˜¯ä¸€ç§æ•°æ®å®‰å…¨çš„è€ƒè™‘ã€‚</p><p>2.ä¸ºä»€ä¹ˆredisä¸­ä½¿ç”¨ä¸¤ç§æ•°æ®ç±»å‹ï¼Œlistå’Œzsetï¼Ÿ</p><p>æ•ˆç‡é—®é¢˜ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦</p><p>3.åœ¨æ·»åŠ zsetæ•°æ®çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸éœ€è¦é¢„åŠ è½½ï¼Ÿ</p><p>ä»»åŠ¡æ¨¡å—æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¨¡å—ï¼Œé¡¹ç›®ä¸­ä»»ä½•éœ€è¦å»¶è¿Ÿé˜Ÿåˆ—çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œè¦è€ƒè™‘åˆ°æ•°æ®é‡çš„é—®é¢˜ï¼Œå¦‚æœæ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œä¸ºäº†é˜²æ­¢é˜»å¡ï¼Œåªéœ€è¦æŠŠæœªæ¥å‡ åˆ†é’Ÿè¦æ‰§è¡Œçš„æ•°æ®å­˜å…¥ç¼“å­˜å³å¯ã€‚</p><h3 id="4-å»¶è¿Ÿä»»åŠ¡æœåŠ¡å®ç°">4)å»¶è¿Ÿä»»åŠ¡æœåŠ¡å®ç°</h3><h4 id="4-1-æ­leadnews-scheduleæ¨¡å—">4.1)æ­leadnews-scheduleæ¨¡å—</h4><h4 id="4-2-æ•°æ®åº“å‡†å¤‡">4.2)æ•°æ®åº“å‡†å¤‡</h4><p>taskinfo ä»»åŠ¡è¡¨</p><p><a href="https://imgse.com/i/pkT7Zes"><img src="https://s21.ax1x.com/2024/07/20/pkT7Zes.png" alt="pkT7Zes.png"></a></p><p>å®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.model.schedule.pojos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itheima</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;taskinfo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Taskinfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.ID_WORKER)</span></span><br><span class="line">    <span class="keyword">private</span> Long taskId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;execute_time&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date executeTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;parameters&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] parameters;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;priority&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer priority;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;task_type&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer taskType;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>taskinfo_logs ä»»åŠ¡æ—¥å¿—è¡¨</p><p><a href="https://imgse.com/i/pkT7ewn"><img src="https://s21.ax1x.com/2024/07/20/pkT7ewn.png" alt="pkT7ewn.png"></a></p><p>å®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.model.schedule.pojos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.*;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itheima</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;taskinfo_logs&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskinfoLogs</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.ID_WORKER)</span></span><br><span class="line">    <span class="keyword">private</span> Long taskId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;execute_time&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date executeTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;parameters&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] parameters;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;priority&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer priority;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;task_type&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer taskType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‰ˆæœ¬å·,ç”¨ä¹è§‚é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Version</span></span><br><span class="line">    <span class="keyword">private</span> Integer version;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ 0=int 1=EXECUTED 2=CANCELLED</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(&quot;status&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹è§‚é”æ”¯æŒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * mybatis-plusä¹è§‚é”æ”¯æŒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">optimisticLockerInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">    interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());</span><br><span class="line">    <span class="keyword">return</span> interceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-é¡¹ç›®é›†æˆredis">4.4)é¡¹ç›®é›†æˆredis</h4><p>â‘  åœ¨é¡¹ç›®å¯¼å…¥redisç›¸å…³ä¾èµ–ï¼Œå·²ç»å®Œæˆ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- redisä¾èµ–commons-pool è¿™ä¸ªä¾èµ–ä¸€å®šè¦æ·»åŠ  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â‘¡ åœ¨heima-leadnews-scheduleä¸­é›†æˆredis,æ·»åŠ ä»¥ä¸‹nacosé…ç½®ï¼Œé“¾æ¥ä¸Šredis</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.200</span><span class="number">.130</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">leadnews</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure><p>â‘¢ æ‹·è´èµ„æ–™æ–‡ä»¶å¤¹ä¸‹çš„ç±»ï¼šCacheServiceåˆ°heima-leadnews-commonæ¨¡å—ä¸‹ï¼Œå¹¶æ·»åŠ è‡ªåŠ¨é…ç½®</p><p>æ“ä½œç¼“å­˜çš„å·¥å…·ç±»:</p><p><img src="%E5%BB%B6%E8%BF%9F%E4%BB%BB%E5%8A%A1%E7%B2%BE%E5%87%86%E5%8F%91%E5%B8%83%E6%96%87%E7%AB%A0.assets%5Cimage-20210514181214681.png" alt="image-20210514181214681"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.schedule.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.dao.DataAccessException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.DataType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnection;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.StringRedisConnection;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.Cursor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisCallback;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.ScanOptions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.ZSetOperations.TypedTuple;</span><br><span class="line"><span class="keyword">import</span> org.springframework.lang.Nullable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheService</span> <span class="keyword">extends</span> <span class="title class_">CachingConfigurerSupport</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> StringRedisTemplate <span class="title function_">getstringRedisTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.stringRedisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** -------------------keyç›¸å…³æ“ä½œ--------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        stringRedisTemplate.delete(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡åˆ é™¤key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keys</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Collection&lt;String&gt; keys)</span> &#123;</span><br><span class="line">        stringRedisTemplate.delete(keys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] dump(String key) &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.dump(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å­˜åœ¨key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">exists</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.hasKey(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">expire</span><span class="params">(String key, <span class="type">long</span> timeout, TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.expire(key, timeout, unit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">expireAt</span><span class="params">(String key, Date date)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.expireAt(key, date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰¾åŒ¹é…çš„key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pattern</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">keys</span><span class="params">(String pattern)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.keys(pattern);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†å½“å‰æ•°æ®åº“çš„ key ç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“ db å½“ä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dbIndex</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">move</span><span class="params">(String key, <span class="type">int</span> dbIndex)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.move(key, dbIndex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤ key çš„è¿‡æœŸæ—¶é—´ï¼Œkey å°†æŒä¹…ä¿æŒ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">persist</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.persist(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å› key çš„å‰©ä½™çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getExpire</span><span class="params">(String key, TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.getExpire(key, unit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å› key çš„å‰©ä½™çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getExpire</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.getExpire(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">randomKey</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.randomKey();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹ key çš„åç§°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> oldKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newKey</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rename</span><span class="params">(String oldKey, String newKey)</span> &#123;</span><br><span class="line">        stringRedisTemplate.rename(oldKey, newKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»…å½“ newkey ä¸å­˜åœ¨æ—¶ï¼Œå°† oldKey æ”¹åä¸º newkey</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> oldKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">renameIfAbsent</span><span class="params">(String oldKey, String newKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.renameIfAbsent(oldKey, newKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å› key æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> DataType <span class="title function_">type</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.type(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** -------------------stringç›¸å…³æ“ä½œ--------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®æŒ‡å®š key çš„å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æŒ‡å®š key çš„å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å› key ä¸­å­—ç¬¦ä¸²å€¼çš„å­å­—ç¬¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getRange</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().get(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†ç»™å®š key çš„å€¼è®¾ä¸º value ï¼Œå¹¶è¿”å› key çš„æ—§å€¼(old value)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAndSet</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().getAndSet(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè·å–æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> offset</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">getBit</span><span class="params">(String key, <span class="type">long</span> offset)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().getBit(key, offset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡è·å–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">multiGet</span><span class="params">(Collection&lt;String&gt; keys)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().multiGet(keys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®ASCIIç , å­—ç¬¦ä¸²&#x27;a&#x27;çš„ASCIIç æ˜¯97, è½¬ä¸ºäºŒè¿›åˆ¶æ˜¯&#x27;01100001&#x27;, æ­¤æ–¹æ³•æ˜¯å°†äºŒè¿›åˆ¶ç¬¬offsetä½å€¼å˜ä¸ºvalue</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            å€¼,trueä¸º1, falseä¸º0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">setBit</span><span class="params">(String key, <span class="type">long</span> offset, <span class="type">boolean</span> value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().setBit(key, offset, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†å€¼ value å…³è”åˆ° key ï¼Œå¹¶å°† key çš„è¿‡æœŸæ—¶é—´è®¾ä¸º timeout</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout</span></span><br><span class="line"><span class="comment">     *            è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     *            æ—¶é—´å•ä½, å¤©:TimeUnit.DAYS å°æ—¶:TimeUnit.HOURS åˆ†é’Ÿ:TimeUnit.MINUTES</span></span><br><span class="line"><span class="comment">     *            ç§’:TimeUnit.SECONDS æ¯«ç§’:TimeUnit.MILLISECONDS</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEx</span><span class="params">(String key, String value, <span class="type">long</span> timeout, TimeUnit unit)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, value, timeout, unit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åªæœ‰åœ¨ key ä¸å­˜åœ¨æ—¶è®¾ç½® key çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¹‹å‰å·²ç»å­˜åœ¨è¿”å›false,ä¸å­˜åœ¨è¿”å›true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">setIfAbsent</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().setIfAbsent(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨ value å‚æ•°è¦†å†™ç»™å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œä»åç§»é‡ offset å¼€å§‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> offset</span></span><br><span class="line"><span class="comment">     *            ä»æŒ‡å®šä½ç½®å¼€å§‹è¦†å†™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRange</span><span class="params">(String key, String value, <span class="type">long</span> offset)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, value, offset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">size</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ·»åŠ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> maps</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">multiSet</span><span class="params">(Map&lt;String, String&gt; maps)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().multiSet(maps);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> maps</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä¹‹å‰å·²ç»å­˜åœ¨è¿”å›false,ä¸å­˜åœ¨è¿”å›true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">multiSetIfAbsent</span><span class="params">(Map&lt;String, String&gt; maps)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().multiSetIfAbsent(maps);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¢åŠ (è‡ªå¢é•¿), è´Ÿæ•°åˆ™ä¸ºè‡ªå‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">incrBy</span><span class="params">(String key, <span class="type">long</span> increment)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().increment(key, increment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">incrByFloat</span><span class="params">(String key, <span class="type">double</span> increment)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().increment(key, increment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿½åŠ åˆ°æœ«å°¾</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">append</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().append(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** -------------------hashç›¸å…³æ“ä½œ------------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">hGet</span><span class="params">(String key, String field)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().get(key, field);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ‰€æœ‰ç»™å®šå­—æ®µçš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title function_">hGetAll</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().entries(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ‰€æœ‰ç»™å®šå­—æ®µçš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fields</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Object&gt; <span class="title function_">hMultiGet</span><span class="params">(String key, Collection&lt;Object&gt; fields)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().multiGet(key, fields);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hPut</span><span class="params">(String key, String hashKey, String value)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForHash().put(key, hashKey, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hPutAll</span><span class="params">(String key, Map&lt;String, String&gt; maps)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForHash().putAll(key, maps);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»…å½“hashKeyä¸å­˜åœ¨æ—¶æ‰è®¾ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> hashKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">hPutIfAbsent</span><span class="params">(String key, String hashKey, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().putIfAbsent(key, hashKey, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå“ˆå¸Œè¡¨å­—æ®µ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fields</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">hDelete</span><span class="params">(String key, Object... fields)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().delete(key, fields);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­ï¼ŒæŒ‡å®šçš„å­—æ®µæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hExists</span><span class="params">(String key, String field)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().hasKey(key, field);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„æŒ‡å®šå­—æ®µçš„æ•´æ•°å€¼åŠ ä¸Šå¢é‡ increment</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> increment</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">hIncrBy</span><span class="params">(String key, Object field, <span class="type">long</span> increment)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().increment(key, field, increment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„æŒ‡å®šå­—æ®µçš„æ•´æ•°å€¼åŠ ä¸Šå¢é‡ increment</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> field</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">hIncrByFloat</span><span class="params">(String key, Object field, <span class="type">double</span> delta)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().increment(key, field, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ‰€æœ‰å“ˆå¸Œè¡¨ä¸­çš„å­—æ®µ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Object&gt; <span class="title function_">hKeys</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().keys(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">hSize</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Object&gt; <span class="title function_">hValues</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().values(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿­ä»£å“ˆå¸Œè¡¨ä¸­çš„é”®å€¼å¯¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Cursor&lt;Map.Entry&lt;Object, Object&gt;&gt; hScan(String key, ScanOptions options) &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForHash().scan(key, options);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ------------------------listç›¸å…³æ“ä½œ---------------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ç´¢å¼•è·å–åˆ—è¡¨ä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lIndex</span><span class="params">(String key, <span class="type">long</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().index(key, index);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     *            å¼€å§‹ä½ç½®, 0æ˜¯å¼€å§‹ä½ç½®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     *            ç»“æŸä½ç½®, -1è¿”å›æ‰€æœ‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">lRange</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().range(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­˜å‚¨åœ¨listå¤´éƒ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLeftPush</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPush(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLeftPushAll</span><span class="params">(String key, String... value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPushAll(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLeftPushAll</span><span class="params">(String key, Collection&lt;String&gt; value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPushAll(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“listå­˜åœ¨çš„æ—¶å€™æ‰åŠ å…¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLeftPushIfPresent</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPushIfPresent(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœpivotå­˜åœ¨,å†pivotå‰é¢æ·»åŠ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pivot</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLeftPush</span><span class="params">(String key, String pivot, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPush(key, pivot, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRightPush</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRightPushAll</span><span class="params">(String key, String... value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRightPushAll</span><span class="params">(String key, Collection&lt;String&gt; value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸ºå·²å­˜åœ¨çš„åˆ—è¡¨æ·»åŠ å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRightPushIfPresent</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPushIfPresent(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨pivotå…ƒç´ çš„å³è¾¹æ·»åŠ å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pivot</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRightPush</span><span class="params">(String key, String pivot, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPush(key, pivot, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ç´¢å¼•è®¾ç½®åˆ—è¡¨å…ƒç´ çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     *            ä½ç½®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lSet</span><span class="params">(String key, <span class="type">long</span> index, String value)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForList().set(key, index, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åˆ é™¤çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lLeftPop</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPop(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout</span></span><br><span class="line"><span class="comment">     *            ç­‰å¾…æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     *            æ—¶é—´å•ä½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lBLeftPop</span><span class="params">(String key, <span class="type">long</span> timeout, TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().leftPop(key, timeout, unit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤å¹¶è·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åˆ é™¤çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lRightPop</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPop(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout</span></span><br><span class="line"><span class="comment">     *            ç­‰å¾…æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     *            æ—¶é—´å•ä½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lBRightPop</span><span class="params">(String key, <span class="type">long</span> timeout, TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPop(key, timeout, unit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨å¹¶è¿”å›</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sourceKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destinationKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lRightPopAndLeftPush</span><span class="params">(String sourceKey, String destinationKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPopAndLeftPush(sourceKey,</span><br><span class="line">                destinationKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»åˆ—è¡¨ä¸­å¼¹å‡ºä¸€ä¸ªå€¼ï¼Œå°†å¼¹å‡ºçš„å…ƒç´ æ’å…¥åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨ä¸­å¹¶è¿”å›å®ƒï¼› å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sourceKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destinationKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timeout</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> unit</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lBRightPopAndLeftPush</span><span class="params">(String sourceKey, String destinationKey,</span></span><br><span class="line"><span class="params">                                        <span class="type">long</span> timeout, TimeUnit unit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().rightPopAndLeftPush(sourceKey,</span><br><span class="line">                destinationKey, timeout, unit);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤é›†åˆä¸­å€¼ç­‰äºvalueå¾—å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index</span></span><br><span class="line"><span class="comment">     *            index=0, åˆ é™¤æ‰€æœ‰å€¼ç­‰äºvalueçš„å…ƒç´ ; index&gt;0, ä»å¤´éƒ¨å¼€å§‹åˆ é™¤ç¬¬ä¸€ä¸ªå€¼ç­‰äºvalueçš„å…ƒç´ ;</span></span><br><span class="line"><span class="comment">     *            index&lt;0, ä»å°¾éƒ¨å¼€å§‹åˆ é™¤ç¬¬ä¸€ä¸ªå€¼ç­‰äºvalueçš„å…ƒç´ ;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lRemove</span><span class="params">(String key, <span class="type">long</span> index, String value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().remove(key, index, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è£å‰ªlist</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lTrim</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        stringRedisTemplate.opsForList().trim(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ—è¡¨é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">lLen</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForList().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/** --------------------setç›¸å…³æ“ä½œ-------------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * setæ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sAdd</span><span class="params">(String key, String... values)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().add(key, values);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * setç§»é™¤å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sRemove</span><span class="params">(String key, Object... values)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().remove(key, values);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤å¹¶è¿”å›é›†åˆçš„ä¸€ä¸ªéšæœºå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sPop</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().pop(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†å…ƒç´ valueä»ä¸€ä¸ªé›†åˆç§»åˆ°å¦ä¸€ä¸ªé›†åˆ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">sMove</span><span class="params">(String key, String value, String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().move(key, value, destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆçš„å¤§å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sSize</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«value</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">sIsMember</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸¤ä¸ªé›†åˆçš„äº¤é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sIntersect</span><span class="params">(String key, String otherKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().intersect(key, otherKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–keyé›†åˆä¸å¤šä¸ªé›†åˆçš„äº¤é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sIntersect</span><span class="params">(String key, Collection&lt;String&gt; otherKeys)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().intersect(key, otherKeys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸otherKeyé›†åˆçš„äº¤é›†å­˜å‚¨åˆ°destKeyé›†åˆä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sIntersectAndStore</span><span class="params">(String key, String otherKey, String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().intersectAndStore(key, otherKey,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸å¤šä¸ªé›†åˆçš„äº¤é›†å­˜å‚¨åˆ°destKeyé›†åˆä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sIntersectAndStore</span><span class="params">(String key, Collection&lt;String&gt; otherKeys,</span></span><br><span class="line"><span class="params">                                   String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().intersectAndStore(key, otherKeys,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸¤ä¸ªé›†åˆçš„å¹¶é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sUnion</span><span class="params">(String key, String otherKeys)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().union(key, otherKeys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–keyé›†åˆä¸å¤šä¸ªé›†åˆçš„å¹¶é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sUnion</span><span class="params">(String key, Collection&lt;String&gt; otherKeys)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().union(key, otherKeys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸otherKeyé›†åˆçš„å¹¶é›†å­˜å‚¨åˆ°destKeyä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sUnionAndStore</span><span class="params">(String key, String otherKey, String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().unionAndStore(key, otherKey, destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸å¤šä¸ªé›†åˆçš„å¹¶é›†å­˜å‚¨åˆ°destKeyä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sUnionAndStore</span><span class="params">(String key, Collection&lt;String&gt; otherKeys,</span></span><br><span class="line"><span class="params">                               String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().unionAndStore(key, otherKeys, destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä¸¤ä¸ªé›†åˆçš„å·®é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sDifference</span><span class="params">(String key, String otherKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().difference(key, otherKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–keyé›†åˆä¸å¤šä¸ªé›†åˆçš„å·®é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sDifference</span><span class="params">(String key, Collection&lt;String&gt; otherKeys)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().difference(key, otherKeys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸otherKeyé›†åˆçš„å·®é›†å­˜å‚¨åˆ°destKeyä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sDifference</span><span class="params">(String key, String otherKey, String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().differenceAndStore(key, otherKey,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * keyé›†åˆä¸å¤šä¸ªé›†åˆçš„å·®é›†å­˜å‚¨åˆ°destKeyä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">sDifference</span><span class="params">(String key, Collection&lt;String&gt; otherKeys,</span></span><br><span class="line"><span class="params">                            String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().differenceAndStore(key, otherKeys,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆæ‰€æœ‰å…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">setMembers</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().members(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éšæœºè·å–é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sRandomMember</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().randomMember(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éšæœºè·å–é›†åˆä¸­countä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> count</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">sRandomMembers</span><span class="params">(String key, <span class="type">long</span> count)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().randomMembers(key, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éšæœºè·å–é›†åˆä¸­countä¸ªå…ƒç´ å¹¶ä¸”å»é™¤é‡å¤çš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> count</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">sDistinctRandomMembers</span><span class="params">(String key, <span class="type">long</span> count)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().distinctRandomMembers(key, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Cursor&lt;String&gt; <span class="title function_">sScan</span><span class="params">(String key, ScanOptions options)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForSet().scan(key, options);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**------------------zSetç›¸å…³æ“ä½œ--------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ å…ƒç´ ,æœ‰åºé›†åˆæ˜¯æŒ‰ç…§å…ƒç´ çš„scoreå€¼ç”±å°åˆ°å¤§æ’åˆ—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> score</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">zAdd</span><span class="params">(String key, String value, <span class="type">double</span> score)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().add(key, value, score);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zAdd</span><span class="params">(String key, Set&lt;TypedTuple&lt;String&gt;&gt; values)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().add(key, values);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zRemove</span><span class="params">(String key, Object... values)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().remove(key, values);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zRemove</span><span class="params">(String key, Collection&lt;String&gt; values)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(values!=<span class="literal">null</span>&amp;&amp;!values.isEmpty())&#123;</span><br><span class="line">            Object[] objs = values.toArray(<span class="keyword">new</span> <span class="title class_">Object</span>[values.size()]);</span><br><span class="line">            <span class="keyword">return</span> stringRedisTemplate.opsForZSet().remove(key, objs);</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¢åŠ å…ƒç´ çš„scoreå€¼ï¼Œå¹¶è¿”å›å¢åŠ åçš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">zIncrementScore</span><span class="params">(String key, String value, <span class="type">double</span> delta)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().incrementScore(key, value, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å…ƒç´ åœ¨é›†åˆçš„æ’å,æœ‰åºé›†åˆæ˜¯æŒ‰ç…§å…ƒç´ çš„scoreå€¼ç”±å°åˆ°å¤§æ’åˆ—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 0è¡¨ç¤ºç¬¬ä¸€ä½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zRank</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().rank(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å…ƒç´ åœ¨é›†åˆçš„æ’å,æŒ‰å…ƒç´ çš„scoreå€¼ç”±å¤§åˆ°å°æ’åˆ—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zReverseRank</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRank(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆçš„å…ƒç´ , ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     *            å¼€å§‹ä½ç½®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     *            ç»“æŸä½ç½®, -1æŸ¥è¯¢æ‰€æœ‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zRange</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().range(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–zseté›†åˆçš„æ‰€æœ‰å…ƒç´ , ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zRangeAll</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> zRange(key,<span class="number">0</span>,-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆå…ƒç´ , å¹¶ä¸”æŠŠscoreå€¼ä¹Ÿè·å–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zRangeWithScores</span><span class="params">(String key, <span class="type">long</span> start,</span></span><br><span class="line"><span class="params">                                                    <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().rangeWithScores(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Scoreå€¼æŸ¥è¯¢é›†åˆå…ƒç´ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     *            æœ€å°å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     *            æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zRangeByScore</span><span class="params">(String key, <span class="type">double</span> min, <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().rangeByScore(key, min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Scoreå€¼æŸ¥è¯¢é›†åˆå…ƒç´ , ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     *            æœ€å°å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     *            æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zRangeByScoreWithScores</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">                                                           <span class="type">double</span> min, <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().rangeByScoreWithScores(key, min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zRangeByScoreWithScores</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">                                                           <span class="type">double</span> min, <span class="type">double</span> max, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().rangeByScoreWithScores(key, min, max,</span><br><span class="line">                start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆçš„å…ƒç´ , ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zReverseRange</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRange(key, start, end);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zReverseRangeByScore</span><span class="params">(String key, <span class="type">long</span> min, <span class="type">long</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRangeByScore(key, min, max);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆçš„å…ƒç´ , ä»å¤§åˆ°å°æ’åº, å¹¶è¿”å›scoreå€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zReverseRangeWithScores</span><span class="params">(String key,</span></span><br><span class="line"><span class="params">                                                           <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRangeWithScores(key, start,</span><br><span class="line">                end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Scoreå€¼æŸ¥è¯¢é›†åˆå…ƒç´ , ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zReverseRangeByScore</span><span class="params">(String key, <span class="type">double</span> min,</span></span><br><span class="line"><span class="params">                                            <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRangeByScore(key, min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®Scoreå€¼æŸ¥è¯¢é›†åˆå…ƒç´ , ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zReverseRangeByScoreWithScores</span><span class="params">(</span></span><br><span class="line"><span class="params">            String key, <span class="type">double</span> min, <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRangeByScoreWithScores(key,</span><br><span class="line">                min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">zReverseRangeByScore</span><span class="params">(String key, <span class="type">double</span> min,</span></span><br><span class="line"><span class="params">                                            <span class="type">double</span> max, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().reverseRangeByScore(key, min, max,</span><br><span class="line">                start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®scoreå€¼è·å–é›†åˆå…ƒç´ æ•°é‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zCount</span><span class="params">(String key, <span class="type">double</span> min, <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().count(key, min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆå¤§å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zSize</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆå¤§å°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zZCard</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().zCard(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é›†åˆä¸­valueå…ƒç´ çš„scoreå€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">zScore</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().score(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤æŒ‡å®šç´¢å¼•ä½ç½®çš„æˆå‘˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zRemoveRange</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().removeRange(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®æŒ‡å®šçš„scoreå€¼çš„èŒƒå›´æ¥ç§»é™¤æˆå‘˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> min</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> max</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zRemoveRangeByScore</span><span class="params">(String key, <span class="type">double</span> min, <span class="type">double</span> max)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().removeRangeByScore(key, min, max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–keyå’ŒotherKeyçš„å¹¶é›†å¹¶å­˜å‚¨åœ¨destKeyä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zUnionAndStore</span><span class="params">(String key, String otherKey, String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().unionAndStore(key, otherKey, destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zUnionAndStore</span><span class="params">(String key, Collection&lt;String&gt; otherKeys,</span></span><br><span class="line"><span class="params">                               String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet()</span><br><span class="line">                .unionAndStore(key, otherKeys, destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº¤é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zIntersectAndStore</span><span class="params">(String key, String otherKey,</span></span><br><span class="line"><span class="params">                                   String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().intersectAndStore(key, otherKey,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº¤é›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> otherKeys</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> destKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">zIntersectAndStore</span><span class="params">(String key, Collection&lt;String&gt; otherKeys,</span></span><br><span class="line"><span class="params">                                   String destKey)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().intersectAndStore(key, otherKeys,</span><br><span class="line">                destKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> options</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Cursor&lt;TypedTuple&lt;String&gt;&gt; <span class="title function_">zScan</span><span class="params">(String key, ScanOptions options)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForZSet().scan(key, options);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰«æä¸»é”®ï¼Œå»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> patten</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">scan</span><span class="params">(String patten)</span>&#123;</span><br><span class="line">        Set&lt;String&gt; keys = stringRedisTemplate.execute((RedisCallback&lt;Set&lt;String&gt;&gt;) connection -&gt; &#123;</span><br><span class="line">            Set&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">try</span> (Cursor&lt;<span class="type">byte</span>[]&gt; cursor = connection.scan(<span class="keyword">new</span> <span class="title class_">ScanOptions</span>.ScanOptionsBuilder()</span><br><span class="line">                    .match(patten).count(<span class="number">10000</span>).build())) &#123;</span><br><span class="line">                <span class="keyword">while</span> (cursor.hasNext()) &#123;</span><br><span class="line">                    result.add(<span class="keyword">new</span> <span class="title class_">String</span>(cursor.next()));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>  keys;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç®¡é“æŠ€æœ¯ï¼Œæé«˜æ€§èƒ½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Object&gt; <span class="title function_">lRightPushPipeline</span><span class="params">(String type,Collection&lt;String&gt; values)</span>&#123;</span><br><span class="line">        List&lt;Object&gt; results = stringRedisTemplate.executePipelined(<span class="keyword">new</span> <span class="title class_">RedisCallback</span>&lt;Object&gt;() &#123;</span><br><span class="line">                    <span class="keyword">public</span> Object <span class="title function_">doInRedis</span><span class="params">(RedisConnection connection)</span> <span class="keyword">throws</span> DataAccessException &#123;</span><br><span class="line">                        <span class="type">StringRedisConnection</span> <span class="variable">stringRedisConn</span> <span class="operator">=</span> (StringRedisConnection)connection;</span><br><span class="line">                        <span class="comment">//é›†åˆè½¬æ¢æ•°ç»„</span></span><br><span class="line">                        String[] strings = values.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[values.size()]);</span><br><span class="line">                        <span class="comment">//ç›´æ¥æ‰¹é‡å‘é€</span></span><br><span class="line">                        stringRedisConn.rPush(type, strings);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Object&gt; <span class="title function_">refreshWithPipeline</span><span class="params">(String future_key,String topic_key,Collection&lt;String&gt; values)</span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Object&gt; objects = stringRedisTemplate.executePipelined(<span class="keyword">new</span> <span class="title class_">RedisCallback</span>&lt;Object&gt;() &#123;</span><br><span class="line">            <span class="meta">@Nullable</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">doInRedis</span><span class="params">(RedisConnection redisConnection)</span> <span class="keyword">throws</span> DataAccessException &#123;</span><br><span class="line">                <span class="type">StringRedisConnection</span> <span class="variable">stringRedisConnection</span> <span class="operator">=</span> (StringRedisConnection)redisConnection;</span><br><span class="line">                String[] strings = values.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[values.size()]);</span><br><span class="line">                stringRedisConnection.rPush(topic_key,strings);</span><br><span class="line">                stringRedisConnection.zRem(future_key,strings);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> objects;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘£ï¼šæµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.schedule.test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.common.redis.CacheService;</span><br><span class="line"><span class="keyword">import</span> com.heima.schedule.ScheduleApplication;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest(classes = ScheduleApplication.class)</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CacheService cacheService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testList</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨listçš„å·¦è¾¹æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="comment">//        cacheService.lLeftPush(&quot;list_001&quot;,&quot;hello,redis&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åœ¨listçš„å³è¾¹è·å–å…ƒç´ ï¼Œå¹¶åˆ é™¤</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">list_001</span> <span class="operator">=</span> cacheService.lRightPop(<span class="string">&quot;list_001&quot;</span>);</span><br><span class="line">        System.out.println(list_001);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testZset</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ æ•°æ®åˆ°zsetä¸­  åˆ†å€¼</span></span><br><span class="line">        <span class="comment">/*cacheService.zAdd(&quot;zset_key_001&quot;,&quot;hello zset 001&quot;,1000);</span></span><br><span class="line"><span class="comment">        cacheService.zAdd(&quot;zset_key_001&quot;,&quot;hello zset 002&quot;,8888);</span></span><br><span class="line"><span class="comment">        cacheService.zAdd(&quot;zset_key_001&quot;,&quot;hello zset 003&quot;,7777);</span></span><br><span class="line"><span class="comment">        cacheService.zAdd(&quot;zset_key_001&quot;,&quot;hello zset 004&quot;,999999);*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŒ‰ç…§åˆ†å€¼è·å–æ•°æ®</span></span><br><span class="line">        Set&lt;String&gt; zset_key_001 = cacheService.zRangeByScore(<span class="string">&quot;zset_key_001&quot;</span>, <span class="number">0</span>, <span class="number">8888</span>);</span><br><span class="line">        System.out.println(zset_key_001);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-5-æ·»åŠ ä»»åŠ¡">4.5)æ·»åŠ ä»»åŠ¡</h4><p>â‘ ï¼šæ‹·è´mybatis-plusç”Ÿæˆçš„æ–‡ä»¶ï¼Œmapper</p><p>â‘¡ï¼šåˆ›å»ºtaskç±»ï¼Œç”¨äºæ¥æ”¶æ·»åŠ ä»»åŠ¡çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.model.schedule.dtos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long taskId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer taskType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer priority;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œid</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> executeTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * taskå‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] parameters;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¢ï¼šåˆ›å»ºTaskService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.schedule.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.dtos.Task;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹å¤–è®¿é—®æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TaskService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task   ä»»åŠ¡å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">addTask</span><span class="params">(Task task)</span> ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.schedule.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.heima.common.constants.ScheduleConstants;</span><br><span class="line"><span class="keyword">import</span> com.heima.common.redis.CacheService;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.dtos.Task;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.pojos.Taskinfo;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.pojos.TaskinfoLogs;</span><br><span class="line"><span class="keyword">import</span> com.heima.schedule.mapper.TaskinfoLogsMapper;</span><br><span class="line"><span class="keyword">import</span> com.heima.schedule.mapper.TaskinfoMapper;</span><br><span class="line"><span class="keyword">import</span> com.heima.schedule.service.TaskService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">TaskService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ å»¶è¿Ÿä»»åŠ¡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">addTask</span><span class="params">(Task task)</span> &#123;</span><br><span class="line">        <span class="comment">//1.æ·»åŠ ä»»åŠ¡åˆ°æ•°æ®åº“ä¸­</span></span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> addTaskToDb(task);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (success) &#123;</span><br><span class="line">            <span class="comment">//2.æ·»åŠ ä»»åŠ¡åˆ°redis</span></span><br><span class="line">            addTaskToCache(task);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> task.getTaskId();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CacheService cacheService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠä»»åŠ¡æ·»åŠ åˆ°redisä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addTaskToCache</span><span class="params">(Task task)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> task.getTaskType() + <span class="string">&quot;_&quot;</span> + task.getPriority();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–5åˆ†é’Ÿä¹‹åçš„æ—¶é—´  æ¯«ç§’å€¼</span></span><br><span class="line">        <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">        calendar.add(Calendar.MINUTE, <span class="number">5</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">nextScheduleTime</span> <span class="operator">=</span> calendar.getTimeInMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.1 å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´å°äºç­‰äºå½“å‰æ—¶é—´ï¼Œå­˜å…¥list</span></span><br><span class="line">        <span class="keyword">if</span> (task.getExecuteTime() &lt;= System.currentTimeMillis()) &#123;</span><br><span class="line">            cacheService.lLeftPush(ScheduleConstants.TOPIC + key, JSON.toJSONString(task));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (task.getExecuteTime() &lt;= nextScheduleTime) &#123;</span><br><span class="line">            <span class="comment">//2.2 å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´å¤§äºå½“å‰æ—¶é—´ &amp;&amp; å°äºç­‰äºé¢„è®¾æ—¶é—´ï¼ˆæœªæ¥5åˆ†é’Ÿï¼‰ å­˜å…¥zsetä¸­</span></span><br><span class="line">            cacheService.zAdd(ScheduleConstants.FUTURE + key, JSON.toJSONString(task), task.getExecuteTime());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TaskinfoMapper taskinfoMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TaskinfoLogsMapper taskinfoLogsMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡åˆ°æ•°æ®åº“ä¸­</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">addTaskToDb</span><span class="params">(Task task)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä¿å­˜ä»»åŠ¡è¡¨</span></span><br><span class="line">            <span class="type">Taskinfo</span> <span class="variable">taskinfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Taskinfo</span>();</span><br><span class="line">            BeanUtils.copyProperties(task, taskinfo);</span><br><span class="line">            taskinfo.setExecuteTime(<span class="keyword">new</span> <span class="title class_">Date</span>(task.getExecuteTime()));</span><br><span class="line">            taskinfoMapper.insert(taskinfo);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//è®¾ç½®taskID</span></span><br><span class="line">            task.setTaskId(taskinfo.getTaskId());</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ä¿å­˜ä»»åŠ¡æ—¥å¿—æ•°æ®</span></span><br><span class="line">            <span class="type">TaskinfoLogs</span> <span class="variable">taskinfoLogs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TaskinfoLogs</span>();</span><br><span class="line">            BeanUtils.copyProperties(taskinfo, taskinfoLogs);</span><br><span class="line">            taskinfoLogs.setVersion(<span class="number">1</span>);</span><br><span class="line">            taskinfoLogs.setStatus(ScheduleConstants.SCHEDULED);</span><br><span class="line">            taskinfoLogsMapper.insert(taskinfoLogs);</span><br><span class="line"></span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ScheduleConstantså¸¸é‡ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.common.constants;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScheduleConstants</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//taskçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> SCHEDULED=<span class="number">0</span>;   <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> EXECUTED=<span class="number">1</span>;       <span class="comment">//å·²æ‰§è¡ŒçŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> CANCELLED=<span class="number">2</span>;   <span class="comment">//å·²å–æ¶ˆçŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String FUTURE=<span class="string">&quot;future_&quot;</span>;   <span class="comment">//æœªæ¥æ•°æ®keyå‰ç¼€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String TOPIC=<span class="string">&quot;topic_&quot;</span>;     <span class="comment">//å½“å‰æ•°æ®keyå‰ç¼€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘£ï¼šæµ‹è¯•</p><h4 id="4-6-å–æ¶ˆä»»åŠ¡">4.6)å–æ¶ˆä»»åŠ¡</h4><p>åœ¨TaskServiceä¸­æ·»åŠ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å–æ¶ˆä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> taskId        ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>              å–æ¶ˆç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">cancelTask</span><span class="params">(<span class="type">long</span> taskId)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å–æ¶ˆä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> taskId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">cancelTask</span><span class="params">(<span class="type">long</span> taskId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤ä»»åŠ¡ï¼Œæ›´æ–°æ—¥å¿—</span></span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> updateDb(taskId,ScheduleConstants.EXECUTED);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤redisçš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span>(task != <span class="literal">null</span>)&#123;</span><br><span class="line">        removeTaskFromCache(task);</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤redisä¸­çš„ä»»åŠ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">removeTaskFromCache</span><span class="params">(Task task)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> task.getTaskType()+<span class="string">&quot;_&quot;</span>+task.getPriority();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(task.getExecuteTime()&lt;=System.currentTimeMillis())&#123;</span><br><span class="line">        cacheService.lRemove(ScheduleConstants.TOPIC+key,<span class="number">0</span>,JSON.toJSONString(task));</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        cacheService.zRemove(ScheduleConstants.FUTURE+key, JSON.toJSONString(task));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ä»»åŠ¡ï¼Œæ›´æ–°ä»»åŠ¡æ—¥å¿—çŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> taskId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> Task <span class="title function_">updateDb</span><span class="params">(<span class="type">long</span> taskId, <span class="type">int</span> status)</span> &#123;</span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ é™¤ä»»åŠ¡</span></span><br><span class="line">        taskinfoMapper.deleteById(taskId);</span><br><span class="line"></span><br><span class="line">        <span class="type">TaskinfoLogs</span> <span class="variable">taskinfoLogs</span> <span class="operator">=</span> taskinfoLogsMapper.selectById(taskId);</span><br><span class="line">        taskinfoLogs.setStatus(status);</span><br><span class="line">        taskinfoLogsMapper.updateById(taskinfoLogs);</span><br><span class="line"></span><br><span class="line">        task = <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">        BeanUtils.copyProperties(taskinfoLogs,task);</span><br><span class="line">        task.setExecuteTime(taskinfoLogs.getExecuteTime().getTime());</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        log.error(<span class="string">&quot;task cancel exception taskid=&#123;&#125;&quot;</span>,taskId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> task;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><h4 id="4-7-æ¶ˆè´¹ä»»åŠ¡">4.7)æ¶ˆè´¹ä»»åŠ¡</h4><p>åœ¨TaskServiceä¸­æ·»åŠ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‰ç…§ç±»å‹å’Œä¼˜å…ˆçº§æ¥æ‹‰å–ä»»åŠ¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> priority</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Task <span class="title function_">poll</span><span class="params">(<span class="type">int</span> type,<span class="type">int</span> priority)</span>;</span><br></pre></td></tr></table></figure><p>å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ç±»å‹å’Œä¼˜å…ˆçº§æ‹‰å–ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Task <span class="title function_">poll</span><span class="params">(<span class="type">int</span> type,<span class="type">int</span> priority)</span> &#123;</span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> type+<span class="string">&quot;_&quot;</span>+priority;</span><br><span class="line">        <span class="type">String</span> <span class="variable">task_json</span> <span class="operator">=</span> cacheService.lRightPop(ScheduleConstants.TOPIC + key);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isNotBlank(task_json))&#123;</span><br><span class="line">            task = JSON.parseObject(task_json, Task.class);</span><br><span class="line">            <span class="comment">//æ›´æ–°æ•°æ®åº“ä¿¡æ¯</span></span><br><span class="line">            updateDb(task.getTaskId(),ScheduleConstants.EXECUTED);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        log.error(<span class="string">&quot;poll task exception&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> task;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-8-æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°">4.8)æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°</h4><h5 id="4-8-1-reids-keyå€¼åŒ¹é…">4.8.1)reids keyå€¼åŒ¹é…</h5><p>æ–¹æ¡ˆ1ï¼škeys æ¨¡ç³ŠåŒ¹é…</p><p>keysçš„æ¨¡ç³ŠåŒ¹é…åŠŸèƒ½å¾ˆæ–¹ä¾¿ä¹Ÿå¾ˆå¼ºå¤§ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒéœ€è¦æ…ç”¨ï¼å¼€å‘ä¸­ä½¿ç”¨keysçš„æ¨¡ç³ŠåŒ¹é…å´å‘ç°redisçš„CPUä½¿ç”¨ç‡æé«˜ï¼Œæ‰€ä»¥å…¬å¸çš„redisç”Ÿäº§ç¯å¢ƒå°†keyså‘½ä»¤ç¦ç”¨äº†ï¼redisæ˜¯å•çº¿ç¨‹ï¼Œä¼šè¢«å µå¡</p><p><a href="https://imgse.com/i/pk7pdhQ"><img src="https://s21.ax1x.com/2024/07/21/pk7pdhQ.png" alt="pk7pdhQ.png"></a></p><p>æ–¹æ¡ˆ2ï¼šscan</p><p>SCAN å‘½ä»¤æ˜¯ä¸€ä¸ªåŸºäºæ¸¸æ ‡çš„è¿­ä»£å™¨ï¼ŒSCANå‘½ä»¤æ¯æ¬¡è¢«è°ƒç”¨ä¹‹åï¼Œ éƒ½ä¼šå‘ç”¨æˆ·è¿”å›ä¸€ä¸ªæ–°çš„æ¸¸æ ‡ï¼Œ ç”¨æˆ·åœ¨ä¸‹æ¬¡è¿­ä»£æ—¶éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–°æ¸¸æ ‡ä½œä¸ºSCANå‘½ä»¤çš„æ¸¸æ ‡å‚æ•°ï¼Œ ä»¥æ­¤æ¥å»¶ç»­ä¹‹å‰çš„è¿­ä»£è¿‡ç¨‹ã€‚</p><p><a href="https://imgse.com/i/pk7p0pj"><img src="https://s21.ax1x.com/2024/07/21/pk7p0pj.png" alt="pk7p0pj.png"></a></p><p>ä»£ç æ¡ˆä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testKeys</span><span class="params">()</span>&#123;</span><br><span class="line">    Set&lt;String&gt; keys = cacheService.keys(<span class="string">&quot;future_*&quot;</span>);</span><br><span class="line">    System.out.println(keys);</span><br><span class="line"></span><br><span class="line">    Set&lt;String&gt; scan = cacheService.scan(<span class="string">&quot;future_*&quot;</span>);</span><br><span class="line">    System.out.println(scan);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-8-2-reidsç®¡é“">4.8.2)reidsç®¡é“</h5><p>æ™®é€šrediså®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’æ¨¡å¼</p><p><a href="https://imgse.com/i/pk7pB1s"><img src="https://s21.ax1x.com/2024/07/21/pk7pB1s.png" alt="pk7pB1s.png"></a></p><p>Pipelineè¯·æ±‚æ¨¡å‹</p><p><a href="https://imgse.com/i/pk7pyn0"><img src="https://s21.ax1x.com/2024/07/21/pk7pyn0.png" alt="pk7pyn0.png"></a></p><p>å®˜æ–¹æµ‹è¯•ç»“æœæ•°æ®å¯¹æ¯”</p><p><a href="https://imgse.com/i/pk7pRNF"><img src="https://s21.ax1x.com/2024/07/21/pk7pRNF.png" alt="pk7pRNF.png"></a></p><p>æµ‹è¯•æ¡ˆä¾‹å¯¹æ¯”ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è€—æ—¶6151</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">testPiple1</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span>System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;<span class="number">10000</span> ; i++) &#123;</span><br><span class="line">        <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">        task.setTaskType(<span class="number">1001</span>);</span><br><span class="line">        task.setPriority(<span class="number">1</span>);</span><br><span class="line">        task.setExecuteTime(<span class="keyword">new</span> <span class="title class_">Date</span>().getTime());</span><br><span class="line">        cacheService.lLeftPush(<span class="string">&quot;1001_1&quot;</span>, JSON.toJSONString(task));</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;è€—æ—¶&quot;</span>+(System.currentTimeMillis()- start));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPiple2</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span>  <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="comment">//ä½¿ç”¨ç®¡é“æŠ€æœ¯</span></span><br><span class="line">    List&lt;Object&gt; objectList = cacheService.getstringRedisTemplate().executePipelined(<span class="keyword">new</span> <span class="title class_">RedisCallback</span>&lt;Object&gt;() &#123;</span><br><span class="line">        <span class="meta">@Nullable</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">doInRedis</span><span class="params">(RedisConnection redisConnection)</span> <span class="keyword">throws</span> DataAccessException &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;<span class="number">10000</span> ; i++) &#123;</span><br><span class="line">                <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">                task.setTaskType(<span class="number">1001</span>);</span><br><span class="line">                task.setPriority(<span class="number">1</span>);</span><br><span class="line">                task.setExecuteTime(<span class="keyword">new</span> <span class="title class_">Date</span>().getTime());</span><br><span class="line">                redisConnection.lPush(<span class="string">&quot;1001_1&quot;</span>.getBytes(), JSON.toJSONString(task).getBytes());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    System.out.println(<span class="string">&quot;ä½¿ç”¨ç®¡é“æŠ€æœ¯æ‰§è¡Œ10000æ¬¡è‡ªå¢æ“ä½œå…±è€—æ—¶:&quot;</span>+(System.currentTimeMillis()-start)+<span class="string">&quot;æ¯«ç§’&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-8-3-æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°-åŠŸèƒ½å®Œæˆ">4.8.3)æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°-åŠŸèƒ½å®Œæˆ</h5><p>åœ¨TaskServiceä¸­æ·»åŠ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scheduled(cron = &quot;0 */1 * * * ?&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">refresh</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(System.currentTimeMillis() / <span class="number">1000</span> + <span class="string">&quot;æ‰§è¡Œäº†å®šæ—¶ä»»åŠ¡&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰æœªæ¥æ•°æ®é›†åˆçš„keyå€¼</span></span><br><span class="line">    Set&lt;String&gt; futureKeys = cacheService.scan(ScheduleConstants.FUTURE + <span class="string">&quot;*&quot;</span>);<span class="comment">// future_*</span></span><br><span class="line">    <span class="keyword">for</span> (String futureKey : futureKeys) &#123; <span class="comment">// future_250_250</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">topicKey</span> <span class="operator">=</span> ScheduleConstants.TOPIC + futureKey.split(ScheduleConstants.FUTURE)[<span class="number">1</span>];</span><br><span class="line">        <span class="comment">//è·å–è¯¥ç»„keyä¸‹å½“å‰éœ€è¦æ¶ˆè´¹çš„ä»»åŠ¡æ•°æ®</span></span><br><span class="line">        Set&lt;String&gt; tasks = cacheService.zRangeByScore(futureKey, <span class="number">0</span>, System.currentTimeMillis());</span><br><span class="line">        <span class="keyword">if</span> (!tasks.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//å°†è¿™äº›ä»»åŠ¡æ•°æ®æ·»åŠ åˆ°æ¶ˆè´¹è€…é˜Ÿåˆ—ä¸­</span></span><br><span class="line">            cacheService.refreshWithPipeline(futureKey, topicKey, tasks);</span><br><span class="line">            System.out.println(<span class="string">&quot;æˆåŠŸçš„å°†&quot;</span> + futureKey + <span class="string">&quot;ä¸‹çš„å½“å‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ•°æ®åˆ·æ–°åˆ°&quot;</span> + topicKey + <span class="string">&quot;ä¸‹&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¼•å¯¼ç±»ä¸­æ·»åŠ å¼€å¯ä»»åŠ¡è°ƒåº¦æ³¨è§£ï¼š<code>@EnableScheduling</code></p><h4 id="4-9-åˆ†å¸ƒå¼é”è§£å†³é›†ç¾¤ä¸‹çš„æ–¹æ³•æŠ¢å æ‰§è¡Œ">4.9)åˆ†å¸ƒå¼é”è§£å†³é›†ç¾¤ä¸‹çš„æ–¹æ³•æŠ¢å æ‰§è¡Œ</h4><h5 id="4-9-1-é—®é¢˜æè¿°">4.9.1)é—®é¢˜æè¿°</h5><p>å¯åŠ¨ä¸¤å°eadnews-scheduleæœåŠ¡ï¼Œæ¯å°æœåŠ¡éƒ½ä¼šå»æ‰§è¡Œrefreshå®šæ—¶ä»»åŠ¡æ–¹æ³•</p><h5 id="4-9-2-åˆ†å¸ƒå¼é”">4.9.2)åˆ†å¸ƒå¼é”</h5><p>åˆ†å¸ƒå¼é”ï¼šæ§åˆ¶åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰åºçš„å»å¯¹å…±äº«èµ„æºè¿›è¡Œæ“ä½œï¼Œé€šè¿‡äº’æ–¥æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p><a href="https://imgse.com/i/pk7p5cR"><img src="https://s21.ax1x.com/2024/07/21/pk7p5cR.png" alt="pk7p5cR.png"></a></p><h5 id="4-9-3-redisåˆ†å¸ƒå¼é”">4.9.3)redisåˆ†å¸ƒå¼é”</h5><p>sexnx ï¼ˆSET if Not eXistsï¼‰ å‘½ä»¤åœ¨æŒ‡å®šçš„ key ä¸å­˜åœ¨æ—¶ï¼Œä¸º key è®¾ç½®æŒ‡å®šçš„å€¼ã€‚</p><p><a href="https://imgse.com/i/pk7pIj1"><img src="https://s21.ax1x.com/2024/07/21/pk7pIj1.png" alt="pk7pIj1.png"></a></p><p>è¿™ç§åŠ é”çš„æ€è·¯æ˜¯ï¼Œå¦‚æœ key ä¸å­˜åœ¨åˆ™ä¸º key è®¾ç½® valueï¼Œå¦‚æœ key å·²å­˜åœ¨åˆ™ SETNX å‘½ä»¤ä¸åšä»»ä½•æ“ä½œ</p><ul><li>å®¢æˆ·ç«¯Aè¯·æ±‚æœåŠ¡å™¨è®¾ç½®keyçš„å€¼ï¼Œå¦‚æœè®¾ç½®æˆåŠŸå°±è¡¨ç¤ºåŠ é”æˆåŠŸ</li><li>å®¢æˆ·ç«¯Bä¹Ÿå»è¯·æ±‚æœåŠ¡å™¨è®¾ç½®keyçš„å€¼ï¼Œå¦‚æœè¿”å›å¤±è´¥ï¼Œé‚£ä¹ˆå°±ä»£è¡¨åŠ é”å¤±è´¥</li><li>å®¢æˆ·ç«¯Aæ‰§è¡Œä»£ç å®Œæˆï¼Œåˆ é™¤é”</li><li>å®¢æˆ·ç«¯Båœ¨ç­‰å¾…ä¸€æ®µæ—¶é—´åå†å»è¯·æ±‚è®¾ç½®keyçš„å€¼ï¼Œè®¾ç½®æˆåŠŸ</li><li>å®¢æˆ·ç«¯Bæ‰§è¡Œä»£ç å®Œæˆï¼Œåˆ é™¤é”</li></ul><h5 id="4-9-4-åœ¨å·¥å…·ç±»CacheServiceä¸­æ·»åŠ æ–¹æ³•">4.9.4)åœ¨å·¥å…·ç±»CacheServiceä¸­æ·»åŠ æ–¹æ³•</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠ é”</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> expire</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">tryLock</span><span class="params">(String name, <span class="type">long</span> expire)</span> &#123;</span><br><span class="line">    name = name + <span class="string">&quot;_lock&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">    <span class="type">RedisConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> stringRedisTemplate.getConnectionFactory();</span><br><span class="line">    <span class="type">RedisConnection</span> <span class="variable">conn</span> <span class="operator">=</span> factory.getConnection();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‚è€ƒrediså‘½ä»¤ï¼š</span></span><br><span class="line">        <span class="comment">//set key value [EX seconds] [PX milliseconds] [NX|XX]</span></span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> conn.set(</span><br><span class="line">                name.getBytes(),</span><br><span class="line">                token.getBytes(),</span><br><span class="line">                Expiration.from(expire, TimeUnit.MILLISECONDS),</span><br><span class="line">                RedisStringCommands.SetOption.SET_IF_ABSENT <span class="comment">//NX</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span> &amp;&amp; result)</span><br><span class="line">            <span class="keyword">return</span> token;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        RedisConnectionUtils.releaseConnection(conn, factory,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Scheduled(cron = &quot;0 */1 * * * ?&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">refresh</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> cacheService.tryLock(<span class="string">&quot;FUTURE_TASK_SYNC&quot;</span>, <span class="number">1000</span> * <span class="number">30</span>);</span><br><span class="line">    <span class="keyword">if</span>(StringUtils.isNotBlank(token))&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æœªæ¥æ•°æ®å®šæ—¶åˆ·æ–°---å®šæ—¶ä»»åŠ¡&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æ‰€æœ‰æœªæ¥æ•°æ®çš„é›†åˆkey</span></span><br><span class="line">        Set&lt;String&gt; futureKeys = cacheService.scan(ScheduleConstants.FUTURE + <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String futureKey : futureKeys) &#123;<span class="comment">//future_100_50</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//è·å–å½“å‰æ•°æ®çš„key  topic</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">topicKey</span> <span class="operator">=</span> ScheduleConstants.TOPIC+futureKey.split(ScheduleConstants.FUTURE)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æŒ‰ç…§keyå’Œåˆ†å€¼æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ•°æ®</span></span><br><span class="line">            Set&lt;String&gt; tasks = cacheService.zRangeByScore(futureKey, <span class="number">0</span>, System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">            <span class="comment">//åŒæ­¥æ•°æ®</span></span><br><span class="line">            <span class="keyword">if</span>(!tasks.isEmpty())&#123;</span><br><span class="line">                cacheService.refreshWithPipeline(futureKey,topicKey,tasks);</span><br><span class="line">                log.info(<span class="string">&quot;æˆåŠŸçš„å°†&quot;</span>+futureKey+<span class="string">&quot;åˆ·æ–°åˆ°äº†&quot;</span>+topicKey);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-10-æ•°æ®åº“åŒæ­¥åˆ°redis">4.10)æ•°æ®åº“åŒæ­¥åˆ°redis</h4><p><a href="https://imgse.com/i/pk7pTnx"><img src="https://s21.ax1x.com/2024/07/21/pk7pTnx.png" alt="pk7pTnx.png"></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scheduled(cron = &quot;0 */5 * * * ?&quot;)</span></span><br><span class="line"><span class="meta">@PostConstruct</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reloadData</span><span class="params">()</span> &#123;</span><br><span class="line">    clearCache();</span><br><span class="line">    log.info(<span class="string">&quot;æ•°æ®åº“æ•°æ®åŒæ­¥åˆ°ç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">    calendar.add(Calendar.MINUTE, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥çœ‹å°äºæœªæ¥5åˆ†é’Ÿçš„æ‰€æœ‰ä»»åŠ¡</span></span><br><span class="line">    List&lt;Taskinfo&gt; allTasks = taskinfoMapper.selectList(Wrappers.&lt;Taskinfo&gt;lambdaQuery().lt(Taskinfo::getExecuteTime,calendar.getTime()));</span><br><span class="line">    <span class="keyword">if</span>(allTasks != <span class="literal">null</span> &amp;&amp; allTasks.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span> (Taskinfo taskinfo : allTasks) &#123;</span><br><span class="line">            <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">            BeanUtils.copyProperties(taskinfo,task);</span><br><span class="line">            task.setExecuteTime(taskinfo.getExecuteTime().getTime());</span><br><span class="line">            addTaskToCache(task);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">clearCache</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// åˆ é™¤ç¼“å­˜ä¸­æœªæ¥æ•°æ®é›†åˆå’Œå½“å‰æ¶ˆè´¹è€…é˜Ÿåˆ—çš„æ‰€æœ‰key</span></span><br><span class="line">    Set&lt;String&gt; futurekeys = cacheService.scan(ScheduleConstants.FUTURE + <span class="string">&quot;*&quot;</span>);<span class="comment">// future_</span></span><br><span class="line">    Set&lt;String&gt; topickeys = cacheService.scan(ScheduleConstants.TOPIC + <span class="string">&quot;*&quot;</span>);<span class="comment">// topic_</span></span><br><span class="line">    cacheService.delete(futurekeys);</span><br><span class="line">    cacheService.delete(topickeys);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-å»¶è¿Ÿé˜Ÿåˆ—è§£å†³ç²¾å‡†æ—¶é—´å‘å¸ƒæ–‡ç« ">5)å»¶è¿Ÿé˜Ÿåˆ—è§£å†³ç²¾å‡†æ—¶é—´å‘å¸ƒæ–‡ç« </h3><h5 id="5-1-å»¶è¿Ÿé˜Ÿåˆ—æœåŠ¡æä¾›å¯¹å¤–æ¥å£">5.1)å»¶è¿Ÿé˜Ÿåˆ—æœåŠ¡æä¾›å¯¹å¤–æ¥å£</h5><p>æä¾›è¿œç¨‹çš„feignæ¥å£ï¼Œåœ¨heima-leadnews-feign-apiç¼–å†™ç±»å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.apis.schedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.model.common.dtos.ResponseResult;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.dtos.Task;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(&quot;leadnews-schedule&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IScheduleClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task   ä»»åŠ¡å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/api/v1/task/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult  <span class="title function_">addTask</span><span class="params">(<span class="meta">@RequestBody</span> Task task)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å–æ¶ˆä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> taskId        ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>              å–æ¶ˆç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/v1/task/cancel/&#123;taskId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult <span class="title function_">cancelTask</span><span class="params">(<span class="meta">@PathVariable(&quot;taskId&quot;)</span> <span class="type">long</span> taskId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ç±»å‹å’Œä¼˜å…ˆçº§æ¥æ‹‰å–ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> priority</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/v1/task/poll/&#123;type&#125;/&#123;priority&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult <span class="title function_">poll</span><span class="params">(<span class="meta">@PathVariable(&quot;type&quot;)</span> <span class="type">int</span> type,<span class="meta">@PathVariable(&quot;priority&quot;)</span>  <span class="type">int</span> priority)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨heima-leadnews-scheduleå¾®æœåŠ¡ä¸‹æä¾›å¯¹åº”çš„å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.schedule.feign;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.apis.schedule.IScheduleClient;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.common.dtos.ResponseResult;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.dtos.Task;</span><br><span class="line"><span class="keyword">import</span> com.heima.schedule.service.TaskService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScheduleClient</span>  <span class="keyword">implements</span> <span class="title class_">IScheduleClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TaskService taskService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> task ä»»åŠ¡å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/api/v1/task/add&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult <span class="title function_">addTask</span><span class="params">(<span class="meta">@RequestBody</span> Task task)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseResult.okResult(taskService.addTask(task));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å–æ¶ˆä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> taskId ä»»åŠ¡id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å–æ¶ˆç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/v1/task/cancel/&#123;taskId&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult <span class="title function_">cancelTask</span><span class="params">(<span class="meta">@PathVariable(&quot;taskId&quot;)</span> <span class="type">long</span> taskId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseResult.okResult(taskService.cancelTask(taskId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‰ç…§ç±»å‹å’Œä¼˜å…ˆçº§æ¥æ‹‰å–ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> priority</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/v1/task/poll/&#123;type&#125;/&#123;priority&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseResult <span class="title function_">poll</span><span class="params">(<span class="meta">@PathVariable(&quot;type&quot;)</span> <span class="type">int</span> type, <span class="meta">@PathVariable(&quot;priority&quot;)</span> <span class="type">int</span> priority)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseResult.okResult(taskService.poll(type,priority));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-2-å‘å¸ƒæ–‡ç« é›†æˆæ·»åŠ å»¶è¿Ÿé˜Ÿåˆ—æ¥å£">5.2)å‘å¸ƒæ–‡ç« é›†æˆæ·»åŠ å»¶è¿Ÿé˜Ÿåˆ—æ¥å£</h5><p>åœ¨åˆ›å»ºWmNewsTaskService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.wemedia.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.model.wemedia.pojos.WmNews;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WmNewsTaskService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡åˆ°å»¶è¿Ÿé˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id  æ–‡ç« çš„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> publishTime  å‘å¸ƒçš„æ—¶é—´  å¯ä»¥åšä¸ºä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addNewsToTask</span><span class="params">(Integer id, Date publishTime)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.wemedia.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.heima.apis.schedule.IScheduleClient;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.common.enums.TaskTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.schedule.dtos.Task;</span><br><span class="line"><span class="keyword">import</span> com.heima.model.wemedia.pojos.WmNews;</span><br><span class="line"><span class="keyword">import</span> com.heima.utils.common.ProtostuffUtil;</span><br><span class="line"><span class="keyword">import</span> com.heima.wemedia.service.WmNewsTaskService;</span><br><span class="line"><span class="keyword">import</span> lombok.SneakyThrows;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Async;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WmNewsTaskServiceImpl</span>  <span class="keyword">implements</span> <span class="title class_">WmNewsTaskService</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IScheduleClient scheduleClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ ä»»åŠ¡åˆ°å»¶è¿Ÿé˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id          æ–‡ç« çš„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> publishTime å‘å¸ƒçš„æ—¶é—´  å¯ä»¥åšä¸ºä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addNewsToTask</span><span class="params">(Integer id, Date publishTime)</span> &#123;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;æ·»åŠ ä»»åŠ¡åˆ°å»¶è¿ŸæœåŠ¡ä¸­----begin&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>();</span><br><span class="line">        task.setExecuteTime(publishTime.getTime());</span><br><span class="line">        task.setTaskType(TaskTypeEnum.NEWS_SCAN_TIME.getTaskType());</span><br><span class="line">        task.setPriority(TaskTypeEnum.NEWS_SCAN_TIME.getPriority());</span><br><span class="line">        <span class="type">WmNews</span> <span class="variable">wmNews</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WmNews</span>();</span><br><span class="line">        wmNews.setId(id);</span><br><span class="line">        task.setParameters(ProtostuffUtil.serialize(wmNews));</span><br><span class="line"></span><br><span class="line">        scheduleClient.addTask(task);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;æ·»åŠ ä»»åŠ¡åˆ°å»¶è¿ŸæœåŠ¡ä¸­----end&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æšä¸¾ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.heima.model.common.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">TaskTypeEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    NEWS_SCAN_TIME(<span class="number">1001</span>, <span class="number">1</span>,<span class="string">&quot;æ–‡ç« å®šæ—¶å®¡æ ¸&quot;</span>),</span><br><span class="line">    REMOTEERROR(<span class="number">1002</span>, <span class="number">2</span>,<span class="string">&quot;ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨å¤±è´¥ï¼Œé‡è¯•&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> taskType; <span class="comment">//å¯¹åº”å…·ä½“ä¸šåŠ¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> priority; <span class="comment">//ä¸šåŠ¡ä¸åŒçº§åˆ«</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String desc; <span class="comment">//æè¿°ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–å·¥å…·å¯¹æ¯”</p><ul><li>JdkSerializeï¼šjavaå†…ç½®çš„åºåˆ—åŒ–èƒ½å°†å®ç°äº†Serilazableæ¥å£çš„å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œ ObjectOutputStreamçš„writeObject()æ–¹æ³•å¯åºåˆ—åŒ–å¯¹è±¡ç”Ÿæˆå­—èŠ‚æ•°ç»„</li><li>Protostuffï¼šgoogleå¼€æºçš„protostuffé‡‡ç”¨æ›´ä¸ºç´§å‡‘çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œè¡¨ç°æ›´åŠ ä¼˜å¼‚ï¼Œç„¶åä½¿ç”¨protostuffçš„ç¼–è¯‘å·¥å…·ç”Ÿæˆpojoç±»</li></ul><p>å·¥å…·ç±»ï¼š</p><p>JdkSerializeUtil</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdkåºåˆ—åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdkSerializeUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> obj</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="type">byte</span>[] serialize(T obj) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (obj  == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line"></span><br><span class="line">            oos.writeObject(obj);</span><br><span class="line">            <span class="keyword">return</span> bos.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(<span class="type">byte</span>[] data, Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(data);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(bis);</span><br><span class="line">            <span class="type">T</span> <span class="variable">obj</span> <span class="operator">=</span> (T)ois.readObject();</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ProtostuffUtil:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProtostuffUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> t</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="type">byte</span>[] serialize(T t)&#123;</span><br><span class="line">        <span class="type">Schema</span> <span class="variable">schema</span> <span class="operator">=</span> RuntimeSchema.getSchema(t.getClass());</span><br><span class="line">        <span class="keyword">return</span> ProtostuffIOUtil.toByteArray(t,schema,</span><br><span class="line">                LinkedBuffer.allocate(LinkedBuffer.DEFAULT_BUFFER_SIZE));</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> c</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(<span class="type">byte</span> []bytes,Class&lt;T&gt; c)</span> &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t = c.newInstance();</span><br><span class="line">            <span class="type">Schema</span> <span class="variable">schema</span> <span class="operator">=</span> RuntimeSchema.getSchema(t.getClass());</span><br><span class="line">             ProtostuffIOUtil.mergeFrom(bytes,t,schema);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * jdkåºåˆ—åŒ–ä¸protostuffåºåˆ—åŒ–å¯¹æ¯”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span>System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;<span class="number">1000000</span> ; i++) &#123;</span><br><span class="line">            <span class="type">WmNews</span> <span class="variable">wmNews</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">WmNews</span>();</span><br><span class="line">            JdkSerializeUtil.serialize(wmNews);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot; jdk èŠ±è´¹ &quot;</span>+(System.currentTimeMillis()-start));</span><br><span class="line"></span><br><span class="line">        start =System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;<span class="number">1000000</span> ; i++) &#123;</span><br><span class="line">            <span class="type">WmNews</span> <span class="variable">wmNews</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">WmNews</span>();</span><br><span class="line">            ProtostuffUtil.serialize(wmNews);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot; protostuff èŠ±è´¹ &quot;</span>+(System.currentTimeMillis()-start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Protostufféœ€è¦å¼•å¯¼ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.protostuff<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>protostuff-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.protostuff<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>protostuff-runtime<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å‘å¸ƒæ–‡ç« ä»£ç ï¼š</p><p>æŠŠä¹‹å‰çš„å¼‚æ­¥è°ƒç”¨ä¿®æ”¹ä¸ºè°ƒç”¨å»¶è¿Ÿä»»åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> WmNewsTaskService wmNewsTaskService;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘å¸ƒä¿®æ”¹æ–‡ç« æˆ–ä¿å­˜ä¸ºè‰ç¨¿</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dto</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> ResponseResult <span class="title function_">submitNews</span><span class="params">(WmNewsDto dto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//0.æ¡ä»¶åˆ¤æ–­</span></span><br><span class="line">    <span class="keyword">if</span>(dto == <span class="literal">null</span> || dto.getContent() == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseResult.errorResult(AppHttpCodeEnum.PARAM_INVALID);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.ä¿å­˜æˆ–ä¿®æ”¹æ–‡ç« </span></span><br><span class="line"></span><br><span class="line">    <span class="type">WmNews</span> <span class="variable">wmNews</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WmNews</span>();</span><br><span class="line">    <span class="comment">//å±æ€§æ‹·è´ å±æ€§åè¯å’Œç±»å‹ç›¸åŒæ‰èƒ½æ‹·è´</span></span><br><span class="line">    BeanUtils.copyProperties(dto,wmNews);</span><br><span class="line">    <span class="comment">//å°é¢å›¾ç‰‡  list---&gt; string</span></span><br><span class="line">    <span class="keyword">if</span>(dto.getImages() != <span class="literal">null</span> &amp;&amp; dto.getImages().size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//[1dddfsd.jpg,sdlfjldk.jpg]--&gt;   1dddfsd.jpg,sdlfjldk.jpg</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">imageStr</span> <span class="operator">=</span> StringUtils.join(dto.getImages(), <span class="string">&quot;,&quot;</span>);</span><br><span class="line">        wmNews.setImages(imageStr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦‚æœå½“å‰å°é¢ç±»å‹ä¸ºè‡ªåŠ¨ -1</span></span><br><span class="line">    <span class="keyword">if</span>(dto.getType().equals(WemediaConstants.WM_NEWS_TYPE_AUTO))&#123;</span><br><span class="line">        wmNews.setType(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    saveOrUpdateWmNews(wmNews);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.åˆ¤æ–­æ˜¯å¦ä¸ºè‰ç¨¿  å¦‚æœä¸ºè‰ç¨¿ç»“æŸå½“å‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span>(dto.getStatus().equals(WmNews.Status.NORMAL.getCode()))&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseResult.okResult(AppHttpCodeEnum.SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.ä¸æ˜¯è‰ç¨¿ï¼Œä¿å­˜æ–‡ç« å†…å®¹å›¾ç‰‡ä¸ç´ æçš„å…³ç³»</span></span><br><span class="line">    <span class="comment">//è·å–åˆ°æ–‡ç« å†…å®¹ä¸­çš„å›¾ç‰‡ä¿¡æ¯</span></span><br><span class="line">    List&lt;String&gt; materials =  ectractUrlInfo(dto.getContent());</span><br><span class="line">    saveRelativeInfoForContent(materials,wmNews.getId());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.ä¸æ˜¯è‰ç¨¿ï¼Œä¿å­˜æ–‡ç« å°é¢å›¾ç‰‡ä¸ç´ æçš„å…³ç³»ï¼Œå¦‚æœå½“å‰å¸ƒå±€æ˜¯è‡ªåŠ¨ï¼Œéœ€è¦åŒ¹é…å°é¢å›¾ç‰‡</span></span><br><span class="line">    saveRelativeInfoForCover(dto,wmNews,materials);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®¡æ ¸æ–‡ç« </span></span><br><span class="line">    <span class="comment">//        wmNewsAutoScanService.autoScanWmNews(wmNews.getId());</span></span><br><span class="line">    wmNewsTaskService.addNewsToTask(wmNews.getId(),wmNews.getPublishTime());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ResponseResult.okResult(AppHttpCodeEnum.SUCCESS);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-3-æ¶ˆè´¹ä»»åŠ¡è¿›è¡Œå®¡æ ¸æ–‡ç« ">5.3)æ¶ˆè´¹ä»»åŠ¡è¿›è¡Œå®¡æ ¸æ–‡ç« </h5><p>WmNewsTaskServiceä¸­æ·»åŠ æ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶ˆè´¹å»¶è¿Ÿé˜Ÿåˆ—æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scanNewsByTask</span>()</span>;</span><br></pre></td></tr></table></figure><p>å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> WmNewsAutoScanServiceImpl wmNewsAutoScanService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¶ˆè´¹å»¶è¿Ÿé˜Ÿåˆ—æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Scheduled(fixedRate = 1000)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">scanNewsByTask</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;æ–‡ç« å®¡æ ¸---æ¶ˆè´¹ä»»åŠ¡æ‰§è¡Œ---begin---&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">ResponseResult</span> <span class="variable">responseResult</span> <span class="operator">=</span> scheduleClient.poll(TaskTypeEnum.NEWS_SCAN_TIME.getTaskType(), TaskTypeEnum.NEWS_SCAN_TIME.getPriority());</span><br><span class="line">    <span class="keyword">if</span>(responseResult.getCode().equals(<span class="number">200</span>) &amp;&amp; responseResult.getData() != <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">json_str</span> <span class="operator">=</span> JSON.toJSONString(responseResult.getData());</span><br><span class="line">        <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> JSON.parseObject(json_str, Task.class);</span><br><span class="line">        <span class="type">byte</span>[] parameters = task.getParameters();</span><br><span class="line">        <span class="type">WmNews</span> <span class="variable">wmNews</span> <span class="operator">=</span> ProtostuffUtil.deserialize(parameters, WmNews.class);</span><br><span class="line">        System.out.println(wmNews.getId()+<span class="string">&quot;-----------&quot;</span>);</span><br><span class="line">        wmNewsAutoScanService.autoScanWmNews(wmNews.getId());</span><br><span class="line">    &#125;</span><br><span class="line">    log.info(<span class="string">&quot;æ–‡ç« å®¡æ ¸---æ¶ˆè´¹ä»»åŠ¡æ‰§è¡Œ---end---&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨WemediaApplicationè‡ªåª’ä½“çš„å¼•å¯¼ç±»ä¸­æ·»åŠ å¼€å¯ä»»åŠ¡è°ƒåº¦æ³¨è§£<code>@EnableScheduling</code></p>]]></content>
    
    
    <summary type="html">æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†å»¶è¿Ÿä»»åŠ¡çš„å®ç°æ–¹å¼ï¼Œè¿˜æœ‰æˆ‘åœ¨é¡¹ç›®å¼€å‘ä¸­æ˜¯å¦‚ä½•è¿ç”¨å»¶è¿Ÿé˜Ÿåˆ—çš„ï¼ï¼ï¼</summary>
    
    
    
    <category term="ç¼–ç¨‹ç»éªŒ" scheme="https://liweierzzz.github.io/categories/%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="é¡¹ç›®ç»éªŒ" scheme="https://liweierzzz.github.io/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
    <category term="Redis" scheme="https://liweierzzz.github.io/tags/Redis/"/>
    
    <category term="å»¶è¿Ÿä»»åŠ¡" scheme="https://liweierzzz.github.io/tags/%E5%BB%B6%E8%BF%9F%E4%BB%BB%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMq-æ­»ä¿¡é˜Ÿåˆ—åœ¨æˆ‘é¡¹ç›®ä¸­çš„ç”¨æ³•</title>
    <link href="https://liweierzzz.github.io/posts/14ef5b40.html"/>
    <id>https://liweierzzz.github.io/posts/14ef5b40.html</id>
    <published>2024-07-18T14:40:55.000Z</published>
    <updated>2024-07-18T14:43:52.007Z</updated>
    
    <content type="html"><![CDATA[<h1>RabbitMq-æ­»ä¿¡é˜Ÿåˆ—ä»‹ç»å’Œç”¨æ³•</h1><h2 id="æ­»ä¿¡å’Œæ­»ä¿¡é˜Ÿåˆ—çš„æ¦‚å¿µ">æ­»ä¿¡å’Œæ­»ä¿¡é˜Ÿåˆ—çš„æ¦‚å¿µ</h2><p>ä»€ä¹ˆæ˜¯æ­»ä¿¡ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯<strong>æ— æ³•è¢«æ¶ˆè´¹å’Œå¤„ç†çš„æ¶ˆæ¯</strong>ã€‚ä¸€èˆ¬ç”Ÿäº§è€…å°†æ¶ˆæ¯æŠ•é€’åˆ°brokeræˆ–è€…queueï¼Œæ¶ˆè´¹è€…ç›´æ¥ä»ä¸­å–å‡ºæ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ã€‚ä½†æœ‰æ—¶å› ä¸ºæŸäº›åŸå› å¯¼è‡´æ¶ˆæ¯ä¸èƒ½è¢«æ¶ˆè´¹ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹åœ¨é˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·çš„<strong>æ¶ˆæ¯å¦‚æœæ²¡æœ‰åç»­çš„å¤„ç†å°±ä¼šå˜æˆæ­»ä¿¡</strong>ï¼Œé‚£ä¹ˆä¸“é—¨<strong>å­˜æ”¾æ­»ä¿¡çš„é˜Ÿåˆ—å°±æ˜¯æ­»ä¿¡é˜Ÿåˆ—</strong>ã€‚</p><hr><h2 id="ä»€ä¹ˆæ˜¯æ­»ä¿¡äº¤æ¢æœºï¼Ÿ"><strong>ä»€ä¹ˆæ˜¯æ­»ä¿¡äº¤æ¢æœºï¼Ÿ</strong></h2><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯æ­»ä¿¡äº¤æ¢æœºå‘¢ï¼Ÿæ­»ä¿¡äº¤æ¢æœºæ˜¯æŒ‡ä¸“é—¨å°†æ­»ä¿¡è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—çš„äº¤æ¢æœºã€‚</p><h2 id="äº§ç”Ÿæ­»ä¿¡çš„åŸå› "><strong>äº§ç”Ÿæ­»ä¿¡çš„åŸå› </strong></h2><ul><li>æ¶ˆæ¯è¶…è¿‡TTLï¼Œå³æ¶ˆæ¯è¿‡æœŸ</li><li>æ¶ˆæ¯è¢«nackæˆ–rejectï¼Œä¸”ä¸äºˆé‡æ–°å…¥é˜Ÿ</li><li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦</li></ul><p>å¦‚æœè¿™ä¸ªåŒ…å«æ­»ä¿¡çš„é˜Ÿåˆ—é…ç½®äº†<code>dead-letter-exchange</code>å±æ€§ï¼ŒæŒ‡å®šäº†ä¸€ä¸ªäº¤æ¢æœºï¼Œé‚£ä¹ˆé˜Ÿåˆ—ä¸­çš„æ­»ä¿¡å°±ä¼šæŠ•é€’åˆ°è¿™ä¸ªäº¤æ¢æœºä¸­ï¼Œè€Œè¿™ä¸ªäº¤æ¢æœºç§°ä¸º<strong>æ­»ä¿¡äº¤æ¢æœº</strong>ï¼ˆDead Letter Exchangeï¼Œæ£€æŸ¥DLXï¼‰ã€‚</p><p>å¦‚å›¾ï¼Œä¸€ä¸ªæ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»äº†ï¼Œå˜æˆäº†æ­»ä¿¡ï¼š\</p><p><a href="https://imgse.com/i/pkoI1gJ"><img src="https://s21.ax1x.com/2024/07/18/pkoI1gJ.png" alt="pkoI1gJ.png"></a></p><p>å› ä¸ºsimple.queueç»‘å®šäº†æ­»ä¿¡äº¤æ¢æœº dl.directï¼Œå› æ­¤æ­»ä¿¡ä¼šæŠ•é€’ç»™è¿™ä¸ªäº¤æ¢æœºï¼š</p><p><a href="https://imgse.com/i/pkoIGuR"><img src="https://s21.ax1x.com/2024/07/18/pkoIGuR.png" alt="pkoIGuR.png"></a></p><p>å¦‚æœè¿™ä¸ªæ­»ä¿¡äº¤æ¢æœºä¹Ÿç»‘å®šäº†ä¸€ä¸ªé˜Ÿåˆ—ï¼Œåˆ™æ¶ˆæ¯æœ€ç»ˆä¼šè¿›å…¥è¿™ä¸ªå­˜æ”¾æ­»ä¿¡çš„é˜Ÿåˆ—ï¼š</p><p><a href="https://imgse.com/i/pkoIJD1"><img src="https://s21.ax1x.com/2024/07/18/pkoIJD1.png" alt="pkoIJD1.png"></a></p><p>å¦å¤–ï¼Œé˜Ÿåˆ—å°†æ­»ä¿¡æŠ•é€’ç»™æ­»ä¿¡äº¤æ¢æœºæ—¶ï¼Œå¿…é¡»çŸ¥é“ä¸¤ä¸ªä¿¡æ¯ï¼š</p><ul><li>æ­»ä¿¡äº¤æ¢æœºåç§°</li><li>æ­»ä¿¡äº¤æ¢æœºä¸æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šçš„RoutingKey</li></ul><p>è¿™æ ·æ‰èƒ½ç¡®ä¿æŠ•é€’çš„æ¶ˆæ¯èƒ½åˆ°è¾¾æ­»ä¿¡äº¤æ¢æœºï¼Œå¹¶ä¸”æ­£ç¡®çš„è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚</p><p><a href="https://imgse.com/i/pkoINE6"><img src="https://s21.ax1x.com/2024/07/18/pkoINE6.png" alt="pkoINE6.png"></a></p><h2 id="TTL">TTL</h2><p>ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¦‚æœè¶…æ—¶æœªæ¶ˆè´¹ï¼Œåˆ™ä¼šå˜ä¸ºæ­»ä¿¡ï¼Œè¶…æ—¶åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p><ul><li>æ¶ˆæ¯æ‰€åœ¨çš„é˜Ÿåˆ—è®¾ç½®äº†è¶…æ—¶æ—¶é—´</li><li>æ¶ˆæ¯æœ¬èº«è®¾ç½®äº†è¶…æ—¶æ—¶é—´</li></ul><p><a href="https://imgse.com/i/pkoIK4U"><img src="https://s21.ax1x.com/2024/07/18/pkoIK4U.png" alt="pkoIK4U.png"></a></p><hr><h2 id="æ­»ä¿¡é˜Ÿåˆ—å®æˆ˜å’Œåº”ç”¨"><strong>æ­»ä¿¡é˜Ÿåˆ—å®æˆ˜å’Œåº”ç”¨</strong></h2><p>æ­»ä¿¡é˜Ÿåˆ—çš„åº”ç”¨å¹¶ä¸éš¾ï¼Œæ— éå°±æ˜¯å¤šå®šä¹‰äº†ä¸€ä¸ªäº¤æ¢æœºã€routingKeyå’Œé˜Ÿåˆ—ç½¢äº†ã€‚åœ¨å£°æ˜æ™®é€šé˜Ÿåˆ—æ—¶ä¼ å…¥Mapå‚æ•°ï¼Œå¾€Mapä¸­putæ­»ä¿¡é˜Ÿåˆ—åç§°ã€æ­»ä¿¡routingKeyã€æ¶ˆæ¯TTLç­‰å‚æ•°å³å¯å®Œæˆæ­»ä¿¡è‡ªåŠ¨æŠ•é€’åˆ°æ­»ä¿¡é˜Ÿåˆ—çš„æµç¨‹ã€‚é€šè¿‡å¦‚ä¸‹ä»£ç å³å¯ç»‘å®šæ™®é€šé˜Ÿåˆ—å’Œæ­»ä¿¡äº¤æ¢æœºäº†ï¼Œè€Œä¸”è¿˜èƒ½è®¾ç½®routingKeyå’Œé˜Ÿåˆ—é•¿åº¦ç­‰å‚æ•°ï¼Œæ— éœ€åƒä¼ ç»Ÿçš„é‚£æ ·é€šè¿‡channelç»‘å®šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// è¿‡æœŸæ—¶é—´</span></span><br><span class="line">arguments.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">10000</span>);     <span class="comment">// æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº </span></span><br><span class="line">arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, DEAD_EXCHANGE); <span class="comment">// è®¾ç½®æ­»ä¿¡</span></span><br><span class="line">routingKey arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;lisi&quot;</span>); <span class="comment">// è®¾ç½®æ­£å¸¸é˜Ÿåˆ—çš„é•¿åº¦é™åˆ¶ ã€</span></span><br><span class="line">arguments.put(<span class="string">&quot;x-max-length&quot;</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§è€…Producerï¼š<br>public class Producer { // æ™®é€šäº¤æ¢æœºåç§° public static final String NORMAL_EXCHANGE = â€œnormal_exchangeâ€;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMQUtils.getChannel();</span><br><span class="line">    <span class="comment">//æ­»ä¿¡æ¶ˆæ¯ è®¾ç½®TTLæ—¶é—´</span></span><br><span class="line">    AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties()</span><br><span class="line">            .builder().expiration(<span class="string">&quot;10000&quot;</span>).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»¶è¿Ÿæ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i &lt; <span class="number">10</span>;i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> i + <span class="string">&quot;info&quot;</span>;</span><br><span class="line">        channel.basicPublish(NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>, properties, message.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>æ™®é€šé˜Ÿåˆ—æ¶ˆè´¹è€…C1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer01</span> &#123;</span><br><span class="line">    <span class="comment">// æ™®é€šäº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;normal_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">// æ­»ä¿¡äº¤æ¢æœºåç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;dead_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">// æ™®é€šé˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;normal_queue&quot;</span>;</span><br><span class="line">    <span class="comment">// æ­»ä¿¡é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMQUtils.getChannel();</span><br><span class="line">        <span class="comment">// å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœºï¼Œç±»å‹ä¸ºdirect</span></span><br><span class="line">        channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT);</span><br><span class="line">        <span class="comment">// å£°æ˜æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-message-ttl&quot;</span>, <span class="number">10000</span>);</span><br><span class="line">        <span class="comment">// æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, DEAD_EXCHANGE);</span><br><span class="line">        <span class="comment">// è®¾ç½®æ­»ä¿¡routingKey</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®æ­£å¸¸é˜Ÿåˆ—çš„é•¿åº¦é™åˆ¶</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-max-length&quot;</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å£°æ˜æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(NORMAL_QUEUE, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, arguments);</span><br><span class="line">        <span class="comment">// å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(DEAD_QUEUE, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        channel.queueBind(NORMAL_QUEUE, NORMAL_EXCHANGE, <span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        channel.queueBind(DEAD_QUEUE, DEAD_EXCHANGE, <span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;consumer01ç­‰å¾…æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (msg.equals(<span class="string">&quot;info5&quot;</span>)) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;consumer01æ¥æ”¶çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">                System.out.println(msg + <span class="string">&quot;ï¼šæ­¤æ¶ˆæ¯æ˜¯è¢«æ‹’ç»çš„&quot;</span>);</span><br><span class="line">                channel.basicReject(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>); <span class="comment">//æ‹’ç»æ­¤æ¶ˆæ¯å¹¶ä¸æ”¾å›æ™®é€šé˜Ÿåˆ—</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;consumer01æ¥æ”¶çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">                channel.basicAck(message.getEnvelope().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;C1å–æ¶ˆæ¶ˆæ¯&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        channel.basicConsume(NORMAL_QUEUE, <span class="literal">false</span>, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…C2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer02</span> &#123;</span><br><span class="line">    <span class="comment">// æ­»ä¿¡é˜Ÿåˆ—åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEAD_QUEUE</span> <span class="operator">=</span> <span class="string">&quot;dead_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> RabbitMQUtils.getChannel();</span><br><span class="line">        System.out.println(<span class="string">&quot;consumer02ç­‰å¾…æ¥æ”¶æ¶ˆæ¯&quot;</span>);</span><br><span class="line">        <span class="type">DeliverCallback</span> <span class="variable">deliverCallback</span> <span class="operator">=</span> (consumerTag, message) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;consumer02æ¥æ”¶çš„æ¶ˆæ¯ï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">CancelCallback</span> <span class="variable">cancelCallback</span> <span class="operator">=</span> consumerTag -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;C2å–æ¶ˆæ¶ˆæ¯&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        channel.basicConsume(DEAD_QUEUE, <span class="literal">true</span>, deliverCallback, cancelCallback);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡å¯åŠ¨ç”Ÿäº§è€…ï¼Œå’Œä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶åœæ‰æ™®é€šé˜Ÿåˆ—çš„æ¶ˆè´¹è€…ï¼Œæˆ‘ä»¬å‘ç°ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯è¢«æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…C2ç»™æ¥æ”¶äº†ã€‚</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘åœ¨æ™®é€šé˜Ÿåˆ—ä¸­è®¾ç½®äº†æ¶ˆæ¯çš„TTLä¸º5sï¼Œä½†æ˜¯æˆ‘åˆåœ¨ç”Ÿäº§è€…è®¾ç½®å‘é€çš„æ¶ˆæ¯TTLä¸º10sï¼Œé‚£ä¹ˆRabbitMQä¼šä»¥å“ªä¸ªä¸ºå‡†å‘¢ï¼Ÿå…¶å®RabbitMQä¼šä»¥è¾ƒçŸ­çš„TTLä¸ºå‡†</p><hr><h2 id="æˆ‘çš„æ™ºèƒ½BIé¡¹ç›®ä¸­è¿ç”¨æ­»ä¿¡äº¤æ¢æœº">æˆ‘çš„æ™ºèƒ½BIé¡¹ç›®ä¸­è¿ç”¨æ­»ä¿¡äº¤æ¢æœº</h2><h3 id="å£°æ˜äº¤æ¢æœºã€é˜Ÿåˆ—å’ŒroutingKeyçš„é…ç½®ç±»">å£°æ˜äº¤æ¢æœºã€é˜Ÿåˆ—å’ŒroutingKeyçš„é…ç½®ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miku.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.retry.MessageRecoverer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.retry.RepublishMessageRecoverer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.miku.constant.MessageConstant.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMqConfig</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜ç”Ÿæˆæ™®é€šäº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;BiExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">Biexchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼šäº¤æ¢æœºåç§°ã€æ˜¯å¦æŒä¹…åŒ–ã€å½“æ²¡æœ‰queueä¸å…¶ç»‘å®šæ—¶æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(BI_EXCHANGE, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æ­»ä¿¡çš„äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;deadLetterExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">deadLetterExchange</span><span class="params">()</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(DEAD_LETTER_EXCHANGE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å£°æ˜é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;BiChartQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">BiQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨QueueBulideræ„å»ºé˜Ÿåˆ—,durableå°±æ˜¯æŒä¹…åŒ–çš„</span></span><br><span class="line">        Map&lt;String,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        map.put(<span class="string">&quot;x-message-ttl&quot;</span>,<span class="number">20000</span>);</span><br><span class="line">        map.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,DEAD_LETTER_EXCHANGE);</span><br><span class="line">        map.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,DEAD_LETTER_ROUTING_KEY);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(BI_QUEUE).withArguments(map).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆæ–‡æœ¬è½¬mdçš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;BiToMdQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">BiToMdQUeue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨QueueBulideræ„å»ºé˜Ÿåˆ—,durableå°±æ˜¯æŒä¹…åŒ–çš„</span></span><br><span class="line">        Map&lt;String,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        map.put(<span class="string">&quot;x-message-ttl&quot;</span>,<span class="number">20000</span>);</span><br><span class="line">        map.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>,DEAD_LETTER_EXCHANGE);</span><br><span class="line">        map.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>,DEAD_LETTER_ROUTING_KEY);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(BI_TO_MD_QUEUE).withArguments(map).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æ­»ä¿¡çš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;deadLetterQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue  <span class="title function_">deadLetterQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(DEAD_LETTER_QUEUE).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šç”Ÿæˆå›¾è¡¨äº¤æ¢æœºå’Œé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">binding</span><span class="params">(<span class="meta">@Qualifier(&quot;BiChartQueue&quot;)</span> Queue queue,</span></span><br><span class="line"><span class="params">                           <span class="meta">@Qualifier(&quot;BiExchange&quot;)</span> DirectExchange exchange)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(BI_ROUTING_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šæ–‡æœ¬è½¬mdçš„äº¤æ¢æœºå’Œé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">biToMdBinding</span><span class="params">(<span class="meta">@Qualifier(&quot;BiToMdQueue&quot;)</span> Queue queue,</span></span><br><span class="line"><span class="params">                                 <span class="meta">@Qualifier(&quot;BiExchange&quot;)</span> DirectExchange exchange)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(BI_TO_MD_ROUTING_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ­»ä¿¡é˜Ÿåˆ—å’Œæ­»ä¿¡äº¤æ¢æœºç»‘å®š</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deadLetterQueueu</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deadLetterExchage</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">deadQueueBingingDeadExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;deadLetterQueue&quot;)</span> Queue deadLetterQueueu,</span></span><br><span class="line"><span class="params">                                                <span class="meta">@Qualifier(&quot;deadLetterExchange&quot;)</span> DirectExchange deadLetterExchage)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(deadLetterQueueu).to(deadLetterExchage).with(DEAD_LETTER_ROUTING_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MessageRecoverer <span class="title function_">republishMessageRecoverer</span><span class="params">(RabbitTemplate rabbitTemplate)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RepublishMessageRecoverer</span>(rabbitTemplate, <span class="string">&quot;error.direct&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="æ™®é€šæ¶ˆè´¹è€…ï¼ˆè´Ÿè´£å¼‚æ­¥ç”Ÿæˆå›¾è¡¨ä¿¡æ¯ï¼‰"><strong>æ™®é€šæ¶ˆè´¹è€…ï¼ˆè´Ÿè´£å¼‚æ­¥ç”Ÿæˆå›¾è¡¨ä¿¡æ¯ï¼‰</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = BI_QUEUE)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receiveMessage</span><span class="params">(String message, Channel channel,<span class="meta">@Header(AmqpHeaders.DELIVERY_TAG)</span> <span class="type">long</span> deliverTag)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ¥æ”¶æ¶ˆæ¯æ˜¯:&#123;&#125;&quot;</span>,message);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(message))&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœå¤±è´¥,æ¶ˆæ¯æ‹’ç»</span></span><br><span class="line">            channel.basicNack(deliverTag,<span class="literal">false</span>,<span class="literal">false</span>);</span><br><span class="line">            log.info(<span class="string">&quot;æ¶ˆæ¯ä¸ºç©ºæ‹’ç»æ¥æ”¶,æ­¤æ¶ˆæ¯æ­£åœ¨è¢«è½¬å‘åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Long chartId=Long.parseLong(message);</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢chartè¡¨</span></span><br><span class="line">        <span class="type">Chart</span> <span class="variable">chart</span> <span class="operator">=</span> chartService.getById(chartId);</span><br><span class="line">        <span class="keyword">if</span> (chart==<span class="literal">null</span>)&#123;</span><br><span class="line">           channel.basicNack(deliverTag,<span class="literal">false</span>,<span class="literal">false</span>);</span><br><span class="line">           log.info(<span class="string">&quot;chartIdä¸º:&#123;&#125;çš„chartä¸å­˜åœ¨&quot;</span>,chartId);</span><br><span class="line">           <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR,<span class="string">&quot;chartIdä¸º:&quot;</span>+chartId+<span class="string">&quot;çš„chartä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">goal</span> <span class="operator">=</span> chart.getGoal();</span><br><span class="line">        <span class="type">String</span> <span class="variable">chartType</span> <span class="operator">=</span> chart.getChartType();</span><br><span class="line">        <span class="type">String</span> <span class="variable">csvData</span> <span class="operator">=</span> chart.getChartData();</span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">userInput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        userInput.append(<span class="string">&quot;åˆ†æéœ€æ±‚:&quot;</span>).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">//æ‹¼æ¥åˆ†æç›®æ ‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userGoal</span> <span class="operator">=</span> goal;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(chartType)) &#123;</span><br><span class="line">            userGoal += <span class="string">&quot;,è¯·ä½¿ç”¨:&quot;</span> + chartType;</span><br><span class="line">        &#125;</span><br><span class="line">        userInput.append(userGoal).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        userInput.append(<span class="string">&quot;åŸå§‹æ•°æ®:&quot;</span>).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        userInput.append(csvData).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="comment">//å°†Chartè¡¨çš„çŠ¶æ€æ”¹ä¸ºæ‰§è¡Œä¸­</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">update</span> <span class="operator">=</span> chartService.update(Wrappers.&lt;Chart&gt;lambdaUpdate()</span><br><span class="line">                .eq(Chart::getId, chart.getId())</span><br><span class="line">                .set(Chart::getStatus, ChartStatusEnum.RUNNING.getValue()));</span><br><span class="line">        <span class="keyword">if</span> (!update) &#123;</span><br><span class="line">            handleChartErrorByMq(chartId, <span class="string">&quot;æ›´æ–°å›¾è¡¨çŠ¶æ€ä¸ºè¿è¡Œä¸­å¤±è´¥&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> sparkUtils.synchronousCalls(AiConstant.MATH_MAP, userInput.toString());</span><br><span class="line">        <span class="comment">//å¯¹è¿”å›ç»“æœåšæ‹†åˆ†,æŒ‰ç…§5ä¸ªä¸­æ‹¬å·è¿›è¡Œæ‹†åˆ†</span></span><br><span class="line">        String[] split = result.split(<span class="string">&quot;ã€ã€ã€ã€ã€&quot;</span>);</span><br><span class="line">        <span class="comment">//æ‹†åˆ†å®Œè¿˜éœ€è¦æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (split.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            handleChartErrorByMq(chartId,<span class="string">&quot;aiç”Ÿæˆæ•°æ®æ ¼å¼ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">genChart</span> <span class="operator">=</span> split[<span class="number">1</span>].trim();</span><br><span class="line">        <span class="type">String</span> <span class="variable">genResult</span> <span class="operator">=</span> split[<span class="number">2</span>].trim();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> ä½¿ç”¨redisç¼“å­˜å›¾è¡¨æ•°æ®,æé«˜æŸ¥è¯¢æ•ˆç‡</span></span><br><span class="line">        chart.setExecMessage(<span class="string">&quot;å›¾è¡¨ç”ŸæˆæˆåŠŸï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        chart.setStatus(ChartStatusEnum.SUCCEEd.getValue());</span><br><span class="line">        chart.setGenChart(genChart);</span><br><span class="line">        chart.setGenResult(genResult);</span><br><span class="line">        <span class="comment">//æ‰§è¡ŒæˆåŠŸ</span></span><br><span class="line">        <span class="comment">//ä¿®æ”¹æ•°æ®åº“çŠ¶æ€ä¸ºæ‰§è¡ŒæˆåŠŸ</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">updateById</span> <span class="operator">=</span> chartService.updateById(chart);</span><br><span class="line">        <span class="keyword">if</span> (!updateById) &#123;</span><br><span class="line">            handleChartErrorByMq(chartId,<span class="string">&quot;æ›´æ–°å›¾è¡¨çŠ¶æ€ä¸ºæˆåŠŸä¸­å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ¶ˆè´¹ç§¯åˆ†-æ¯æ¬¡ä½¿ç”¨æ¶ˆè´¹1ç§¯åˆ†</span></span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">credits</span> <span class="operator">=</span> creditService.consumeCredits(chart.getUserId(), -<span class="number">1L</span>);</span><br><span class="line">        ThrowUtils.throwIf(!credits,ErrorCode.OPERATION_ERROR,<span class="string">&quot;ä½ çš„ç§¯åˆ†ä¸è¶³&quot;</span>);</span><br><span class="line">        <span class="comment">//å­˜å…¥ç¼“å­˜</span></span><br><span class="line">        redisTemplate.opsForValue().set(CHAHE_KEY+chartId,JSONUtil.toJsonStr(chart));</span><br><span class="line">       <span class="comment">//å¦‚æœä»»åŠ¡æ‰§è¡ŒæˆåŠŸ,æ‰‹åŠ¨æ‰§è¡Œack</span></span><br><span class="line">        channel.basicAck(deliverTag,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h3 id="æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…ï¼ˆè´Ÿè´£å¤„ç†æ­»ä¿¡ï¼‰"><strong>æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…ï¼ˆè´Ÿè´£å¤„ç†æ­»ä¿¡ï¼‰</strong></h3><p>æ”¶åˆ°æ­»ä¿¡åæˆ‘æ˜¯ç›´æ¥ç¡®è®¤äº†ï¼Œè¿™ç§æ–¹å¼å¯èƒ½ä¸å¥½ï¼Œä½ ä¹Ÿå¯ä»¥æ¢æˆå…¶ä»–æ–¹å¼æ¯”å¦‚é‡æ–°å…¥é˜Ÿï¼Œæˆ–è€…å†™å…¥æ•°æ®åº“å¹¶æ‰“ä¸Šæ—¥å¿—ç­‰ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TtlQueueConsumer</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    BIMessageProducer biMessageProducer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;bi_dead_letter_queue&quot;, ackMode = &quot;MANUAL&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doTTLMessage</span><span class="params">(String message, Channel channel, <span class="meta">@Header(AmqpHeaders.DELIVERY_TAG)</span> <span class="type">long</span> deliveryTag)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å·²ç»æ¥å—åˆ°æ­»ä¿¡æ¶ˆæ¯ï¼š&#123;&#125;&quot;</span>, message);</span><br><span class="line">        biMessageProducer.sendMessage(message);</span><br><span class="line">        channel.basicAck(deliveryTag, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†æ­»ä¿¡é˜Ÿåˆ—æ˜¯ä»€ä¹ˆï¼Œè¿˜æœ‰æˆ‘åœ¨é¡¹ç›®å¼€å‘ä¸­æ˜¯å¦‚ä½•è¿ç”¨æ­»ä¿¡é˜Ÿåˆ—çš„ï¼ï¼ï¼</summary>
    
    
    
    <category term="ç¼–ç¨‹ç»éªŒ" scheme="https://liweierzzz.github.io/categories/%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="RabbitMq" scheme="https://liweierzzz.github.io/tags/RabbitMq/"/>
    
    <category term="æ­»ä¿¡é˜Ÿåˆ—" scheme="https://liweierzzz.github.io/tags/%E6%AD%BB%E4%BF%A1%E9%98%9F%E5%88%97/"/>
    
    <category term="é¡¹ç›®ç»éªŒ" scheme="https://liweierzzz.github.io/tags/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>dockerå¸¸ç”¨çš„å¯åŠ¨å‘½ä»¤</title>
    <link href="https://liweierzzz.github.io/posts/c4278608.html"/>
    <id>https://liweierzzz.github.io/posts/c4278608.html</id>
    <published>2024-07-16T15:42:55.000Z</published>
    <updated>2024-07-18T14:44:52.087Z</updated>
    
    <content type="html"><![CDATA[<h1>å¸¸ç”¨çš„Dockerå¯åŠ¨å‘½ä»¤</h1><h2 id="dockerå•æœºéƒ¨ç½²Javaå°æŠ€å·§">dockerå•æœºéƒ¨ç½²Javaå°æŠ€å·§</h2><p>åœ¨åŒçº§â½¬å½•ä¸‹å‡†å¤‡â¼€ä¸ªdockerfileâ½‚ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8</span><br><span class="line">ENV workdir=/home/wanwuCode/wanwu-code-bi</span><br><span class="line">COPY . $&#123;workdir&#125;</span><br><span class="line">WORKDIR $&#123;workdir&#125;</span><br><span class="line">EXPOSE 8807</span><br><span class="line">CMD [&quot;java&quot;,&quot;-jar&quot;,&quot;wanwu-code-bi-0.0.1-SNAPSHOT.jar&quot;]</span><br></pre></td></tr></table></figure><blockquote><p>workdir={jaråŒ…æ”¾ç½®çš„â½‚ä»¶å¤¹} CMD [â€œjavaâ€ , â€œ-jarâ€ , â€œ{jaråŒ…åç§°}â€]</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//å…ˆåˆ°â½‚ä»¶å¤¹â½¬å½•ä¸‹â¾¯</span><br><span class="line">cd /home/wanwu-code</span><br><span class="line">//è¿›â¾é¡¹â½¬æ‰“åŒ… -tåâ¾¯è·Ÿçš„æ˜¯ä½ é¡¹â½¬æ‰“åŒ…çš„åå­—</span><br><span class="line">docker build -f ./dockerfile -t wanwu-code .</span><br><span class="line">//è¿›â¾å®¹å™¨çš„è¿â¾ --name åâ¾¯æ˜¯ä½ æƒ³å–çš„å®¹å™¨åå­— ç´§è·Ÿç€åâ¾¯æ˜¯ ä½ ä¸Šâ¾¯æ‰“åŒ…çš„åå­—+:latest</span><br><span class="line">//-påâ¾¯æ˜¯ä½ é¡¹â½¬çš„ç«¯â¼å· å¦‚æœä¸é€šè¿‡nginxä»£ç†å‡ºå»æƒ³é€šè¿‡åœ°å€ä½¿â½¤ï¼Œå°±è¦åˆ°æœåŠ¡å™¨é˜²â½•å¢™è¿›â¾</span><br><span class="line">æ”¾â¾æ“ä½œ</span><br><span class="line">docker run -d -p 8806:8806 --name &quot;wanwu-code&quot; wanwu-code:latest</span><br><span class="line">//æŸ¥çœ‹å®¹å™¨åˆ—è¡¨</span><br><span class="line">docker ps -a</span><br><span class="line">//å¦‚æœæŸ¥çœ‹å®¹å™¨æ˜¯å¦å¯åŠ¨æˆåŠŸæˆ–è€…å¤±è´¥ çœ‹æ§åˆ¶å° å®¹å™¨idä¸â½¤æ‰“å…¨ï¼Œå‰â¼ä½æ•°å°±â¾</span><br><span class="line">docker logs -f å®¹å™¨id</span><br><span class="line">//éƒ¨ç½²å¤±è´¥æ€ä¹ˆåˆ é™¤å®¹å™¨</span><br><span class="line">//æ‰¾åˆ°å®¹å™¨id</span><br><span class="line">//åˆ é™¤å®¹å™¨ å®¹å™¨idä¸â½¤æ‰“å…¨ï¼Œå‰â¼ä½æ•°å°±â¾</span><br><span class="line">docker rm -f f416</span><br></pre></td></tr></table></figure><h2 id="docker-çš„å®‰è£…ï¼ˆCentosï¼‰">docker çš„å®‰è£…ï¼ˆCentosï¼‰</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">yumå®‰è£…gccç›¸å…³ç¯å¢ƒ</span><br><span class="line">yum -y install gcc</span><br><span class="line">yum -y install gcc-c++</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…yumçš„â¼¯å…·</span></span><br><span class="line">yum install -y yum-utils</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ·»åŠ é˜¿â¾¥äº‘dockeré•œåƒåœ°å€</span></span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/ce</span><br><span class="line">ntos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ›´æ–°yumè½¯ä»¶åŒ…ç´¢å¼•</span></span><br><span class="line">yum makecache</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å®‰è£…docker</span></span><br><span class="line">yum install --allowerasing docker-ce docker-ce-cli containerd.io #</span><br><span class="line">ä¸è¦â½¤yum install docker-ce docker-ce-cli containerd.ioå®‰è£…ï¼Œcentos8å†…ç½®äº†pod</span><br><span class="line">manå®¹å™¨ä¼šå†²çªï¼ˆæ˜¯â¼€ä¸ªè·Ÿdockerå·®ä¸å¤šçš„å®¹å™¨ï¼Œå› ä¸ºcentos8æ”¾å¼ƒäº†å¯¹dockerçš„â½€æŒï¼Œä»£æ›¿â½…æ¡ˆ</span><br><span class="line">å°±æ˜¯podmanï¼‰--allowerasingå‘½ä»¤â½¤äºå°†è¦å®‰è£…çš„åŒ…æ›¿ä»£å†²çªçš„åŒ…</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨docker</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¼€æœºâ¾ƒå¯</span></span><br><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure><h3 id="dockerçš„åœæ­¢">dockerçš„åœæ­¢</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker </span><br></pre></td></tr></table></figure><h3 id="docker-å®‰è£…-WireGuard">docker å®‰è£… WireGuard</h3><figure class="highlight plaintext"><figcaption><span>Text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line"> --name=wg-easy \</span><br><span class="line"> -e WG_HOST=43.138.246.140 \</span><br><span class="line"> -e PASSWORD=oo771901874 \</span><br><span class="line"> -v /usr/local/src/wireguard:/etc/wireguard \</span><br><span class="line"> -p 51820:51820/udp \</span><br><span class="line"> -p 51821:51821/tcp \</span><br><span class="line"> --cap-add=NET_ADMIN \</span><br><span class="line"> --cap-add=SYS_MODULE \</span><br><span class="line"> --sysctl=&quot;net.ipv4.conf.all.src_valid_mark=1&quot; \</span><br><span class="line"> --sysctl=&quot;net.ipv4.ip_forward=1&quot; \</span><br><span class="line"> weejewel/wg-easy</span><br><span class="line"> </span><br></pre></td></tr></table></figure><hr><h3 id="dockerå®‰è£…RabbitMQ">dockerå®‰è£…RabbitMQ</h3><ol><li>ä½¿ç”¨<a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020">docker</a>æŸ¥è¯¢<a href="https://so.csdn.net/so/search?q=rabbitmq&amp;spm=1001.2101.3001.7020">rabbitmq</a>çš„é•œåƒ</li></ol><blockquote><p>docker search rabbitmq</p></blockquote><ol start="2"><li>å®‰è£…é•œåƒ</li></ol><blockquote><p>å¦‚æœéœ€è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬åœ¨rabbitmqåé¢è·Ÿä¸Šç‰ˆæœ¬å·å³å¯ docker pull rabbitmq:3.7.7-management</p><p>è¯´æ˜</p><p>docker pull rabbitmq:ç‰ˆæœ¬å· -management</p></blockquote><blockquote><p>å®‰è£…nameä¸ºrabbitmqçš„è¿™é‡Œæ˜¯ç›´æ¥å®‰è£…æœ€æ–°çš„ docker pull rabbitmq</p></blockquote><ol start="3"><li>æ ¹æ®ä¸‹è½½çš„é•œåƒåˆ›å»ºå’Œå¯åŠ¨å®¹å™¨</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -di --name rabbitmq -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_D</span><br><span class="line">EFAULT_PASS=admin -p 15672:15672 -p 5672:5672 -p 25672:25672 -p 61613:6161</span><br><span class="line">3 -p 1883:1883 rabbitmq:management</span><br></pre></td></tr></table></figure><blockquote><p>-d åå°è¿è¡Œå®¹å™¨ï¼›</p><p>â€“name æŒ‡å®šå®¹å™¨åï¼›</p><p>-p æŒ‡å®šæœåŠ¡è¿è¡Œçš„ç«¯å£ï¼ˆ5672ï¼šåº”ç”¨è®¿é—®ç«¯å£ï¼›15672ï¼šæ§åˆ¶å°Webç«¯å£å·ï¼‰ï¼›</p><p>-v æ˜ å°„ç›®å½•æˆ–æ–‡ä»¶ï¼›</p><p>â€“hostname  ä¸»æœºåï¼ˆRabbitMQçš„ä¸€ä¸ªé‡è¦æ³¨æ„äº‹é¡¹æ˜¯å®ƒæ ¹æ®æ‰€è°“çš„ â€œèŠ‚ç‚¹åç§°â€ å­˜å‚¨æ•°æ®ï¼Œé»˜è®¤ä¸ºä¸»æœºåï¼‰ï¼›</p><p>-e æŒ‡å®šç¯å¢ƒå˜é‡ï¼›ï¼ˆRABBITMQ_DEFAULT_VHOSTï¼šé»˜è®¤è™šæ‹Ÿæœºåï¼›RABBITMQ_DEFAULT_USERï¼šé»˜è®¤çš„ç”¨æˆ·åï¼›</p><p>RABBITMQ_DEFAULT_PASSï¼šé»˜è®¤ç”¨æˆ·åçš„å¯†ç ï¼‰</p></blockquote><hr><h3 id="docker-å®‰è£…Mysql">docker å®‰è£…Mysql</h3><ol><li>ä¸‹è½½é•œåƒ</li></ol><blockquote><p>docker pull mysql:xxx   ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„Mysqlé•œåƒ (xxxæŒ‡å…·ä½“ç‰ˆæœ¬å·)</p></blockquote><ol start="2"><li>åˆ›å»ºMysqlå®¹å™¨å¹¶è¿è¡Œ</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--nameæŒ‡å®šå®¹å™¨åå­— -vâ½¬å½•æŒ‚è½½ -pæŒ‡å®šç«¯â¼æ˜ å°„ -eè®¾ç½®mysqlå‚æ•° -dåå°è¿â¾</span></span><br><span class="line">docker run --name mysql -v /usr/local/mysql/data:/var/lib/mysql -e MYSQL_RO</span><br><span class="line">OT_PASSWORD=lhc010516 -p 3306:3306 -d mysql:8.0.27</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¿›â¼Šdockerâ¾¥â¾¯mysqlçš„â½¬å½•</span></span><br><span class="line">docker exec -it mysql /bin/bash</span><br></pre></td></tr></table></figure><hr><h3 id="docker-å®‰è£…å¯åŠ¨Elasticsearchã€Kibana">docker å®‰è£…å¯åŠ¨Elasticsearchã€Kibana</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å­˜å‚¨å’Œæ£€ç´¢æ•°æ®</span></span><br><span class="line">docker pull elasticsearch:7.4.2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯è§†åŒ–æ£€ç´¢æ•°æ®</span></span><br><span class="line">docker pull kibana:7.4.2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºé…ç½®â½‚ä»¶â½¬å½•</span></span><br><span class="line">mkdir -p /mydata/elasticsearch/config</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºæ•°æ®â½¬å½•</span></span><br><span class="line">mkdir -p /mydata/elasticsearch/data</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†/mydata/elasticsearch/â½‚ä»¶å¤¹ä¸­â½‚ä»¶éƒ½å¯è¯»å¯å†™</span></span><br><span class="line">chmod -R 777 /mydata/elasticsearch/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é…ç½®ä»»æ„æœºå™¨å¯ä»¥è®¿é—® elasticsearch</span></span><br><span class="line">echo &quot;http.host: 0.0.0.0&quot; &gt;/mydata/elasticsearch/config/elasticsearch.yml</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨Elasticsearch</span></span><br><span class="line">docker run --name elasticsearch -p 9200:9200 -p 9300:9300 \</span><br><span class="line">-e &quot;discovery.type=single-node&quot; \</span><br><span class="line">-e ES_JAVA_OPTS=&quot;-Xms64m -Xmx128m&quot; \</span><br><span class="line">-v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch</span><br><span class="line">/config/elasticsearch.yml \</span><br><span class="line">-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data \</span><br><span class="line">-v /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins \</span><br><span class="line">-d elasticsearch:7.4.2</span><br><span class="line">â— -p 9200:9200 -p 9300:9300ï¼šå‘å¤–æš´éœ²ä¸¤ä¸ªç«¯â¼ï¼Œ9200â½¤äºHTTP REST APIè¯·æ±‚ï¼Œ9300</span><br><span class="line">ES åœ¨åˆ†å¸ƒå¼é›†ç¾¤çŠ¶æ€ä¸‹ ES ä¹‹é—´çš„é€šä¿¡ç«¯â¼ï¼›</span><br><span class="line">â— -e &quot;discovery.type=single-node&quot;ï¼šes ä»¥å•èŠ‚ç‚¹è¿â¾</span><br><span class="line">â— -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx128m&quot;ï¼šè®¾ç½®å¯åŠ¨å â½¤å†…å­˜ï¼Œä¸è®¾ç½®å¯èƒ½ä¼šå â½¤å½“å‰ç³»ç»Ÿ</span><br><span class="line">æ‰€æœ‰å†…å­˜</span><br><span class="line">â— -vï¼šæŒ‚è½½å®¹å™¨ä¸­çš„é…ç½®â½‚ä»¶ã€æ•°æ®â½‚ä»¶ã€æ’ä»¶æ•°æ®åˆ°æœ¬æœºçš„â½‚ä»¶å¤¹ï¼›</span><br><span class="line">â— -d elasticsearch:7.6.2ï¼šæŒ‡å®šè¦å¯åŠ¨çš„é•œåƒ</span><br><span class="line">è®¿é—® IP:9200 çœ‹åˆ°è¿”å›çš„ json æ•°æ®è¯´æ˜å¯åŠ¨æˆåŠŸã€‚</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è®¾ç½® Elasticsearch éšDockerå¯åŠ¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å½“å‰ Docker å¼€æœºâ¾ƒå¯ï¼Œæ‰€ä»¥ ES ç°åœ¨ä¹Ÿæ˜¯å¼€æœºâ¾ƒå¯</span></span><br><span class="line">docker update elasticsearch --restart=always</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨å¯è§†åŒ–Kibana</span></span><br><span class="line">docker run --name kibana \</span><br><span class="line">-e ELASTICSEARCH_HOSTS=http://110.42.254.129:9200 \</span><br><span class="line">-p 5601:5601 \</span><br><span class="line">-d kibana:7.4.2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è®¾ç½® Kibana éšDockerå¯åŠ¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å½“å‰ Docker å¼€æœºâ¾ƒå¯ï¼Œæ‰€ä»¥ kibana ç°åœ¨ä¹Ÿæ˜¯å¼€æœºâ¾ƒå¯</span></span><br><span class="line">docker update kibana --restart=always</span><br></pre></td></tr></table></figure><h3 id="dockerå®‰è£…minio">dockerå®‰è£…minio</h3><ol><li>å¯»æ‰¾ Minio é•œåƒ</li><li>ä¸‹è½½Minio é•œåƒ</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/minio:RELEASE.2022-06-20T23-13-45Z.fips #ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„ Minio é•œåƒ (xxx æŒ‡å…·ä½“ç‰ˆæœ¬å·)</span><br></pre></td></tr></table></figure><ol start="3"><li>å®‰è£…å¹¶å¯åŠ¨minio</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 9000:9000 -p 9001:9001 --name minio --restart=alwa</span><br><span class="line">ys --privileged=true -v /home/minio/config:/root/.minio -v /home/mini</span><br><span class="line">o/data:/data -e &quot;MINIO_ROOT_USER=miniocong&quot; -e &quot;MINIO_ROOT_PASSWORD=min</span><br><span class="line">iocong&quot; minio/minio server /data --console-address &quot;:9001&quot; --address &quot;:90</span><br><span class="line">00</span><br></pre></td></tr></table></figure><h3 id="docker-å®‰è£…-Nacos">docker å®‰è£… Nacos</h3>]]></content>
    
    
    <summary type="html">æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å¸¸ç”¨çš„dockerå‘½ä»¤å’Œdockerçš„æŠ€å·§</summary>
    
    
    
    <category term="ç¼–ç¨‹ç»éªŒ" scheme="https://liweierzzz.github.io/categories/%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="docker" scheme="https://liweierzzz.github.io/tags/docker/"/>
    
    <category term="ç»éªŒåˆ†äº«" scheme="https://liweierzzz.github.io/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>çº¿ç¨‹æ± çŸ¥è¯†æ€»ç»“</title>
    <link href="https://liweierzzz.github.io/posts/5e416ab8.html"/>
    <id>https://liweierzzz.github.io/posts/5e416ab8.html</id>
    <published>2024-07-12T13:43:55.000Z</published>
    <updated>2024-07-12T16:23:48.547Z</updated>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« ï¼š</p><div class="tag link"><a class="link-card" title="Javaçº¿ç¨‹æ± å®ç°åŸç†è¯¦è§£å‹" href="https://segmentfault.com/a/1190000041683266"><div class="left"><img src="https://bu.dusays.com/2021/01/15/093039e40e761.png"/></div><div class="right"><p class="text">Javaçº¿ç¨‹æ± å®ç°åŸç†è¯¦è§£å‹</p><p class="url">https://segmentfault.com/a/1190000041683266</p></div></a></div> <h2 id="ä¸€ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ">ä¸€ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± </h2><p><strong>çº¿ç¨‹æ± </strong>æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†èµ„æºï¼ˆçº¿ç¨‹ã€ä»»åŠ¡ï¼‰çš„æ–¹å¼ã€‚</p><p>è¿™é‡Œå€Ÿç”¨ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹æåˆ°çš„æ¥è¯´ä¸€ä¸‹<strong>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</strong>ï¼š</p><ul><li><strong>é™ä½èµ„æºæ¶ˆè€—</strong>ï¼šé€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li><li><strong>æé«˜å“åº”é€Ÿåº¦</strong>ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰å¾…åˆ›å»ºçº¿ç¨‹å°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li><li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong>ï¼šçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— çº¿çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li></ul><h2 id="äºŒã€çº¿ç¨‹æ± çš„åŸºæœ¬æ¦‚å¿µ">äºŒã€çº¿ç¨‹æ± çš„åŸºæœ¬æ¦‚å¿µ</h2><p>çº¿ç¨‹æ± ä¸»è¦ç”±<code>Executor</code>æ¡†æ¶å®ç°ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ç±»æ˜¯<code>ThreadPoolExecutor</code>ã€‚<code>ThreadPoolExecutor</code>æ˜¯ä¸€ä¸ªå®ç°äº†<code>ExecutorService</code>æ¥å£çš„ç±»ï¼Œå®ƒæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¥ç®¡ç†çº¿ç¨‹æ± çš„ç”Ÿå‘½å‘¨æœŸå’Œä»»åŠ¡è°ƒåº¦ã€‚</p><h2 id="ä¸‰ã€çº¿ç¨‹æ± çš„å·¥ä½œåŸç†">ä¸‰ã€çº¿ç¨‹æ± çš„å·¥ä½œåŸç†</h2><p><a href="https://imgse.com/i/pk4tmtJ"><img src="https://s21.ax1x.com/2024/07/12/pk4tmtJ.png" alt="pk4tmtJ.png"></a></p><p>å½“ç”¨æˆ·å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œçº¿ç¨‹æ± ä¼šå…ˆå°†ä»»åŠ¡æ”¾å…¥ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼ˆworkQueueï¼‰ä¸­ã€‚ç„¶åï¼Œçº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹ï¼ˆworkerSetï¼‰ä¼šä»è¿™ä¸ªé˜Ÿåˆ—ä¸­ä¸æ–­è·å–ä»»åŠ¡å¹¶æ‰§è¡Œã€‚å¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼ˆcoreSizeï¼‰ï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼›å¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™ä»»åŠ¡ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</p><hr><h2 id="å››ã€Javaæä¾›çš„çº¿ç¨‹æ± å®ç°">å››ã€Javaæä¾›çš„çº¿ç¨‹æ± å®ç°</h2><p>Javaæä¾›äº†å¤šç§çº¿ç¨‹æ± å®ç°æ–¹å¼ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯<code>ThreadPoolExecutor</code>ç±»å’Œ<code>Executors</code>ç±»æä¾›çš„é™æ€å·¥å‚æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± å®ç°ï¼š</p><p>åæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨ç¨‹åºä¸­å®ç°çº¿ç¨‹æ± ã€‚äº‹å®ä¸Šï¼Œå¤§å¤šæ•°ç¨‹åºéƒ½ä¼šæœ‰ä¸€ä¸ªåŸºæœ¬çš„çº¿ç¨‹æ± å®ç°ã€‚</p><ul><li>åœ¨ Spring ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ ThreadPoolTaskExecutor é…åˆ @Async æ³¨è§£æ¥å®ç°çº¿ç¨‹æ± (ä¸å¤ªå»ºè®®)ã€‚</li></ul><blockquote><p>ps.è™½ç„¶ Spring æ¡†æ¶æä¾›äº†çº¿ç¨‹æ± çš„å®ç°ï¼Œä½†å¹¶ä¸ç‰¹åˆ«æ¨èä½¿ç”¨ã€‚å› ä¸º Spring æ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå®ƒè¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„å°è£…ï¼Œå¯èƒ½éšè—äº†ä¸€äº›ç»†èŠ‚ã€‚æ›´æ¨èå¤§å®¶ç›´æ¥ä½¿ç”¨ Java å¹¶å‘åŒ…ä¸­çš„çº¿ç¨‹æ± ã€‚</p></blockquote><ul><li><p>åœ¨ Java ä¸­ï¼Œ<strong>å¯ä»¥ä½¿ç”¨JUCå¹¶å‘ç¼–ç¨‹åŒ…ä¸­çš„ ThreadPoolExecutor</strong>-&gt;è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œæ¥å®ç°éå¸¸çµæ´»åœ°è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚</p></li><li><p><strong>newFixedThreadPool(int nThreads)</strong>ï¼šåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</p><p><strong>FixedThreadPool - çº¿ç¨‹æ± å¤§å°å›ºå®šï¼Œä»»åŠ¡é˜Ÿåˆ—æ— ç•Œ</strong></p><p>ä¸‹é¢æ˜¯ Executors ç±» newFixedThreadPool æ–¹æ³•çš„æºç ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="keyword">new</span><span class="type">FixedThreadPool</span>(int nThreads) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">ThreadPoolExecutor</span>(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0</span>L, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> <span class="type">LinkedBlockingQueue</span>&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° corePoolSize å’Œ maximumPoolSize è®¾ç½®æˆäº†ç›¸åŒçš„å€¼ï¼Œæ­¤æ—¶ä¸å­˜åœ¨çº¿ç¨‹æ•°é‡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°é‡çš„æƒ…å†µï¼Œæ‰€ä»¥KeepAliveæ—¶é—´è®¾ç½®ä¸ä¼šç”Ÿæ•ˆã€‚ä»»åŠ¡é˜Ÿåˆ—ä½¿ç”¨çš„æ˜¯ä¸é™åˆ¶å¤§å°çš„ LinkedBlockingQueue ï¼Œç”±äºæ˜¯æ— ç•Œé˜Ÿåˆ—æ‰€ä»¥å®¹çº³çš„ä»»åŠ¡æ•°é‡æ²¡æœ‰ä¸Šé™ã€‚</p><p>å› æ­¤ï¼ŒFixedThreadPoolçš„è¡Œä¸ºå¦‚ä¸‹ï¼š</p><ol><li>ä»çº¿ç¨‹æ± ä¸­è·å–å¯ç”¨çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çº¿ç¨‹åˆ™ä½¿ç”¨ThreadFactoryåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹æ•°è¾¾åˆ°nThreads</li><li>çº¿ç¨‹æ± çº¿ç¨‹æ•°è¾¾åˆ°nThreadsä»¥åï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ”¾å…¥é˜Ÿåˆ—</li></ol><p>FixedThreadPoolçš„ä¼˜ç‚¹æ˜¯<strong>èƒ½å¤Ÿä¿è¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½è¢«æ‰§è¡Œï¼Œæ°¸è¿œä¸ä¼šæ‹’ç»æ–°çš„ä»»åŠ¡</strong>ï¼›åŒæ—¶ç¼ºç‚¹æ˜¯é˜Ÿåˆ—æ•°é‡æ²¡æœ‰é™åˆ¶ï¼Œ<strong>åœ¨ä»»åŠ¡æ‰§è¡Œæ—¶é—´æ— é™å»¶é•¿çš„è¿™ç§æç«¯æƒ…å†µä¸‹ä¼šé€ æˆå†…å­˜é—®é¢˜</strong>ã€‚</p></li><li><p><strong>newCachedThreadPool()</strong>ï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚</p><p>SynchronousQueueæ˜¯ä¸€ä¸ªåªæœ‰1ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ï¼Œå…¥é˜Ÿçš„ä»»åŠ¡éœ€è¦ä¸€ç›´ç­‰å¾…ç›´åˆ°é˜Ÿåˆ—ä¸­çš„å…ƒç´ è¢«ç§»å‡ºã€‚æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯0ï¼Œæ„å‘³ç€æ‰€æœ‰ä»»åŠ¡ä¼šå…ˆå…¥é˜Ÿåˆ—ï¼›æœ€å¤§çº¿ç¨‹æ•°æ˜¯Integer.MAX_VALUEï¼Œå¯ä»¥è®¤ä¸ºçº¿ç¨‹æ•°é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚KeepAliveæ—¶é—´è¢«è®¾ç½®æˆ60ç§’ï¼Œæ„å‘³ç€åœ¨æ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™çº¿ç¨‹ç­‰å¾…60ç§’ä»¥åé€€å‡ºã€‚CachedThreadPoolå¯¹ä»»åŠ¡çš„å¤„ç†ç­–ç•¥æ˜¯æäº¤çš„ä»»åŠ¡ä¼šç«‹å³åˆ†é…ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ‰§è¡Œï¼Œçº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡ä¼šéšç€ä»»åŠ¡æ•°çš„å˜åŒ–è‡ªåŠ¨æ‰©å¼ å’Œç¼©å‡ï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œæ—¶é—´æ— é™å»¶é•¿çš„æç«¯æƒ…å†µä¸‹ä¼šåˆ›å»ºè¿‡å¤šçš„çº¿ç¨‹ã€‚</p></li><li><p><strong>newSingleThreadExecutor()</strong>ï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œæ‰€æœ‰ä»»åŠ¡éƒ½æŒ‰é¡ºåºæ‰§è¡Œã€‚</p><p>è¿™ä¸ªå·¥å‚æ–¹æ³•ä¸­ä½¿ç”¨æ— ç•ŒLinkedBlockingQueueï¼Œå¹¶çš„å°†çº¿ç¨‹æ•°è®¾ç½®æˆ1ï¼Œé™¤æ­¤ä»¥å¤–è¿˜ä½¿ç”¨FinalizableDelegatedExecutorServiceç±»è¿›è¡Œäº†åŒ…è£…ã€‚è¿™ä¸ªåŒ…è£…ç±»çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å±è”½ThreadPoolExecutorä¸­åŠ¨æ€ä¿®æ”¹çº¿ç¨‹æ•°é‡çš„åŠŸèƒ½ï¼Œä»…ä¿ç•™ExecutorServiceä¸­æä¾›çš„æ–¹æ³•ã€‚è™½ç„¶æ˜¯å•çº¿ç¨‹å¤„ç†ï¼Œä¸€æ—¦çº¿ç¨‹å› ä¸ºå¤„ç†å¼‚å¸¸ç­‰åŸå› ç»ˆæ­¢çš„æ—¶å€™ï¼ŒThreadPoolExecutorä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»§ç»­è¿›è¡Œå·¥ä½œã€‚</p><p>SingleThreadExecutor é€‚ç”¨äºåœ¨é€»è¾‘ä¸Šéœ€è¦å•çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„åœºæ™¯ï¼ŒåŒæ—¶æ— ç•Œçš„LinkedBlockingQueue<strong>ä¿è¯æ–°ä»»åŠ¡éƒ½èƒ½å¤Ÿæ”¾å…¥é˜Ÿåˆ—ï¼Œä¸ä¼šè¢«æ‹’ç»</strong>ï¼›<strong>ç¼ºç‚¹å’ŒFixedThreadPoolç›¸åŒï¼Œå½“å¤„ç†ä»»åŠ¡æ— é™ç­‰å¾…çš„æ—¶å€™ä¼šé€ æˆå†…å­˜é—®é¢˜</strong>ã€‚</p></li></ul><hr><h4 id="ä¸‰ç§ExecutorServiceç‰¹æ€§æ€»ç»“">ä¸‰ç§ExecutorServiceç‰¹æ€§æ€»ç»“</h4><table><thead><tr><th>ç±»å‹</th><th>æ ¸å¿ƒçº¿ç¨‹æ•°</th><th>æœ€å¤§çº¿ç¨‹æ•°</th><th>Keep Alive æ—¶é—´</th><th>ä»»åŠ¡é˜Ÿåˆ—</th><th>ä»»åŠ¡å¤„ç†ç­–ç•¥</th></tr></thead><tbody><tr><td>FixedThreadPool</td><td>å›ºå®šå¤§å°</td><td>å›ºå®šå¤§å°ï¼ˆä¸æ ¸å¿ƒçº¿ç¨‹æ•°ç›¸åŒï¼‰</td><td>0</td><td>LinkedBlockingQueue</td><td>çº¿ç¨‹æ± å¤§å°å›ºå®šï¼Œæ²¡æœ‰å¯ç”¨çº¿ç¨‹çš„æ—¶å€™ä»»åŠ¡ä¼šæ”¾å…¥é˜Ÿåˆ—ç­‰å¾…ï¼Œé˜Ÿåˆ—é•¿åº¦æ— é™åˆ¶</td></tr><tr><td>SingleThreadExecutor</td><td>1</td><td>1</td><td>0</td><td>LinkedBlockingQueue</td><td>ä¸ FixedThreadPool ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºçº¿ç¨‹æ± çš„å¤§å°ä¸º1ï¼Œé€‚ç”¨äºä¸šåŠ¡é€»è¾‘ä¸Šåªå…è®¸1ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†çš„åœºæ™¯</td></tr><tr><td>CachedThreadPool</td><td>0</td><td>Integer.MAX_VALUE</td><td>1åˆ†é’Ÿ</td><td>SynchronousQueue</td><td>çº¿ç¨‹æ± çš„æ•°é‡æ— é™å¤§ï¼Œæ–°ä»»åŠ¡ä¼šç›´æ¥åˆ†é…æˆ–è€…åˆ›å»ºä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ‰§è¡Œ</td></tr></tbody></table><h2 id="äº”ã€çº¿ç¨‹æ± çš„å‡ ä¸ªä¸»è¦å‚æ•°çš„ä½œç”¨">äº”ã€çº¿ç¨‹æ± çš„å‡ ä¸ªä¸»è¦å‚æ•°çš„ä½œç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,</span></span><br><span class="line"><span class="params">                              <span class="type">int</span> maximumPoolSize,</span></span><br><span class="line"><span class="params">                              <span class="type">long</span> keepAliveTime,</span></span><br><span class="line"><span class="params">                              TimeUnit unit,</span></span><br><span class="line"><span class="params">                              BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class="line"><span class="params">                              ThreadFactory threadFactory,</span></span><br><span class="line"><span class="params">                              RejectedExecutionHandler handler)</span></span><br></pre></td></tr></table></figure><ul><li><code>corePoolSize</code>ï¼š<strong>æ ¸å¿ƒçº¿ç¨‹æ•°é‡</strong>ã€‚è¿™äº›çº¿ç¨‹å°±å¥½æ¯”æ˜¯å…¬å¸çš„æ­£å¼å‘˜å·¥ï¼Œä»–ä»¬åœ¨æ­£å¸¸æƒ…å†µä¸‹éƒ½æ˜¯éšæ—¶å¾…å‘½å¤„ç†ä»»åŠ¡çš„ã€‚å¦‚ä½•å»è®¾å®šè¿™ä¸ªå‚æ•°å‘¢ï¼Ÿæ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„ AI æœåŠ¡åªå…è®¸å››ä¸ªä»»åŠ¡åŒæ—¶è¿›è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ ¸å¿ƒçº¿ç¨‹æ•°åº”è¯¥å°±è¢«è®¾ç½®ä¸ºå››ã€‚</li><li><code>maximumPoolSize</code>ï¼š<strong>æœ€å¤§çº¿ç¨‹æ•°é‡</strong>ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹æ± çš„å®¹é‡ã€‚åœ¨æé™æƒ…å†µä¸‹æˆ‘ä»¬çš„ç³»ç»Ÿæˆ–çº¿ç¨‹æ± èƒ½æœ‰å¤šå°‘ä¸ªçº¿ç¨‹åœ¨å·¥ä½œã€‚å°±ç®—ä»»åŠ¡å†å¤šï¼Œä½ æœ€å¤šä¹Ÿåªèƒ½é›‡ä½£è¿™ä¹ˆå¤šçš„äººï¼Œå› ä¸ºä½ éœ€è¦è€ƒè™‘æˆæœ¬å’Œèµ„æºçš„é—®é¢˜ã€‚å‡è®¾ AI æœåŠ¡æœ€å¤šåªå…è®¸å››ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œé‚£ä¹ˆæœ€å¤§çº¿ç¨‹æ•°åº”å½“è®¾ç½®ä¸ºå››ã€‚</li><li><code>keepAliveTime</code>ï¼š<strong>çº¿ç¨‹ç©ºé—²ç­‰å¾…æ—¶é—´</strong>ï¼Œä¹Ÿå’Œå·¥ä½œçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæœ‰å…³ã€‚è¿™ä¸ªå‚æ•°å†³å®šäº†å½“ä»»åŠ¡å°‘çš„æ—¶å€™ï¼Œä¸´æ—¶é›‡ä½£çš„çº¿ç¨‹ä¼šç­‰å¾…å¤šä¹…æ‰ä¼šè¢«å‰”é™¤ã€‚è¿™ä¸ªå‚æ•°çš„è®¾å®šæ˜¯ä¸ºäº†é‡Šæ”¾æ— ç”¨çš„çº¿ç¨‹èµ„æºã€‚ä½ å¯ä»¥ç†è§£ä¸ºï¼Œå¤šä¹…ä¹‹åä¼šâ€œè§£é›‡â€æ²¡æœ‰ä»»åŠ¡åšçš„ä¸´æ—¶å·¥ã€‚</li><li><code>unit</code>ï¼š<strong>çº¿ç¨‹ç©ºé—²æ—¶é—´çš„å•ä½</strong>ï¼Œæœ€ç»ˆä¼šè½¬ä¸ºæˆçº³ç§’ã€‚</li><li><code>workQueue</code>ï¼šç­‰å¾…é˜Ÿåˆ—æˆ–è€…å«ä»»åŠ¡é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯ä»»åŠ¡é˜Ÿåˆ—ã€‚è¿™ä¸ªé˜Ÿåˆ—å­˜å‚¨æ‰€æœ‰ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¹Ÿå¯ä»¥å«å®ƒ<strong>é˜»å¡é˜Ÿåˆ—</strong>ï¼Œå› ä¸ºçº¿ç¨‹éœ€è¦æŒ‰é¡ºåºä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ¥æ‰§è¡Œã€‚è¿™ä¸ªé˜Ÿåˆ—çš„é•¿åº¦ä¸€å®šè¦è®¾å®šï¼Œå› ä¸ºæ— é™é•¿åº¦çš„é˜Ÿåˆ—ä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚</li><li><code>ThreadFactory</code>ï¼šåˆ›å»ºçº¿ç¨‹çš„å·¥å‚ï¼Œé»˜è®¤ä½¿ç”¨<code>Executors.defaultThreadFactory()</code>ä½œä¸ºçº¿ç¨‹æ± å·¥å‚å®ä¾‹ã€‚<strong>å®ƒè´Ÿè´£æ§åˆ¶æ¯ä¸ªçº¿ç¨‹çš„ç”Ÿæˆ</strong>ï¼Œå°±åƒä¸€ä¸ªç®¡ç†å‘˜ï¼Œè´Ÿè´£æ‹›è˜ã€ç®¡ç†å‘˜å·¥ï¼Œæ¯”å¦‚è®¾å®šå‘˜å·¥çš„åå­—ã€å·¥èµ„ï¼Œæˆ–è€…å…¶ä»–å±æ€§ã€‚</li><li><code>handler</code>ï¼šçº¿ç¨‹æ± çš„æ‰§è¡Œæ‰§è¡Œå¤„ç†å™¨ï¼Œæ›´å¤šçš„æ—¶å€™æˆä¸ºæ‹’ç»ç­–ç•¥ï¼Œæ‹’ç»ç­–ç•¥æ‰§è¡Œçš„æ—¶æœºæ˜¯å½“é˜»å¡é˜Ÿåˆ—å·²æ»¡ã€æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼ˆåŒ…å«æ ¸å¿ƒçº¿ç¨‹å’Œéæ ¸å¿ƒçº¿ç¨‹ï¼‰å¹¶ä¸”ç»§ç»­æäº¤ä»»åŠ¡ã€‚æä¾›äº†4ç§æ‹’ç»ç­–ç•¥å®ç°ï¼š<ul><li><code>AbortPolicy</code>ï¼šç›´æ¥æ‹’ç»ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ‰§è¡Œä»»åŠ¡ï¼Œç›´æ¥æŠ›å‡º<code>RjectedExecutionExcetion</code>é”™è¯¯ï¼Œé»˜è®¤çš„æ‹’ç»ç­–ç•¥ã€‚</li><li><code>DiscardPolicy</code>ï¼šæŠ›å¼ƒç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å¿½ç•¥æäº¤çš„ä»»åŠ¡ã€‚</li><li><code>DiscardOldestPolicy</code>ï¼šæŠ›å¼ƒæœ€è€ä»»åŠ¡ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡<code>poll()</code>æ–¹æ³•å–å‡ºä»»åŠ¡é˜Ÿåˆ—å¤´çš„ä»»åŠ¡æŠ›å¼ƒï¼Œç„¶åæ‰§è¡Œå½“å‰æäº¤çš„ä»»åŠ¡ã€‚</li><li><code>CallerRunsPolicy</code>ï¼šè°ƒç”¨è€…æ‰§è¡Œç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯å½“å‰è°ƒç”¨<code>Executor#execute()</code>çš„çº¿ç¨‹ç›´æ¥è°ƒç”¨ä»»åŠ¡<code>Runnable#run()</code>ï¼Œ<strong>ä¸€èˆ¬ä¸å¸Œæœ›ä»»åŠ¡ä¸¢å¤±ä¼šé€‰ç”¨è¿™ç§ç­–ç•¥ï¼Œä½†ä»å®é™…è§’åº¦æ¥çœ‹ï¼ŒåŸæ¥çš„å¼‚æ­¥è°ƒç”¨æ„å›¾ä¼šé€€åŒ–æˆåŒæ­¥è°ƒç”¨ã€‚</strong></li></ul></li></ul><h3 id="çº¿ç¨‹æ± å‚æ•°æ€»ç»“"><strong>çº¿ç¨‹æ± å‚æ•°æ€»ç»“</strong></h3><p><strong>å›å½’åˆ°æˆ‘ä»¬çš„ä¸šåŠ¡ï¼Œè¦è€ƒè™‘ç³»ç»Ÿæœ€è„†å¼±çš„ç¯èŠ‚(ç³»ç»Ÿçš„ç“¶é¢ˆ)åœ¨å“ªé‡Œï¼Ÿ</strong> ç°æœ‰æ¡ä»¶ï¼šæ¯”å¦‚ AI ç”Ÿæˆèƒ½åŠ›çš„å¹¶å‘æ˜¯åªå…è®¸ 4 ä¸ªä»»åŠ¡åŒæ—¶å»æ‰§è¡Œï¼ŒAI èƒ½åŠ›å…è®¸ 20 ä¸ªä»»åŠ¡æ’é˜Ÿã€‚</p><ul><li>corePoolSize (æ ¸å¿ƒçº¿ç¨‹æ•° =&gt; æ­£å¼å‘˜å·¥æ•°)ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå¯ä»¥åŒæ—¶å·¥ä½œçš„çº¿ç¨‹æ•°(éšæ—¶å°±ç»ªçš„çŠ¶æ€)</li><li>maximumPoolSize (æœ€å¤§çº¿ç¨‹æ•° =&gt; å“ªæ€•ä»»åŠ¡å†å¤šï¼Œä½ ä¹Ÿæœ€å¤šæ‹›è¿™äº›äºº)ï¼šæé™æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± æœ€å¤šå¯ä»¥æ‹¥æœ‰å¤šå°‘ä¸ªçº¿ç¨‹ï¼Ÿ</li><li>keepAliveTime (ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´)ï¼šéæ ¸å¿ƒçº¿ç¨‹åœ¨æ²¡æœ‰ä»»åŠ¡çš„æƒ…å†µä¸‹ï¼Œè¿‡å¤šä¹…è¦åˆ é™¤(ç†è§£ä¸ºå¼€é™¤ä¸´æ—¶å·¥)ï¼Œä»è€Œé‡Šæ”¾æ— ç”¨çš„çº¿ç¨‹èµ„æºã€‚</li><li>workQueue (å·¥ä½œé˜Ÿåˆ—)ï¼šç”¨äºå­˜æ”¾ç»™çº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—çš„é•¿åº¦(ä¸€å®šè¦è®¾ç½®ï¼Œä¸è¦è¯´é˜Ÿåˆ—é•¿åº¦æ— é™ï¼Œå› ä¸ºä¹Ÿä¼šå ç”¨èµ„æºï¼‰</li><li>threadFactory (çº¿ç¨‹å·¥å‚)ï¼šæ§åˆ¶æ¯ä¸ªçº¿ç¨‹çš„ç”Ÿæˆã€çº¿ç¨‹çš„å±æ€§(æ¯”å¦‚çº¿ç¨‹å)</li><li>RejectedExecutionHandler (æ‹’ç»ç­–ç•¥)ï¼šä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬é‡‡å–ä»€ä¹ˆæªæ–½ï¼Œæ¯”å¦‚æŠ›å¼‚å¸¸ã€ä¸æŠ›å¼‚å¸¸ã€è‡ªå®šä¹‰ç­–ç•¥ã€‚</li></ul><h2 id="å…­ã€çº¿ç¨‹æ± çš„å·¥ä½œæµç¨‹">å…­ã€çº¿ç¨‹æ± çš„å·¥ä½œæµç¨‹</h2><p>åˆšå¼€å§‹ï¼Œæ²¡æœ‰ä»»ä½•çš„çº¿ç¨‹å’Œä»»åŠ¡ï¼š</p><p><a href="https://imgse.com/i/pk4twct"><img src="https://s21.ax1x.com/2024/07/12/pk4twct.webp" alt="pk4twct.webp"></a></p><p>å½“æœ‰æ–°ä»»åŠ¡è¿›æ¥ï¼Œå‘ç°å½“å‰å‘˜å·¥æ•°é‡è¿˜æœªè¾¾åˆ°è®¾å®šçš„æ­£å¼å‘˜å·¥æ•°(corePoolSize = 2)ï¼Œåˆ™ä¼šç›´æ¥å¢è˜ä¸€åæ–°å‘˜å·¥æ¥å¤„ç†è¿™ä¸ªä»»åŠ¡ï¼š</p><p><a href="https://imgse.com/i/pk4t0jP"><img src="https://s21.ax1x.com/2024/07/12/pk4t0jP.webp" alt="pk4t0jP.webp"></a></p><p>åˆæ¥ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œå‘ç°å½“å‰å‘˜å·¥æ•°é‡è¿˜æœªè¾¾åˆ°è®¾å®šçš„æ­£å¼å‘˜å·¥æ•°(corePoolSize = 2)ï¼Œåˆ™ä¼šå†æ¬¡å¢è˜ä¸€åæ–°å‘˜å·¥æ¥å¤„ç†è¿™ä¸ªä»»åŠ¡ï¼š</p><p><a href="https://imgse.com/i/pk4tDnf"><img src="https://s21.ax1x.com/2024/07/12/pk4tDnf.webp" alt="pk4tDnf.webp"></a></p><p>åˆæ¥äº†ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œä½†æ˜¯æ­£å¼å‘˜å·¥æ•°å·²ç»è¾¾åˆ°ä¸Šé™(å½“å‰çº¿ç¨‹æ•° = corePoolSize = 2)ï¼Œè¿™ä¸ªæ–°ä»»åŠ¡å°†è¢«æ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­(æœ€å¤§é•¿åº¦ workQueue.size æ˜¯ 2) ï¼Œè€Œä¸æ˜¯ç«‹å³å¢è˜æ–°å‘˜å·¥ï¼š</p><p><a href="https://imgse.com/i/pk4trB8"><img src="https://s21.ax1x.com/2024/07/12/pk4trB8.webp" alt="pk4trB8.webp"></a></p><p>åˆæ¥äº†ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ä»»åŠ¡é˜Ÿåˆ—å·²ç»æ»¡äº†(å½“å‰çº¿ç¨‹æ•° &gt; corePoolSize = 2ï¼Œå·²æœ‰ä»»åŠ¡æ•° = æœ€å¤§é•¿åº¦ workQueue.size = 2)ï¼Œæˆ‘ä»¬å°†å¢è®¾æ–°çº¿ç¨‹(æœ€å¤§çº¿ç¨‹æ•° maximumPoolSize = 4)æ¥å¤„ç†ä»»åŠ¡ï¼Œè€Œä¸æ˜¯é€‰æ‹©ä¸¢å¼ƒè¿™ä¸ªä»»åŠ¡ï¼š</p><p><a href="https://imgse.com/i/pk4tsHS"><img src="https://s21.ax1x.com/2024/07/12/pk4tsHS.webp" alt="pk4tsHS.webp"></a></p><p>å½“è¾¾åˆ°ä¸ƒä¸ªä»»åŠ¡æ—¶ï¼Œç”±äºæˆ‘ä»¬çš„ä»»åŠ¡é˜Ÿåˆ—å·²ç»æ»¡äº†ã€ä¸´æ—¶å·¥ä¹Ÿæ‹›æ»¡äº†(å½“å‰çº¿ç¨‹æ•° = maximumPoolSize = 4ï¼Œå·²æœ‰ä»»åŠ¡æ•° = æœ€å¤§é•¿åº¦ workQueue.size = 2)ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¼šé‡‡ç”¨ RejectedExecutionHandler(æ‹’ç»ç­–ç•¥)æ¥å¤„ç†å¤šä½™çš„ä»»åŠ¡ï¼š</p><p><a href="https://imgse.com/i/pk4tIBT"><img src="https://s21.ax1x.com/2024/07/12/pk4tIBT.webp" alt="pk4tIBT.webp"></a></p><p>å¦‚æœå½“å‰çº¿ç¨‹æ•°è¶…è¿‡ corePoolSize (æ­£å¼å‘˜å·¥æ•°)ï¼Œå¹¶ä¸”è¿™äº›é¢å¤–çš„çº¿ç¨‹æ²¡æœ‰æ–°çš„ä»»åŠ¡å¯æ‰§è¡Œï¼Œé‚£ä¹ˆåœ¨ keepAliveTime æ—¶é—´è¾¾åˆ°åï¼Œè¿™äº›é¢å¤–çš„çº¿ç¨‹å°†ä¼šè¢«é‡Šæ”¾ã€‚</p><p>æ€»ç»“ä¸€ä¸‹æµç¨‹ï¼š</p><p><a href="https://imgse.com/i/pk4toHU"><img src="https://s21.ax1x.com/2024/07/12/pk4toHU.webp" alt="pk4toHU.webp"></a></p><hr><h2 id="ä¸ƒã€å¦‚ä½•é€šè¿‡Guavaå®ç°é‡è¯•æœºåˆ¶">ä¸ƒã€å¦‚ä½•é€šè¿‡Guavaå®ç°é‡è¯•æœºåˆ¶</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ä½ çš„çº¿ç¨‹æ± é…ç½®ä¸­åŠ å…¥åŸºäºGuavaçš„é‡è¯•æœºåˆ¶ï¼š</p><ol><li><strong>åˆ›å»ºçº¿ç¨‹æ± </strong>ï¼šä½¿ç”¨ä½ æä¾›çš„é…ç½®åˆ›å»ºçº¿ç¨‹æ± ã€‚</li><li><strong>åŒ…è£…çº¿ç¨‹æ± </strong>ï¼šå°†çº¿ç¨‹æ± åŒ…è£…ä¸º<code>ListeningExecutorService</code>ã€‚</li><li><strong>å®ç°é‡è¯•é€»è¾‘</strong>ï¼šåˆ›å»ºä¸€ä¸ªä»»åŠ¡å°è£…ï¼Œç”¨äºæ•è·å¼‚å¸¸å¹¶åœ¨å¤±è´¥æ—¶é‡è¯•ã€‚</li></ol><p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„é¡¹ç›®ä¸­å·²ç»æ·»åŠ äº†Guavaä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>31.0.1-jre<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- è¯·ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬å· --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹å¼å®ç°é‡è¯•æœºåˆ¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.common.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadPoolConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;threadpool.corePoolSize&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> corePoolSize;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;threadpool.maximumPoolSize&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> maximumPoolSize;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;threadpool.keepAliveTime&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> keepAliveTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ThreadPoolExecutor <span class="title function_">threadPoolExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ThreadFactory</span> <span class="variable">threadFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadFactory</span>() &#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(<span class="meta">@NotNull</span> Runnable r)</span> &#123;</span><br><span class="line">                <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(r);</span><br><span class="line">                thread.setName(<span class="string">&quot;çº¿ç¨‹:&quot;</span> + count);</span><br><span class="line">                count++;</span><br><span class="line">                <span class="keyword">return</span> thread;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">                corePoolSize,</span><br><span class="line">                maximumPoolSize,</span><br><span class="line">                keepAliveTime,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">4</span>),</span><br><span class="line">                threadFactory</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> threadPoolExecutor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ListeningExecutorService <span class="title function_">listeningExecutorService</span><span class="params">(ThreadPoolExecutor threadPoolExecutor)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> MoreExecutors.listeningDecorator(threadPoolExecutor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Guavaè¿›è¡Œé‡è¯•çš„ç¤ºä¾‹æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">executeWithRetry</span><span class="params">(ListeningExecutorService service, Runnable task, <span class="type">int</span> maxRetries, <span class="type">long</span> delayMillis)</span> &#123;</span><br><span class="line">        service.submit(() -&gt; &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">attempts</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (!success &amp;&amp; attempts &lt; maxRetries) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    task.run();</span><br><span class="line">                    success = <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    attempts++;</span><br><span class="line">                    System.out.println(<span class="string">&quot;ä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œæ­£åœ¨è¿›è¡Œç¬¬ &quot;</span> + attempts + <span class="string">&quot; æ¬¡é‡è¯•&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (attempts &gt;= maxRetries) &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œä»»åŠ¡æ‰§è¡Œå¤±è´¥&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(delayMillis);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                        Thread.currentThread().interrupt();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶å°†å…¶åŒ…è£…ä¸º<code>ListeningExecutorService</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>executeWithRetry</code>æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ª<code>ListeningExecutorService</code>ã€ä¸€ä¸ªä»»åŠ¡ã€æœ€å¤§é‡è¯•æ¬¡æ•°å’Œé‡è¯•å»¶è¿Ÿæ—¶é—´ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¾ªç¯æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶åœ¨æ•è·åˆ°å¼‚å¸¸æ—¶è¿›è¡Œé‡è¯•ï¼Œç›´åˆ°ä»»åŠ¡æˆåŠŸæ‰§è¡Œæˆ–è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚</p><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­çš„é‡è¯•é€»è¾‘æ˜¯åŒæ­¥çš„ï¼Œå³åœ¨ä»»åŠ¡å¤±è´¥åï¼Œå®ƒä¼šåœ¨å½“å‰çº¿ç¨‹ä¸­ç­‰å¾…æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´åå†æ¬¡å°è¯•æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœä½ éœ€è¦å¼‚æ­¥é‡è¯•ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨<code>ScheduledExecutorService</code>æ¥å®‰æ’é‡è¯•ä»»åŠ¡ã€‚</p><hr><h2 id="å…«ã€ThreadPoolExecutorä¸Executorsç±»çš„å…·ä½“åŒºåˆ«å’Œé€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ">å…«ã€ThreadPoolExecutorä¸Executorsç±»çš„å…·ä½“åŒºåˆ«å’Œé€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>ThreadPoolExecutorä¸Executorsç±»åœ¨Javaä¸­éƒ½æ˜¯ç”¨äºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹æ± çš„å·¥å…·ï¼Œä½†å®ƒä»¬åœ¨å…·ä½“å®ç°å’Œé€‚ç”¨åœºæ™¯ä¸Šæœ‰ä¸€äº›åŒºåˆ«ã€‚</p><ol><li><strong>å…·ä½“åŒºåˆ«</strong>ï¼š<ul><li><strong>Executorsç±»</strong>ï¼šæä¾›äº†å¤šç§é™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚å®ƒç®€åŒ–äº†çº¿ç¨‹ç®¡ç†ï¼Œå‡å°‘äº†ä»£ç é‡ï¼Œå¹¶ä¸”é€šè¿‡å¤ç”¨çº¿ç¨‹ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†å¤§é‡çŸ­æœŸå¼‚æ­¥ä»»åŠ¡ã€‚Executorsç±»é€‚ç”¨äºéœ€è¦å¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± çš„åœºæ™¯ï¼Œä¾‹å¦‚WebæœåŠ¡å™¨å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚æˆ–å¼‚æ­¥æ—¥å¿—è®°å½•ã€‚</li><li><strong>ThreadPoolExecutor</strong>ï¼šæ˜¯ä¸€ä¸ªæ›´é«˜çº§çš„æ¥å£ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçº¿ç¨‹æ± å’Œä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—çš„ç»„åˆã€‚å®ƒå…è®¸ç”¨æˆ·è‡ªå®šä¹‰çº¿ç¨‹æ± çš„å¤§å°ã€æ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ç­‰å‚æ•°ã€‚ä½¿ç”¨ThreadPoolExecutorå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡Futureæ¥å£è·å–å¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚</li></ul></li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<ul><li><strong>Executorsç±»</strong>ï¼šé€‚ç”¨äº<strong>æ‰§è¡Œå¤§é‡çŸ­æœŸå¼‚æ­¥ä»»åŠ¡</strong>ï¼Œå°¤å…¶æ˜¯ä»»åŠ¡æ‰§è¡Œæ—¶é—´ä¸ç¡®å®šçš„æƒ…å†µã€‚ä¾‹å¦‚ï¼ŒWebæœåŠ¡å™¨å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ï¼Œæˆ–è€…å¼‚æ­¥æ—¥å¿—è®°å½•ã€‚</li><li><strong>ThreadPoolExecutor</strong>ï¼šé€‚ç”¨äº<strong>éœ€è¦ç²¾ç»†æ§åˆ¶çº¿ç¨‹æ± å‚æ•°çš„åœºæ™¯</strong>ã€‚ä¾‹å¦‚ï¼Œå½“éœ€è¦æ ¹æ®å®é™…æƒ…å†µåŠ¨æ€è°ƒæ•´çº¿ç¨‹æ± å¤§å°æ—¶ï¼Œå¯ä»¥é€‰æ‹©ThreadPoolExecutorè¿›è¡Œè‡ªå®šä¹‰é…ç½®ã€‚</li></ul></li></ol><p>æ€»ç»“æ¥è¯´ï¼ŒExecutorsç±»æä¾›äº†ä¸€ç§å¿«é€Ÿä¸”ç®€ä¾¿çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œé€‚åˆäºé‚£äº›å¯¹çº¿ç¨‹æ± è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚</p><h2 id="ä¹ã€Javaçº¿ç¨‹æ± åœ¨å¤„ç†é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µæ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ">ä¹ã€Javaçº¿ç¨‹æ± åœ¨å¤„ç†é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µæ¡ˆä¾‹æœ‰å“ªäº›ï¼Ÿ</h2><p>åœ¨å¤„ç†é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒJavaçº¿ç¨‹æ± çš„æœ€ä½³å®è·µæ¡ˆä¾‹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li><strong>é€‰æ‹©åˆé€‚çš„çº¿ç¨‹æ± ç±»å‹</strong>ï¼š<ul><li><code>newFixedThreadPool</code>ï¼šåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚è¿™ç§ç±»å‹çš„çº¿ç¨‹æ± é€‚ç”¨äºéœ€è¦å›ºå®šçº¿ç¨‹æ•°çš„ä»»åŠ¡ã€‚</li><li><code>newSingleThreadExecutor</code>ï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåºï¼ˆFIFO, LIFO, ä¼˜å…ˆçº§ï¼‰æ‰§è¡Œã€‚è¿™ç§ç±»å‹çš„çº¿ç¨‹æ± é€‚ç”¨äºå¯¹ä»»åŠ¡æ‰§è¡Œé¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚çš„åœºæ™¯ã€‚</li></ul></li><li><strong>åˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°</strong>ï¼š<ul><li>æ ¸å¿ƒçº¿ç¨‹æ•°ï¼ˆcorePoolSizeï¼‰ï¼šè®¾ç½®çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå³çº¿ç¨‹æ± ä¸­å§‹ç»ˆå­˜åœ¨çš„çº¿ç¨‹æ•°ã€‚</li><li>æœ€å¤§çº¿ç¨‹æ•°ï¼ˆmaxPoolSizeï¼‰ï¼šè®¾ç½®çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°ï¼Œå½“ä»»åŠ¡æ•°é‡è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œä¼šå°è¯•ä»å·¥ä½œé˜Ÿåˆ—ä¸­è·å–æ›´å¤šçš„çº¿ç¨‹ã€‚</li><li>å·¥ä½œé˜Ÿåˆ—ï¼ˆworkQueueï¼‰ï¼šç”¨äºå­˜å‚¨ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¸¸è§çš„å®ç°æœ‰<code> LinkedBlockingQueue</code>ç­‰ã€‚</li><li>é˜»å¡é˜Ÿåˆ—ï¼ˆblockQueueï¼‰ï¼šç”¨äºå­˜å‚¨å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œå½“æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹éƒ½å¿™æ—¶ï¼Œæ–°ä»»åŠ¡å°†è¢«æ”¾å…¥é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</li></ul></li><li><strong>åŠ¨æ€è°ƒæ•´çº¿ç¨‹æ± è§„æ¨¡</strong>ï¼š<ul><li>ä½¿ç”¨åŠ¨æ€åŒ–çº¿ç¨‹æ± è§£å†³æ–¹æ¡ˆï¼Œæ ¹æ®ç³»ç»Ÿè´Ÿè½½å’Œèµ„æºæƒ…å†µåŠ¨æ€è°ƒæ•´çº¿ç¨‹æ± çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µï¼ˆå¦‚CPUã€å†…å­˜ç­‰ï¼‰ï¼ŒåŠ¨æ€å¢åŠ æˆ–å‡å°‘çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ã€‚</li></ul></li><li><strong>ä¼˜åŒ–é”ç­–ç•¥å’Œé¿å…æ­»é”</strong>ï¼š<ul><li>å°½é‡å‡å°‘å…±äº«çŠ¶æ€çš„ä½¿ç”¨ï¼Œä»¥é™ä½æ­»é”çš„é£é™©ã€‚</li><li>ä½¿ç”¨é«˜çº§å¹¶å‘APIï¼Œå¦‚<code>java.util.concurrent.locks  ReentrantLock</code>ï¼Œå¹¶ç»“åˆæ¡ä»¶å˜é‡ï¼ˆ<code> condition</code>ï¼‰è¿›è¡Œèµ„æºç«äº‰çš„ç®¡ç†ã€‚</li></ul></li><li><strong>ç›‘æ§å’Œè°ƒä¼˜</strong>ï¼š<ul><li>å®šæœŸç›‘æ§çº¿ç¨‹æ± çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä»»åŠ¡æäº¤ç‡ã€å®Œæˆç‡ã€çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç­‰ã€‚</li><li>æ ¹æ®ç›‘æ§ç»“æœè¿›è¡Œè°ƒä¼˜ï¼Œæ¯”å¦‚è°ƒæ•´æ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€å·¥ä½œé˜Ÿåˆ—å¤§å°ç­‰ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹èƒ½å¤Ÿé«˜æ•ˆè¿è¡Œã€‚</li></ul></li></ol><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">â­æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†å¦‚ä½•çº¿ç¨‹æ± çš„æ¦‚å¿µè®²è§£ï¼Œä»¥åŠçº¿ç¨‹æ± å‚æ•°è®¾ç½®ï¼Œè¿˜æœ‰å¦‚ä½•ä½¿ç”¨çº¿ç¨‹æ± </summary>
    
    
    
    <category term="java" scheme="https://liweierzzz.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="å¤šçº¿ç¨‹" scheme="https://liweierzzz.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    <category term="å¼‚æ­¥åŒ–" scheme="https://liweierzzz.github.io/tags/%E5%BC%82%E6%AD%A5%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯æ¨é€åŠŸèƒ½è¸©å‘</title>
    <link href="https://liweierzzz.github.io/posts/cc836709.html"/>
    <id>https://liweierzzz.github.io/posts/cc836709.html</id>
    <published>2024-07-11T03:19:55.000Z</published>
    <updated>2024-07-11T06:29:57.999Z</updated>
    
    <content type="html"><![CDATA[<h1>å¾®ä¿¡å…¬ä¼—å· åŸæ ·è¿”å›echostr ä»ç„¶éªŒè¯å¤±è´¥çš„å‘</h1><p>é‡åˆ°çš„é—®é¢˜ï¼š</p><p><a href="https://imgse.com/i/pkhYIUJ"><img src="https://s21.ax1x.com/2024/07/11/pkhYIUJ.jpg" alt="pkhYIUJ.jpg"></a></p><p>æ­»æ´»tokenæ ¡éªŒä¸é€šè¿‡ï¼Œæˆ‘çœŸçš„ä¸çŸ¥é“å•¥åŸå› </p><p>å¾®ä¿¡è¦æ±‚ï¼šç¡®è®¤æ­¤æ¬¡GETè¯·æ±‚æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨ï¼Œåˆ™åŸæ ·è¿”å›echostrå‚æ•°å†…å®¹</p><p>éƒ½æŒ‰è¦æ±‚æ¥äº†ï¼Œä½†æ€ä¹ˆéƒ½ä¸è¡Œï¼Œæ€»æ˜¯æç¤ºï¼šTokenæ ¡éªŒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç¡®è®¤</p><p>ä»”ç»†æ£€æŸ¥äº†é…ç½®å¥½å‡ æ¬¡ï¼Œéƒ½æ²¡å‘ç°èƒ½æœ‰ä»€ä¹ˆé—®é¢˜</p><p>æˆ‘è‡ªå·±éƒ½é€šè¿‡æµè§ˆå™¨æ‰‹åŠ¨è¾“å…¥å‚æ•°è®¤è¯äº†å¥½å‡ éï¼Œéƒ½èƒ½éªŒè¯æˆåŠŸï¼Œè€Œä¸”è¿”å›äº†echostrå‚æ•°å†…å®¹ï¼Œé‚£æ€ä¹ˆå¾®ä¿¡å¼€é€šè®¾ç½®è€æ˜¯æç¤ºTokenæ ¡éªŒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç¡®è®¤ï¼Ÿ</p><p>è¿™æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯returnå›æ¥çš„echostræ˜¯å¸¦åŒå¼•å·ï¼Œè€Œechoå›æ¥çš„echostræ˜¯ä¸å¸¦åŒå¼•å·çš„ã€‚</p><p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ¶ˆæ¯æ ¡éªŒï¼Œç¡®å®šæ˜¯å¾®ä¿¡å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> signature</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> timestamp</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> nonce</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> echostr</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/get&quot;)</span></span><br><span class="line">   <span class="comment">//-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯,signature:072146db664ac6e89cf22ceb5ee35c0dc7536a66,timestamp:1720665348,nonce:190254112,echostr:7375403449705256878</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">doGet</span><span class="params">(String signature, String timestamp, String nonce, String echostr)</span> &#123;</span><br><span class="line">       log.info(<span class="string">&quot;-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯,signature:&#123;&#125;,timestamp:&#123;&#125;,nonce:&#123;&#125;,echostr:&#123;&#125;&quot;</span>, signature, timestamp, nonce, echostr);</span><br><span class="line">       <span class="comment">// æ¶ˆæ¯åˆæ³•</span></span><br><span class="line">       <span class="keyword">if</span> (wxMaService.checkSignature(timestamp, nonce, signature)) &#123;</span><br><span class="line">           log.info(<span class="string">&quot;-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯é€šè¿‡,echostr:&#123;&#125;&quot;</span>, echostr);</span><br><span class="line">           <span class="keyword">return</span> echostr;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// æ¶ˆæ¯ç­¾åä¸æ­£ç¡®ï¼Œè¯´æ˜ä¸æ˜¯å…¬ä¼—å¹³å°å‘è¿‡æ¥çš„æ¶ˆæ¯</span></span><br><span class="line">       <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>æ­»æ´»éªŒè¯ä¸è¿‡å»ï¼Œç™¾åº¦åŠå¤©æ²¡äººç»™å‡ºæ­£ç¡®çš„è§£å†³åŠæ³•ã€‚æœ€åç»ˆäºæ‰¾åˆ°äº†è§£å†³åŠæ³•ï¼ŒæŠŠechostræ”¹æˆLongç±»å‹ï¼ŒéªŒè¯æˆåŠŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ¶ˆæ¯æ ¡éªŒï¼Œç¡®å®šæ˜¯å¾®ä¿¡å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> signature</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> timestamp</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> nonce</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> echostr</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/get&quot;)</span></span><br><span class="line">   <span class="comment">//-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯,signature:072146db664ac6e89cf22ceb5ee35c0dc7536a66,timestamp:1720665348,nonce:190254112,echostr:7375403449705256878</span></span><br><span class="line">   <span class="keyword">public</span> Long <span class="title function_">doGet</span><span class="params">(String signature, String timestamp, String nonce, Long echostr)</span> &#123;</span><br><span class="line">       log.info(<span class="string">&quot;-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯,signature:&#123;&#125;,timestamp:&#123;&#125;,nonce:&#123;&#125;,echostr:&#123;&#125;&quot;</span>, signature, timestamp, nonce, echostr);</span><br><span class="line">       <span class="comment">// æ¶ˆæ¯åˆæ³•</span></span><br><span class="line">       <span class="keyword">if</span> (wxMaService.checkSignature(timestamp, nonce, signature)) &#123;</span><br><span class="line">           log.info(<span class="string">&quot;-------------å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯éªŒè¯é€šè¿‡,echostr:&#123;&#125;&quot;</span>, echostr);</span><br><span class="line">           <span class="keyword">return</span> echostr;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// æ¶ˆæ¯ç­¾åä¸æ­£ç¡®ï¼Œè¯´æ˜ä¸æ˜¯å…¬ä¼—å¹³å°å‘è¿‡æ¥çš„æ¶ˆæ¯</span></span><br><span class="line">       <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p><a href="https://imgse.com/i/pkhY5E4"><img src="https://s21.ax1x.com/2024/07/11/pkhY5E4.md.png" alt="pkhY5E4.md.png"></a></p>]]></content>
    
    
    <summary type="html">â­è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†æˆ‘åœ¨å¯ç”¨å¾®ä¿¡å°ç¨‹åºçš„æ¶ˆæ¯æ¨é€åŠŸèƒ½ä¸­é‡åˆ°çš„å‘(è¿™å¾®ä¿¡ä¹Ÿå¤ªå‘äº†å§)â­</summary>
    
    
    
    <category term="è¸©å‘" scheme="https://liweierzzz.github.io/categories/%E8%B8%A9%E5%9D%91/"/>
    
    
    <category term="è¸©å‘" scheme="https://liweierzzz.github.io/tags/%E8%B8%A9%E5%9D%91/"/>
    
    <category term="å¾®ä¿¡å°ç¨‹åº" scheme="https://liweierzzz.github.io/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
    <category term="æ¶ˆæ¯æ¨é€" scheme="https://liweierzzz.github.io/tags/%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81/"/>
    
  </entry>
  
  <entry>
    <title>é™æµçš„ä½¿ç”¨å’Œå¸¸è§çš„é™æµç®—æ³•</title>
    <link href="https://liweierzzz.github.io/posts/c2a8353e.html"/>
    <id>https://liweierzzz.github.io/posts/c2a8353e.html</id>
    <published>2024-07-10T10:44:03.000Z</published>
    <updated>2024-07-10T11:36:59.897Z</updated>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« ï¼š</p><div class="tag link"><a class="link-card" title="å¸¸è§çš„å››ç§é™æµç®—æ³•" href="https://juejin.cn/post/6967742960540581918"><div class="left"><img src="https://bu.dusays.com/2024/07/09/668d53bc18fda.jpg"/></div><div class="right"><p class="text">å¸¸è§çš„å››ç§é™æµç®—æ³•</p><p class="url">https://juejin.cn/post/6967742960540581918</p></div></a></div><div class="tag link"><a class="link-card" title="ä¸€æ–‡è¯¦è§£ Java é™æµå¸¸è§çš„å››ç§é™æµç®—æ³•" href="https://blog.csdn.net/weixin_45583158/article/details/135664278"><div class="left"><img src="https://bu.dusays.com/2024/07/07/668a4bc246db5.jpg"/></div><div class="right"><p class="text">ä¸€æ–‡è¯¦è§£ Java é™æµå¸¸è§çš„å››ç§é™æµç®—æ³•</p><p class="url">https://blog.csdn.net/weixin_45583158/article/details/135664278</p></div></a></div><h1>é™æµ</h1><h2 id="1-ä¸ºä»€ä¹ˆè¦è¿›è¡Œé™æµ">1. ä¸ºä»€ä¹ˆè¦è¿›è¡Œé™æµ</h2><ol><li>ç¬æ—¶æµé‡è¿‡é«˜ï¼ŒæœåŠ¡è¢«å‹å®</li><li>æ¶æ„ç”¨æˆ·é«˜é¢‘å…‰é¡¾ï¼Œå¯¼è‡´<a href="https://so.csdn.net/so/search?q=%E6%9C%8D%E5%8A%A1%E5%99%A8&amp;spm=1001.2101.3001.7020">æœåŠ¡å™¨</a>å®•æœºï¼Ÿ</li><li>æ¶ˆæ¯æ¶ˆè´¹è¿‡å¿«ï¼Œå¯¼è‡´<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93&amp;spm=1001.2101.3001.7020">æ•°æ®åº“</a>å‹åŠ›è¿‡å¤§ï¼Œæ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒï¼Ÿ</li></ol><h2 id="2-ä»€ä¹ˆæ˜¯é™æµ">2. ä»€ä¹ˆæ˜¯é™æµ</h2><p>é™æµï¼Œä¹Ÿç§°æµé‡æ§åˆ¶ã€‚æ˜¯æŒ‡ç³»ç»Ÿåœ¨é¢ä¸´é«˜å¹¶å‘ï¼Œæˆ–è€…<strong>å¤§æµé‡è¯·æ±‚</strong>çš„æƒ…å†µä¸‹ï¼Œ<strong>é™åˆ¶æ–°çš„è¯·æ±‚å¯¹ç³»ç»Ÿçš„è®¿é—®</strong>ï¼Œä»è€Œ<strong>ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§</strong>ã€‚é™æµä¼šå¯¼è‡´éƒ¨åˆ†ç”¨æˆ·è¯·æ±‚å¤„ç†ä¸åŠæ—¶æˆ–è€…è¢«æ‹’ï¼Œè¿™å°±å½±å“äº†ç”¨æˆ·ä½“éªŒã€‚æ‰€ä»¥ä¸€èˆ¬éœ€è¦åœ¨ç³»ç»Ÿç¨³å®šå’Œç”¨æˆ·ä½“éªŒä¹‹é—´<strong>å¹³è¡¡</strong>ä¸€ä¸‹ã€‚ä¸¾ä¸ªç”Ÿæ´»çš„ä¾‹å­ï¼š</p><blockquote><p>ä¸€äº›çƒ­é—¨çš„æ—…æ¸¸æ™¯åŒºï¼Œä¸€èˆ¬ä¼šå¯¹æ¯æ—¥çš„æ—…æ¸¸å‚è§‚äººæ•°æœ‰é™åˆ¶çš„ã€‚æ¯å¤©åªä¼šå–å‡ºå›ºå®šæ•°ç›®çš„é—¨ç¥¨ï¼Œæ¯”å¦‚5000å¼ ã€‚å‡è®¾åœ¨äº”ä¸€ã€å›½åº†å‡æœŸï¼Œä½ å»æ™šäº†ï¼Œå¯èƒ½å½“å¤©çš„ç¥¨å°±å·²ç»å–å®Œäº†ï¼Œå°±æ— æ³•è¿›å»æ¸¸ç©äº†ã€‚å³ä½¿ä½ è¿›å»äº†ï¼Œæ’é˜Ÿä¹Ÿèƒ½æ’åˆ°ä½ æ€€ç–‘äººç”Ÿã€‚</p></blockquote><hr><h2 id="3-å¸¸è§çš„é™æµç®—æ³•">3. å¸¸è§çš„é™æµç®—æ³•</h2><h3 id="3-1-å›ºå®šçª—å£é™æµç®—æ³•">3.1 å›ºå®šçª—å£é™æµç®—æ³•</h3><p>é¦–å…ˆç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå°†å•ä½æ—¶é—´æ®µå½“åšä¸€ä¸ªçª—å£ï¼Œè®¡æ•°å™¨è®°å½•è¿™ä¸ªçª—å£æ¥æ”¶è¯·æ±‚çš„æ¬¡æ•°ã€‚</p><ul><li>å½“æ¬¡æ•°å°‘äºé™æµé˜€å€¼ï¼Œå°±å…è®¸è®¿é—®ï¼Œå¹¶ä¸”è®¡æ•°å™¨+1</li><li>å½“æ¬¡æ•°å¤§äºé™æµé˜€å€¼ï¼Œå°±æ‹’ç»è®¿é—®ã€‚</li><li>å½“å‰çš„æ—¶é—´çª—å£è¿‡å»ä¹‹åï¼Œè®¡æ•°å™¨æ¸…é›¶ã€‚</li></ul><p>å‡è®¾å•ä½æ—¶é—´æ˜¯1ç§’ï¼Œé™æµé˜€å€¼ä¸º3ã€‚åœ¨å•ä½æ—¶é—´1ç§’å†…ï¼Œæ¯æ¥ä¸€ä¸ªè¯·æ±‚,è®¡æ•°å™¨å°±åŠ 1ï¼Œå¦‚æœè®¡æ•°å™¨ç´¯åŠ çš„æ¬¡æ•°è¶…è¿‡é™æµé˜€å€¼3ï¼Œåç»­çš„è¯·æ±‚å…¨éƒ¨æ‹’ç»ã€‚ç­‰åˆ°1sç»“æŸåï¼Œè®¡æ•°å™¨æ¸…0ï¼Œé‡æ–°å¼€å§‹è®¡æ•°ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><a href="https://imgse.com/i/pkhFua4"><img src="https://s21.ax1x.com/2024/07/10/pkhFua4.webp" alt="pkhFua4.webp"></a></p><h4 id="ä»£ç å®ç°">ä»£ç å®ç°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FixedWindowRateLimiter</span> &#123;</span><br><span class="line">    <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(FixedWindowRateLimiter.class);</span><br><span class="line">    <span class="comment">//æ—¶é—´çª—å£å¤§å°ï¼Œå•ä½æ¯«ç§’</span></span><br><span class="line">    <span class="type">long</span> windowSize;</span><br><span class="line">    <span class="comment">//å…è®¸é€šè¿‡çš„è¯·æ±‚æ•°</span></span><br><span class="line">    <span class="type">int</span> maxRequestCount;</span><br><span class="line">    <span class="comment">//å½“å‰çª—å£é€šè¿‡çš„è¯·æ±‚æ•°</span></span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//çª—å£å³è¾¹ç•Œ</span></span><br><span class="line">    <span class="type">long</span> windowBorder;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FixedWindowRateLimiter</span><span class="params">(<span class="type">long</span> windowSize, <span class="type">int</span> maxRequestCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.windowSize = windowSize;</span><br><span class="line">        <span class="built_in">this</span>.maxRequestCount = maxRequestCount;</span><br><span class="line">        <span class="built_in">this</span>.windowBorder = System.currentTimeMillis() + windowSize;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">if</span> (windowBorder &lt; currentTime) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;window reset&quot;</span>);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                windowBorder += windowSize;</span><br><span class="line">            &#125; <span class="keyword">while</span> (windowBorder &lt; currentTime);</span><br><span class="line">            counter = <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (counter.intValue() &lt; maxRequestCount) &#123;</span><br><span class="line">            counter.incrementAndGet();</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire success&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire fail&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ä¼˜ç¼ºç‚¹"><strong>ä¼˜ç¼ºç‚¹</strong>:</h4><p>**ä¼˜ç‚¹ï¼š**å®ç°ç®€å•ï¼Œå®¹æ˜“ç†è§£</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li><p><strong>é™æµä¸å¤Ÿå¹³æ»‘</strong>ã€‚ä¾‹å¦‚ï¼šé™æµæ˜¯æ¯ç§’3ä¸ªï¼Œåœ¨ç¬¬ä¸€æ¯«ç§’å‘é€äº†3ä¸ªè¯·æ±‚ï¼Œè¾¾åˆ°é™æµï¼Œçª—å£å‰©ä½™æ—¶é—´çš„è¯·æ±‚éƒ½å°†ä¼šè¢«æ‹’ç»ï¼Œä½“éªŒä¸å¥½ã€‚</p></li><li><p><strong>æ— æ³•å¤„ç†çª—å£è¾¹ç•Œé—®é¢˜</strong>ã€‚å› ä¸ºæ˜¯åœ¨æŸä¸ªæ—¶é—´çª—å£å†…è¿›è¡Œæµé‡æ§åˆ¶ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°çª—å£è¾¹ç•Œæ•ˆåº”ï¼Œå³åœ¨æ—¶é—´çª—å£çš„è¾¹ç•Œå¤„å¯èƒ½ä¼šæœ‰å¤§é‡çš„è¯·æ±‚è¢«å…è®¸é€šè¿‡ï¼Œä»è€Œå¯¼è‡´çªå‘æµé‡ã€‚å³ï¼šå¦‚æœç¬¬2åˆ°3ç§’å†…äº§ç”Ÿäº†150æ¬¡è¯·æ±‚ï¼Œè€Œç¬¬3åˆ°4ç§’å†…äº§ç”Ÿäº†150æ¬¡è¯·æ±‚ï¼Œé‚£ä¹ˆå…¶å®åœ¨ç¬¬2ç§’åˆ°ç¬¬4ç§’è¿™ä¸¤ç§’å†…ï¼Œå°±å·²ç»å‘ç”Ÿäº†300æ¬¡è¯·æ±‚äº†ï¼Œè¿œè¿œå¤§äºæˆ‘ä»¬è¦æ±‚çš„<strong>3ç§’å†…çš„è¯·æ±‚ä¸è¦è¶…è¿‡150æ¬¡</strong>è¿™ä¸ªé™åˆ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p></li></ol><p><a href="https://imgse.com/i/pkhFlGR"><img src="https://s21.ax1x.com/2024/07/10/pkhFlGR.webp" alt="pkhFlGR.webp"></a></p><hr><h3 id="3-2-æ»‘åŠ¨çª—å£é™æµç®—æ³•">3.2 æ»‘åŠ¨çª—å£é™æµç®—æ³•</h3><p>æ»‘åŠ¨çª—å£é™æµè§£å†³å›ºå®šçª—å£ä¸´ç•Œå€¼çš„é—®é¢˜ã€‚å®ƒå°†å•ä½æ—¶é—´å‘¨æœŸåˆ†ä¸ºnä¸ªå°å‘¨æœŸï¼Œåˆ†åˆ«è®°å½•æ¯ä¸ªå°å‘¨æœŸå†…æ¥å£çš„è®¿é—®æ¬¡æ•°ï¼Œå¹¶ä¸”æ ¹æ®æ—¶é—´æ»‘åŠ¨åˆ é™¤è¿‡æœŸçš„å°å‘¨æœŸã€‚</p><p>ä¸€å¼ å›¾è§£é‡Šæ»‘åŠ¨çª—å£ç®—æ³•ï¼Œå¦‚ä¸‹ï¼š</p><p><a href="https://imgse.com/i/pkhF3xx"><img src="https://s21.ax1x.com/2024/07/10/pkhF3xx.webp" alt="pkhF3xx.webp"></a></p><p>å‡è®¾å•ä½æ—¶é—´è¿˜æ˜¯1sï¼Œæ»‘åŠ¨çª—å£ç®—æ³•æŠŠå®ƒåˆ’åˆ†ä¸º5ä¸ªå°å‘¨æœŸï¼Œä¹Ÿå°±æ˜¯æ»‘åŠ¨çª—å£ï¼ˆå•ä½æ—¶é—´ï¼‰è¢«åˆ’åˆ†ä¸º5ä¸ªå°æ ¼å­ã€‚æ¯æ ¼è¡¨ç¤º0.2sã€‚æ¯è¿‡0.2sï¼Œæ—¶é—´çª—å£å°±ä¼šå¾€å³æ»‘åŠ¨ä¸€æ ¼ã€‚ç„¶åå‘¢ï¼Œæ¯ä¸ªå°å‘¨æœŸï¼Œéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„è®¡æ•°å™¨ï¼Œå¦‚æœè¯·æ±‚æ˜¯0.83såˆ°è¾¾çš„ï¼Œ0.8~1.0så¯¹åº”çš„è®¡æ•°å™¨å°±ä¼šåŠ 1ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹æ»‘åŠ¨çª—å£æ˜¯å¦‚ä½•è§£å†³ä¸´ç•Œé—®é¢˜çš„ï¼Ÿ</p><p>å‡è®¾æˆ‘ä»¬1så†…çš„é™æµé˜€å€¼è¿˜æ˜¯5ä¸ªè¯·æ±‚ï¼Œ<code>0.8~1.0s</code>å†…ï¼ˆæ¯”å¦‚0.9sçš„æ—¶å€™ï¼‰æ¥äº†5ä¸ªè¯·æ±‚ï¼Œè½åœ¨é»„è‰²æ ¼å­é‡Œã€‚æ—¶é—´è¿‡äº†1.0sè¿™ä¸ªç‚¹ä¹‹åï¼Œåˆæ¥5ä¸ªè¯·æ±‚ï¼Œè½åœ¨ç´«è‰²æ ¼å­é‡Œã€‚å¦‚æœ<strong>æ˜¯å›ºå®šçª—å£ç®—æ³•ï¼Œæ˜¯ä¸ä¼šè¢«é™æµçš„</strong>ï¼Œä½†æ˜¯<strong>æ»‘åŠ¨çª—å£çš„è¯ï¼Œæ¯è¿‡ä¸€ä¸ªå°å‘¨æœŸï¼Œå®ƒä¼šå³ç§»ä¸€ä¸ªå°æ ¼</strong>ã€‚è¿‡äº†1.0sè¿™ä¸ªç‚¹åï¼Œä¼šå³ç§»ä¸€å°æ ¼ï¼Œå½“å‰çš„å•ä½æ—¶é—´æ®µæ˜¯0.2~1.2sï¼Œè¿™ä¸ªåŒºåŸŸçš„è¯·æ±‚å·²ç»è¶…è¿‡é™å®šçš„5äº†ï¼Œå·²è§¦å‘é™æµå•¦ï¼Œå®é™…ä¸Šï¼Œç´«è‰²æ ¼å­çš„è¯·æ±‚éƒ½è¢«æ‹’ç»å•¦ã€‚</p><p><strong>TIPS:</strong> å½“æ»‘åŠ¨çª—å£çš„æ ¼å­å‘¨æœŸåˆ’åˆ†çš„è¶Šå¤šï¼Œé‚£ä¹ˆæ»‘åŠ¨çª—å£çš„æ»šåŠ¨å°±è¶Šå¹³æ»‘ï¼Œé™æµçš„ç»Ÿè®¡å°±ä¼šè¶Šç²¾ç¡®ã€‚</p><h4 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SlidingWindowRateLimiter</span> &#123;</span><br><span class="line">    <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(FixedWindowRateLimiter.class);</span><br><span class="line">    <span class="comment">//æ—¶é—´çª—å£å¤§å°ï¼Œå•ä½æ¯«ç§’</span></span><br><span class="line">    <span class="type">long</span> windowSize;</span><br><span class="line">    <span class="comment">//åˆ†ç‰‡çª—å£æ•°</span></span><br><span class="line">    <span class="type">int</span> shardNum;</span><br><span class="line">    <span class="comment">//å…è®¸é€šè¿‡çš„è¯·æ±‚æ•°</span></span><br><span class="line">    <span class="type">int</span> maxRequestCount;</span><br><span class="line">    <span class="comment">//å„ä¸ªçª—å£å†…è¯·æ±‚è®¡æ•°</span></span><br><span class="line">    <span class="type">int</span>[] shardRequestCount;</span><br><span class="line">    <span class="comment">//è¯·æ±‚æ€»æ•°</span></span><br><span class="line">    <span class="type">int</span> totalCount;</span><br><span class="line">    <span class="comment">//å½“å‰çª—å£ä¸‹æ ‡</span></span><br><span class="line">    <span class="type">int</span> shardId;</span><br><span class="line">    <span class="comment">//æ¯ä¸ªå°çª—å£å¤§å°ï¼Œæ¯«ç§’</span></span><br><span class="line">    <span class="type">long</span> tinyWindowSize;</span><br><span class="line">    <span class="comment">//çª—å£å³è¾¹ç•Œ</span></span><br><span class="line">    <span class="type">long</span> windowBorder;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SlidingWindowRateLimiter</span><span class="params">(<span class="type">long</span> windowSize, <span class="type">int</span> shardNum, <span class="type">int</span> maxRequestCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.windowSize = windowSize;</span><br><span class="line">        <span class="built_in">this</span>.shardNum = shardNum;</span><br><span class="line">        <span class="built_in">this</span>.maxRequestCount = maxRequestCount;</span><br><span class="line">        <span class="built_in">this</span>.shardRequestCount = <span class="keyword">new</span> <span class="title class_">int</span>[shardNum];</span><br><span class="line">        <span class="built_in">this</span>.tinyWindowSize = windowSize / shardNum;</span><br><span class="line">        <span class="built_in">this</span>.windowBorder = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">if</span> (windowBorder &lt; currentTime) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;window reset&quot;</span>);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                shardId = (++shardId) % shardNum;</span><br><span class="line">                totalCount -= shardRequestCount[shardId];</span><br><span class="line">                shardRequestCount[shardId] = <span class="number">0</span>;</span><br><span class="line">                windowBorder += tinyWindowSize;</span><br><span class="line">            &#125; <span class="keyword">while</span> (windowBorder &lt; currentTime);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (totalCount &lt; maxRequestCount) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire success:&#123;&#125;&quot;</span>, shardId);</span><br><span class="line">            shardRequestCount[shardId]++;</span><br><span class="line">            totalCount++;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire fail&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ä¼˜ç¼ºç‚¹-2">ä¼˜ç¼ºç‚¹</h4><p>**ä¼˜ç‚¹ï¼š**è§£å†³äº†å›ºå®šçª—å£ç®—æ³•çš„çª—å£è¾¹ç•Œé—®é¢˜ï¼Œé¿å…çªå‘æµé‡å‹å®æœåŠ¡å™¨ã€‚</p><p>**ç¼ºç‚¹ï¼š**è¿˜æ˜¯å­˜åœ¨é™æµä¸å¤Ÿå¹³æ»‘çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼šé™æµæ˜¯æ¯ç§’3ä¸ªï¼Œåœ¨ç¬¬ä¸€æ¯«ç§’å‘é€äº†3ä¸ªè¯·æ±‚ï¼Œè¾¾åˆ°é™æµï¼Œå‰©ä½™çª—å£æ—¶é—´çš„è¯·æ±‚éƒ½å°†ä¼šè¢«æ‹’ç»ï¼Œä½“éªŒä¸å¥½ã€‚</p><h3 id="3-3-æ¼æ¡¶ç®—æ³•">3.3 æ¼æ¡¶ç®—æ³•</h3><h4 id="å®ç°åŸç†">å®ç°åŸç†</h4><p>å®ƒçš„åŸç†å¾ˆç®€å•ï¼Œå¯ä»¥è®¤ä¸ºå°±æ˜¯<strong>æ³¨æ°´æ¼æ°´</strong>çš„è¿‡ç¨‹ã€‚å¾€æ¼æ¡¶ä¸­ä»¥ä»»æ„é€Ÿç‡æµå…¥æ°´ï¼Œä»¥å›ºå®šçš„é€Ÿç‡æµå‡ºæ°´ã€‚å½“æ°´è¶…è¿‡æ¡¶çš„å®¹é‡æ—¶ï¼Œä¼šè¢«æº¢å‡ºï¼Œä¹Ÿå°±æ˜¯è¢«ä¸¢å¼ƒã€‚å› ä¸ºæ¡¶å®¹é‡æ˜¯ä¸å˜çš„ï¼Œä¿è¯äº†æ•´ä½“çš„é€Ÿç‡ã€‚</p><p><a href="https://imgse.com/i/pkhFJsK"><img src="https://s21.ax1x.com/2024/07/10/pkhFJsK.webp" alt="pkhFJsK.webp"></a></p><ul><li>æµå…¥çš„æ°´æ»´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯è®¿é—®ç³»ç»Ÿçš„è¯·æ±‚ï¼Œè¿™ä¸ªæµå…¥é€Ÿç‡æ˜¯ä¸ç¡®å®šçš„ã€‚</li><li>æ¡¶çš„å®¹é‡ä¸€èˆ¬è¡¨ç¤ºç³»ç»Ÿæ‰€èƒ½å¤„ç†çš„è¯·æ±‚æ•°ã€‚</li><li>å¦‚æœæ¡¶çš„å®¹é‡æ»¡äº†ï¼Œå°±è¾¾åˆ°é™æµçš„é˜€å€¼ï¼Œå°±ä¼šä¸¢å¼ƒæ°´æ»´ï¼ˆæ‹’ç»è¯·æ±‚ï¼‰</li><li>æµå‡ºçš„æ°´æ»´ï¼Œæ˜¯æ’å®šè¿‡æ»¤çš„ï¼Œå¯¹åº”æœåŠ¡æŒ‰ç…§å›ºå®šçš„é€Ÿç‡å¤„ç†è¯·æ±‚ã€‚</li></ul><h4 id="ä»£ç å®ç°-3">ä»£ç å®ç°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeakyBucketRateLimiter</span> &#123;</span><br><span class="line">    <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(LeakyBucketRateLimiter.class);</span><br><span class="line">    <span class="comment">//æ¡¶çš„å®¹é‡</span></span><br><span class="line">    <span class="type">int</span> capacity;</span><br><span class="line">    <span class="comment">//æ¡¶ä¸­ç°å­˜æ°´é‡</span></span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">water</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line">    <span class="comment">//å¼€å§‹æ¼æ°´æ—¶é—´</span></span><br><span class="line">    <span class="type">long</span> leakTimestamp;</span><br><span class="line">    <span class="comment">//æ°´æµå‡ºçš„é€Ÿç‡ï¼Œå³æ¯ç§’å…è®¸é€šè¿‡çš„è¯·æ±‚æ•°</span></span><br><span class="line">    <span class="type">int</span> leakRate;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LeakyBucketRateLimiter</span><span class="params">(<span class="type">int</span> capacity, <span class="type">int</span> leakRate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">        <span class="built_in">this</span>.leakRate = leakRate;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//æ¡¶ä¸­æ²¡æœ‰æ°´ï¼Œ é‡æ–°å¼€å§‹è®¡ç®—</span></span><br><span class="line">        <span class="keyword">if</span> (water.get() == <span class="number">0</span>) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;start leaking&quot;</span>);</span><br><span class="line">            leakTimestamp = System.currentTimeMillis();</span><br><span class="line">            water.incrementAndGet();</span><br><span class="line">            <span class="keyword">return</span> water.get() &lt; capacity;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å…ˆæ¼æ°´ï¼Œè®¡ç®—å‰©ä½™æ°´é‡</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">int</span> <span class="variable">leakedWater</span> <span class="operator">=</span> (<span class="type">int</span>) ((currentTime - leakTimestamp) / <span class="number">1000</span> * leakRate);</span><br><span class="line">        logger.info(<span class="string">&quot;lastTime:&#123;&#125;, currentTime:&#123;&#125;. LeakedWater:&#123;&#125;&quot;</span>, leakTimestamp, currentTime, leakedWater);</span><br><span class="line">        <span class="comment">//å¯èƒ½æ—¶é—´ä¸è¶³ï¼Œåˆ™å…ˆä¸æ¼æ°´</span></span><br><span class="line">        <span class="keyword">if</span> (leakedWater != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">leftWater</span> <span class="operator">=</span> water.get() - leakedWater;</span><br><span class="line">            <span class="comment">//å¯èƒ½æ°´å·²æ¼å…‰ã€‚è®¾ä¸º0</span></span><br><span class="line">            water.set(Math.max(<span class="number">0</span>, leftWater));</span><br><span class="line">            leakTimestamp = System.currentTimeMillis();</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(<span class="string">&quot;å‰©ä½™å®¹é‡:&#123;&#125;&quot;</span>, capacity - water.get());</span><br><span class="line">        <span class="keyword">if</span> (water.get() &lt; capacity) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire sucess&quot;</span>);</span><br><span class="line">            water.incrementAndGet();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;tryAcquire fail&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="ä¼˜ç¼ºç‚¹-3">ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ol><li><p><strong>å¹³æ»‘æµé‡</strong>ã€‚ç”±äºæ¼æ¡¶ç®—æ³•ä»¥å›ºå®šçš„é€Ÿç‡å¤„ç†è¯·æ±‚ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å¹³æ»‘å’Œæ•´å½¢æµé‡ï¼Œé¿å…æµé‡çš„çªå‘å’Œæ³¢åŠ¨ï¼ˆç±»ä¼¼äºæ¶ˆæ¯é˜Ÿåˆ—çš„å‰Šå³°å¡«è°·çš„ä½œç”¨ï¼‰ã€‚</p></li><li><p><strong>é˜²æ­¢è¿‡è½½</strong>ã€‚å½“æµå…¥çš„è¯·æ±‚è¶…è¿‡æ¡¶çš„å®¹é‡æ—¶ï¼Œå¯ä»¥ç›´æ¥ä¸¢å¼ƒè¯·æ±‚ï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½ã€‚</p></li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li><p><strong>æ— æ³•å¤„ç†çªå‘æµé‡</strong>ï¼šç”±äºæ¼æ¡¶çš„å‡ºå£é€Ÿåº¦æ˜¯å›ºå®šçš„ï¼Œæ— æ³•å¤„ç†çªå‘æµé‡ã€‚ä¾‹å¦‚ï¼Œå³ä½¿åœ¨æµé‡è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿæ— æ³•ä»¥æ›´å¿«çš„é€Ÿåº¦å¤„ç†è¯·æ±‚ã€‚</p></li><li><p><strong>å¯èƒ½ä¼šä¸¢å¤±æ•°æ®</strong>ï¼šå¦‚æœå…¥å£æµé‡è¿‡å¤§ï¼Œè¶…è¿‡äº†æ¡¶çš„å®¹é‡ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸¢å¼ƒéƒ¨åˆ†è¯·æ±‚ã€‚åœ¨ä¸€äº›ä¸èƒ½æ¥å—ä¸¢å¤±è¯·æ±‚çš„åœºæ™¯ä¸­ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p></li><li><p><strong>ä¸é€‚åˆé€Ÿç‡å˜åŒ–å¤§çš„åœºæ™¯</strong>ï¼šå¦‚æœé€Ÿç‡å˜åŒ–å¤§ï¼Œæˆ–è€…éœ€è¦åŠ¨æ€è°ƒæ•´é€Ÿç‡ï¼Œé‚£ä¹ˆæ¼æ¡¶ç®—æ³•å°±æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚</p></li><li><p><strong>èµ„æºåˆ©ç”¨ç‡</strong>ï¼šä¸ç®¡å½“å‰ç³»ç»Ÿçš„è´Ÿè½½å‹åŠ›å¦‚ä½•ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¾—è¿›è¡Œæ’é˜Ÿï¼Œå³ä½¿æ­¤æ—¶æœåŠ¡å™¨çš„è´Ÿè½½å¤„äºç›¸å¯¹ç©ºé—²çš„çŠ¶æ€ï¼Œè¿™æ ·ä¼šé€ æˆç³»ç»Ÿèµ„æºçš„æµªè´¹ã€‚</p></li></ol><p>ç”±äºæ¼æ¡¶çš„ç¼ºé™·æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä½¿ç”¨çš„æ¯”è¾ƒå°‘ã€‚</p><h3 id="3-4-ä»¤ç‰Œæ¡¶ç®—æ³•">3.4 ä»¤ç‰Œæ¡¶ç®—æ³•</h3><h4 id="å®ç°åŸç†-2">å®ç°åŸç†</h4><ul><li>æœ‰ä¸€ä¸ªä»¤ç‰Œç®¡ç†å‘˜ï¼Œæ ¹æ®é™æµå¤§å°ï¼Œå®šé€Ÿå¾€ä»¤ç‰Œæ¡¶é‡Œæ”¾ä»¤ç‰Œã€‚</li><li>å¦‚æœä»¤ç‰Œæ•°é‡æ»¡äº†ï¼Œè¶…è¿‡ä»¤ç‰Œæ¡¶å®¹é‡çš„é™åˆ¶ï¼Œé‚£å°±ä¸¢å¼ƒã€‚</li><li>ç³»ç»Ÿåœ¨æ¥å—åˆ°ä¸€ä¸ªç”¨æˆ·è¯·æ±‚æ—¶ï¼Œéƒ½ä¼šå…ˆå»ä»¤ç‰Œæ¡¶è¦ä¸€ä¸ªä»¤ç‰Œã€‚å¦‚æœæ‹¿åˆ°ä»¤ç‰Œï¼Œé‚£ä¹ˆå°±å¤„ç†è¿™ä¸ªè¯·æ±‚çš„ä¸šåŠ¡é€»è¾‘ï¼›</li><li>å¦‚æœæ‹¿ä¸åˆ°ä»¤ç‰Œï¼Œå°±ç›´æ¥æ‹’ç»è¿™ä¸ªè¯·æ±‚ã€‚</li></ul><p><a href="https://imgse.com/i/pkhFUde"><img src="https://s21.ax1x.com/2024/07/10/pkhFUde.webp" alt="pkhFUde.webp"></a></p><h4 id="ä»£ç å®ç°-4">ä»£ç å®ç°</h4><p>Guavaä¸­çš„RateLimiterå°±æ˜¯åŸºäºä»¤ç‰Œæ¡¶å®ç°çš„ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚</p><p>ç®€å•çš„å›ºå®šäº§ç”Ÿä»¤ç‰Œå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">acquireTest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//æ¯ç§’å›ºå®šç”Ÿæˆ5ä¸ªä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">RateLimiter</span> <span class="variable">rateLimiter</span> <span class="operator">=</span> RateLimiter.create(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">time</span> <span class="operator">=</span> rateLimiter.acquire();</span><br><span class="line">            logger.info(<span class="string">&quot;ç­‰å¾…æ—¶é—´ï¼š&#123;&#125;s&quot;</span>, time);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¼˜ç¼ºç‚¹-4">ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ol><li><p><strong>å¯ä»¥å¤„ç†çªå‘æµé‡</strong>ï¼šä»¤ç‰Œæ¡¶ç®—æ³•å¯ä»¥å¤„ç†çªå‘æµé‡ã€‚å½“æ¡¶æ»¡æ—¶ï¼Œèƒ½å¤Ÿä»¥æœ€å¤§é€Ÿåº¦å¤„ç†è¯·æ±‚ã€‚è¿™å¯¹äºéœ€è¦å¤„ç†çªå‘æµé‡çš„åº”ç”¨åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</p></li><li><p><strong>é™åˆ¶å¹³å‡é€Ÿç‡</strong>ï¼šåœ¨é•¿æœŸè¿è¡Œä¸­ï¼Œæ•°æ®çš„ä¼ è¾“ç‡ä¼šè¢«é™åˆ¶åœ¨é¢„å®šä¹‰çš„å¹³å‡é€Ÿç‡ï¼ˆå³ç”Ÿæˆä»¤ç‰Œçš„é€Ÿç‡ï¼‰ã€‚</p></li><li><p><strong>çµæ´»æ€§</strong>ï¼šä¸æ¼æ¡¶ç®—æ³•ç›¸æ¯”ï¼Œä»¤ç‰Œæ¡¶ç®—æ³•æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åŠ¨æ€åœ°è°ƒæ•´ç”Ÿæˆä»¤ç‰Œçš„é€Ÿç‡ã€‚</p></li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li><p><strong>å¯èƒ½å¯¼è‡´è¿‡è½½</strong>ï¼šå¦‚æœä»¤ç‰Œäº§ç”Ÿçš„é€Ÿåº¦è¿‡å¿«ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„çªå‘æµé‡ï¼Œè¿™å¯èƒ½ä¼šä½¿ç½‘ç»œæˆ–æœåŠ¡è¿‡è½½ã€‚</p></li><li><p><strong>éœ€è¦å­˜å‚¨ç©ºé—´</strong>ï¼šä»¤ç‰Œæ¡¶éœ€è¦ä¸€å®šçš„å­˜å‚¨ç©ºé—´æ¥ä¿å­˜ä»¤ç‰Œï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜èµ„æºçš„æµªè´¹ã€‚</p></li><li><p><strong>å®ç°ç¨å¤æ‚</strong>ï¼šç›¸æ¯”äºè®¡æ•°å™¨ç®—æ³•ï¼Œä»¤ç‰Œæ¡¶ç®—æ³•çš„å®ç°ç¨å¾®å¤æ‚ä¸€äº›ã€‚</p></li></ol><h2 id="é™æµå¸¸è§çš„å››ç§å®ç°æ–¹æ¡ˆ">é™æµå¸¸è§çš„å››ç§å®ç°æ–¹æ¡ˆ</h2><h3 id="1-åŸºäº-guava-é™æµå®ç°ï¼ˆå•æœºç‰ˆï¼‰">1. åŸºäº guava é™æµå®ç°ï¼ˆå•æœºç‰ˆï¼‰</h3><p>guava ä¸ºè°·æ­Œå¼€æºçš„ä¸€ä¸ªæ¯”è¾ƒå®ç”¨çš„ç»„ä»¶ï¼Œåˆ©ç”¨è¿™ä¸ªç»„ä»¶å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å®Œæˆå¸¸è§„çš„é™æµæ“ä½œï¼Œæ¥ä¸‹æ¥çœ‹å…·ä½“çš„å®ç°æ­¥éª¤</p><h4 id="1ã€å¼•å…¥ä¾èµ–ï¼š">1ã€å¼•å…¥ä¾èµ–ï¼š</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>30.1-jre<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">12345</span><br></pre></td></tr></table></figure><h4 id="2ã€è‡ªå®šä¹‰é™æµæ³¨è§£">2ã€è‡ªå®šä¹‰é™æµæ³¨è§£</h4><p>è‡ªå®šä¹‰ä¸€ä¸ªé™æµç”¨çš„æ³¨è§£ï¼Œåé¢åœ¨éœ€è¦é™æµçš„æ–¹æ³•æˆ–æ¥å£ä¸Šé¢åªéœ€æ·»åŠ è¯¥æ³¨è§£å³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(value = ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> GuavaLimitRateAnnotation &#123;</span><br><span class="line">    <span class="comment">// é™åˆ¶ç±»å‹</span></span><br><span class="line">    String <span class="title function_">limitType</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ¯ç§’ 5 ä¸ªè¯·æ±‚</span></span><br><span class="line">    <span class="type">double</span> <span class="title function_">limitCount</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">5d</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ã€é™æµ-AOP-ç±»">3ã€é™æµ AOP ç±»</h4><p>é€šè¿‡AOPå‰ç½®é€šçŸ¥çš„æ–¹å¼æ‹¦æˆªæ·»åŠ äº†ä¸Šè¿°è‡ªå®šä¹‰é™æµæ³¨è§£çš„æ–¹æ³•ï¼Œè§£ææ³¨è§£ä¸­çš„å±æ€§å€¼ï¼Œå¹¶ä»¥è¯¥å±æ€§å€¼ä½œä¸º guava æä¾›çš„é™æµå‚æ•°ï¼Œè¯¥ç±»ä¸ºæ•´ä¸ªå®ç°çš„æ ¸å¿ƒæ‰€åœ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GuavaLimitRateAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(GuavaLimitRateAspect.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(@GuavaLimitRateAnnotation * *(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">limit</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å½“å‰æ–¹æ³•</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">currentMethod</span> <span class="operator">=</span> getCurrentMethod(joinPoint);</span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(currentMethod)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.ä»æ–¹æ³•æ³¨è§£å®šä¹‰ä¸Šè·å–é™æµçš„ç±»å‹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">limitType</span> <span class="operator">=</span> currentMethod.getAnnotation(GuavaLimitRateAnnotation.class).limitType();</span><br><span class="line">        <span class="type">double</span> <span class="variable">limitCount</span> <span class="operator">=</span> currentMethod.getAnnotation(GuavaLimitRateAnnotation.class).limitCount();</span><br><span class="line">        <span class="comment">// 3.ä½¿ç”¨guavaçš„ä»¤ç‰Œæ¡¶ç®—æ³•è·å–ä¸€ä¸ªä»¤ç‰Œï¼Œè·å–ä¸åˆ°å…ˆç­‰å¾…</span></span><br><span class="line">        <span class="type">RateLimiter</span> <span class="variable">rateLimiter</span> <span class="operator">=</span> RateLimitHelper.getRateLimiter(limitType, limitCount);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> rateLimiter.tryAcquire();</span><br><span class="line">        <span class="keyword">if</span> (b) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è·å–åˆ°ä»¤ç‰Œ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">HttpServletResponse</span> <span class="variable">resp</span> <span class="operator">=</span> ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getResponse();</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">            jsonObject.put(<span class="string">&quot;success&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">            jsonObject.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;é™æµä¸­&quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                output(resp, jsonObject.toJSONString());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.error(<span class="string">&quot;error,e:&#123;&#125;&quot;</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">output</span><span class="params">(HttpServletResponse response, String msg)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            outputStream = response.getOutputStream();</span><br><span class="line">            outputStream.write(msg.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">assert</span> outputStream != <span class="literal">null</span>;</span><br><span class="line">            outputStream.flush();</span><br><span class="line">            outputStream.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Method <span class="title function_">getCurrentMethod</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        Method[] methods = joinPoint.getTarget().getClass().getMethods();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">target</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="keyword">if</span> (method.getName().equals(joinPoint.getSignature().getName())) &#123;</span><br><span class="line">                target = method;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­é™æµçš„æ ¸å¿ƒ API å³ä¸º <code>RateLimiter</code> è¿™ä¸ªå¯¹è±¡ï¼Œæ¶‰åŠåˆ°çš„ <code>RateLimitHelper</code> ç±»å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RateLimitHelper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">RateLimitHelper</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, RateLimiter&gt; rateMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RateLimiter <span class="title function_">getRateLimiter</span><span class="params">(String limitType, <span class="type">double</span> limitCount )</span>&#123;</span><br><span class="line">        <span class="type">RateLimiter</span> <span class="variable">rateLimiter</span> <span class="operator">=</span> rateMap.get(limitType);</span><br><span class="line">        <span class="keyword">if</span>(rateLimiter == <span class="literal">null</span>)&#123;</span><br><span class="line">            rateLimiter = RateLimiter.create(limitCount);</span><br><span class="line">            rateMap.put(limitType,rateLimiter);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rateLimiter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4ã€æµ‹è¯•">4ã€æµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/limit&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LimitController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/limitByGuava&quot;)</span></span><br><span class="line">    <span class="meta">@GuavaLimitRateAnnotation(limitType = &quot;æµ‹è¯•é™æµ&quot;, limitCount = 1)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">limitByGuava</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;limitByGuava&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1234567891011</span></span><br></pre></td></tr></table></figure><p>åœ¨æ¥å£ä¸­ä¸ºäº†æ¨¡æ‹Ÿå‡ºæ•ˆæœï¼Œæˆ‘ä»¬å°†å‚æ•°è®¾ç½®çš„éå¸¸å°ï¼Œå³QPSä¸º1ï¼Œå¯ä»¥é¢„æƒ³å½“æ¯ç§’è¯·æ±‚è¶…è¿‡1æ—¶å°†ä¼šå‡ºç°è¢«é™æµçš„æç¤ºï¼Œå¯åŠ¨å·¥ç¨‹å¹¶éªŒè¯æ¥å£ï¼Œæ¯ç§’1æ¬¡çš„è¯·æ±‚ï¼Œå¯ä»¥æ­£å¸¸å¾—åˆ°ç»“æœï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><a href="https://imgse.com/i/pkhFbeU"><img src="https://s21.ax1x.com/2024/07/10/pkhFbeU.png" alt="pkhFbeU.png"></a></p><hr><h3 id="2-åŸºäº-sentinel-é™æµå®ç°ï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰">2. åŸºäº sentinel é™æµå®ç°ï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰</h3><p>sentinel é€šå¸¸æ˜¯éœ€è¦<strong>ç»“åˆ springcloud-alibaba</strong> æ¡†æ¶ä¸€èµ·å®ç”¨çš„ï¼Œè€Œä¸”ä¸æ¡†æ¶é›†æˆä¹‹åï¼Œå¯ä»¥é…åˆæ§åˆ¶å°ä¸€èµ·ä½¿ç”¨è¾¾åˆ°æ›´å¥½çš„æ•ˆæœï¼Œå®é™…ä¸Šï¼Œsentinel å®˜æ–¹ä¹Ÿæä¾›äº†ç›¸å¯¹åŸç”Ÿçš„ SDK å¯ä¾›ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥å°±ä»¥è¿™ç§æ–¹å¼è¿›è¡Œæ•´åˆã€‚</p><h4 id="1ã€å¼•å…¥ä¾èµ–">1ã€å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.csp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sentinel-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2ã€è‡ªå®šä¹‰é™æµæ³¨è§£-2">2ã€è‡ªå®šä¹‰é™æµæ³¨è§£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(value = ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SentinelLimitRateAnnotation &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™åˆ¶ç±»å‹</span></span><br><span class="line">    String <span class="title function_">resourceName</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ¯ç§’ 5 ä¸ª</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">limitCount</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">5</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ã€è‡ªå®šä¹‰AOPç±»å®ç°é™æµ">3ã€è‡ªå®šä¹‰AOPç±»å®ç°é™æµ</h4><p>è¯¥ç±»çš„å®ç°æ€è·¯ä¸ä¸Šè¿°ä½¿ç”¨guavaç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯sentinelåŸç”Ÿçš„é™æµç›¸å…³çš„APIï¼Œå¯¹æ­¤ä¸å¤Ÿå±æ€§çš„å¯ä»¥æŸ¥é˜…å®˜æ–¹çš„æ–‡æ¡£è¿›è¡Œå­¦ä¹ ï¼Œè¿™é‡Œå°±ä¸å±•å¼€æ¥è¯´äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SentinelLimitRateAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(value = &quot;@annotation(com.hcr.sbes.limit.sentinel.SentinelLimitRateAnnotation)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rateLimit</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;rateLimit()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å½“å‰æ–¹æ³•</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">currentMethod</span> <span class="operator">=</span> getCurrentMethod(joinPoint);</span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(currentMethod)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.ä»æ–¹æ³•æ³¨è§£å®šä¹‰ä¸Šè·å–é™æµçš„ç±»å‹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">resourceName</span> <span class="operator">=</span> currentMethod.getAnnotation(SentinelLimitRateAnnotation.class).resourceName();</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(resourceName))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;èµ„æºåç§°ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">limitCount</span> <span class="operator">=</span> currentMethod.getAnnotation(SentinelLimitRateAnnotation.class).limitCount();</span><br><span class="line">        <span class="comment">// 3.åˆå§‹åŒ–è§„åˆ™</span></span><br><span class="line">        initFlowRule(resourceName,limitCount);</span><br><span class="line">        <span class="type">Entry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            entry = SphU.entry(resourceName);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                result = joinPoint.proceed();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">                throwable.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (BlockException ex) &#123;</span><br><span class="line">            <span class="comment">// èµ„æºè®¿é—®é˜»æ­¢ï¼Œè¢«é™æµæˆ–è¢«é™çº§ï¼Œåœ¨æ­¤å¤„è¿›è¡Œç›¸åº”çš„å¤„ç†æ“ä½œ</span></span><br><span class="line">            System.out.println(<span class="string">&quot;blocked&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;è¢«é™æµäº†&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            Tracer.traceEntry(e, entry);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (entry != <span class="literal">null</span>) &#123;</span><br><span class="line">                entry.exit();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">initFlowRule</span><span class="params">(String resourceName,<span class="type">int</span> limitCount)</span> &#123;</span><br><span class="line">        List&lt;FlowRule&gt; rules = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">FlowRule</span> <span class="variable">rule</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FlowRule</span>();</span><br><span class="line">        <span class="comment">//è®¾ç½®å—ä¿æŠ¤çš„èµ„æº</span></span><br><span class="line">        rule.setResource(resourceName);</span><br><span class="line">        <span class="comment">//è®¾ç½®æµæ§è§„åˆ™ QPS</span></span><br><span class="line">        rule.setGrade(RuleConstant.FLOW_GRADE_QPS);</span><br><span class="line">        <span class="comment">//è®¾ç½®å—ä¿æŠ¤çš„èµ„æºé˜ˆå€¼</span></span><br><span class="line">        rule.setCount(limitCount);</span><br><span class="line">        rules.add(rule);</span><br><span class="line">        <span class="comment">//åŠ è½½é…ç½®å¥½çš„è§„åˆ™</span></span><br><span class="line">        FlowRuleManager.loadRules(rules);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Method <span class="title function_">getCurrentMethod</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        Method[] methods = joinPoint.getTarget().getClass().getMethods();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">target</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="keyword">if</span> (method.getName().equals(joinPoint.getSignature().getName())) &#123;</span><br><span class="line">                target = method;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4ã€æµ‹è¯•æ¥å£">4ã€æµ‹è¯•æ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/limitBySentinel&quot;)</span></span><br><span class="line"><span class="meta">@SentinelLimitRateAnnotation(resourceName = &quot;æµ‹è¯•é™æµ2&quot;, limitCount = 1)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">limitBySentinel</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;limitBySentinel&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åŸºäºredissoné™æµå®ç°ï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰">3. åŸºäºredissoné™æµå®ç°ï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰</h3><h4 id="1-å¼•å…¥redissonä¾èµ–">1. å¼•å…¥redissonä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.redisson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.32.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>  </span><br></pre></td></tr></table></figure><h4 id="2-ç¼–å†™é…ç½®">2. ç¼–å†™é…ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.springbootinit.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.redisson.Redisson;</span><br><span class="line"><span class="keyword">import</span> org.redisson.api.RedissonClient;</span><br><span class="line"><span class="keyword">import</span> org.redisson.config.Config;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// ä»application.ymlæ–‡ä»¶ä¸­è¯»å–å‰ç¼€ä¸º&quot;spring.redis&quot;çš„é…ç½®é¡¹</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;spring.redis&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedissonConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer database;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer port;</span><br><span class="line">    <span class="comment">// å¦‚æœredisé»˜è®¤æ²¡æœ‰å¯†ç ï¼Œåˆ™ä¸ç”¨å†™</span></span><br><span class="line">    <span class="comment">//private String password;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// springå¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªRedissonClientå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedissonClient <span class="title function_">getRedissonClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºé…ç½®å¯¹è±¡</span></span><br><span class="line">        <span class="type">Config</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Config</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ å•æœºRedissoné…ç½®</span></span><br><span class="line">        config.useSingleServer()</span><br><span class="line">        <span class="comment">// è®¾ç½®æ•°æ®åº“</span></span><br><span class="line">        .setDatabase(database)</span><br><span class="line">        <span class="comment">// è®¾ç½®redisçš„åœ°å€</span></span><br><span class="line">        .setAddress(<span class="string">&quot;redis://&quot;</span> + host + <span class="string">&quot;:&quot;</span> + port);</span><br><span class="line">        <span class="comment">// è®¾ç½®redisçš„å¯†ç (redisæœ‰å¯†ç æ‰è®¾ç½®)</span></span><br><span class="line">        <span class="comment">//                .setPassword(password);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºRedissonå®ä¾‹</span></span><br><span class="line">        <span class="type">RedissonClient</span> <span class="variable">redisson</span> <span class="operator">=</span> Redisson.create(config);</span><br><span class="line">        <span class="keyword">return</span> redisson;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-ç¼–å†™RedisLimiterManager">3. ç¼–å†™RedisLimiterManager</h4><p>ç¼–å†™ RedisLimiterManagerï¼šä»€ä¹ˆæ˜¯ Managerï¼Ÿä¸“é—¨æä¾› RedisLimiter é™æµåŸºç¡€æœåŠ¡çš„(æä¾›äº†é€šç”¨çš„èƒ½åŠ›ï¼Œå¯ä»¥æ”¾åˆ°ä»»ä½•ä¸€ä¸ªé¡¹ç›®é‡Œ)ã€‚</p><h4 id="4-æµ‹è¯•">4. æµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.springbootinit.manager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RedisLimiterManagerTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisLimiterManager redisLimiterManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doRateLimit</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿä¸€ä¸‹æ“ä½œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="comment">// ç¬é—´æ‰§è¡Œ2æ¬¡,æ¯æˆåŠŸä¸€æ¬¡,å°±æ‰“å°&#x27;æˆåŠŸ&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">            redisLimiterManager.doRateLimit(userId);</span><br><span class="line">            System.out.println(<span class="string">&quot;æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç¡1ç§’</span></span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="comment">// ç¬é—´æ‰§è¡Œ5æ¬¡,æ¯æˆåŠŸä¸€æ¬¡,å°±æ‰“å°&#x27;æˆåŠŸ&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            redisLimiterManager.doRateLimit(userId);</span><br><span class="line">            System.out.println(<span class="string">&quot;æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="4-åŸºäºç½‘å…³-gateway-é™æµï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰">4. åŸºäºç½‘å…³ gateway é™æµï¼ˆåˆ†å¸ƒå¼ç‰ˆï¼‰</h3><p>å®ç°ç®—æ³•å‚ç…§ä¸Šé¢çš„ä»¤ç‰Œæ¡¶å®ç°,gatewayé‡Œé¢çš„æ‹¦æˆªå™¨ç¼–å†™é™æµé€»è¾‘å°±å¯ä»¥äº†ï¼</p><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å¸¸è§çš„4ç§é™æµç®—æ³•,ä»¥åŠå¸¸è§çš„é™æµå®ç°æ–¹å¼,åŒ…æ‹¬ä»¤ç‰Œæ¡¶ç®—æ³•,æ¼æ¡¶ç®—æ³•,æ»‘åŠ¨çª—å£ç®—æ³•,è®¡æ•°å™¨ç®—æ³•ç­‰</summary>
    
    
    
    <category term="java" scheme="https://liweierzzz.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="é™æµç®—æ³•" scheme="https://liweierzzz.github.io/tags/%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/"/>
    
    <category term="é™æµå®ç°" scheme="https://liweierzzz.github.io/tags/%E9%99%90%E6%B5%81%E5%AE%9E%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>javaçŸ¥è¯†ä½“ç³»(ä¸‰)</title>
    <link href="https://liweierzzz.github.io/posts/d7ff03d7.html"/>
    <id>https://liweierzzz.github.io/posts/d7ff03d7.html</id>
    <published>2024-07-10T01:39:03.000Z</published>
    <updated>2024-07-11T12:49:52.841Z</updated>
    
    <content type="html"><![CDATA[<h1>Java å…¨æ ˆçŸ¥è¯†ç‚¹é—®é¢˜æ±‡æ€»ï¼ˆä¸‰ï¼‰</h1><a class="button" href='https://pdai.tech/' title='Java å…¨æ ˆçŸ¥è¯†ä½“ç³»'><img src=''>Java å…¨æ ˆçŸ¥è¯†ä½“ç³»</a><p>æœ¬æ–‡å‚è€ƒé“¾æ¥: <a href="https://pdai.tech/">| Java å…¨æ ˆçŸ¥è¯†ä½“ç³» (pdai.tech)</a>å¤§å®¶çœ‹è¿™ä¸ªç½‘ç«™å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šjavaç›¸å…³çš„çŸ¥è¯†å“¦!!!</p><h2 id="Javaå¹¶å‘">Javaå¹¶å‘</h2><h3 id="1-å¹¶å‘åŸºç¡€">1. å¹¶å‘åŸºç¡€</h3><p>æƒ³çŸ¥é“æ›´è¯¦ç»†è¯·äº†è§£ï¼š</p><div class="tag link"><a class="link-card" title="Java å¹¶å‘- ç†è®ºåŸºç¡€" href="https://pdai.tech/md/java/thread/java-thread-x-theorty.html"><div class="left"><img src="https://bu.dusays.com/2024/07/08/668bea85aa4cb.jpg"/></div><div class="right"><p class="text">Java å¹¶å‘- ç†è®ºåŸºç¡€</p><p class="url">https://pdai.tech/md/java/thread/java-thread-x-theorty.html</p></div></a></div><div class="tag link"><a class="link-card" title="Java å¹¶å‘- çº¿ç¨‹åŸºç¡€" href="https://pdai.tech/md/java/thread/java-thread-x-thread-basic.html"><div class="left"><img src="https://bu.dusays.com/2024/07/07/668a4bc15dc58.jpg"/></div><div class="right"><p class="text">Java å¹¶å‘- çº¿ç¨‹åŸºç¡€</p><p class="url">https://pdai.tech/md/java/thread/java-thread-x-thread-basic.html</p></div></a></div><h4 id="1-1-å¤šçº¿ç¨‹çš„å‡ºç°æ˜¯è¦è§£å†³ä»€ä¹ˆé—®é¢˜çš„-æœ¬è´¨ä»€ä¹ˆ">1.1 å¤šçº¿ç¨‹çš„å‡ºç°æ˜¯è¦è§£å†³ä»€ä¹ˆé—®é¢˜çš„? æœ¬è´¨ä»€ä¹ˆ?</h4><p>CPUã€å†…å­˜ã€I/O è®¾å¤‡çš„é€Ÿåº¦æ˜¯æœ‰æå¤§å·®å¼‚çš„ï¼Œä¸ºäº†åˆç†åˆ©ç”¨ CPU çš„é«˜æ€§èƒ½ï¼Œå¹³è¡¡è¿™ä¸‰è€…çš„é€Ÿåº¦å·®å¼‚ï¼Œè®¡ç®—æœºä½“ç³»ç»“æ„ã€æ“ä½œç³»ç»Ÿã€ç¼–è¯‘ç¨‹åºéƒ½åšå‡ºäº†è´¡çŒ®ï¼Œä¸»è¦ä½“ç°ä¸º:</p><ul><li>CPU å¢åŠ äº†ç¼“å­˜ï¼Œä»¥å‡è¡¡ä¸å†…å­˜çš„é€Ÿåº¦å·®å¼‚ï¼›// å¯¼è‡´å¯è§æ€§é—®é¢˜</li><li>æ“ä½œç³»ç»Ÿå¢åŠ äº†è¿›ç¨‹ã€çº¿ç¨‹ï¼Œä»¥åˆ†æ—¶å¤ç”¨ CPUï¼Œè¿›è€Œå‡è¡¡ CPU ä¸ I/O è®¾å¤‡çš„é€Ÿåº¦å·®å¼‚ï¼›// å¯¼è‡´åŸå­æ€§é—®é¢˜</li><li>ç¼–è¯‘ç¨‹åºä¼˜åŒ–æŒ‡ä»¤æ‰§è¡Œæ¬¡åºï¼Œä½¿å¾—ç¼“å­˜èƒ½å¤Ÿå¾—åˆ°æ›´åŠ åˆç†åœ°åˆ©ç”¨ã€‚// å¯¼è‡´æœ‰åºæ€§é—®é¢˜</li></ul><hr><h4 id="1-2-Javaæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„">1.2 Javaæ˜¯æ€ä¹ˆè§£å†³å¹¶å‘é—®é¢˜çš„?</h4><p>Java å†…å­˜æ¨¡å‹æ˜¯ä¸ªå¾ˆå¤æ‚çš„è§„èŒƒï¼Œå…·ä½“çœ‹<a href="https://pdai.tech/md/java/jvm/java-jvm-jmm.html">Java å†…å­˜æ¨¡å‹è¯¦è§£</a>ã€‚</p><p><strong>ç†è§£çš„ç¬¬ä¸€ä¸ªç»´åº¦ï¼šæ ¸å¿ƒçŸ¥è¯†ç‚¹</strong></p><p>JMMæœ¬è´¨ä¸Šå¯ä»¥ç†è§£ä¸ºï¼ŒJava å†…å­˜æ¨¡å‹è§„èŒƒäº† JVM å¦‚ä½•æä¾›æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–çš„æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™äº›æ–¹æ³•åŒ…æ‹¬ï¼š</p><ul><li>volatileã€synchronized å’Œ final ä¸‰ä¸ªå…³é”®å­—</li><li>Happens-Before è§„åˆ™</li></ul><p><strong>ç†è§£çš„ç¬¬äºŒä¸ªç»´åº¦ï¼šå¯è§æ€§ï¼Œæœ‰åºæ€§ï¼ŒåŸå­æ€§</strong></p><ul><li><strong>åŸå­æ€§</strong></li></ul><p>åœ¨Javaä¸­ï¼Œå¯¹åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡çš„<strong>è¯»å–å’Œèµ‹å€¼æ“ä½œ</strong>æ˜¯åŸå­æ€§æ“ä½œï¼Œå³è¿™äº›æ“ä½œæ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼Œè¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚ è¯·åˆ†æä»¥ä¸‹å“ªäº›æ“ä½œæ˜¯åŸå­æ€§æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">10</span>;        <span class="comment">//è¯­å¥1: ç›´æ¥å°†æ•°å€¼10èµ‹å€¼ç»™xï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹æ‰§è¡Œè¿™ä¸ªè¯­å¥çš„ä¼šç›´æ¥å°†æ•°å€¼10å†™å…¥åˆ°å·¥ä½œå†…å­˜ä¸­</span></span><br><span class="line">y = x;         <span class="comment">//è¯­å¥2: åŒ…å«2ä¸ªæ“ä½œï¼Œå®ƒå…ˆè¦å»è¯»å–xçš„å€¼ï¼Œå†å°†xçš„å€¼å†™å…¥å·¥ä½œå†…å­˜ï¼Œè™½ç„¶è¯»å–xçš„å€¼ä»¥åŠ å°†xçš„å€¼å†™å…¥å·¥ä½œå†…å­˜ è¿™2ä¸ªæ“ä½œéƒ½æ˜¯åŸå­æ€§æ“ä½œï¼Œä½†æ˜¯åˆèµ·æ¥å°±ä¸æ˜¯åŸå­æ€§æ“ä½œäº†ã€‚</span></span><br><span class="line">x++;           <span class="comment">//è¯­å¥3ï¼š x++åŒ…æ‹¬3ä¸ªæ“ä½œï¼šè¯»å–xçš„å€¼ï¼Œè¿›è¡ŒåŠ 1æ“ä½œï¼Œå†™å…¥æ–°çš„å€¼ã€‚</span></span><br><span class="line">x = x + <span class="number">1</span>;     <span class="comment">//è¯­å¥4ï¼š åŒè¯­å¥3</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢4ä¸ªè¯­å¥åªæœ‰è¯­å¥1çš„æ“ä½œå…·å¤‡åŸå­æ€§ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ç®€å•çš„è¯»å–ã€èµ‹å€¼ï¼ˆè€Œä¸”å¿…é¡»æ˜¯å°†æ•°å­—èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œå˜é‡ä¹‹é—´çš„ç›¸äº’èµ‹å€¼ä¸æ˜¯åŸå­æ“ä½œï¼‰æ‰æ˜¯åŸå­æ“ä½œã€‚</p><blockquote><p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒJavaå†…å­˜æ¨¡å‹åªä¿è¯äº†<strong>åŸºæœ¬è¯»å–å’Œèµ‹å€¼æ˜¯åŸå­æ€§æ“ä½œ</strong>ï¼Œå¦‚æœè¦å®ç°æ›´å¤§èŒƒå›´æ“ä½œçš„åŸå­æ€§ï¼Œå¯ä»¥é€šè¿‡synchronizedå’ŒLockæ¥å®ç°ã€‚ç”±äº<strong>synchronizedå’ŒLockèƒ½å¤Ÿä¿è¯ä»»ä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹</strong>æ‰§è¡Œè¯¥ä»£ç å—ï¼Œé‚£ä¹ˆè‡ªç„¶å°±ä¸å­˜åœ¨åŸå­æ€§é—®é¢˜äº†ï¼Œä»è€Œä¿è¯äº†åŸå­æ€§ã€‚</p></blockquote><ul><li><strong>å¯è§æ€§</strong></li></ul><p>Javaæä¾›äº†volatileå…³é”®å­—æ¥ä¿è¯å¯è§æ€§ã€‚</p><p>å½“ä¸€ä¸ªå…±äº«å˜é‡è¢«volatileä¿®é¥°æ—¶ï¼Œå®ƒä¼šä¿è¯ä¿®æ”¹çš„å€¼ä¼šç«‹å³è¢«æ›´æ–°åˆ°ä¸»å­˜ï¼Œå½“æœ‰å…¶ä»–çº¿ç¨‹éœ€è¦è¯»å–æ—¶ï¼Œå®ƒä¼šå»å†…å­˜ä¸­è¯»å–æ–°å€¼ã€‚</p><p>è€Œ<strong>æ™®é€šçš„å…±äº«å˜é‡ä¸èƒ½ä¿è¯å¯è§æ€§</strong>ï¼Œå› ä¸ºæ™®é€šå…±äº«å˜é‡è¢«ä¿®æ”¹ä¹‹åï¼Œä»€ä¹ˆæ—¶å€™è¢«å†™å…¥ä¸»å­˜æ˜¯ä¸ç¡®å®šçš„ï¼Œå½“å…¶ä»–çº¿ç¨‹å»è¯»å–æ—¶ï¼Œæ­¤æ—¶å†…å­˜ä¸­å¯èƒ½è¿˜æ˜¯åŸæ¥çš„æ—§å€¼ï¼Œå› æ­¤æ— æ³•ä¿è¯å¯è§æ€§ã€‚</p><blockquote><p>å¦å¤–ï¼Œé€šè¿‡synchronizedå’ŒLockä¹Ÿèƒ½å¤Ÿä¿è¯å¯è§æ€§ï¼Œsynchronizedå’ŒLockèƒ½ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å–é”ç„¶åæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå¹¶ä¸”åœ¨é‡Šæ”¾é”ä¹‹å‰ä¼šå°†å¯¹å˜é‡çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å­˜å½“ä¸­ã€‚å› æ­¤å¯ä»¥ä¿è¯å¯è§æ€§ã€‚</p></blockquote><ul><li><strong>æœ‰åºæ€§</strong></li></ul><p>åœ¨Javaé‡Œé¢ï¼Œå¯ä»¥é€šè¿‡<strong>volatileå…³é”®å­—æ¥ä¿è¯ä¸€å®šçš„â€œæœ‰åºæ€§â€</strong>ã€‚å¦å¤–å¯ä»¥é€šè¿‡<strong>synchronizedå’ŒLockæ¥ä¿è¯æœ‰åºæ€§</strong>ï¼Œå¾ˆæ˜¾ç„¶ï¼Œsynchronizedå’ŒLockä¿è¯æ¯ä¸ªæ—¶åˆ»æ˜¯æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œç›¸å½“äºæ˜¯è®©çº¿ç¨‹é¡ºåºæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè‡ªç„¶å°±ä¿è¯äº†æœ‰åºæ€§ã€‚å½“ç„¶<strong>JMMæ˜¯é€šè¿‡Happens-Before</strong> è§„åˆ™æ¥ä¿è¯æœ‰åºæ€§çš„ã€‚</p><hr><h4 id="1-3-çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯">1.3 çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯?</h4><ol><li><strong>äº’æ–¥åŒæ­¥</strong></li></ol><p>synchronized å’Œ ReentrantLockã€‚</p><ol start="2"><li><strong>éé˜»å¡åŒæ­¥</strong></li></ol><p>äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯<strong>çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜</strong>ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚</p><p>äº’æ–¥åŒæ­¥å±äºä¸€ç§<strong>æ‚²è§‚çš„å¹¶å‘ç­–ç•¥</strong>ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”(è¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”)ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚</p><ul><li>CAS</li></ul><p>éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„<strong>ä¹è§‚å¹¶å‘ç­–ç•¥:</strong> <strong>å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½</strong>(ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢)ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½<strong>ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡</strong>ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚</p><hr><p>ä¹è§‚é”éœ€è¦<strong>æ“ä½œå’Œå†²çªæ£€æµ‹</strong>è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡<strong>åŸå­æ€§</strong>ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œ<strong>åªèƒ½é ç¡¬ä»¶æ¥å®Œæˆ</strong>ã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯: **æ¯”è¾ƒå¹¶äº¤æ¢(**Compare-and-Swapï¼ŒCAS)ã€‚CAS æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚</p><hr><ul><li>AtomicInteger</li></ul><p>J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» AtomicIntegerï¼Œå…¶ä¸­çš„ compareAndSet() å’Œ getAndIncrement() ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œã€‚</p><ol start="3"><li><strong>æ— åŒæ­¥æ–¹æ¡ˆ</strong></li></ol><p>è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚</p><ul><li>æ ˆå°é—­</li></ul><p>å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œ<strong>ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨</strong>é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äº<strong>çº¿ç¨‹ç§æœ‰</strong>çš„ã€‚</p><ul><li>çº¿ç¨‹æœ¬åœ°å­˜å‚¨(Thread Local Storage)</li></ul><p>å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›<strong>å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ</strong>ã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚</p><hr><h4 id="1-4-å¦‚ä½•ç†è§£å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«">1.4 å¦‚ä½•ç†è§£å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«?</h4><p>å¹¶å‘æ˜¯æŒ‡ä¸€ä¸ªå¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚</p><p><a href="https://imgse.com/i/pkf4eYR"><img src="https://s21.ax1x.com/2024/07/10/pkf4eYR.jpg" alt="pkf4eYR.jpg"></a></p><p>å¹¶è¡Œæ˜¯æŒ‡å¤šä¸ªå¤„ç†å™¨æˆ–è€…æ˜¯å¤šæ ¸çš„å¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä¸åŒçš„ä»»åŠ¡ã€‚</p><p><a href="https://imgse.com/i/pkf4mf1"><img src="https://s21.ax1x.com/2024/07/10/pkf4mf1.jpg" alt="pkf4mf1.jpg"></a></p><hr><h4 id="1-5-çº¿ç¨‹æœ‰å“ªå‡ ç§çŠ¶æ€-åˆ†åˆ«è¯´æ˜ä»ä¸€ç§çŠ¶æ€åˆ°å¦ä¸€ç§çŠ¶æ€è½¬å˜æœ‰å“ªäº›æ–¹å¼">1.5 çº¿ç¨‹æœ‰å“ªå‡ ç§çŠ¶æ€? åˆ†åˆ«è¯´æ˜ä»ä¸€ç§çŠ¶æ€åˆ°å¦ä¸€ç§çŠ¶æ€è½¬å˜æœ‰å“ªäº›æ–¹å¼?</h4><p><a href="https://imgse.com/i/pkf4uSx"><img src="https://s21.ax1x.com/2024/07/10/pkf4uSx.png" alt="pkf4uSx.png"></a></p><ul><li>æ–°å»º(New)</li></ul><p>åˆ›å»ºåå°šæœªå¯åŠ¨ã€‚</p><ul><li>å¯è¿è¡Œ(Runnable)</li></ul><p>å¯èƒ½æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯èƒ½æ­£åœ¨ç­‰å¾… CPU æ—¶é—´ç‰‡ã€‚</p><p>åŒ…å«äº†æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€ä¸­çš„ Running å’Œ Readyã€‚</p><ul><li>é˜»å¡(Blocking)</li></ul><p>ç­‰å¾…è·å–ä¸€ä¸ªæ’å®ƒé”ï¼Œå¦‚æœå…¶çº¿ç¨‹é‡Šæ”¾äº†é”å°±ä¼šç»“æŸæ­¤çŠ¶æ€ã€‚</p><ul><li>æ— é™æœŸç­‰å¾…(Waiting)</li></ul><p>ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ï¼Œå¦åˆ™ä¸ä¼šè¢«åˆ†é… CPU æ—¶é—´ç‰‡ã€‚</p><table><thead><tr><th>è¿›å…¥æ–¹æ³•</th><th>é€€å‡ºæ–¹æ³•</th></tr></thead><tbody><tr><td>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</td><td>Object.notify() / Object.notifyAll()</td></tr><tr><td>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</td><td>è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</td></tr><tr><td>LockSupport.park() æ–¹æ³•</td><td>-</td></tr></tbody></table><ul><li>é™æœŸç­‰å¾…(Timed Waiting)</li></ul><p>æ— éœ€ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ï¼Œåœ¨ä¸€å®šæ—¶é—´ä¹‹åä¼šè¢«<strong>ç³»ç»Ÿè‡ªåŠ¨å”¤é†’</strong>ã€‚</p><p>è°ƒç”¨ Thread.sleep() æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…çŠ¶æ€æ—¶ï¼Œå¸¸å¸¸ç”¨â€œä½¿ä¸€ä¸ªçº¿ç¨‹ç¡çœ â€è¿›è¡Œæè¿°ã€‚</p><p>è°ƒç”¨ Object.wait() æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…æ—¶ï¼Œå¸¸å¸¸ç”¨â€œæŒ‚èµ·ä¸€ä¸ªçº¿ç¨‹â€è¿›è¡Œæè¿°ã€‚</p><p>ç¡çœ å’ŒæŒ‚èµ·æ˜¯ç”¨æ¥<strong>æè¿°è¡Œä¸º</strong>ï¼Œè€Œé˜»å¡å’Œç­‰å¾…ç”¨æ¥<strong>æè¿°çŠ¶æ€</strong>ã€‚</p><p>é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡<strong>æ˜¯è¢«åŠ¨çš„</strong>ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…è·å–ä¸€ä¸ªæ’å®ƒé”ã€‚è€Œ<strong>ç­‰å¾…æ˜¯ä¸»åŠ¨çš„</strong>ï¼Œé€šè¿‡è°ƒç”¨ Thread.sleep() å’Œ Object.wait() ç­‰æ–¹æ³•è¿›å…¥ã€‚</p><table><thead><tr><th>è¿›å…¥æ–¹æ³•</th><th>é€€å‡ºæ–¹æ³•</th></tr></thead><tbody><tr><td>Thread.sleep() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ</td></tr><tr><td>è®¾ç½®äº† Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ / Object.notify() / Object.notifyAll()</td></tr><tr><td>è®¾ç½®äº† Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ / è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</td></tr><tr><td>LockSupport.parkNanos() æ–¹æ³•</td><td>-</td></tr><tr><td>LockSupport.parkUntil() æ–¹æ³•</td><td>-</td></tr></tbody></table><ul><li>æ­»äº¡(Terminated)</li></ul><p>å¯ä»¥æ˜¯çº¿ç¨‹ç»“æŸä»»åŠ¡ä¹‹åè‡ªå·±ç»“æŸï¼Œæˆ–è€…äº§ç”Ÿäº†å¼‚å¸¸è€Œç»“æŸã€‚</p><hr><h4 id="1-6-é€šå¸¸çº¿ç¨‹æœ‰å“ªå‡ ç§ä½¿ç”¨æ–¹å¼">1.6 é€šå¸¸çº¿ç¨‹æœ‰å“ªå‡ ç§ä½¿ç”¨æ–¹å¼?</h4><p>æœ‰ä¸‰ç§ä½¿ç”¨çº¿ç¨‹çš„æ–¹æ³•:</p><ul><li>å®ç° Runnable æ¥å£ï¼›</li><li>å®ç° Callable æ¥å£ï¼›</li><li>ç»§æ‰¿ Thread ç±»ã€‚</li></ul><p>å®ç° Runnable å’Œ Callable æ¥å£çš„ç±»<strong>åªèƒ½å½“åšä¸€ä¸ªå¯ä»¥åœ¨çº¿ç¨‹ä¸­è¿è¡Œçš„ä»»åŠ¡</strong>ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çº¿ç¨‹ï¼Œå› æ­¤æœ€åè¿˜éœ€è¦é€šè¿‡ Thread æ¥è°ƒç”¨ã€‚å¯ä»¥è¯´ä»»åŠ¡æ˜¯é€šè¿‡çº¿ç¨‹é©±åŠ¨ä»è€Œæ‰§è¡Œçš„ã€‚</p><h4 id="1-7-åŸºç¡€çº¿ç¨‹æœºåˆ¶æœ‰å“ªäº›">1.7 åŸºç¡€çº¿ç¨‹æœºåˆ¶æœ‰å“ªäº›?</h4><ul><li><strong>Executor</strong></li></ul><p>Executor ç®¡ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œï¼Œè€Œæ— éœ€ç¨‹åºå‘˜æ˜¾å¼åœ°ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œçš„å¼‚æ­¥æ˜¯æŒ‡å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œäº’ä¸å¹²æ‰°ï¼Œä¸éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œã€‚</p><p>ä¸»è¦æœ‰ä¸‰ç§ Executor:</p><ol><li>CachedThreadPool: ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼›</li><li>FixedThreadPool: æ‰€æœ‰ä»»åŠ¡åªèƒ½ä½¿ç”¨å›ºå®šå¤§å°çš„çº¿ç¨‹ï¼›</li><li>SingleThreadExecutor: ç›¸å½“äºå¤§å°ä¸º 1 çš„ FixedThreadPoolã€‚</li></ol><ul><li><strong>Daemon</strong></li></ul><p>å®ˆæŠ¤çº¿ç¨‹æ˜¯ç¨‹åºè¿è¡Œæ—¶åœ¨<strong>åå°æä¾›æœåŠ¡çš„çº¿ç¨‹</strong>ï¼Œä¸å±äºç¨‹åºä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚</p><p>å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹ã€‚</p><p>main() å±äºéå®ˆæŠ¤çº¿ç¨‹ã€‚ä½¿ç”¨ setDaemon() æ–¹æ³•å°†ä¸€ä¸ªçº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</p><ul><li><strong>sleep()</strong></li></ul><p>Thread.sleep(millisec) æ–¹æ³•ä¼šä¼‘çœ å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ï¼Œmillisec å•ä½ä¸ºæ¯«ç§’ã€‚</p><p>sleep() å¯èƒ½ä¼šæŠ›å‡º InterruptedExceptionï¼Œå› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­å› main() ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚</p><ul><li><strong>yield()</strong></li></ul><p>å¯¹é™æ€æ–¹æ³• Thread.yield() çš„è°ƒç”¨å£°æ˜äº†å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶å®ƒçº¿ç¨‹æ¥æ‰§è¡Œã€‚è¯¥æ–¹æ³•åªæ˜¯å¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶å®ƒçº¿ç¨‹å¯ä»¥è¿è¡Œã€‚</p><hr><h4 id="1-8-çº¿ç¨‹çš„ä¸­æ–­æ–¹å¼æœ‰å“ªäº›">1.8 çº¿ç¨‹çš„ä¸­æ–­æ–¹å¼æœ‰å“ªäº›?</h4><p>ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šè‡ªåŠ¨ç»“æŸï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šæå‰ç»“æŸã€‚</p><ul><li><strong>InterruptedException</strong></li></ul><p>é€šè¿‡è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„ interrupt() æ¥ä¸­æ–­è¯¥çº¿ç¨‹ï¼Œå¦‚æœè¯¥çº¿ç¨‹å¤„äºé˜»å¡ã€é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸè¯¥çº¿ç¨‹ã€‚ä½†æ˜¯ä¸èƒ½ä¸­æ–­ I/O é˜»å¡å’Œ synchronized é”é˜»å¡ã€‚</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œåœ¨ main() ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹åå†ä¸­æ–­å®ƒï¼Œç”±äºçº¿ç¨‹ä¸­è°ƒç”¨äº† Thread.sleep() æ–¹æ³•ï¼Œå› æ­¤ä¼šæŠ›å‡ºä¸€ä¸ª InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ï¼Œä¸æ‰§è¡Œä¹‹åçš„è¯­å¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterruptExample</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyThread1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread run&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread1</span>();</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread1.interrupt();</span><br><span class="line">        System.out.println(<span class="string">&quot;Main run&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Main run</span><br><span class="line">java.lang.InterruptedException: sleep interrupted</span><br><span class="line">    at java.lang.Thread.sleep(Native Method)</span><br><span class="line">    at InterruptExample.lambda$main$<span class="number">0</span>(InterruptExample.java:<span class="number">5</span>)</span><br><span class="line">    at InterruptExample$$Lambda$<span class="number">1</span>/<span class="number">713338599.</span>run(Unknown Source)</span><br><span class="line">    at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>interrupted()</strong></li></ul><p>å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„ run() æ–¹æ³•æ‰§è¡Œä¸€ä¸ªæ— é™å¾ªç¯ï¼Œå¹¶ä¸”æ²¡æœ‰æ‰§è¡Œ sleep() ç­‰ä¼šæŠ›å‡º InterruptedException çš„æ“ä½œï¼Œé‚£ä¹ˆè°ƒç”¨çº¿ç¨‹çš„ interrupt() æ–¹æ³•å°±æ— æ³•ä½¿çº¿ç¨‹æå‰ç»“æŸã€‚</p><p>ä½†æ˜¯è°ƒç”¨ interrupt() æ–¹æ³•ä¼š<strong>è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°</strong>ï¼Œæ­¤æ—¶è°ƒç”¨ interrupted() æ–¹æ³•ä¼šè¿”å› trueã€‚å› æ­¤å¯ä»¥åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ interrupted() æ–¹æ³•æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºä¸­æ–­çŠ¶æ€ï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ã€‚</p><ul><li><strong>Executor çš„ä¸­æ–­æ“ä½œ</strong></li></ul><p>è°ƒç”¨ Executor çš„ shutdown() æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­ï¼Œä½†æ˜¯å¦‚æœè°ƒç”¨çš„æ˜¯ shutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³•ã€‚</p><h4 id="1-9-çº¿ç¨‹çš„äº’æ–¥åŒæ­¥æ–¹å¼æœ‰å“ªäº›-å¦‚ä½•æ¯”è¾ƒå’Œé€‰æ‹©">1.9 çº¿ç¨‹çš„äº’æ–¥åŒæ­¥æ–¹å¼æœ‰å“ªäº›? å¦‚ä½•æ¯”è¾ƒå’Œé€‰æ‹©?</h4><p>Java æä¾›äº†ä¸¤ç§é”æœºåˆ¶æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ï¼Œç¬¬ä¸€ä¸ªæ˜¯ JVM å®ç°çš„ <strong>synchronized</strong>ï¼Œè€Œå¦ä¸€ä¸ªæ˜¯ JDK å®ç°çš„ <strong>ReentrantLock</strong>ã€‚</p><ul><li><strong>é”çš„å®ç°</strong></li></ul><p>synchronized æ˜¯ JVM å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ JDK å®ç°çš„ã€‚</p><ul><li><strong>æ€§èƒ½</strong></li></ul><p>æ–°ç‰ˆæœ¬ Java å¯¹ synchronized è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚è‡ªæ—‹é”ç­‰ï¼Œsynchronized ä¸ ReentrantLock å¤§è‡´ç›¸åŒã€‚</p><ul><li><strong>ç­‰å¾…å¯ä¸­æ–­</strong></li></ul><p>å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚</p><p>ReentrantLock å¯ä¸­æ–­ï¼Œè€Œ synchronized ä¸è¡Œã€‚</p><ul><li><strong>å…¬å¹³é”</strong></li></ul><p>å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚</p><p>synchronized ä¸­çš„é”æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLock é»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å…¬å¹³çš„ã€‚</p><ul><li><strong>é”ç»‘å®šå¤šä¸ªæ¡ä»¶</strong></li></ul><p>ä¸€ä¸ª ReentrantLock å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ª Condition å¯¹è±¡ã€‚</p><hr><h4 id="1-9-çº¿ç¨‹ä¹‹é—´æœ‰å“ªäº›åä½œæ–¹å¼">1.9 çº¿ç¨‹ä¹‹é—´æœ‰å“ªäº›åä½œæ–¹å¼?</h4><p>å½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚</p><ul><li><strong>join()</strong></li></ul><p>åœ¨çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè€Œä¸æ˜¯å¿™ç­‰å¾…ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ç»“æŸã€‚</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œè™½ç„¶ b çº¿ç¨‹å…ˆå¯åŠ¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ b çº¿ç¨‹ä¸­è°ƒç”¨äº† a çº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œb çº¿ç¨‹ä¼šç­‰å¾… a çº¿ç¨‹ç»“æŸæ‰ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤æœ€åèƒ½å¤Ÿä¿è¯ a çº¿ç¨‹çš„è¾“å‡ºå…ˆäº b çº¿ç¨‹çš„è¾“å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JoinExample</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> A a;</span><br><span class="line"></span><br><span class="line">        B(A a) &#123;</span><br><span class="line">            <span class="built_in">this</span>.a = a;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                a.join();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>();</span><br><span class="line">        <span class="type">B</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">B</span>(a);</span><br><span class="line">        b.start();</span><br><span class="line">        a.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">JoinExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JoinExample</span>();</span><br><span class="line">    example.test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">B</span><br></pre></td></tr></table></figure><ul><li><strong>wait() notify() notifyAll()</strong></li></ul><p>è°ƒç”¨ wait() ä½¿å¾—çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³ï¼Œçº¿ç¨‹åœ¨ç­‰å¾…æ—¶ä¼šè¢«æŒ‚èµ·ï¼Œå½“å…¶ä»–çº¿ç¨‹çš„<strong>è¿è¡Œä½¿å¾—è¿™ä¸ªæ¡ä»¶æ»¡è¶³æ—¶</strong>ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè°ƒç”¨ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p><p>å®ƒä»¬éƒ½å±äº Object çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸å±äº Threadã€‚</p><p>åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º IllegalMonitorStateExeceptionã€‚</p><p>ä½¿ç”¨ wait() æŒ‚èµ·æœŸé—´ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾é”ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚</p><h4 id="1-10-wait-å’Œ-sleep-çš„åŒºåˆ«">1.10 <strong>wait() å’Œ sleep() çš„åŒºåˆ«</strong></h4><ul><li><p>wait() æ˜¯ Object çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ï¼›</p></li><li><p>wait() ä¼šé‡Šæ”¾é”ï¼Œsleep() ä¸ä¼šã€‚</p></li><li><p><strong>await() signal() signalAll()</strong></p></li></ul><p>java.util.concurrent ç±»åº“ä¸­æä¾›äº† Condition ç±»æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼Œå¯ä»¥åœ¨ Condition ä¸Šè°ƒç”¨ await() æ–¹æ³•ä½¿çº¿ç¨‹ç­‰å¾…ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨ signal() æˆ– signalAll() æ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚ç›¸æ¯”äº wait() è¿™ç§ç­‰å¾…æ–¹å¼ï¼Œawait() å¯ä»¥æŒ‡å®šç­‰å¾…çš„æ¡ä»¶ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚</p><hr><h3 id="2-å¹¶å‘å…³é”®å­—">2.  å¹¶å‘å…³é”®å­—</h3><p>æƒ³çŸ¥é“æ›´è¯¦ç»†è¯·äº†è§£ï¼š</p><div class="tag link"><a class="link-card" title="å…³é”®å­—: synchronizedè¯¦è§£" href="https://pdai.tech/md/java/thread/java-thread-x-key-synchronized.html"><div class="left"><img src="https://bu.dusays.com/2021/01/15/dcf30b34409bc.png"/></div><div class="right"><p class="text">å…³é”®å­—: synchronizedè¯¦è§£</p><p class="url">https://pdai.tech/md/java/thread/java-thread-x-key-synchronized.html</p></div></a></div><div class="tag link"><a class="link-card" title="å…³é”®å­—: volatileè¯¦è§£" href="https://pdai.tech/md/java/thread/java-thread-x-key-volatile.html"><div class="left"><img src="https://bu.dusays.com/2021/01/15/b37f959f4f221.png"/></div><div class="right"><p class="text">å…³é”®å­—: volatileè¯¦è§£</p><p class="url">https://pdai.tech/md/java/thread/java-thread-x-key-volatile.html</p></div></a></div><div class="tag link"><a class="link-card" title="å…³é”®å­—: finalè¯¦è§£" href="https://pdai.tech/md/java/thread/java-thread-x-key-final.html"><div class="left"><img src="https://bu.dusays.com/2021/01/15/aa31a3d231600.png"/></div><div class="right"><p class="text">å…³é”®å­—: finalè¯¦è§£</p><p class="url">https://pdai.tech/md/java/thread/java-thread-x-key-final.html</p></div></a></div><h4 id="2-1-Synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªé‡Œ">2.1 Synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªé‡Œ?</h4><ul><li>å¯¹è±¡é”</li><li>æ–¹æ³•é”</li><li>ç±»é”</li></ul><hr><h4 id="2-2-Synchronizedæœ¬è´¨ä¸Šæ˜¯é€šè¿‡ä»€ä¹ˆä¿è¯çº¿ç¨‹å®‰å…¨çš„">2.2 Synchronizedæœ¬è´¨ä¸Šæ˜¯é€šè¿‡ä»€ä¹ˆä¿è¯çº¿ç¨‹å®‰å…¨çš„?</h4><ul><li><strong>åŠ é”å’Œé‡Šæ”¾é”çš„åŸç†</strong></li></ul><p>æ·±å…¥JVMçœ‹å­—èŠ‚ç ï¼Œåˆ›å»ºå¦‚ä¸‹çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedDemo2</span> &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨javacå‘½ä»¤è¿›è¡Œç¼–è¯‘ç”Ÿæˆ.classæ–‡ä»¶</p><p><a href="https://imgse.com/i/pkhuXkV"><img src="https://s21.ax1x.com/2024/07/10/pkhuXkV.png" alt="pkhuXkV.png"></a></p><p>å…³æ³¨çº¢è‰²æ–¹æ¡†é‡Œçš„<code>monitorenter</code>å’Œ<code>monitorexit</code>å³å¯ã€‚</p><p><code>Monitorenter</code>å’Œ<code>Monitorexit</code>æŒ‡ä»¤ï¼Œä¼šè®©å¯¹è±¡åœ¨æ‰§è¡Œï¼Œä½¿å…¶é”è®¡æ•°å™¨åŠ 1æˆ–è€…å‡1ã€‚</p><p>æ¯ä¸€ä¸ªå¯¹è±¡åœ¨åŒä¸€æ—¶é—´åªä¸ä¸€ä¸ªmonitor(é”)ç›¸å…³è”ï¼Œè€Œä¸€ä¸ªmonitoråœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å¾—ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨å°è¯•è·å¾—ä¸è¿™ä¸ªå¯¹è±¡ç›¸å…³è”çš„Monitoré”çš„æ‰€æœ‰æƒçš„æ—¶å€™ï¼ŒmonitorenteræŒ‡ä»¤ä¼šå‘ç”Ÿå¦‚ä¸‹3ä¸­æƒ…å†µä¹‹ä¸€ï¼š</p><ul><li>monitorè®¡æ•°å™¨ä¸º0ï¼Œæ„å‘³ç€ç›®å‰è¿˜æ²¡æœ‰è¢«è·å¾—ï¼Œé‚£è¿™ä¸ªçº¿ç¨‹å°±ä¼šç«‹åˆ»è·å¾—ç„¶åæŠŠé”è®¡æ•°å™¨+1ï¼Œä¸€æ—¦+1ï¼Œåˆ«çš„çº¿ç¨‹å†æƒ³è·å–ï¼Œå°±éœ€è¦ç­‰å¾…ã€‚</li><li>å¦‚æœè¿™ä¸ªmonitorå·²ç»æ‹¿åˆ°äº†è¿™ä¸ªé”çš„æ‰€æœ‰æƒï¼Œåˆé‡å…¥äº†è¿™æŠŠé”ï¼Œé‚£é”è®¡æ•°å™¨å°±ä¼šç´¯åŠ ï¼Œå˜æˆ2ï¼Œå¹¶ä¸”éšç€é‡å…¥çš„æ¬¡æ•°ï¼Œä¼šä¸€ç›´ç´¯åŠ ã€‚</li><li>è¿™æŠŠé”å·²ç»è¢«åˆ«çš„çº¿ç¨‹è·å–äº†ï¼Œç­‰å¾…é”é‡Šæ”¾ã€‚</li></ul><p><code>monitorexitæŒ‡ä»¤</code>ï¼šé‡Šæ”¾å¯¹äºmonitorçš„æ‰€æœ‰æƒï¼Œé‡Šæ”¾è¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯è®²monitorçš„è®¡æ•°å™¨å‡1ï¼Œå¦‚æœ<strong>å‡å®Œä»¥åï¼Œè®¡æ•°å™¨ä¸æ˜¯0ï¼Œåˆ™ä»£è¡¨åˆšæ‰æ˜¯é‡å…¥è¿›æ¥</strong>çš„ï¼Œå½“å‰çº¿ç¨‹è¿˜ç»§ç»­æŒæœ‰è¿™æŠŠé”çš„æ‰€æœ‰æƒï¼Œå¦‚æœè®¡æ•°å™¨å˜æˆ0ï¼Œåˆ™ä»£è¡¨å½“å‰çº¿ç¨‹ä¸å†æ‹¥æœ‰è¯¥monitorçš„æ‰€æœ‰æƒï¼Œå³é‡Šæ”¾é”ã€‚</p><hr><p>ä¸‹å›¾è¡¨ç°äº†å¯¹è±¡ï¼Œå¯¹è±¡ç›‘è§†å™¨ï¼ŒåŒæ­¥é˜Ÿåˆ—ä»¥åŠæ‰§è¡Œçº¿ç¨‹çŠ¶æ€ä¹‹é—´çš„å…³ç³»ï¼š</p><p><a href="https://imgse.com/i/pkhuzpF"><img src="https://s21.ax1x.com/2024/07/10/pkhuzpF.md.webp" alt="pkhuzpF.md.webp"></a></p><p>è¯¥å›¾å¯ä»¥çœ‹å‡ºï¼Œä»»æ„çº¿ç¨‹å¯¹Objectçš„è®¿é—®ï¼Œé¦–å…ˆ<strong>è¦è·å¾—Objectçš„ç›‘è§†å™¨</strong>ï¼Œå¦‚æœè·å–å¤±è´¥ï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥åŒæ­¥çŠ¶æ€ï¼Œçº¿ç¨‹çŠ¶æ€å˜ä¸ºBLOCKEDï¼Œå½“Objectçš„ç›‘è§†å™¨å æœ‰è€…é‡Šæ”¾åï¼Œåœ¨åŒæ­¥é˜Ÿåˆ—ä¸­å¾—çº¿ç¨‹å°±ä¼šæœ‰æœºä¼šé‡æ–°è·å–è¯¥ç›‘è§†å™¨ã€‚</p><hr><ul><li><strong>å¯é‡å…¥åŸç†ï¼šåŠ é”æ¬¡æ•°è®¡æ•°å™¨</strong></li></ul><p>çœ‹å¦‚ä¸‹çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (SynchronizedDemo.class) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        method2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">method2</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„å­—èŠ‚ç </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public static void main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: (0x0009) ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=3, args_size=1</span><br><span class="line">         0: ldc           <span class="comment">#2                  // class tech/pdai/test/synchronized/SynchronizedDemo</span></span><br><span class="line">         2: dup</span><br><span class="line">         3: astore_1</span><br><span class="line">         4: monitorenter</span><br><span class="line">         5: aload_1</span><br><span class="line">         6: monitorexit</span><br><span class="line">         7: goto          15</span><br><span class="line">        10: astore_2</span><br><span class="line">        11: aload_1</span><br><span class="line">        12: monitorexit</span><br><span class="line">        13: aload_2</span><br><span class="line">        15: invokestatic  <span class="comment">#3                  // Method method2:()V</span></span><br><span class="line">      Exception table:</span><br><span class="line">         from    to  target <span class="built_in">type</span></span><br><span class="line">             5     7    10   any</span><br><span class="line">            10    13    10   any</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„SynchronizedDemoä¸­åœ¨æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä¹‹åç´§æ¥ç€å†ä¼šå»æ‰§è¡Œä¸€ä¸ªé™æ€åŒæ­¥æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•é”çš„å¯¹è±¡ä¾ç„¶å°±è¿™ä¸ªç±»å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è¿˜éœ€è¦è·å–è¯¥é”å—?</p><p>ç­”æ¡ˆæ˜¯ä¸å¿…çš„ï¼Œä»ä¸Šå›¾ä¸­å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ‰§è¡Œé™æ€åŒæ­¥æ–¹æ³•çš„æ—¶å€™å°±åªæœ‰ä¸€æ¡monitorexitæŒ‡ä»¤ï¼Œå¹¶æ²¡æœ‰monitorenterè·å–é”çš„æŒ‡ä»¤ã€‚è¿™å°±æ˜¯é”çš„é‡å…¥æ€§ï¼Œå³åœ¨åŒä¸€é”ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¸éœ€è¦å†æ¬¡è·å–åŒä¸€æŠŠé”ã€‚</p><p>Synchronizedå…ˆå¤©å…·æœ‰é‡å…¥æ€§ã€‚æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“çº¿ç¨‹è·å–è¯¥å¯¹è±¡é”åï¼Œè®¡æ•°å™¨å°±ä¼šåŠ ä¸€ï¼Œé‡Šæ”¾é”åå°±ä¼šå°†è®¡æ•°å™¨å‡ä¸€ã€‚</p><hr><ul><li><strong>ä¿è¯å¯è§æ€§çš„åŸç†ï¼šå†…å­˜æ¨¡å‹å’Œhappens-beforeè§„åˆ™</strong></li></ul><p>Synchronizedçš„happens-beforeè§„åˆ™ï¼Œå³ç›‘è§†å™¨é”è§„åˆ™ï¼šå¯¹åŒä¸€ä¸ªç›‘è§†å™¨çš„è§£é”ï¼Œhappens-beforeäºå¯¹è¯¥ç›‘è§†å™¨çš„åŠ é”ã€‚ç»§ç»­æ¥çœ‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MonitorDemo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">writer</span><span class="params">()</span> &#123;     <span class="comment">// 1</span></span><br><span class="line">        a++;                                <span class="comment">// 2</span></span><br><span class="line">    &#125;                                       <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">reader</span><span class="params">()</span> &#123;    <span class="comment">// 4</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> a;                         <span class="comment">// 5</span></span><br><span class="line">    &#125;                                      <span class="comment">// 6</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥ä»£ç çš„happens-beforeå…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š</p><p><a href="https://imgse.com/i/pkhKMnA"><img src="https://s21.ax1x.com/2024/07/10/pkhKMnA.webp" alt="pkhKMnA.webp"></a></p><p>åœ¨å›¾ä¸­æ¯ä¸€ä¸ªç®­å¤´è¿æ¥çš„ä¸¤ä¸ªèŠ‚ç‚¹å°±ä»£è¡¨ä¹‹é—´çš„happens-beforeå…³ç³»ï¼Œé»‘è‰²çš„æ˜¯é€šè¿‡ç¨‹åºé¡ºåºè§„åˆ™æ¨å¯¼å‡ºæ¥</p><p>çº¢è‰²çš„ä¸ºç›‘è§†å™¨é”è§„åˆ™æ¨å¯¼è€Œå‡ºï¼šçº¿ç¨‹Aé‡Šæ”¾é”happens-beforeçº¿ç¨‹BåŠ é”</p><p>è“è‰²çš„åˆ™æ˜¯é€šè¿‡ç¨‹åºé¡ºåºè§„åˆ™å’Œç›‘è§†å™¨é”è§„åˆ™æ¨æµ‹å‡ºæ¥happens-beforå…³ç³»ï¼Œé€šè¿‡ä¼ é€’æ€§è§„åˆ™è¿›ä¸€æ­¥æ¨å¯¼çš„happens-beforeå…³ç³»ã€‚ç°åœ¨æˆ‘ä»¬æ¥é‡ç‚¹å…³æ³¨2 happens-before 5ï¼Œé€šè¿‡è¿™ä¸ªå…³ç³»æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»€ä¹ˆ?</p><p>æ ¹æ®happens-beforeçš„å®šä¹‰ä¸­çš„ä¸€æ¡:å¦‚æœA happens-before Bï¼Œåˆ™Açš„æ‰§è¡Œç»“æœå¯¹Bå¯è§ï¼Œå¹¶ä¸”Açš„æ‰§è¡Œé¡ºåºå…ˆäºBã€‚çº¿ç¨‹Aå…ˆå¯¹å…±äº«å˜é‡Aè¿›è¡ŒåŠ ä¸€ï¼Œç”±2 happens-before 5å…³ç³»å¯çŸ¥<strong>çº¿ç¨‹Açš„æ‰§è¡Œç»“æœå¯¹çº¿ç¨‹Bå¯è§å³çº¿ç¨‹Bæ‰€è¯»å–åˆ°çš„açš„å€¼ä¸º1ã€‚</strong></p><hr><h4 id="2-3-Synchronizedä½¿å¾—åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼Œæ€§èƒ½æ¯”è¾ƒå·®ï¼Œæœ‰ä»€ä¹ˆæå‡çš„æ–¹æ³•">2.3 Synchronizedä½¿å¾—åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼Œæ€§èƒ½æ¯”è¾ƒå·®ï¼Œæœ‰ä»€ä¹ˆæå‡çš„æ–¹æ³•?</h4><p>ç®€å•æ¥è¯´åœ¨JVMä¸­monitorenterå’Œmonitorexitå­—èŠ‚ç ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„Mutex Lockæ¥å®ç°çš„</p><p>ä½†æ˜¯ç”±äºä½¿ç”¨Mutex Lockéœ€è¦å°†å½“å‰çº¿ç¨‹æŒ‚èµ·å¹¶ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€æ¥æ‰§è¡Œï¼Œè¿™ç§åˆ‡æ¢çš„ä»£ä»·æ˜¯éå¸¸æ˜‚è´µçš„ï¼›</p><p>ç„¶è€Œåœ¨ç°å®ä¸­çš„å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒåŒæ­¥æ–¹æ³•æ˜¯è¿è¡Œåœ¨å•çº¿ç¨‹ç¯å¢ƒ(æ— é”ç«äº‰ç¯å¢ƒ)å¦‚æœæ¯æ¬¡éƒ½è°ƒç”¨Mutex Locké‚£ä¹ˆå°†ä¸¥é‡çš„å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p><p><strong>ä¸è¿‡åœ¨jdk1.6ä¸­å¯¹é”çš„å®ç°å¼•å…¥äº†å¤§é‡çš„ä¼˜åŒ–ï¼Œå¦‚é”ç²—åŒ–(Lock Coarsening)ã€é”æ¶ˆé™¤(Lock Elimination)ã€è½»é‡çº§é”(Lightweight Locking)ã€åå‘é”(Biased Locking)ã€é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning)ç­‰æŠ€æœ¯æ¥å‡å°‘é”æ“ä½œçš„å¼€é”€</strong>ã€‚</p><ul><li><p><strong>é”ç²—åŒ–(Lock Coarsening)</strong>ï¼šä¹Ÿå°±æ˜¯å‡<strong>å°‘ä¸å¿…è¦çš„ç´§è¿åœ¨ä¸€èµ·çš„</strong>unlockï¼Œlockæ“ä½œï¼Œå°†å¤šä¸ªè¿ç»­çš„é”æ‰©å±•æˆä¸€ä¸ªèŒƒå›´æ›´å¤§çš„é”ã€‚</p></li><li><p><strong>é”æ¶ˆé™¤(Lock Elimination)</strong>ï¼šé€šè¿‡è¿è¡Œæ—¶JITç¼–è¯‘å™¨çš„é€ƒé€¸åˆ†ææ¥<strong>æ¶ˆé™¤ä¸€äº›æ²¡æœ‰åœ¨å½“å‰åŒæ­¥å—ä»¥å¤–è¢«å…¶ä»–çº¿ç¨‹å…±äº«çš„æ•°æ®çš„é”ä¿æŠ¤</strong>ï¼Œé€šè¿‡é€ƒé€¸åˆ†æä¹Ÿå¯ä»¥åœ¨çº¿ç¨‹æœ¬åœ°Stackä¸Šè¿›è¡Œå¯¹è±¡ç©ºé—´çš„åˆ†é…(åŒæ—¶è¿˜å¯ä»¥å‡å°‘Heapä¸Šçš„åƒåœ¾æ”¶é›†å¼€é”€)ã€‚</p></li><li><p><strong>è½»é‡çº§é”(Lightweight Locking)</strong>ï¼šè¿™ç§é”å®ç°çš„èƒŒååŸºäºè¿™æ ·ä¸€ç§å‡è®¾ï¼Œ**å³åœ¨çœŸå®çš„æƒ…å†µä¸‹æˆ‘ä»¬ç¨‹åºä¸­çš„å¤§éƒ¨åˆ†åŒæ­¥ä»£ç ä¸€èˆ¬éƒ½å¤„äºæ— é”ç«äº‰çŠ¶æ€(**å³å•çº¿ç¨‹æ‰§è¡Œç¯å¢ƒ)ï¼Œåœ¨æ— é”ç«äº‰çš„æƒ…å†µä¸‹å®Œå…¨å¯ä»¥é¿å…è°ƒç”¨æ“ä½œç³»ç»Ÿå±‚é¢çš„é‡é‡çº§äº’æ–¥é”ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯åœ¨monitorenterå’Œmonitorexitä¸­åªéœ€è¦ä¾é ä¸€æ¡CASåŸå­æŒ‡ä»¤å°±å¯ä»¥å®Œæˆé”çš„è·å–åŠé‡Šæ”¾ã€‚å½“å­˜åœ¨é”ç«äº‰çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡ŒCASæŒ‡ä»¤å¤±è´¥çš„çº¿ç¨‹å°†è°ƒç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é”è¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œå½“é”è¢«é‡Šæ”¾çš„æ—¶å€™è¢«å”¤é†’ã€‚</p></li><li><p><strong>åå‘é”(Biased Locking)</strong>ï¼šæ˜¯ä¸ºäº†åœ¨<strong>æ— é”ç«äº‰çš„æƒ…å†µä¸‹é¿å…åœ¨é”è·å–è¿‡ç¨‹ä¸­æ‰§è¡Œä¸å¿…è¦çš„CASåŸå­æŒ‡ä»¤</strong>ï¼Œå› ä¸ºCASåŸå­æŒ‡ä»¤è™½ç„¶ç›¸å¯¹äºé‡é‡çº§é”æ¥è¯´å¼€é”€æ¯”è¾ƒå°ä½†è¿˜æ˜¯å­˜åœ¨éå¸¸å¯è§‚çš„æœ¬åœ°å»¶è¿Ÿã€‚</p></li><li><p><strong>é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning)</strong>ï¼šå½“çº¿ç¨‹åœ¨è·å–è½»é‡çº§é”çš„è¿‡ç¨‹ä¸­æ‰§è¡ŒCASæ“ä½œå¤±è´¥æ—¶ï¼Œåœ¨<strong>è¿›å…¥ä¸monitorç›¸å…³è”çš„æ“ä½œç³»ç»Ÿé‡é‡çº§é”(mutex semaphore)å‰ä¼šè¿›å…¥å¿™ç­‰å¾…</strong>(Spinning)ç„¶åå†æ¬¡å°è¯•ï¼Œå½“å°è¯•ä¸€å®šçš„æ¬¡æ•°åå¦‚æœä»ç„¶æ²¡æœ‰æˆåŠŸåˆ™è°ƒç”¨ä¸è¯¥monitorå…³è”çš„semaphore(å³äº’æ–¥é”)<strong>è¿›å…¥åˆ°é˜»å¡çŠ¶æ€</strong>ã€‚</p></li></ul><h4 id="2-4-Synchronizedç”±ä»€ä¹ˆæ ·çš„ç¼ºé™·-Java-Lockæ˜¯æ€ä¹ˆå¼¥è¡¥è¿™äº›ç¼ºé™·çš„">2.4 Synchronizedç”±ä»€ä¹ˆæ ·çš„ç¼ºé™·?Java Lockæ˜¯æ€ä¹ˆå¼¥è¡¥è¿™äº›ç¼ºé™·çš„?</h4><ul><li><strong>synchronizedçš„ç¼ºé™·</strong><ul><li><strong>æ•ˆç‡ä½</strong>ï¼š<strong>é”çš„é‡Šæ”¾æƒ…å†µå°‘</strong>ï¼Œåªæœ‰ä»£ç æ‰§è¡Œå®Œæ¯•æˆ–è€…å¼‚å¸¸ç»“æŸæ‰ä¼šé‡Šæ”¾é”ï¼›è¯•å›¾è·å–é”çš„æ—¶å€™ä¸èƒ½è®¾å®šè¶…æ—¶ï¼Œä¸èƒ½ä¸­æ–­ä¸€ä¸ªæ­£åœ¨ä½¿ç”¨é”çš„çº¿ç¨‹ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒLockå¯ä»¥ä¸­æ–­å’Œè®¾ç½®è¶…æ—¶ã€‚</li><li><strong>ä¸å¤Ÿçµæ´»</strong>ï¼šåŠ é”å’Œé‡Šæ”¾çš„æ—¶æœºå•ä¸€ï¼Œæ¯ä¸ªé”ä»…æœ‰ä¸€ä¸ªå•ä¸€çš„æ¡ä»¶(æŸä¸ªå¯¹è±¡)ï¼Œç›¸å¯¹è€Œè¨€ï¼Œè¯»å†™é”æ›´åŠ çµæ´»ã€‚</li><li><strong>æ— æ³•çŸ¥é“æ˜¯å¦æˆåŠŸè·å¾—é”</strong>ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒLockå¯ä»¥æ‹¿åˆ°çŠ¶æ€ã€‚</li></ul></li><li><strong>Lockè§£å†³ç›¸åº”é—®é¢˜</strong></li></ul><p>Lockç±»è¿™é‡Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä¸»è¦çœ‹é‡Œé¢çš„4ä¸ªæ–¹æ³•:</p><ol><li><code>lock()</code>: åŠ é”</li><li><code>unlock()</code>: è§£é”</li><li><code>tryLock()</code>: å°è¯•è·å–é”ï¼Œè¿”å›ä¸€ä¸ªbooleanå€¼</li><li><code>tryLock(long,TimeUtil)</code>: å°è¯•è·å–é”ï¼Œå¯ä»¥è®¾ç½®è¶…æ—¶</li></ol><p>Synchronizedåªæœ‰é”åªä¸ä¸€ä¸ªæ¡ä»¶(æ˜¯å¦è·å–é”)ç›¸å…³è”ï¼Œä¸çµæ´»ï¼Œåæ¥<strong>Conditionä¸Lockçš„ç»“åˆ</strong>è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>å¤šçº¿ç¨‹ç«äº‰ä¸€ä¸ªé”æ—¶ï¼Œå…¶ä½™æœªå¾—åˆ°é”çš„çº¿ç¨‹åªèƒ½ä¸åœçš„å°è¯•è·å¾—é”ï¼Œè€Œä¸èƒ½ä¸­æ–­ã€‚</p><p>é«˜å¹¶å‘çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ReentrantLockçš„lockInterruptibly()æ–¹æ³•å¯ä»¥ä¼˜å…ˆè€ƒè™‘å“åº”ä¸­æ–­ã€‚</p><p>ä¸€ä¸ªçº¿ç¨‹<strong>ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œå®ƒå¯ä»¥ä¸­æ–­è‡ªå·±</strong>ï¼Œç„¶åReentrantLockå“åº”è¿™ä¸ªä¸­æ–­ï¼Œä¸å†è®©è¿™ä¸ªçº¿ç¨‹ç»§ç»­ç­‰å¾…ã€‚æœ‰äº†è¿™ä¸ªæœºåˆ¶ï¼Œä½¿ç”¨ReentrantLockæ—¶å°±ä¸ä¼šåƒsynchronizedé‚£æ ·äº§ç”Ÿæ­»é”äº†ã€‚</p><hr><h4 id="2-5-Synchronizedå’ŒLockçš„å¯¹æ¯”ï¼Œå’Œé€‰æ‹©">2.5 Synchronizedå’ŒLockçš„å¯¹æ¯”ï¼Œå’Œé€‰æ‹©?</h4><ul><li><strong>å­˜åœ¨å±‚æ¬¡ä¸Š</strong></li></ul><p>synchronized: Javaçš„å…³é”®å­—ï¼Œåœ¨jvmå±‚é¢ä¸Š</p><p>Lock: æ˜¯ä¸€ä¸ªæ¥å£</p><ul><li><strong>é”çš„é‡Šæ”¾</strong></li></ul><p><strong>synchronized</strong>:</p><ol><li>ä»¥è·å–é”çš„çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç ï¼Œé‡Šæ”¾é”</li><li>çº¿ç¨‹æ‰§è¡Œå‘ç”Ÿå¼‚å¸¸ï¼Œjvmä¼šè®©çº¿ç¨‹é‡Šæ”¾é”</li></ol><p><strong>LOCK</strong>:åœ¨finallyä¸­å¿…é¡»é‡Šæ”¾é”ï¼Œä¸ç„¶å®¹æ˜“é€ æˆçº¿ç¨‹æ­»é”</p><ul><li><p><strong>é”çš„è·å–</strong></p><p>synchronized: å‡è®¾Açº¿ç¨‹è·å¾—é”ï¼ŒBçº¿ç¨‹ç­‰å¾…ã€‚å¦‚æœAçº¿ç¨‹é˜»å¡ï¼ŒBçº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…</p></li></ul><p>Lock: åˆ†æƒ…å†µè€Œå®šï¼ŒLockæœ‰å¤šä¸ªé”è·å–çš„æ–¹å¼ï¼Œå¤§è‡´å°±æ˜¯å¯ä»¥å°è¯•è·å¾—é”ï¼Œçº¿ç¨‹å¯ä»¥ä¸ç”¨ä¸€ç›´ç­‰å¾…(å¯ä»¥é€šè¿‡tryLockåˆ¤æ–­æœ‰æ²¡æœ‰é”)ã€‚</p><ul><li><strong>é”çš„é‡Šæ”¾ï¼ˆæ­»é”äº§ç”Ÿï¼‰</strong></li></ul><p>synchronized: åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶å€™ä¼šè‡ªåŠ¨é‡Šæ”¾å æœ‰çš„é”ï¼Œå› æ­¤ä¸ä¼šå‡ºç°æ­»é”</p><p>Lock: å‘ç”Ÿå¼‚å¸¸æ—¶å€™ï¼Œä¸ä¼šä¸»åŠ¨é‡Šæ”¾å æœ‰çš„é”ï¼Œå¿…é¡»æ‰‹åŠ¨unlockæ¥é‡Šæ”¾é”ï¼Œå¯èƒ½å¼•èµ·æ­»é”çš„å‘ç”Ÿ</p><ul><li><strong>é”çš„çŠ¶æ€</strong></li></ul><p>synchronized: æ— æ³•åˆ¤æ–­</p><p>Lock: å¯ä»¥åˆ¤æ–­ã€</p><ul><li><strong>é”çš„ç±»å‹</strong></li></ul><p>synchronized: å¯é‡å…¥ ä¸å¯ä¸­æ–­ éå…¬å¹³</p><p>Lock: å¯é‡å…¥ å¯åˆ¤æ–­ å¯å…¬å¹³ï¼ˆä¸¤è€…çš†å¯ï¼‰</p><ul><li><strong>æ€§èƒ½</strong></li></ul><p>synchronized: å°‘é‡åŒæ­¥</p><p>Lock: å¤§é‡åŒæ­¥</p><hr><p>Lockå¯ä»¥æé«˜å¤šä¸ªçº¿ç¨‹è¿›è¡Œè¯»æ“ä½œçš„æ•ˆç‡ã€‚</p><p>åœ¨èµ„æºç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼ŒSynchronizedçš„æ€§èƒ½è¦ä¼˜äºReetrantLockï¼Œä½†æ˜¯åœ¨èµ„æºç«äº‰å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼ŒSynchronizedçš„æ€§èƒ½ä¼šä¸‹é™å‡ åå€ï¼Œä½†æ˜¯ReetrantLockçš„æ€§èƒ½èƒ½ç»´æŒå¸¸æ€ï¼›</p><p>ReentrantLockæä¾›äº†å¤šæ ·åŒ–çš„åŒæ­¥ï¼Œæ¯”å¦‚æœ‰æ—¶é—´é™åˆ¶çš„åŒæ­¥ï¼Œå¯ä»¥è¢«Interruptçš„åŒæ­¥ï¼ˆsynchronizedçš„åŒæ­¥æ˜¯ä¸èƒ½Interruptçš„ï¼‰ç­‰ã€‚åœ¨èµ„æºç«äº‰ä¸æ¿€çƒˆçš„æƒ…å½¢ä¸‹ï¼Œæ€§èƒ½ç¨å¾®æ¯”synchronizedå·®ç‚¹ç‚¹ã€‚ä½†æ˜¯å½“åŒæ­¥éå¸¸æ¿€çƒˆçš„æ—¶å€™ï¼Œsynchronizedçš„æ€§èƒ½ä¸€ä¸‹å­èƒ½ä¸‹é™å¥½å‡ åå€ã€‚è€ŒReentrantLockç¡®è¿˜èƒ½ç»´æŒå¸¸æ€ã€‚</p><ul><li><strong>è°ƒåº¦</strong></li></ul><p>synchronized: ä½¿ç”¨Objectå¯¹è±¡æœ¬èº«çš„wait ã€notifyã€notifyAllè°ƒåº¦æœºåˆ¶</p><p>Lock: å¯ä»¥ä½¿ç”¨Conditionè¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„è°ƒåº¦</p><ul><li><strong>ç”¨æ³•</strong></li></ul><p>synchronized: åœ¨éœ€è¦åŒæ­¥çš„å¯¹è±¡ä¸­åŠ å…¥æ­¤æ§åˆ¶ï¼Œsynchronizedå¯ä»¥åŠ åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥åŠ åœ¨ç‰¹å®šä»£ç å—ä¸­ï¼Œæ‹¬å·ä¸­è¡¨ç¤ºéœ€è¦é”çš„å¯¹è±¡ã€‚</p><p>Lock: ä¸€èˆ¬ä½¿ç”¨ReentrantLockç±»åšä¸ºé”ã€‚åœ¨åŠ é”å’Œè§£é”å¤„éœ€è¦é€šè¿‡lock()å’Œunlock()æ˜¾ç¤ºæŒ‡å‡ºã€‚æ‰€ä»¥ä¸€èˆ¬ä¼šåœ¨finallyå—ä¸­å†™unlock()ä»¥é˜²æ­»é”ã€‚</p><ul><li><strong>åº•å±‚å®ç°</strong></li></ul><p>synchronized: åº•å±‚ä½¿ç”¨<strong>æŒ‡ä»¤ç æ–¹å¼æ¥æ§åˆ¶é”çš„</strong>ï¼Œæ˜ å°„æˆå­—èŠ‚ç æŒ‡ä»¤å°±æ˜¯å¢åŠ æ¥ä¸¤ä¸ªæŒ‡ä»¤ï¼š</p><p>monitorenterå’Œmonitorexitã€‚å½“çº¿ç¨‹æ‰§è¡Œé‡åˆ°monitorenteræŒ‡ä»¤æ—¶ä¼šå°è¯•è·å–å†…ç½®é”ï¼Œå¦‚æœè·å–é”åˆ™é”è®¡æ•°å™¨+1ï¼Œå¦‚æœæ²¡æœ‰è·å–é”åˆ™é˜»å¡ï¼›å½“é‡åˆ°monitorexitæŒ‡ä»¤æ—¶é”è®¡æ•°å™¨-1ï¼Œå¦‚æœè®¡æ•°å™¨ä¸º0åˆ™é‡Šæ”¾é”ã€‚</p><p>Lock: åº•å±‚<strong>æ˜¯CASä¹è§‚é”</strong>ï¼Œä¾èµ–AbstractQueuedSynchronizerç±»ï¼ŒæŠŠæ‰€æœ‰çš„è¯·æ±‚çº¿ç¨‹æ„æˆä¸€ä¸ªCLHé˜Ÿåˆ—ã€‚è€Œå¯¹è¯¥é˜Ÿåˆ—çš„æ“ä½œå‡é€šè¿‡Lock-Freeï¼ˆCASï¼‰æ“ä½œã€‚</p><h4 id="2-6-synchronizedåœ¨ä½¿ç”¨æ—¶æœ‰ä½•æ³¨æ„äº‹é¡¹">2.6 synchronizedåœ¨ä½¿ç”¨æ—¶æœ‰ä½•æ³¨æ„äº‹é¡¹?</h4><ul><li><p><strong>é”å¯¹è±¡ä¸èƒ½ä¸ºç©º</strong>ï¼Œå› ä¸ºé”çš„ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¯¹è±¡å¤´é‡Œ</p></li><li><p><strong>ä½œç”¨åŸŸä¸å®œè¿‡å¤§</strong>ï¼Œå½±å“ç¨‹åºæ‰§è¡Œçš„é€Ÿåº¦ï¼Œæ§åˆ¶èŒƒå›´è¿‡å¤§ï¼Œç¼–å†™ä»£ç ä¹Ÿå®¹æ˜“å‡ºé”™</p></li><li><p><strong>é¿å…æ­»é”</strong></p></li><li><p>åœ¨èƒ½é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œ<strong>æ—¢ä¸è¦ç”¨Lockä¹Ÿä¸è¦ç”¨synchronizedå…³é”®å­—</strong>ï¼Œç”¨java.util.concurrentåŒ…ä¸­çš„å„ç§å„æ ·çš„ç±»ï¼Œå¦‚æœä¸ç”¨è¯¥åŒ…ä¸‹çš„ç±»ï¼Œåœ¨æ»¡è¶³ä¸šåŠ¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨synchronizedå…³é”®ï¼Œå› ä¸ºä»£ç é‡å°‘ï¼Œé¿å…å‡ºé”™ã€‚</p></li></ul><hr><h4 id="2-7-Synchronizedä¿®é¥°çš„æ–¹æ³•åœ¨æŠ›å‡ºå¼‚å¸¸æ—¶-ä¼šé‡Šæ”¾é”å—">2.7 Synchronizedä¿®é¥°çš„æ–¹æ³•åœ¨æŠ›å‡ºå¼‚å¸¸æ—¶,ä¼šé‡Šæ”¾é”å—?</h4><p>ä¼š</p><h4 id="2-8-å¤šä¸ªçº¿ç¨‹ç­‰å¾…åŒä¸€ä¸ªSynchronizedé”çš„æ—¶å€™ï¼ŒJVMå¦‚ä½•é€‰æ‹©ä¸‹ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹">2.8 å¤šä¸ªçº¿ç¨‹ç­‰å¾…åŒä¸€ä¸ªSynchronizedé”çš„æ—¶å€™ï¼ŒJVMå¦‚ä½•é€‰æ‹©ä¸‹ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹?</h4><p>éå…¬å¹³é”ï¼Œå³æŠ¢å å¼ã€‚</p><h4 id="2-9-synchronizedæ˜¯å…¬å¹³é”å—ï¼Ÿ">2.9 synchronizedæ˜¯å…¬å¹³é”å—ï¼Ÿ</h4><p>synchronized<strong>å®é™…ä¸Šæ˜¯éå…¬å¹³çš„</strong>ï¼Œæ–°æ¥çš„çº¿ç¨‹æœ‰å¯èƒ½ç«‹å³è·å¾—ç›‘è§†å™¨ï¼Œè€Œåœ¨ç­‰å¾…åŒºä¸­ç­‰å€™å·²ä¹…çš„çº¿ç¨‹å¯èƒ½å†æ¬¡ç­‰å¾…ï¼Œè¿™æ ·æœ‰åˆ©äºæé«˜æ€§èƒ½ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´é¥¥é¥¿ç°è±¡ã€‚</p><h4 id="2-10-volatileå…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆ">2.10 volatileå…³é”®å­—çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?</h4><ul><li><strong>é˜²é‡æ’åº</strong> æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç»å…¸çš„ä¾‹å­æ¥åˆ†æé‡æ’åºé—®é¢˜ã€‚å¤§å®¶åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰å•ä¾‹æ¨¡å¼çš„å®ç°ï¼Œè€Œåœ¨å¹¶å‘ç¯å¢ƒä¸‹çš„å•ä¾‹å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥é‡‡ç”¨åŒé‡æ£€æŸ¥åŠ é”(DCL)çš„æ–¹å¼æ¥å®ç°ã€‚å…¶æºç å¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton singleton;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ å‡½æ•°ç§æœ‰ï¼Œç¦æ­¢å¤–éƒ¨å®ä¾‹åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (singleton == <span class="literal">null</span>) &#123;</span><br><span class="line">                    singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆè¦åœ¨å˜é‡singletonä¹‹é—´åŠ ä¸Švolatileå…³é”®å­—ã€‚è¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œå…ˆè¦äº†è§£å¯¹è±¡çš„æ„é€ è¿‡ç¨‹ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å…¶å®å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>åˆ†é…å†…å­˜ç©ºé—´ã€‚</li><li>åˆå§‹åŒ–å¯¹è±¡ã€‚</li><li>å°†å†…å­˜ç©ºé—´çš„åœ°å€èµ‹å€¼ç»™å¯¹åº”çš„å¼•ç”¨ã€‚</li></ol><p>ä½†æ˜¯ç”±äºæ“ä½œç³»ç»Ÿå¯ä»¥<strong>å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åº</strong>ï¼Œæ‰€ä»¥ä¸Šé¢çš„è¿‡ç¨‹ä¹Ÿå¯èƒ½ä¼šå˜æˆå¦‚ä¸‹è¿‡ç¨‹ï¼š</p><ol><li>åˆ†é…å†…å­˜ç©ºé—´ã€‚</li><li>å°†å†…å­˜ç©ºé—´çš„åœ°å€èµ‹å€¼ç»™å¯¹åº”çš„å¼•ç”¨ã€‚</li><li>åˆå§‹åŒ–å¯¹è±¡</li></ol><p>å¦‚æœæ˜¯è¿™ä¸ªæµç¨‹ï¼Œ<strong>å¤šçº¿ç¨‹ç¯å¢ƒ</strong>ä¸‹å°±å¯èƒ½å°†ä¸€ä¸ª<strong>æœªåˆå§‹åŒ–çš„å¯¹è±¡å¼•ç”¨æš´éœ²å‡ºæ¥</strong>ï¼Œä»è€Œå¯¼è‡´ä¸å¯é¢„æ–™çš„ç»“æœã€‚å› æ­¤ï¼Œä¸ºäº†é˜²æ­¢è¿™ä¸ªè¿‡ç¨‹çš„é‡æ’åºï¼Œæˆ‘ä»¬éœ€è¦å°†å˜é‡è®¾ç½®ä¸ºvolatileç±»å‹çš„å˜é‡ã€‚</p><hr><ul><li><strong>å®ç°å¯è§æ€§</strong></li></ul><p>å¯è§æ€§é—®é¢˜ä¸»è¦æŒ‡<strong>ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡å€¼ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹å´çœ‹ä¸åˆ°</strong>ã€‚å¼•èµ·å¯è§æ€§é—®é¢˜çš„ä¸»è¦åŸå› æ˜¯<strong>æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„ä¸€ä¸ªé«˜é€Ÿç¼“å­˜åŒº</strong>â€”â€”çº¿ç¨‹å·¥ä½œå†…å­˜ã€‚volatileå…³é”®å­—èƒ½æœ‰æ•ˆçš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼Œå°±å¯ä»¥çŸ¥é“å…¶ä½œç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestVolatile</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">stop</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Thread-A</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="string">&quot;Thread A&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (!stop) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread() + <span class="string">&quot; stopped&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Thread-main</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">            System.out.println(Thread.currentThread() + <span class="string">&quot; after 1 seconds&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        stop = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¾“å‡ºå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Thread[main,5,main] after 1 seconds</span><br><span class="line"></span><br><span class="line">// Thread Aä¸€ç›´åœ¨loop, å› ä¸ºThread A ç”±äºå¯è§æ€§åŸå› çœ‹ä¸åˆ°Thread Main å·²ç»ä¿®æ”¹stopçš„å€¼</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° Thread-main ä¼‘çœ 1ç§’ä¹‹åï¼Œè®¾ç½® stop = tureï¼Œä½†æ˜¯Thread Aæ ¹æœ¬æ²¡åœä¸‹æ¥ï¼Œè¿™å°±æ˜¯å¯è§æ€§é—®é¢˜ã€‚å¦‚æœé€šè¿‡åœ¨stopå˜é‡å‰é¢åŠ ä¸Švolatileå…³é”®å­—åˆ™ä¼šçœŸæ­£stopã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thread[main,<span class="number">5</span>,main] after <span class="number">1</span> seconds</span><br><span class="line">Thread[Thread A,<span class="number">5</span>,main] stopped</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure><ul><li><strong>ä¿è¯åŸå­æ€§:å•æ¬¡è¯»/å†™</strong></li></ul><p>volatileä¸èƒ½ä¿è¯å®Œå…¨çš„åŸå­æ€§ï¼Œåªèƒ½ä¿è¯å•æ¬¡çš„è¯»/å†™æ“ä½œå…·æœ‰åŸå­æ€§ã€‚</p><h4 id="2-11-volatileèƒ½ä¿è¯åŸå­æ€§å—">2.11 volatileèƒ½ä¿è¯åŸå­æ€§å—?</h4><p>ä¸èƒ½å®Œå…¨ä¿è¯ï¼Œåªèƒ½ä¿è¯å•æ¬¡çš„è¯»/å†™æ“ä½œå…·æœ‰åŸå­æ€§ã€‚</p><h4 id="2-12-32ä½æœºå™¨ä¸Šå…±äº«çš„longå’Œdoubleå˜é‡çš„ä¸ºä»€ä¹ˆè¦ç”¨volatile">2.12 32ä½æœºå™¨ä¸Šå…±äº«çš„longå’Œdoubleå˜é‡çš„ä¸ºä»€ä¹ˆè¦ç”¨volatile?</h4><p>å› ä¸ºlongå’Œdoubleä¸¤ç§æ•°æ®ç±»å‹çš„æ“ä½œå¯åˆ†ä¸ºé«˜32ä½å’Œä½32ä½ä¸¤éƒ¨åˆ†ï¼Œå› æ­¤<strong>æ™®é€šçš„longæˆ–doubleç±»å‹è¯»/å†™å¯èƒ½ä¸æ˜¯åŸå­</strong>çš„ã€‚å› æ­¤ï¼Œé¼“åŠ±å¤§å®¶å°†å…±äº«çš„longå’Œdoubleå˜é‡è®¾ç½®ä¸ºvolatileç±»å‹ï¼Œè¿™æ ·èƒ½ä¿è¯ä»»ä½•æƒ…å†µä¸‹å¯¹longå’Œdoubleçš„å•æ¬¡è¯»/å†™æ“ä½œéƒ½å…·æœ‰åŸå­æ€§ã€‚</p><p>ç›®å‰å„ç§å¹³å°ä¸‹çš„å•†ç”¨è™šæ‹Ÿæœºéƒ½é€‰æ‹©æŠŠ 64 ä½æ•°æ®çš„è¯»å†™æ“ä½œä½œä¸ºåŸå­æ“ä½œæ¥å¯¹å¾…ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸€èˆ¬ä¸æŠŠlong å’Œ double å˜é‡ä¸“é—¨å£°æ˜ä¸º volatileå¤šæ•°æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸ä¼šé”™çš„ã€‚</p><hr><h4 id="2-13-volatileæ˜¯å¦‚ä½•å®ç°å¯è§æ€§çš„">2.13 volatileæ˜¯å¦‚ä½•å®ç°å¯è§æ€§çš„?</h4><p>å†…å­˜å±éšœã€‚</p><h4 id="2-14-volatileæ˜¯å¦‚ä½•å®ç°æœ‰åºæ€§çš„">2.14 volatileæ˜¯å¦‚ä½•å®ç°æœ‰åºæ€§çš„?</h4><p>happens-beforeç­‰</p><h4 id="2-15-è¯´ä¸‹volatileçš„åº”ç”¨åœºæ™¯">2.15 è¯´ä¸‹volatileçš„åº”ç”¨åœºæ™¯?</h4><p>ä½¿ç”¨ volatile å¿…é¡»å…·å¤‡çš„æ¡ä»¶</p><ol><li>å¯¹å˜é‡çš„å†™æ“ä½œä¸ä¾èµ–äºå½“å‰å€¼ã€‚</li><li>è¯¥å˜é‡æ²¡æœ‰åŒ…å«åœ¨å…·æœ‰å…¶ä»–å˜é‡çš„ä¸å˜å¼ä¸­ã€‚</li><li>åªæœ‰åœ¨çŠ¶æ€çœŸæ­£ç‹¬ç«‹äºç¨‹åºå†…å…¶ä»–å†…å®¹æ—¶æ‰èƒ½ä½¿ç”¨ volatileã€‚</li></ol><ul><li><strong>ä¾‹å­ 1ï¼š å•ä¾‹æ¨¡å¼</strong></li></ul><p>å•ä¾‹æ¨¡å¼çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œä½†å¾ˆå¤šäººä¼šå¿½ç•¥ volatile å…³é”®å­—ï¼Œå› ä¸ºæ²¡æœ‰è¯¥å…³é”®å­—ï¼Œç¨‹åºä¹Ÿå¯ä»¥å¾ˆå¥½çš„è¿è¡Œï¼Œåªä¸è¿‡ä»£ç çš„ç¨³å®šæ€§æ€»ä¸æ˜¯ 100%ï¼Œè¯´ä¸å®šåœ¨æœªæ¥çš„æŸä¸ªæ—¶åˆ»ï¼Œéšè—çš„ bug å°±å‡ºæ¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            syschronized(Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>ä¾‹å­2ï¼š volatile bean</strong></li></ul><p>åœ¨ volatile bean æ¨¡å¼ä¸­ï¼ŒJavaBean çš„æ‰€æœ‰æ•°æ®æˆå‘˜éƒ½æ˜¯ volatile ç±»å‹çš„ï¼Œå¹¶ä¸” getter å’Œ setter æ–¹æ³•å¿…é¡»éå¸¸æ™®é€š â€”â€” é™¤äº†è·å–æˆ–è®¾ç½®ç›¸åº”çš„å±æ€§å¤–ï¼Œä¸èƒ½åŒ…å«ä»»ä½•é€»è¾‘ã€‚æ­¤å¤–ï¼Œå¯¹äºå¯¹è±¡å¼•ç”¨çš„æ•°æ®æˆå‘˜ï¼Œå¼•ç”¨çš„å¯¹è±¡å¿…é¡»æ˜¯æœ‰æ•ˆä¸å¯å˜çš„ã€‚(è¿™å°†ç¦æ­¢å…·æœ‰æ•°ç»„å€¼çš„å±æ€§ï¼Œå› ä¸ºå½“æ•°ç»„å¼•ç”¨è¢«å£°æ˜ä¸º volatile æ—¶ï¼Œåªæœ‰å¼•ç”¨è€Œä¸æ˜¯æ•°ç»„æœ¬èº«å…·æœ‰ volatile è¯­ä¹‰)ã€‚å¯¹äºä»»ä½• volatile å˜é‡ï¼Œä¸å˜å¼æˆ–çº¦æŸéƒ½ä¸èƒ½åŒ…å« JavaBean å±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ThreadSafe</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">int</span> age;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFirstName</span><span class="params">()</span> &#123; <span class="keyword">return</span> firstName; &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLastName</span><span class="params">()</span> &#123; <span class="keyword">return</span> lastName; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFirstName</span><span class="params">(String firstName)</span> &#123; </span><br><span class="line">        <span class="built_in">this</span>.firstName = firstName;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLastName</span><span class="params">(String lastName)</span> &#123; </span><br><span class="line">        <span class="built_in">this</span>.lastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123; </span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-16-æ‰€æœ‰çš„finalä¿®é¥°çš„å­—æ®µéƒ½æ˜¯ç¼–è¯‘æœŸå¸¸é‡å—">2.16 æ‰€æœ‰çš„finalä¿®é¥°çš„å­—æ®µéƒ½æ˜¯ç¼–è¯‘æœŸå¸¸é‡å—?</h4><p>ä¸æ˜¯</p><h4 id="2-17-å¦‚ä½•ç†è§£privateæ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯éšå¼çš„final">2.17 å¦‚ä½•ç†è§£privateæ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯éšå¼çš„final?</h4><p>ç±»ä¸­æ‰€æœ‰privateæ–¹æ³•éƒ½éšå¼åœ°æŒ‡å®šä¸ºfinalçš„ï¼Œç”±äºæ— æ³•å–ç”¨privateæ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸èƒ½è¦†ç›–å®ƒã€‚å¯ä»¥å¯¹privateæ–¹æ³•å¢æ·»finalå…³é”®å­—ï¼Œä½†è¿™æ ·åšå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½å¤„ã€‚çœ‹ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Son</span> <span class="keyword">extends</span> <span class="title class_">Base</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Son</span> <span class="variable">son</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Son</span>();</span><br><span class="line">        <span class="type">Base</span> <span class="variable">father</span> <span class="operator">=</span> son;</span><br><span class="line">        <span class="comment">//father.test();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Baseå’ŒSonéƒ½æœ‰æ–¹æ³•test(),ä½†æ˜¯è¿™å¹¶ä¸æ˜¯ä¸€ç§è¦†ç›–ï¼Œå› ä¸ºprivateæ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯éšå¼çš„finalï¼Œä¹Ÿå°±æ˜¯æ— æ³•è¢«ç»§æ‰¿ï¼Œæ‰€ä»¥æ›´ä¸ç”¨è¯´æ˜¯è¦†ç›–äº†ï¼Œåœ¨Sonä¸­çš„test()æ–¹æ³•ä¸è¿‡æ˜¯å±äºSonçš„æ–°æˆå‘˜ç½¢äº†ï¼ŒSonè¿›è¡Œå‘ä¸Šè½¬å‹å¾—åˆ°fatherï¼Œä½†æ˜¯father.test()æ˜¯ä¸å¯æ‰§è¡Œçš„ï¼Œå› ä¸ºBaseä¸­çš„testæ–¹æ³•æ˜¯privateçš„ï¼Œæ— æ³•è¢«è®¿é—®åˆ°ã€‚</p><h4 id=""></h4><hr><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">javaå…¨æ ˆçŸ¥è¯†ä½“ç³»ä¸‰,è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†javaä¸­å¹¶å‘ç¼–ç¨‹çš„çŸ¥è¯†ç‚¹</summary>
    
    
    
    <category term="java" scheme="https://liweierzzz.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="å¹¶å‘" scheme="https://liweierzzz.github.io/tags/%E5%B9%B6%E5%8F%91/"/>
    
    <category term="å¤šçº¿ç¨‹" scheme="https://liweierzzz.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨è®¯é£aiå’Œaiå¸¸ç”¨æŠ€å·§</title>
    <link href="https://liweierzzz.github.io/posts/e09b9d02.html"/>
    <id>https://liweierzzz.github.io/posts/e09b9d02.html</id>
    <published>2024-07-09T15:07:55.000Z</published>
    <updated>2024-07-11T04:43:22.585Z</updated>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« ï¼š</p><div class="tag link"><a class="link-card" title="" href=""><div class="left"><img src="/assets/coffee.png"/></div><div class="right"><p class="text"></p><p class="url"></p></div></a></div><hr><p>ä½¿ç”¨æ–¹å¼:</p><blockquote><h3 id="å¼•å…¥é¡¹ç›®">å¼•å…¥é¡¹ç›®</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&gt;&lt;!--ä¿®æ”¹versionä¸ºæœ€æ–°ç¨³å®šç‰ˆ--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&gt;&lt;dependency&gt;</span></span><br><span class="line">   <span class="string">&lt;groupId&gt;io.github.briqt&lt;/groupId&gt;</span></span><br><span class="line">   <span class="string">&lt;artifactId&gt;xunfei-spark4j&lt;/artifactId&gt;</span></span><br><span class="line">   <span class="string">&lt;version&gt;1.2.0&lt;/version&gt;</span></span><br><span class="line"><span class="string">&gt;&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure></blockquote><hr><h3 id="åˆ›å»ºå®¢æˆ·ç«¯">åˆ›å»ºå®¢æˆ·ç«¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miku.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.SparkClient;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;miku.ai&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XunFeiConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String appid;</span><br><span class="line">    <span class="keyword">private</span> String apikey;</span><br><span class="line">    <span class="keyword">private</span> String secretkey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">   <span class="keyword">public</span> SparkClient <span class="title function_">sparkClient</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SparkClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SparkClient</span>();</span><br><span class="line">        client.appid=appid;</span><br><span class="line">        client.apiKey=apikey;</span><br><span class="line">        client.apiSecret=secretkey;</span><br><span class="line">        <span class="keyword">return</span> client;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®°å¾—é…ç½®appid apikey secretkey ç­‰ åœ¨yamlæ–‡ä»¶é‡Œé¢ å‰ç¼€æ˜¯ miku.ai</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="åŒæ­¥è°ƒç”¨">åŒæ­¥è°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miku.utils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.SparkClient;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.constant.SparkApiVersion;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.exception.SparkException;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.model.SparkMessage;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.model.SparkSyncChatResponse;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.model.request.SparkRequest;</span><br><span class="line"><span class="keyword">import</span> io.github.briqt.spark4j.model.response.SparkTextUsage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SparkUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkClient sparkClient;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæ­¥è°ƒç”¨aiå·¥å…·ç±»</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> systemContent- ç³»ç»Ÿé¢„è®¾å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userContent-   ç”¨æˆ·è¾“å…¥å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  String <span class="title function_">synchronousCalls</span><span class="params">(String systemContent, String userContent)</span> &#123;</span><br><span class="line">        List&lt;SparkMessage&gt; messages = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        messages.add(SparkMessage.systemContent(systemContent));</span><br><span class="line">        messages.add(SparkMessage.userContent(userContent));</span><br><span class="line">        <span class="comment">// æ„é€ è¯·æ±‚</span></span><br><span class="line">        <span class="type">SparkRequest</span> <span class="variable">sparkRequest</span> <span class="operator">=</span> SparkRequest.builder()</span><br><span class="line">                <span class="comment">// æ¶ˆæ¯åˆ—è¡¨</span></span><br><span class="line">                .messages(messages)</span><br><span class="line">                <span class="comment">// æ¨¡å‹å›ç­”çš„tokensçš„æœ€å¤§é•¿åº¦,éå¿…ä¼ ï¼Œé»˜è®¤ä¸º2048ã€‚</span></span><br><span class="line">                <span class="comment">// V1.5å–å€¼ä¸º[1,4096]</span></span><br><span class="line">                <span class="comment">// V2.0å–å€¼ä¸º[1,8192]</span></span><br><span class="line">                <span class="comment">// V3.0å–å€¼ä¸º[1,8192]</span></span><br><span class="line">                .maxTokens(<span class="number">2048</span>)</span><br><span class="line">                <span class="comment">// æ ¸é‡‡æ ·é˜ˆå€¼ã€‚ç”¨äºå†³å®šç»“æœéšæœºæ€§,å–å€¼è¶Šé«˜éšæœºæ€§è¶Šå¼ºå³ç›¸åŒçš„é—®é¢˜å¾—åˆ°çš„ä¸åŒç­”æ¡ˆçš„å¯èƒ½æ€§è¶Šé«˜ éå¿…ä¼ ,å–å€¼ä¸º[0,1],é»˜è®¤ä¸º0.5</span></span><br><span class="line">                .temperature(<span class="number">0.2</span>)</span><br><span class="line">                <span class="comment">// æŒ‡å®šè¯·æ±‚ç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨æœ€æ–°3.0ç‰ˆæœ¬</span></span><br><span class="line">                .apiVersion(SparkApiVersion.V3_0)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åŒæ­¥è°ƒç”¨</span></span><br><span class="line">            <span class="type">SparkSyncChatResponse</span> <span class="variable">chatResponse</span> <span class="operator">=</span> sparkClient.chatSync(sparkRequest);</span><br><span class="line">            <span class="type">SparkTextUsage</span> <span class="variable">textUsage</span> <span class="operator">=</span> chatResponse.getTextUsage();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;\nå›ç­”ï¼š&quot;</span> + chatResponse.getContent());</span><br><span class="line">            System.out.println(<span class="string">&quot;\næé—®tokensï¼š&quot;</span> + textUsage.getPromptTokens()</span><br><span class="line">                    + <span class="string">&quot;ï¼Œå›ç­”tokensï¼š&quot;</span> + textUsage.getCompletionTokens()</span><br><span class="line">                    + <span class="string">&quot;ï¼Œæ€»æ¶ˆè€—tokensï¼š&quot;</span> + textUsage.getTotalTokens());</span><br><span class="line">            <span class="keyword">return</span> chatResponse.getContent();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SparkException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;å‘ç”Ÿå¼‚å¸¸äº†ï¼š&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;è°ƒç”¨å¤±è´¥&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h3 id="è°ƒç”¨ç¤ºä¾‹">è°ƒç”¨ç¤ºä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line">   <span class="keyword">private</span> SparkUtils sparkUtils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * è°ƒç”¨aiæœåŠ¡ç”Ÿæˆæ™ºèƒ½ç”Ÿæˆ</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> multipartFile</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> aiRequest</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@ApiOperation(value = &quot;è°ƒç”¨aiæœåŠ¡ç”Ÿæˆæ™ºèƒ½ç”Ÿæˆå›¾è¡¨å’Œç»“è®º&quot;)</span></span><br><span class="line">   <span class="meta">@PostMapping(&quot;/generate&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> BaseResponse&lt;String&gt; <span class="title function_">genSmartChart</span><span class="params">(<span class="meta">@RequestPart(&quot;file&quot;)</span> MultipartFile multipartFile,</span></span><br><span class="line"><span class="params">                                             GenerByAiRequest aiRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">       <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> aiRequest.getName();</span><br><span class="line">       <span class="type">String</span> <span class="variable">goal</span> <span class="operator">=</span> aiRequest.getGoal();</span><br><span class="line">       <span class="type">String</span> <span class="variable">chartType</span> <span class="operator">=</span> aiRequest.getChartType();</span><br><span class="line"></span><br><span class="line">       <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">       <span class="comment">//ç”¨æˆ·è¾“å…¥</span></span><br><span class="line">       StringBuilder userInput= <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">       userInput.append(<span class="string">&quot;åˆ†æç›®æ ‡:&quot;</span>+goal).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       <span class="keyword">if</span> (StringUtils.isNotBlank(chartType))&#123;</span><br><span class="line">           userInput.append(<span class="string">&quot;å›¾è¡¨ç±»å‹:&quot;</span>+chartType).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       userInput.append(<span class="string">&quot;åç§°:&quot;</span>+name).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       <span class="comment">//æ ¡éªŒ</span></span><br><span class="line">       ThrowUtils.throwIf(StringUtils.isBlank(goal), ErrorCode.PARAMS_ERROR, <span class="string">&quot;ç›®æ ‡ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">       ThrowUtils.throwIf(StringUtils.isNotBlank(name)&amp;&amp;name.length()&gt;<span class="number">100</span>,ErrorCode.PARAMS_ERROR,<span class="string">&quot;å›¾è¡¨åç§°ä¸èƒ½è¶…è¿‡100ä¸ªå­—ç¬¦&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//å‹ç¼©Excelæ•°æ®</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">excelCsv</span> <span class="operator">=</span> ExcelUtils.excelCsv(multipartFile);</span><br><span class="line">       userInput.append(<span class="string">&quot;æ•°æ®:&quot;</span>).append(excelCsv).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       <span class="comment">//è¯»å–ç”¨æˆ·ä¸Šä¼ çš„excelæ–‡ä»¶ å¹¶ä¸”å¤„ç†</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> sparkUtils.synchronousCalls(AiConstant.MATH_MAP, userInput.toString());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> ResultUtils.success(userInput.toString());</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Aiè°ƒç”¨æŠ€å·§">Aiè°ƒç”¨æŠ€å·§</h2><h3 id="1-å‹ç¼©åŸå§‹æ•°æ®">1. å‹ç¼©åŸå§‹æ•°æ®</h3><blockquote><p>å› ä¸ºåˆ«äººæä¾›çš„aiæ¥å£æœ‰å­—æ•°é™åˆ¶ï¼Œæ‰€ä»¥å’±ä»¬éœ€è¦å°†ç”¨æˆ·ä¼ è¿‡æ¥çš„æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œ æ¥å£æ™®ééƒ½æœ‰è¾“å…¥å­—æ•°é™åˆ¶ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å°½å¯èƒ½å‹ç¼©æ•°æ®ï¼Œèƒ½å¤Ÿå…è®¸å¤šä¼ ä¸€äº›æ•°æ®ã€‚</p></blockquote><p>AIå‹ç¼©é™¤äº†åå°è‡ªå·±å‹ç¼©å¤–ï¼Œè¿˜å¯ä»¥è°ƒç”¨aiæœåŠ¡ï¼Œè®©aiå¸®ä½ è¿›è¡Œå‹ç¼©æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Alæè¯æŠ€å·§<span class="number">1</span>:æŒç»­è¾“å…¥,æŒç»­ä¼˜åŒ–</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€æ¬¡é—®:</span><br><span class="line">æˆ‘ç»™ä½ ä¸‰è¡Œæ•°æ®ï¼Œè¯·å¸®æˆ‘åˆ†æç½‘ç«™çš„å¢é•¿è¶‹åŠ¿ï¼Œæ•°æ®å¦‚ä¸‹:</span><br><span class="line">ç¬¬ä¸€è¡Œ:æ—¥æœŸ: <span class="number">1</span>å·, ç”¨æˆ·æ•°: <span class="number">10</span>äºº</span><br><span class="line">ç¬¬äºŒè¡Œ:æ—¥æœŸ: <span class="number">2</span>å·ï¼Œç”¨æˆ·æ•°: <span class="number">20</span>äºº</span><br><span class="line">ç¬¬ä¸‰è¡Œ:æ—¥æœŸ: <span class="number">3</span>å·ï¼Œç”¨æˆ·æ•°: <span class="number">30</span>äºº</span><br><span class="line"></span><br><span class="line">Alç­”:</span><br><span class="line">æ ¹æ®ç»™å‡ºçš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™ä¸ªç½‘ç«™çš„ç”¨æˆ·æ•°åœ¨ä¸‰å¤©å†…å‘ˆç°å¿«é€Ÿå¢é•¿çš„è¶‹åŠ¿ã€‚</span><br><span class="line">å…·ä½“æ¥è¯´,è¯¥ç½‘ç«™ç”¨æˆ·æ•°ä»ç¬¬ä¸€å¤©çš„<span class="number">10</span>äººå¢é•¿åˆ°ç¬¬äºŒå¤©çš„<span class="number">20</span>äººï¼Œå¢åŠ äº†<span class="number">10</span>äººï¼Œ</span><br><span class="line">å¢é•¿ç‡ä¸º<span class="number">100</span>%;ç›¸æ¯”ä¹‹ä¸‹,ç¬¬ä¸‰å¤©ç”¨æˆ·æ•°ä»ç¬¬äºŒå¤©çš„<span class="number">20</span>äººå¢é•¿åˆ°ç¬¬ä¸‰å¤©çš„<span class="number">30</span>äººï¼Œ</span><br><span class="line">å¢åŠ äº†åŒæ ·çš„<span class="number">10</span>äººï¼Œå¢é•¿ç‡é™è‡³<span class="number">50</span>%ã€‚å¦‚æœè¿™ç§å¢é•¿è¶‹åŠ¿æŒç»­ä¸‹å»,æˆ‘ä»¬å¯ä»¥</span><br><span class="line">é¢„æœŸè¯¥ç½‘ç«™åœ¨æœªæ¥å‡ å¤©å†…è¿˜ä¼šç»§ç»­å¸å¼•æ›´å¤šç”¨æˆ·ã€‚å½“ç„¶ï¼Œè‹¥è¦å¾—å‡ºæ›´åŠ å‡†ç¡®</span><br><span class="line">çš„ç»“è®º,éœ€è¦æ›´å¤šæ•°æ®çš„æ”¯æŒã€‚</span><br><span class="line"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # </span><br><span class="line">AIæè¯æŠ€å·§<span class="number">2</span>:æ•°æ®å‹ç¼©(å†…å®¹å‹ç¼©ï¼Œæ¯”å¦‚æŠŠå¾ˆé•¿çš„å†…å®¹æå–å…³é”®è¯,ä¹Ÿå¯ä»¥è®©Alæ¥åš)</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒæ¬¡é—®:</span><br><span class="line">æˆ‘ç»™ä½ ä¸‰è¡Œæ•°æ®ï¼Œè¯·å¸®æˆ‘åˆ†æç½‘ç«™çš„å¢é•¿è¶‹åŠ¿ï¼Œæ•°æ®å¦‚ä¸‹:</span><br><span class="line">è¡¨å¤´:æ—¥æœŸ,ç”¨æˆ·æ•°</span><br><span class="line"><span class="number">1</span>å·,<span class="number">10</span></span><br><span class="line"><span class="number">2</span>å·,<span class="number">20</span></span><br><span class="line"><span class="number">3</span>å·,<span class="number">30</span></span><br><span class="line"></span><br><span class="line">Alå›ç­”:</span><br><span class="line">æ ¹æ®ç»™å‡ºçš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæ¯æ—¥ç”¨æˆ·å¢é•¿é‡:</span><br><span class="line">â— ç¬¬ä¸€å¤©å¢é•¿äº†<span class="number">10</span>ä¸ªæ–°ç”¨æˆ·;</span><br><span class="line">â— ç¬¬äºŒå¤©å¢é•¿äº†<span class="number">20</span> - <span class="number">10</span>=<span class="number">10</span>ä¸ªæ–°ç”¨æˆ·;</span><br><span class="line">â— ç¬¬ä¸‰å¤©å¢é•¿äº†<span class="number">30</span> - <span class="number">20</span>=<span class="number">10</span>ä¸ªæ–°ç”¨æˆ·ã€‚</span><br><span class="line">å¯ä»¥çœ‹å‡ºï¼Œæ¯å¤©çš„ç”¨æˆ·å¢é•¿é‡éƒ½ç›¸ç­‰ï¼Œå‘ˆç°ä¸€ä¸ªçº¿æ€§å¢é•¿è¶‹åŠ¿ã€‚å¦‚æœè¿™ä¸ªç½‘ç«™</span><br><span class="line">åœ¨æœªæ¥çš„æ—¶é—´é‡Œèƒ½å¤Ÿä¿æŒç°åœ¨çš„å¢é•¿é€Ÿåº¦å’Œç­–ç•¥ä¸å˜,é¢„è®¡æ¯è¿‡ä¸€å¤©ä¼šå¢åŠ <span class="number">10</span>ä¸ª</span><br><span class="line">ç”¨æˆ·ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯,è¿™ä¸ªé¢„æµ‹æ˜¯åŸºäºç›®å‰çš„æ•°æ®æƒ…å†µï¼Œå®é™…æƒ…å†µå—åˆ°è®¸å¤šå› </span><br><span class="line">ç´ çš„å½±å“ï¼Œä¸èƒ½å®Œå…¨å‡†ç¡®é¢„æµ‹æœªæ¥ç”¨æˆ·å¢é•¿ã€‚</span><br><span class="line"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # </span><br><span class="line">ä½¿ç”¨Alå‹ç¼©</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ¬¡é—®:</span><br><span class="line">æˆ‘ç»™ä½ ä¸‰è¡Œæ•°æ®ï¼Œè¯·å¸®æˆ‘ç”¨æœ€å°‘çš„å­—æ•°å‹ç¼©è¿™æ®µæ•°æ®</span><br><span class="line">ç¬¬ä¸€è¡Œ:æ—¥æœŸ: <span class="number">1</span>å·, ç”¨æˆ·æ•°: <span class="number">10</span>äºº</span><br><span class="line">ç¬¬äºŒè¡Œ:æ—¥æœŸ: <span class="number">2</span>å·ï¼Œç”¨æˆ·æ•°: <span class="number">20</span>äºº</span><br><span class="line">ç¬¬ä¸‰è¡Œ:æ—¥æœŸ: <span class="number">3</span>å·ï¼Œç”¨æˆ·æ•°: <span class="number">30</span>äºº</span><br><span class="line"></span><br><span class="line">Alå›ç­”:</span><br><span class="line">æ—¥æœŸ<span class="number">1</span>-<span class="number">3</span>å·,ç”¨æˆ·æ•°åˆ†åˆ«ä¸º<span class="number">10</span>/<span class="number">20</span>/<span class="number">30</span>äºº</span><br></pre></td></tr></table></figure><hr><h3 id="2-ä¸ºäº†è®©-Al-æ›´å¥½åœ°ç†è§£æˆ‘ä»¬çš„è¾“å…¥ï¼Œå¹¶ç»™å‡ºé¢„æœŸç²¾ç¡®çš„è¾“å‡ºï¼Œéœ€è¦ä¸¥æ ¼æ§åˆ¶æˆ‘ä»¬çš„æé—®è¯ã€‚">2. ä¸ºäº†è®© Al æ›´å¥½åœ°ç†è§£æˆ‘ä»¬çš„è¾“å…¥ï¼Œå¹¶ç»™å‡ºé¢„æœŸç²¾ç¡®çš„è¾“å‡ºï¼Œéœ€è¦ä¸¥æ ¼æ§åˆ¶æˆ‘ä»¬çš„æé—®è¯ã€‚</h3><ul><li><p>ä½¿ç”¨ç³»ç»Ÿé¢„è®¾ + æ§åˆ¶è¾“å…¥æ ¼å¼(ä¾¿äºAlç²¾ç¡®åœ°ç†è§£æˆ‘ä»¬çš„éœ€æ±‚)</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆå’Œå‰ç«¯å¼€å‘ä¸“å®¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŒ‰ç…§ä»¥ä¸‹å›ºå®šæ ¼å¼ç»™ä½ æä¾›å†…å®¹ï¼š</span><br><span class="line">åˆ†æéœ€æ±‚:</span><br><span class="line">&#123;æ•°æ®åˆ†æçš„éœ€æ±‚æˆ–è€…ç›®æ ‡&#125;</span><br><span class="line">åŸå§‹æ•°æ®:</span><br><span class="line">&#123;csvæ ¼å¼çš„åŸå§‹æ•°æ®ï¼Œç”¨,ä½œä¸ºåˆ†éš”ç¬¦&#125;</span><br><span class="line">è¯·æ ¹æ®ä»¥ä¸Šå†…å®¹ï¼Œå¸®æˆ‘ç”Ÿæˆæ•°æ®åˆ†æç»“è®ºå’Œå¯è§†åŒ–å›¾è¡¨ä»£ç </span><br><span class="line">åˆ†æéœ€æ±‚ï¼š</span><br><span class="line">åˆ†æç½‘ç«™ç”¨æˆ·çš„å¢é•¿æƒ…å†µ</span><br><span class="line">åŸå§‹æ•°æ®ï¼š</span><br><span class="line">æ—¥æœŸ,ç”¨æˆ·æ•°</span><br><span class="line"><span class="number">1</span>å·,<span class="number">10</span></span><br><span class="line"><span class="number">2</span>å·,<span class="number">20</span></span><br><span class="line"><span class="number">3</span>å·,<span class="number">30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-æ§åˆ¶è¾“å‡ºæ ¼å¼-ä¾¿äº-AI-è¿”å›çš„å†…å®¹èƒ½å¤Ÿæ›´åŠ æ–¹ä¾¿åœ°ä¸ºæˆ‘ä»¬æ‰€ç”¨">3. æ§åˆ¶è¾“å‡ºæ ¼å¼(ä¾¿äº AI è¿”å›çš„å†…å®¹èƒ½å¤Ÿæ›´åŠ æ–¹ä¾¿åœ°ä¸ºæˆ‘ä»¬æ‰€ç”¨)</h3></li></ul><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆå’Œå‰ç«¯å¼€å‘ä¸“å®¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šæŒ‰ç…§ä»¥ä¸‹å›ºå®šæ ¼å¼ç»™ä½ æä¾›å†…å®¹ï¼š</span></span><br><span class="line"><span class="language-xml">åˆ†æéœ€æ±‚ï¼š</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;æ•°æ®åˆ†æçš„éœ€æ±‚æˆ–è€…ç›®æ ‡&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">åŸå§‹æ•°æ®ï¼š</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;csvæ ¼å¼çš„åŸå§‹æ•°æ®ï¼Œç”¨,ä½œä¸ºåˆ†éš”ç¬¦&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">è¯·æ ¹æ®è¿™ä¸¤éƒ¨åˆ†å†…å®¹ï¼ŒæŒ‰ç…§ä»¥ä¸‹æŒ‡å®šæ ¼å¼ç”Ÿæˆå†…å®¹ï¼ˆæ­¤å¤–ä¸è¦è¾“å‡ºä»»ä½•å¤šä½™çš„å¼€å¤´ã€ç»“å°¾ã€æ³¨é‡Šï¼‰</span></span><br><span class="line"><span class="language-xml">ã€ã€ã€ã€ã€</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;å‰ç«¯ Echarts V5 çš„ option é…ç½®å¯¹è±¡jsä»£ç ï¼Œåˆç†åœ°å°†æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼Œä¸è¦ç”Ÿæˆä»»ä½•å¤šä½™çš„å†…å®¹ï¼Œæ¯”å¦‚æ³¨é‡Š&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ã€ã€ã€ã€ã€</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;æ˜ç¡®çš„æ•°æ®åˆ†æç»“è®ºã€è¶Šè¯¦ç»†è¶Šå¥½ï¼Œä¸è¦ç”Ÿæˆå¤šä½™çš„æ³¨é‡Š&#125;</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆç»“è®ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ã€ã€ã€ã€ã€</span><br><span class="line">&#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">        text: <span class="string">&#x27;ç½‘ç«™ç”¨æˆ·å¢é•¿æƒ…å†µ&#x27;</span>,</span><br><span class="line">        subtext: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    tooltip: &#123;</span><br><span class="line">        trigger: <span class="string">&#x27;axis&#x27;</span>,</span><br><span class="line">        axisPointer: &#123;</span><br><span class="line">            type: <span class="string">&#x27;shadow&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    legend: &#123;</span><br><span class="line">        data: [<span class="string">&#x27;ç”¨æˆ·æ•°&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">    xAxis: &#123;</span><br><span class="line">        data: [<span class="string">&#x27;1å·&#x27;</span>, <span class="string">&#x27;2å·&#x27;</span>, <span class="string">&#x27;3å·&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    yAxis: &#123;&#125;,</span><br><span class="line">    series: [&#123;</span><br><span class="line">        name: <span class="string">&#x27;ç”¨æˆ·æ•°&#x27;</span>,</span><br><span class="line">        type: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">        data: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br><span class="line">ã€ã€ã€ã€ã€</span><br><span class="line">æ ¹æ®æ•°æ®åˆ†æå¯å¾—ï¼Œè¯¥ç½‘ç«™ç”¨æˆ·æ•°é‡é€æ—¥å¢é•¿ï¼Œæ—¶é—´è¶Šé•¿ï¼Œç”¨æˆ·æ•°é‡å¢é•¿è¶Šå¤šã€‚</span><br><span class="line">   </span><br></pre></td></tr></table></figure><ul><li>æŒ‡å®šä¸€ä¸ªç¤ºä¾‹é—®ç­”ï¼Œone-shot æˆ–è€… few-shotã€‚</li></ul><blockquote><p>one-shotï¼šç»™ AI ä¸€è½®ç¤ºä¾‹é—®ç­”</p><p>ew-shotï¼šç»™ AI å¤šè½®ç¤ºä¾‹é—®ç­”</p></blockquote><h3 id="æ€»ç»“ï¼šæ™ºèƒ½æ¥å£å®ç°"><strong>æ€»ç»“ï¼šæ™ºèƒ½æ¥å£å®ç°</strong></h3><p><strong>åç«¯æµç¨‹ï¼š</strong></p><ul><li>æ„é€ ç”¨æˆ·è¯·æ±‚ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€csv æ•°æ®ã€å›¾è¡¨ç±»å‹ï¼‰</li><li>è°ƒç”¨è®¯é£å¤§æ¨¡å‹sdkï¼Œå¾—åˆ° AI å“åº”ç»“æœã€‚</li><li>ä» AI å“åº”ç»“æœä¸­ï¼Œå–å‡ºéœ€è¦çš„ä¿¡æ¯ã€‚</li><li>ä¿å­˜å›¾è¡¨åˆ°æ•°æ®åº“ã€‚</li></ul><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">â­æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†å¦‚ä½•æ¥å…¥è®¯é£aiï¼Œè¿˜æœ‰å¯¹aiæé—®çš„å¸¸ç”¨æŠ€å·§â­</summary>
    
    
    
    <category term="ç¼–ç¨‹ç»éªŒ" scheme="https://liweierzzz.github.io/categories/%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="è®¯é£æ˜Ÿç«å¤§æ¨¡å‹" scheme="https://liweierzzz.github.io/tags/%E8%AE%AF%E9%A3%9E%E6%98%9F%E7%81%AB%E5%A4%A7%E6%A8%A1%E5%9E%8B/"/>
    
    <category term="aiæé—®å¸¸ç”¨æŠ€å·§" scheme="https://liweierzzz.github.io/tags/ai%E6%8F%90%E9%97%AE%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    
    <category term="æ¥å…¥ai" scheme="https://liweierzzz.github.io/tags/%E6%8E%A5%E5%85%A5ai/"/>
    
  </entry>
  
  <entry>
    <title>javaçŸ¥è¯†ä½“ç³»(äºŒ)</title>
    <link href="https://liweierzzz.github.io/posts/a90c23fc.html"/>
    <id>https://liweierzzz.github.io/posts/a90c23fc.html</id>
    <published>2024-07-09T01:43:03.000Z</published>
    <updated>2024-07-10T11:27:24.152Z</updated>
    
    <content type="html"><![CDATA[<h1>Java å…¨æ ˆçŸ¥è¯†ç‚¹é—®é¢˜æ±‡æ€»ï¼ˆäºŒï¼‰</h1><a class="button" href='https://pdai.tech/' title='Java å…¨æ ˆçŸ¥è¯†ä½“ç³»'><img src=''>Java å…¨æ ˆçŸ¥è¯†ä½“ç³»</a><p>æœ¬æ–‡å‚è€ƒé“¾æ¥: <a href="https://pdai.tech/">| Java å…¨æ ˆçŸ¥è¯†ä½“ç³» (pdai.tech)</a>å¤§å®¶çœ‹è¿™ä¸ªç½‘ç«™å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šjavaç›¸å…³çš„çŸ¥è¯†å“¦!!!</p><h1>1. Collection</h1><h2 id="1-1-é›†åˆæœ‰å“ªäº›ç±»ï¼Ÿ">1.1 é›†åˆæœ‰å“ªäº›ç±»ï¼Ÿ</h2><ul><li>Set<ul><li>TreeSet åŸºäºçº¢é»‘æ ‘å®ç°ï¼Œæ”¯æŒæœ‰åºæ€§æ“ä½œï¼Œä¾‹å¦‚æ ¹æ®ä¸€ä¸ªèŒƒå›´æŸ¥æ‰¾å…ƒç´ çš„æ“ä½œã€‚ä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä¸å¦‚ HashSetï¼ŒHashSet æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼ŒTreeSet åˆ™ä¸º O(logN)ã€‚</li><li>HashSet åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæ”¯æŒ<strong>å¿«é€ŸæŸ¥æ‰¾</strong>ï¼Œä½†ä¸æ”¯æŒæœ‰åºæ€§æ“ä½œã€‚å¹¶ä¸”å¤±å»äº†å…ƒç´ çš„æ’å…¥é¡ºåºä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ Iterator éå† HashSet å¾—åˆ°çš„ç»“æœæ˜¯<strong>ä¸ç¡®å®š</strong>çš„ã€‚</li><li>LinkedHashSet å…·æœ‰ HashSet çš„æŸ¥æ‰¾æ•ˆç‡ï¼Œä¸”å†…éƒ¨ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåºã€‚</li></ul></li><li>List<ul><li>ArrayList åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œæ”¯æŒéšæœºè®¿é—®ã€‚</li><li>Vector å’Œ ArrayList ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„ã€‚</li><li>LinkedList åŸºäº<strong>åŒå‘é“¾è¡¨å®ç°</strong>ï¼Œåªèƒ½<strong>é¡ºåºè®¿é—®</strong>ï¼Œä½†æ˜¯å¯ä»¥å¿«é€Ÿåœ°åœ¨é“¾è¡¨ä¸­é—´<strong>æ’å…¥å’Œåˆ é™¤å…ƒç´ </strong>ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒLinkedList è¿˜å¯ä»¥ç”¨ä½œæ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ã€‚</li></ul></li><li>Queue<ul><li>LinkedList å¯ä»¥ç”¨å®ƒæ¥å®ç°åŒå‘é˜Ÿåˆ—ã€‚</li><li>PriorityQueue åŸºäºå †ç»“æ„å®ç°ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚</li></ul></li></ul><h2 id="1-2-ArrayListçš„åº•å±‚ï¼Ÿ">1.2 ArrayListçš„åº•å±‚ï¼Ÿ</h2><p><em>ArrayList</em>å®ç°äº†<em>List</em>æ¥å£ï¼Œæ˜¯é¡ºåºå®¹å™¨ï¼Œå³å…ƒç´ å­˜æ”¾çš„æ•°æ®ä¸æ”¾è¿›å»çš„é¡ºåºç›¸åŒï¼Œå…è®¸æ”¾å…¥<code>null</code>å…ƒç´ ï¼Œåº•å±‚é€šè¿‡<strong>æ•°ç»„å®ç°</strong>ã€‚</p><p>é™¤è¯¥ç±»æœªå®ç°åŒæ­¥å¤–ï¼Œå…¶ä½™è·Ÿ<em>Vector</em>å¤§è‡´ç›¸åŒã€‚</p><p>æ¯ä¸ª<em>ArrayList</em>éƒ½æœ‰ä¸€ä¸ªå®¹é‡(capacity)ï¼Œè¡¨ç¤ºåº•å±‚æ•°ç»„çš„å®é™…å¤§å°ï¼Œå®¹å™¨å†…å­˜å‚¨å…ƒç´ çš„ä¸ªæ•°ä¸èƒ½å¤šäºå½“å‰å®¹é‡ã€‚å½“å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœå®¹é‡ä¸è¶³ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å¢å¤§åº•å±‚æ•°ç»„çš„å¤§å°ã€‚</p><p>å‰é¢å·²ç»æè¿‡ï¼ŒJavaæ³›å‹åªæ˜¯ç¼–è¯‘å™¨æä¾›çš„è¯­æ³•ç³–ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ•°ç»„<strong>æ˜¯ä¸€ä¸ªObjectæ•°ç»„</strong>ï¼Œä»¥ä¾¿èƒ½å¤Ÿå®¹çº³ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚</p><p><a href="https://imgse.com/i/pkfVE5Q"><img src="https://s21.ax1x.com/2024/07/09/pkfVE5Q.png" alt="pkfVE5Q.png"></a></p><h2 id="1-3-ArrayListè‡ªåŠ¨æ‰©å®¹ï¼Ÿ">1.3 ArrayListè‡ªåŠ¨æ‰©å®¹ï¼Ÿ</h2><p>æ¯å½“å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œéƒ½è¦å»<strong>æ£€æŸ¥</strong>æ·»åŠ åå…ƒç´ çš„ä¸ªæ•°æ˜¯å¦ä¼šè¶…å‡ºå½“å‰æ•°ç»„çš„é•¿åº¦ï¼Œå¦‚æœè¶…å‡ºï¼Œæ•°ç»„å°†ä¼šè¿›è¡Œæ‰©å®¹ï¼Œä»¥æ»¡è¶³æ·»åŠ æ•°æ®çš„éœ€æ±‚ã€‚</p><p>æ•°ç»„æ‰©å®¹é€šè¿‡<strong>ensureCapacity(int minCapacity)æ–¹æ³•</strong>æ¥å®ç°ã€‚åœ¨å®é™…æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä½¿ç”¨ensureCapacityæ¥æ‰‹åŠ¨å¢åŠ ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚</p><p>æ•°ç»„è¿›è¡Œæ‰©å®¹æ—¶ï¼Œä¼šå°†è€æ•°ç»„ä¸­çš„å…ƒç´ é‡æ–°æ‹·è´ä¸€ä»½åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œæ¯æ¬¡æ•°ç»„å®¹é‡çš„å¢é•¿å¤§çº¦æ˜¯å…¶åŸå®¹é‡çš„1.5å€ã€‚</p><p>è¿™ç§æ“ä½œçš„ä»£ä»·æ˜¯å¾ˆé«˜çš„ï¼Œå› æ­¤åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å…æ•°ç»„å®¹é‡çš„æ‰©å¼ ã€‚</p><p>å½“æˆ‘ä»¬å¯é¢„çŸ¥è¦ä¿å­˜çš„å…ƒç´ çš„å¤šå°‘æ—¶ï¼Œè¦åœ¨æ„é€ ArrayListå®ä¾‹æ—¶ï¼Œå°±æŒ‡å®šå…¶å®¹é‡ï¼Œä»¥é¿å…æ•°ç»„æ‰©å®¹çš„å‘ç”Ÿã€‚æˆ–è€…æ ¹æ®å®é™…éœ€æ±‚ï¼Œé€šè¿‡è°ƒç”¨ensureCapacityæ–¹æ³•æ¥æ‰‹åŠ¨å¢åŠ ArrayListå®ä¾‹çš„å®¹é‡ã€‚</p><p><a href="https://imgse.com/i/pkfVe8s"><img src="https://s21.ax1x.com/2024/07/09/pkfVe8s.md.png" alt="pkfVe8s.md.png"></a></p><h2 id="1-4-ArrayListçš„Fail-Fastæœºåˆ¶ï¼Ÿ">1.4 ArrayListçš„Fail-Fastæœºåˆ¶ï¼Ÿ</h2><p>ArrayListä¹Ÿé‡‡ç”¨äº†å¿«é€Ÿå¤±è´¥çš„æœºåˆ¶ï¼Œé€šè¿‡<strong>è®°å½•modCount</strong>å‚æ•°æ¥å®ç°ã€‚åœ¨é¢å¯¹å¹¶å‘çš„ä¿®æ”¹æ—¶ï¼Œè¿­ä»£å™¨å¾ˆå¿«å°±ä¼šå®Œå…¨å¤±è´¥ï¼Œè€Œä¸æ˜¯å†’ç€åœ¨å°†æ¥æŸä¸ªä¸ç¡®å®šæ—¶é—´å‘ç”Ÿä»»æ„ä¸ç¡®å®šè¡Œä¸ºçš„é£é™©ã€‚</p><h1>2 Map</h1><h2 id="2-1-Mapæœ‰å“ªäº›ç±»ï¼Ÿ">2.1 Mapæœ‰å“ªäº›ç±»ï¼Ÿ</h2><ul><li><p><code>TreeMap</code> åŸºäºçº¢é»‘æ ‘å®ç°ã€‚</p></li><li><p><code>HashMap</code> 1.7åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œ1.8åŸºäºæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ã€‚</p></li><li><p><code>HashTable</code> å’Œ HashMap ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å†™å…¥ HashTable å¹¶ä¸”ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚å®ƒæ˜¯é—ç•™ç±»ï¼Œ<strong>ä¸åº”è¯¥å»ä½¿ç”¨å®ƒ</strong>ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ ConcurrentHashMap æ¥æ”¯æŒçº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸” ConcurrentHashMap çš„æ•ˆç‡ä¼šæ›´é«˜(1.7 ConcurrentHashMap å¼•å…¥äº†åˆ†æ®µé”, 1.8 å¼•å…¥äº†çº¢é»‘æ ‘)ã€‚</p></li></ul><h2 id="2-1-JDK7-HashMapå¦‚ä½•å®ç°ï¼Ÿ">2.1 JDK7 HashMapå¦‚ä½•å®ç°ï¼Ÿ</h2><p>å“ˆå¸Œè¡¨æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§å¼€æ”¾åœ°å€æ–¹å¼(Open addressing)ï¼Œå¦ä¸€ç§æ˜¯å†²çªé“¾è¡¨æ–¹å¼(Separate chaining with linked lists)ã€‚<strong>Java7 *HashMap*é‡‡ç”¨çš„æ˜¯å†²çªé“¾è¡¨æ–¹å¼</strong>ã€‚</p><p><a href="https://imgse.com/i/pkfVm2n"><img src="https://s21.ax1x.com/2024/07/09/pkfVm2n.png" alt="pkfVm2n.png"></a></p><p>ä»ä¸Šå›¾å®¹æ˜“çœ‹å‡ºï¼Œå¦‚æœé€‰æ‹©åˆé€‚çš„å“ˆå¸Œå‡½æ•°ï¼Œ<code>put()</code>å’Œ<code>get()</code>æ–¹æ³•å¯ä»¥åœ¨å¸¸æ•°æ—¶é—´å†…å®Œæˆã€‚ä½†åœ¨å¯¹<em>HashMap</em>è¿›è¡Œè¿­ä»£æ—¶ï¼Œéœ€è¦éå†æ•´ä¸ªtableä»¥åŠåé¢è·Ÿçš„å†²çªé“¾è¡¨ã€‚å› æ­¤å¯¹äºè¿­ä»£æ¯”è¾ƒé¢‘ç¹çš„åœºæ™¯ï¼Œä¸å®œå°†<em>HashMap</em>çš„åˆå§‹å¤§å°è®¾çš„è¿‡å¤§ã€‚</p><p>æœ‰ä¸¤ä¸ªå‚æ•°å¯ä»¥å½±å“<em>HashMap</em>çš„æ€§èƒ½: åˆå§‹å®¹é‡(inital capacity)å’Œè´Ÿè½½ç³»æ•°(load factor)ã€‚åˆå§‹å®¹é‡æŒ‡å®šäº†åˆå§‹<code>table</code>çš„å¤§å°ï¼Œè´Ÿè½½ç³»æ•°ç”¨æ¥æŒ‡å®šè‡ªåŠ¨æ‰©å®¹çš„ä¸´ç•Œå€¼ã€‚å½“<code>entry</code>çš„æ•°é‡è¶…è¿‡<code>capacity*load_factor</code>æ—¶ï¼Œå®¹å™¨å°†è‡ªåŠ¨æ‰©å®¹å¹¶é‡æ–°å“ˆå¸Œã€‚å¯¹äºæ’å…¥å…ƒç´ è¾ƒå¤šçš„åœºæ™¯ï¼Œå°†åˆå§‹å®¹é‡è®¾å¤§å¯ä»¥å‡å°‘é‡æ–°å“ˆå¸Œçš„æ¬¡æ•°ã€‚</p><h2 id="2-2-JDK8-HashMapå¦‚ä½•å®ç°ï¼Ÿ">2.2 JDK8 HashMapå¦‚ä½•å®ç°ï¼Ÿ</h2><p>æ ¹æ® Java7 HashMap çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ® hash å€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º O(n)ã€‚</p><p>ä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨ Java8 ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¾¾åˆ°äº† 8 ä¸ªæ—¶ï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚</p><p><img src="https://pdai.tech/images/java/java-collection-hashmap8.png" alt="img"></p><h2 id="2-3-HashSetæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ">2.3 HashSetæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h2><p><em>HashSet</em>æ˜¯å¯¹<em>HashMap</em>çš„ç®€å•åŒ…è£…ï¼Œå¯¹<em>HashSet</em>çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šè½¬æ¢æˆåˆé€‚çš„<em>HashMap</em>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HashSetæ˜¯å¯¹HashMapçš„ç®€å•åŒ…è£…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashSet</span>&lt;E&gt;</span><br><span class="line">&#123;</span><br><span class="line">......</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap&lt;E,Object&gt; map;<span class="comment">//HashSeté‡Œé¢æœ‰ä¸€ä¸ªHashMap</span></span><br><span class="line">    <span class="comment">// Dummy value to associate with an Object in the backing Map</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">PRESENT</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">()</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;<span class="comment">//ç®€å•çš„æ–¹æ³•è½¬æ¢</span></span><br><span class="line">        <span class="keyword">return</span> map.put(e, PRESENT)==<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-4-ä»€ä¹ˆæ˜¯WeakHashMap">2.4 ä»€ä¹ˆæ˜¯WeakHashMap?</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“Javaä¸­å†…å­˜æ˜¯é€šè¿‡GCè‡ªåŠ¨ç®¡ç†çš„ï¼ŒGCä¼šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨åˆ¤æ–­å“ªäº›å¯¹è±¡æ˜¯å¯ä»¥è¢«å›æ”¶çš„ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡Œå†…å­˜é‡Šæ”¾ã€‚GCåˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶çš„ä¾æ®æ˜¯ï¼Œ<strong>æ˜¯å¦æœ‰æœ‰æ•ˆçš„å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡</strong>ã€‚å¦‚æœæ²¡æœ‰æœ‰æ•ˆå¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡(åŸºæœ¬æ„å‘³ç€ä¸å­˜åœ¨è®¿é—®è¯¥å¯¹è±¡çš„æ–¹å¼)ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å°±æ˜¯å¯å›æ”¶çš„ã€‚è¿™é‡Œçš„<strong>æœ‰æ•ˆå¼•ç”¨</strong> å¹¶ä¸åŒ…æ‹¬<strong>å¼±å¼•ç”¨</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>è™½ç„¶å¼±å¼•ç”¨å¯ä»¥ç”¨æ¥è®¿é—®å¯¹è±¡ï¼Œä½†è¿›è¡Œåƒåœ¾å›æ”¶æ—¶å¼±å¼•ç”¨å¹¶ä¸ä¼šè¢«è€ƒè™‘åœ¨å†…ï¼Œä»…æœ‰å¼±å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ä»ç„¶ä¼šè¢«GCå›æ”¶</strong>ã€‚</p><p>WeakHashMap å†…éƒ¨æ˜¯é€šè¿‡å¼±å¼•ç”¨æ¥ç®¡ç†entryçš„ï¼Œå¼±å¼•ç”¨çš„ç‰¹æ€§å¯¹åº”åˆ° WeakHashMap ä¸Šæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ</p><p><em>WeakHashMap</em> é‡Œçš„<code>entry</code>å¯èƒ½ä¼šè¢«GCè‡ªåŠ¨åˆ é™¤ï¼Œå³ä½¿ç¨‹åºå‘˜æ²¡æœ‰è°ƒç”¨<code>remove()</code>æˆ–è€…<code>clear()</code>æ–¹æ³•ã€‚</p><p><strong>WeakHashMap</strong> çš„è¿™ä¸ªç‰¹ç‚¹ç‰¹åˆ«é€‚ç”¨äºéœ€è¦ç¼“å­˜çš„åœºæ™¯**ã€‚åœ¨ç¼“å­˜åœºæ™¯ä¸‹ï¼Œç”±äºå†…å­˜æ˜¯æœ‰é™çš„ï¼Œä¸èƒ½ç¼“å­˜æ‰€æœ‰å¯¹è±¡ï¼›å¯¹è±¡ç¼“å­˜å‘½ä¸­å¯ä»¥æé«˜ç³»ç»Ÿæ•ˆç‡ï¼Œä½†ç¼“å­˜MISSä¹Ÿä¸ä¼šé€ æˆé”™è¯¯ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡è®¡ç®—é‡æ–°å¾—åˆ°ã€‚</p><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div><p>æƒ³çŸ¥é“æ›´è¯¦ç»†è¯·äº†è§£ï¼š</p><div class="tag link"><a class="link-card" title="Collection ç±»å…³ç³»å›¾" href="https://pdai.tech/md/java/collection/java-collection-all.html"><div class="left"><img src="https://bu.dusays.com/2023/09/25/6511980d58e3b.webp"/></div><div class="right"><p class="text">Collection ç±»å…³ç³»å›¾</p><p class="url">https://pdai.tech/md/java/collection/java-collection-all.html</p></div></a></div>]]></content>
    
    
    <summary type="html">javaå…¨æ ˆçŸ¥è¯†ä½“ç³»äºŒ,è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†javaä¸­é›†åˆæ¡†æ¶çš„çŸ¥è¯†ç‚¹</summary>
    
    
    
    <category term="java" scheme="https://liweierzzz.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="é›†åˆæ¡†æ¶" scheme="https://liweierzzz.github.io/tags/%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>javaçŸ¥è¯†ä½“ç³»(ä¸€)</title>
    <link href="https://liweierzzz.github.io/posts/63db89e.html"/>
    <id>https://liweierzzz.github.io/posts/63db89e.html</id>
    <published>2024-07-08T13:40:03.000Z</published>
    <updated>2024-07-10T11:27:24.884Z</updated>
    
    <content type="html"><![CDATA[<h1>Java å…¨æ ˆçŸ¥è¯†ç‚¹é—®é¢˜æ±‡æ€»ï¼ˆä¸€ï¼‰</h1><a class="button" href='https://pdai.tech/' title='Java å…¨æ ˆçŸ¥è¯†ä½“ç³»'><img src=''>Java å…¨æ ˆçŸ¥è¯†ä½“ç³»</a><p>æœ¬æ–‡å‚è€ƒé“¾æ¥: <a href="https://pdai.tech/">| Java å…¨æ ˆçŸ¥è¯†ä½“ç³» (pdai.tech)</a>å¤§å®¶çœ‹è¿™ä¸ªç½‘ç«™å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šjavaç›¸å…³çš„çŸ¥è¯†å“¦!!!</p><h2 id="1-javaåŸºç¡€">1.javaåŸºç¡€</h2><h3 id="1-1-è¯­æ³•åŸºç¡€">1.1 è¯­æ³•åŸºç¡€</h3><h4 id="é¢å‘å¯¹è±¡ç‰¹æ€§">é¢å‘å¯¹è±¡ç‰¹æ€§?</h4><ul><li><strong>å°è£…</strong></li></ul><p>â€‹     åˆ©ç”¨æŠ½è±¡æ•°æ®ç±»å‹å°†æ•°æ®å’ŒåŸºäºæ•°æ®çš„æ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œä½¿å…¶æ„æˆä¸€ä¸ªä¸å¯åˆ†å‰²çš„ç‹¬ç«‹å®ä½“ã€‚æ•°æ®è¢«ä¿æŠ¤åœ¨æŠ½è±¡æ•°æ®ç±»å‹çš„å†…éƒ¨ï¼Œå°½å¯èƒ½åœ°éšè—å†…éƒ¨çš„ç»†èŠ‚ï¼Œåªä¿ç•™ä¸€äº›å¯¹å¤–æ¥å£ä½¿ä¹‹ä¸å¤–éƒ¨å‘ç”Ÿè”ç³»ã€‚ç”¨æˆ·æ— éœ€çŸ¥é“å¯¹è±¡å†…éƒ¨çš„ç»†èŠ‚ï¼Œä½†å¯ä»¥é€šè¿‡å¯¹è±¡å¯¹å¤–æä¾›çš„æ¥å£æ¥è®¿é—®è¯¥å¯¹è±¡ã€‚</p><p>ä¼˜ç‚¹:</p><ul><li>å‡å°‘è€¦åˆ: å¯ä»¥ç‹¬ç«‹åœ°å¼€å‘ã€æµ‹è¯•ã€ä¼˜åŒ–ã€ä½¿ç”¨ã€ç†è§£å’Œä¿®æ”¹</li><li>å‡è½»ç»´æŠ¤çš„è´Ÿæ‹…: å¯ä»¥æ›´å®¹æ˜“è¢«ç¨‹åºå‘˜ç†è§£ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥ä¸å½±å“å…¶ä»–æ¨¡å—</li><li>æœ‰æ•ˆåœ°è°ƒèŠ‚æ€§èƒ½: å¯ä»¥é€šè¿‡å‰–æç¡®å®šå“ªäº›æ¨¡å—å½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½</li><li>æé«˜è½¯ä»¶çš„å¯é‡ç”¨æ€§</li><li>é™ä½äº†æ„å»ºå¤§å‹ç³»ç»Ÿçš„é£é™©: å³ä½¿æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œä½†æ˜¯è¿™äº›ç‹¬ç«‹çš„æ¨¡å—å´æœ‰å¯èƒ½æ˜¯å¯ç”¨çš„</li></ul><hr><ul><li>ç»§æ‰¿</li></ul><p>ç»§æ‰¿å®ç°äº† <strong>IS-A</strong> å…³ç³»ï¼Œä¾‹å¦‚ Cat å’Œ Animal å°±æ˜¯ä¸€ç§ IS-A å…³ç³»ï¼Œå› æ­¤ Cat å¯ä»¥ç»§æ‰¿è‡ª Animalï¼Œä»è€Œè·å¾— Animal é private çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p>ç»§æ‰¿åº”è¯¥éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚</p><p>Cat å¯ä»¥å½“åš Animal æ¥ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨ Animal å¼•ç”¨ Cat å¯¹è±¡ã€‚çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ç§°ä¸º <strong>å‘ä¸Šè½¬å‹</strong> ã€‚</p><hr><ul><li>å¤šæ€</li></ul><p>å¤šæ€åˆ†ä¸ºç¼–è¯‘æ—¶å¤šæ€å’Œè¿è¡Œæ—¶å¤šæ€:</p><ul><li>ç¼–è¯‘æ—¶å¤šæ€ä¸»è¦æŒ‡<strong>æ–¹æ³•çš„é‡è½½</strong></li><li>è¿è¡Œæ—¶å¤šæ€æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¯¹è±¡å¼•ç”¨æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹åœ¨è¿è¡ŒæœŸé—´æ‰ç¡®å®š</li></ul><p>è¿è¡Œæ—¶å¤šæ€æœ‰ä¸‰ä¸ªæ¡ä»¶:</p><ul><li>ç»§æ‰¿</li><li>è¦†ç›–(é‡å†™)</li><li>å‘ä¸Šè½¬å‹</li></ul><hr><h4 id="a-a-b-ä¸-a-b-çš„åŒºåˆ«">a = a + b ä¸ a += b çš„åŒºåˆ«</h4><p>+= éšå¼çš„å°†åŠ æ“ä½œçš„ç»“æœç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºæŒæœ‰ç»“æœçš„ç±»å‹ã€‚å¦‚æœä¸¤ä¸ªæ•´å‹ç›¸åŠ ï¼Œå¦‚ byteã€short æˆ–è€… intï¼Œé¦–å…ˆä¼šå°†å®ƒä»¬æå‡åˆ° int ç±»å‹ï¼Œç„¶ååœ¨æ‰§è¡ŒåŠ æ³•æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">byte</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">127</span>;</span><br><span class="line"><span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">127</span>;</span><br><span class="line">b = a + b; <span class="comment">// error : cannot convert from int to byte</span></span><br><span class="line">b += a; <span class="comment">// ok</span></span><br></pre></td></tr></table></figure><p>(å› ä¸º a+b æ“ä½œä¼šå°† aã€b æå‡ä¸º int ç±»å‹ï¼Œæ‰€ä»¥å°† int ç±»å‹èµ‹å€¼ç»™ byte å°±ä¼šç¼–è¯‘å‡ºé”™)</p><h4 id="3-0-1-0-3-å°†ä¼šè¿”å›ä»€ä¹ˆ-true-è¿˜æ˜¯-false">3*0.1 == 0.3 å°†ä¼šè¿”å›ä»€ä¹ˆ? true è¿˜æ˜¯ false?</h4><p>falseï¼Œå› ä¸ºæœ‰äº›æµ®ç‚¹æ•°ä¸èƒ½å®Œå…¨ç²¾ç¡®çš„è¡¨ç¤ºå‡ºæ¥ã€‚</p><h4 id="èƒ½åœ¨-Switch-ä¸­ä½¿ç”¨-String-å—">èƒ½åœ¨ Switch ä¸­ä½¿ç”¨ String å—?</h4><p>ä» Java 7 å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ switch case ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œä½†è¿™ä»…ä»…æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚å†…éƒ¨å®ç°åœ¨ switch ä¸­ä½¿ç”¨å­—ç¬¦ä¸²çš„ hash codeã€‚</p><h4 id="å¯¹equals-å’ŒhashCode-çš„ç†è§£">å¯¹equals()å’ŒhashCode()çš„ç†è§£?</h4><ul><li><strong>ä¸ºä»€ä¹ˆåœ¨é‡å†™ equals æ–¹æ³•çš„æ—¶å€™éœ€è¦é‡å†™ hashCode æ–¹æ³•</strong>?</li></ul><p>å› ä¸ºæœ‰å¼ºåˆ¶çš„è§„èŒƒæŒ‡å®šéœ€è¦åŒæ—¶é‡å†™ hashcode ä¸ equals æ˜¯æ–¹æ³•ï¼Œè®¸å¤šå®¹å™¨ç±»ï¼Œå¦‚ HashMapã€HashSet éƒ½ä¾èµ–äº hashcode ä¸ equals çš„è§„å®šã€‚</p><ul><li><strong>æœ‰æ²¡æœ‰å¯èƒ½ä¸¤ä¸ªä¸ç›¸ç­‰çš„å¯¹è±¡æœ‰ç›¸åŒçš„ hashcode</strong>?</li></ul><p>æœ‰å¯èƒ½ï¼Œä¸¤ä¸ªä¸ç›¸ç­‰çš„å¯¹è±¡å¯èƒ½ä¼šæœ‰ç›¸åŒçš„ hashcode å€¼ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ hashmap ä¸­ä¼šæœ‰å†²çªã€‚ç›¸ç­‰ hashcode å€¼çš„è§„å®šåªæ˜¯è¯´<strong>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œå¿…é¡»æœ‰ç›¸åŒçš„hashcode å€¼</strong>ï¼Œä½†æ˜¯æ²¡æœ‰å…³äºä¸ç›¸ç­‰å¯¹è±¡çš„ä»»ä½•è§„å®šã€‚</p><ul><li><strong>ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ä¼šæœ‰ä¸åŒçš„ hash code å—</strong>?</li></ul><p>ä¸èƒ½ï¼Œæ ¹æ® hash code çš„è§„å®šï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚</p><h4 id="finalã€finalize-å’Œ-finally-çš„ä¸åŒä¹‹å¤„">finalã€finalize å’Œ finally çš„ä¸åŒä¹‹å¤„?</h4><ul><li>final æ˜¯ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œå¯ä»¥<strong>ä¿®é¥°å˜é‡ã€æ–¹æ³•å’Œç±»</strong>ã€‚å¦‚æœ final ä¿®é¥°å˜é‡ï¼Œæ„å‘³ç€è¯¥å˜é‡çš„å€¼åœ¨åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜ã€‚</li><li>Java æŠ€æœ¯å…è®¸ä½¿ç”¨ finalize() æ–¹æ³•åœ¨åƒåœ¾æ”¶é›†å™¨å°†å¯¹è±¡ä»å†…å­˜ä¸­æ¸…é™¤å‡ºå»ä¹‹å‰åšå¿…è¦çš„æ¸…ç†å·¥ä½œã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”±åƒåœ¾æ”¶é›†å™¨åœ¨ç¡®å®šè¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨æ—¶å¯¹è¿™ä¸ªå¯¹è±¡è°ƒç”¨çš„ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™è°ƒç”¨ finalize æ²¡æœ‰ä¿è¯ã€‚</li><li>finally æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œ<strong>ä¸ try å’Œ catch ä¸€èµ·ç”¨äºå¼‚å¸¸çš„å¤„ç†</strong>ã€‚finally å—ä¸€å®šä¼šè¢«æ‰§è¡Œï¼Œæ— è®ºåœ¨ try å—ä¸­æ˜¯å¦æœ‰å‘ç”Ÿå¼‚å¸¸ã€‚</li></ul><h4 id="Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«ï¼Ÿ">Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«ï¼Ÿ</h4><ul><li>ç¬¬ä¸€ç‚¹: å¯å˜å’Œé€‚ç”¨èŒƒå›´ã€‚String<strong>å¯¹è±¡æ˜¯ä¸å¯å˜çš„</strong>ï¼Œè€ŒStringBufferå’ŒStringBuilder<strong>æ˜¯å¯å˜å­—ç¬¦åºåˆ—</strong>ã€‚æ¯æ¬¡å¯¹Stringçš„æ“ä½œ<strong>ç›¸å½“äºç”Ÿæˆä¸€ä¸ªæ–°çš„Stringå¯¹è±¡</strong>ï¼Œè€Œå¯¹StringBufferå’ŒStringBuilderçš„æ“ä½œæ˜¯<strong>å¯¹å¯¹è±¡æœ¬èº«çš„æ“ä½œ</strong>ï¼Œè€Œä¸ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯¹äºé¢‘ç¹æ”¹å˜å†…å®¹çš„å­—ç¬¦ä¸²é¿å…ä½¿ç”¨Stringï¼Œå› ä¸ºé¢‘ç¹çš„ç”Ÿæˆå¯¹è±¡å°†ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿå½±å“ã€‚</li><li>ç¬¬äºŒç‚¹: çº¿ç¨‹å®‰å…¨ã€‚Stringç”±äº<strong>æœ‰finalä¿®é¥°</strong>ï¼Œæ˜¯immutableçš„ï¼Œå®‰å…¨æ€§æ˜¯ç®€å•è€Œçº¯ç²¹çš„ã€‚StringBuilderå’ŒStringBufferçš„åŒºåˆ«åœ¨äº<strong>StringBuilderä¸ä¿è¯åŒæ­¥</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœéœ€è¦çº¿ç¨‹å®‰å…¨éœ€è¦ä½¿ç”¨StringBufferï¼Œä¸éœ€è¦åŒæ­¥çš„StringBuilderæ•ˆç‡æ›´é«˜ã€‚</li></ul><h4 id="æ¥å£ä¸æŠ½è±¡ç±»çš„åŒºåˆ«ï¼Ÿ">æ¥å£ä¸æŠ½è±¡ç±»çš„åŒºåˆ«ï¼Ÿ</h4><ul><li>ä¸€ä¸ªå­ç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±», ä½†èƒ½å®ç°å¤šä¸ªæ¥å£</li><li>æŠ½è±¡ç±»å¯ä»¥<strong>æœ‰</strong>æ„é€ æ–¹æ³•, æ¥å£<strong>æ²¡æœ‰</strong>æ„é€ æ–¹æ³•</li><li>æŠ½è±¡ç±»å¯ä»¥<strong>æœ‰</strong>æ™®é€šæˆå‘˜å˜é‡, æ¥å£<strong>æ²¡æœ‰</strong>æ™®é€šæˆå‘˜å˜é‡</li><li>æŠ½è±¡ç±»å’Œæ¥å£<strong>éƒ½å¯æœ‰é™æ€æˆå‘˜å˜é‡</strong>, æŠ½è±¡ç±»ä¸­é™æ€æˆå‘˜å˜é‡<strong>è®¿é—®ç±»å‹ä»»æ„</strong>ï¼Œæ¥å£<strong>åªèƒ½public static final(é»˜è®¤)</strong></li><li>æŠ½è±¡ç±»<strong>å¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•</strong>, æŠ½è±¡ç±»<strong>å¯ä»¥æœ‰æ™®é€šæ–¹æ³•</strong>ï¼›æ¥å£åœ¨JDK8ä¹‹å‰éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œåœ¨<strong>JDK8å¯ä»¥æœ‰defaultæ–¹æ³•</strong>ï¼Œåœ¨<strong>JDK9ä¸­å…è®¸æœ‰ç§æœ‰æ™®é€šæ–¹æ³•</strong></li><li>æŠ½è±¡ç±»<strong>å¯ä»¥æœ‰é™æ€æ–¹æ³•</strong>ï¼›æ¥å£åœ¨<strong>JDK8ä¹‹å‰ä¸èƒ½æœ‰é™æ€æ–¹æ³•</strong>ï¼Œåœ¨JDK8ä¸­å¯ä»¥æœ‰é™æ€æ–¹æ³•ï¼Œä¸”<strong>åªèƒ½è¢«æ¥å£ç±»ç›´æ¥è°ƒç”¨</strong>ï¼ˆä¸èƒ½è¢«å®ç°ç±»çš„å¯¹è±¡è°ƒç”¨ï¼‰</li></ul><h4 id="this-super-åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ">this() &amp; super()åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ</h4><ul><li>è°ƒç”¨super()<strong>å¿…é¡»å†™åœ¨å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ</strong>, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li><li>superä»å­ç±»è°ƒç”¨çˆ¶ç±»æ„é€ , <strong>thisåœ¨åŒä¸€ç±»ä¸­è°ƒç”¨å…¶ä»–æ„é€ </strong>å‡éœ€è¦<strong>æ”¾åœ¨ç¬¬ä¸€è¡Œ</strong>ã€‚</li><li>å°½ç®¡å¯ä»¥ç”¨thisè°ƒç”¨ä¸€ä¸ªæ„é€ å™¨, å´<strong>ä¸èƒ½è°ƒç”¨2ä¸ª</strong>ã€‚</li><li>thiså’Œsuper<strong>ä¸èƒ½å‡ºç°åœ¨åŒä¸€ä¸ªæ„é€ å™¨ä¸­</strong>, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li><li>this()ã€super()éƒ½<strong>æŒ‡çš„å¯¹è±¡</strong>,ä¸å¯ä»¥åœ¨<strong>static</strong>ç¯å¢ƒä¸­ä½¿ç”¨</li><li>æœ¬è´¨this<strong>æŒ‡å‘æœ¬å¯¹è±¡çš„æŒ‡é’ˆ</strong>ã€‚superæ˜¯ä¸€ä¸ª<strong>å…³é”®å­—</strong>ã€‚</li></ul><h4 id="Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ">Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ</h4><ul><li><code>&lt;&lt;</code> :å·¦ç§»è¿ç®—ç¬¦,<code>x &lt;&lt; 1</code>,ç›¸å½“äºxä¹˜ä»¥2(ä¸æº¢å‡ºçš„æƒ…å†µä¸‹),ä½ä½è¡¥0ã€‚</li><li><code>&gt;&gt;</code> :å¸¦ç¬¦å·å³ç§»,<code>x &gt;&gt; 1</code>,ç›¸å½“äºxé™¤ä»¥2,æ­£æ•°é«˜ä½è¡¥0,è´Ÿæ•°é«˜ä½è¡¥1ã€‚</li><li><code>&gt;&gt;&gt;</code> :æ— ç¬¦å·å³ç§»,å¿½ç•¥ç¬¦å·ä½,ç©ºä½éƒ½ä»¥0è¡¥é½ã€‚</li></ul><h3 id="1-2-æ³›å‹">1.2 æ³›å‹</h3><h4 id="ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ">ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ</h4><ol><li><p><strong>é€‚ç”¨äºå¤šç§æ•°æ®ç±»å‹æ‰§è¡Œç›¸åŒçš„ä»£ç </strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    System.out.println(a + <span class="string">&quot;+&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a + b));</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">float</span> <span class="title function_">add</span><span class="params">(<span class="type">float</span> a, <span class="type">float</span> b)</span> &#123;</span><br><span class="line">    System.out.println(a + <span class="string">&quot;+&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a + b));</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">add</span><span class="params">(<span class="type">double</span> a, <span class="type">double</span> b)</span> &#123;</span><br><span class="line">    System.out.println(a + <span class="string">&quot;+&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a + b));</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰æ³›å‹ï¼Œè¦å®ç°ä¸åŒç±»å‹çš„åŠ æ³•ï¼Œæ¯ç§ç±»å‹éƒ½éœ€è¦é‡è½½ä¸€ä¸ªaddæ–¹æ³•ï¼›é€šè¿‡æ³›å‹ï¼Œæˆ‘ä»¬å¯ä»¥å¤ç”¨ä¸ºä¸€ä¸ªæ–¹æ³•ï¼š</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Number</span>&gt; <span class="type">double</span> <span class="title function_">add</span><span class="params">(T a, T b)</span> &#123;</span><br><span class="line">    System.out.println(a + <span class="string">&quot;+&quot;</span> + b + <span class="string">&quot;=&quot;</span> + (a.doubleValue() + b.doubleValue()));</span><br><span class="line">    <span class="keyword">return</span> a.doubleValue() + b.doubleValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">list.add(<span class="string">&quot;xxString&quot;</span>);</span><br><span class="line">list.add(<span class="number">100d</span>);</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">Person</span>());</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸Šè¿°listä¸­ï¼Œlistä¸­çš„å…ƒç´ éƒ½æ˜¯Objectç±»å‹ï¼ˆæ— æ³•çº¦æŸå…¶ä¸­çš„ç±»å‹ï¼‰ï¼Œæ‰€ä»¥åœ¨å–å‡ºé›†åˆå…ƒç´ æ—¶éœ€è¦äººä¸ºçš„å¼ºåˆ¶ç±»å‹è½¬åŒ–åˆ°å…·ä½“çš„ç›®æ ‡ç±»å‹ï¼Œä¸”å¾ˆå®¹æ˜“å‡ºç°<code>java.lang.ClassCastException</code>å¼‚å¸¸ã€‚</p><p>å¼•å…¥æ³›å‹ï¼Œå®ƒå°†æä¾›ç±»å‹çš„çº¦æŸï¼Œæä¾›ç¼–è¯‘å‰çš„æ£€æŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// listä¸­åªèƒ½æ”¾String, ä¸èƒ½æ”¾å…¶å®ƒç±»å‹çš„å…ƒç´ </span></span><br></pre></td></tr></table></figure><h4 id="æ³›å‹ç±»å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ">æ³›å‹ç±»å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ</h4><ul><li>ä»ä¸€ä¸ªç®€å•çš„æ³›å‹ç±»çœ‹èµ·ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span>&lt;T&gt;&#123;         <span class="comment">// æ­¤å¤„å¯ä»¥éšä¾¿å†™æ ‡è¯†ç¬¦å·ï¼ŒTæ˜¯typeçš„ç®€ç§°  </span></span><br><span class="line">    <span class="keyword">private</span> T <span class="keyword">var</span> ;     <span class="comment">// varçš„ç±»å‹ç”±TæŒ‡å®šï¼Œå³ï¼šç”±å¤–éƒ¨æŒ‡å®š  </span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getVar</span><span class="params">()</span>&#123;  <span class="comment">// è¿”å›å€¼çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š  </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">var</span> ;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVar</span><span class="params">(T <span class="keyword">var</span>)</span>&#123;  <span class="comment">// è®¾ç½®çš„ç±»å‹ä¹Ÿç”±å¤–éƒ¨å†³å®š  </span></span><br><span class="line">        <span class="built_in">this</span>.<span class="keyword">var</span> = <span class="keyword">var</span> ;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericsDemo06</span>&#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;  </span><br><span class="line">        Point&lt;String&gt; p = <span class="keyword">new</span> <span class="title class_">Point</span>&lt;String&gt;() ;     <span class="comment">// é‡Œé¢çš„varç±»å‹ä¸ºStringç±»å‹  </span></span><br><span class="line">        p.setVar(<span class="string">&quot;it&quot;</span>) ;                            <span class="comment">// è®¾ç½®å­—ç¬¦ä¸²  </span></span><br><span class="line">        System.out.println(p.getVar().length()) ;   <span class="comment">// å–å¾—å­—ç¬¦ä¸²çš„é•¿åº¦  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤šå…ƒæ³›å‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>&lt;K,V&gt;&#123;       <span class="comment">// æ­¤å¤„æŒ‡å®šäº†ä¸¤ä¸ªæ³›å‹ç±»å‹  </span></span><br><span class="line">    <span class="keyword">private</span> K key ;     <span class="comment">// æ­¤å˜é‡çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š  </span></span><br><span class="line">    <span class="keyword">private</span> V value ;   <span class="comment">// æ­¤å˜é‡çš„ç±»å‹ç”±å¤–éƒ¨å†³å®š  </span></span><br><span class="line">    <span class="keyword">public</span> K <span class="title function_">getKey</span><span class="params">()</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.key ;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">getValue</span><span class="params">()</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.value ;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setKey</span><span class="params">(K key)</span>&#123;  </span><br><span class="line">        <span class="built_in">this</span>.key = key ;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(V value)</span>&#123;  </span><br><span class="line">        <span class="built_in">this</span>.value = value ;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericsDemo09</span>&#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;  </span><br><span class="line">        User&lt;String,Integer&gt; t = <span class="literal">null</span> ;        <span class="comment">// å®šä¹‰ä¸¤ä¸ªæ³›å‹ç±»å‹çš„å¯¹è±¡  </span></span><br><span class="line">        t = <span class="keyword">new</span> <span class="title class_">User</span>&lt;String,Integer&gt;() ;       <span class="comment">// é‡Œé¢çš„keyä¸ºStringï¼Œvalueä¸ºInteger  </span></span><br><span class="line">        t.setKey(<span class="string">&quot;æ±¤å§†&quot;</span>) ;        <span class="comment">// è®¾ç½®ç¬¬ä¸€ä¸ªå†…å®¹  </span></span><br><span class="line">        t.setValue(<span class="number">20</span>) ;            <span class="comment">// è®¾ç½®ç¬¬äºŒä¸ªå†…å®¹  </span></span><br><span class="line">        System.out.print(<span class="string">&quot;å§“åï¼›&quot;</span> + t.getKey()) ;      <span class="comment">// å–å¾—ä¿¡æ¯  </span></span><br><span class="line">        System.out.print(<span class="string">&quot;ï¼Œå¹´é¾„ï¼›&quot;</span> + t.getValue()) ;       <span class="comment">// å–å¾—ä¿¡æ¯  </span></span><br><span class="line">  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ³›å‹æ¥å£å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ">æ³›å‹æ¥å£å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ</h4><ul><li>ç®€å•çš„æ³›å‹æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Info</span>&lt;T&gt;&#123;        <span class="comment">// åœ¨æ¥å£ä¸Šå®šä¹‰æ³›å‹  </span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getVar</span><span class="params">()</span> ; <span class="comment">// å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯æ³›å‹ç±»å‹  </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InfoImpl</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Info</span>&lt;T&gt;&#123;   <span class="comment">// å®šä¹‰æ³›å‹æ¥å£çš„å­ç±»  </span></span><br><span class="line">    <span class="keyword">private</span> T <span class="keyword">var</span> ;             <span class="comment">// å®šä¹‰å±æ€§  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InfoImpl</span><span class="params">(T <span class="keyword">var</span>)</span>&#123;     <span class="comment">// é€šè¿‡æ„é€ æ–¹æ³•è®¾ç½®å±æ€§å†…å®¹  </span></span><br><span class="line">        <span class="built_in">this</span>.setVar(<span class="keyword">var</span>) ;    </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVar</span><span class="params">(T <span class="keyword">var</span>)</span>&#123;  </span><br><span class="line">        <span class="built_in">this</span>.<span class="keyword">var</span> = <span class="keyword">var</span> ;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getVar</span><span class="params">()</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.<span class="keyword">var</span> ;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericsDemo24</span>&#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String arsg[])</span>&#123;  </span><br><span class="line">        Info&lt;String&gt; i = <span class="literal">null</span>;        <span class="comment">// å£°æ˜æ¥å£å¯¹è±¡  </span></span><br><span class="line">        i = <span class="keyword">new</span> <span class="title class_">InfoImpl</span>&lt;String&gt;(<span class="string">&quot;æ±¤å§†&quot;</span>) ;  <span class="comment">// é€šè¿‡å­ç±»å®ä¾‹åŒ–å¯¹è±¡  </span></span><br><span class="line">        System.out.println(<span class="string">&quot;å†…å®¹ï¼š&quot;</span> + i.getVar()) ;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h4 id="æ³›å‹æ–¹æ³•å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ">æ³›å‹æ–¹æ³•å¦‚ä½•å®šä¹‰ä½¿ç”¨ï¼Ÿ</h4><ul><li>å®šä¹‰æ³›å‹æ–¹æ³•è¯­æ³•æ ¼å¼</li></ul><p><a href="https://imgse.com/i/pkfC3p6"><img src="https://s21.ax1x.com/2024/07/08/pkfC3p6.png" alt="pkfC3p6.png"></a></p><ul><li>è°ƒç”¨æ³›å‹æ–¹æ³•è¯­æ³•æ ¼å¼</li></ul><p><a href="https://imgse.com/i/pkfCG6O"><img src="https://s21.ax1x.com/2024/07/08/pkfCG6O.png" alt="pkfCG6O.png"></a></p><p>è¯´æ˜ä¸€ä¸‹ï¼Œå®šä¹‰æ³›å‹æ–¹æ³•æ—¶ï¼Œå¿…é¡»åœ¨è¿”å›å€¼å‰è¾¹åŠ ä¸€ä¸ª<code>&lt;T&gt;</code>ï¼Œæ¥å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼ŒæŒæœ‰ä¸€ä¸ªæ³›å‹<code>T</code>ï¼Œç„¶åæ‰å¯ä»¥ç”¨æ³›å‹Tä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚</p><p><code>Class&lt;T&gt;</code>çš„ä½œç”¨å°±æ˜¯æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ï¼Œè€Œ<code>Class&lt;T&gt;</code>ç±»å‹çš„å˜é‡cï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºæ³›å‹ç±»çš„å¯¹è±¡ã€‚</p><p>ä¸ºä»€ä¹ˆè¦ç”¨å˜é‡cæ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿæ—¢ç„¶æ˜¯æ³›å‹æ–¹æ³•ï¼Œå°±ä»£è¡¨ç€æˆ‘ä»¬ä¸çŸ¥é“å…·ä½“çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“æ„é€ æ–¹æ³•å¦‚ä½•ï¼Œå› æ­¤æ²¡æœ‰åŠæ³•å»newä¸€ä¸ªå¯¹è±¡ï¼Œä½†å¯ä»¥åˆ©ç”¨å˜é‡cçš„newInstanceæ–¹æ³•å»åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨åå°„åˆ›å»ºå¯¹è±¡ã€‚</p><p>æ³›å‹æ–¹æ³•è¦æ±‚çš„å‚æ•°æ˜¯<code>Class&lt;T&gt;</code>ç±»å‹ï¼Œè€Œ<code>Class.forName()</code>æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯<code>Class&lt;T&gt;</code>ï¼Œå› æ­¤å¯ä»¥ç”¨<code>Class.forName()</code>ä½œä¸ºå‚æ•°ã€‚å…¶ä¸­ï¼Œ<code>forName()</code>æ–¹æ³•ä¸­çš„å‚æ•°æ˜¯ä½•ç§ç±»å‹ï¼Œè¿”å›çš„<code>Class&lt;T&gt;</code>å°±æ˜¯ä½•ç§ç±»å‹ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ<code>forName()</code>æ–¹æ³•ä¸­ä¼ å…¥çš„æ˜¯Userç±»çš„å®Œæ•´è·¯å¾„ï¼Œå› æ­¤è¿”å›çš„æ˜¯<code>Class&lt;User&gt;</code>ç±»å‹çš„å¯¹è±¡ï¼Œå› æ­¤è°ƒç”¨æ³›å‹æ–¹æ³•æ—¶ï¼Œå˜é‡cçš„ç±»å‹å°±æ˜¯<code>Class&lt;User&gt;</code>ï¼Œå› æ­¤æ³›å‹æ–¹æ³•ä¸­çš„æ³›å‹Tå°±è¢«æŒ‡æ˜ä¸ºUserï¼Œå› æ­¤å˜é‡objçš„ç±»å‹ä¸ºUserã€‚</p><p>å½“ç„¶ï¼Œæ³›å‹æ–¹æ³•ä¸æ˜¯ä»…ä»…å¯ä»¥æœ‰ä¸€ä¸ªå‚æ•°<code>Class&lt;T&gt;</code>ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–å‚æ•°ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹æ–¹æ³•å‘¢</strong>ï¼Ÿå› ä¸ºæ³›å‹ç±»è¦åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±æŒ‡æ˜ç±»å‹ï¼Œå¦‚æœæƒ³æ¢ä¸€ç§ç±»å‹ï¼Œä¸å¾—ä¸é‡æ–°newä¸€æ¬¡ï¼Œå¯èƒ½ä¸å¤Ÿçµæ´»ï¼›è€Œæ³›å‹æ–¹æ³•å¯ä»¥åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡æ˜ç±»å‹ï¼Œæ›´åŠ çµæ´»ã€‚</p><h4 id="æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ">æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ</h4><p>åœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¼ å…¥çš„æ³›å‹ç±»å‹å®å‚è¿›è¡Œä¸Šä¸‹è¾¹ç•Œçš„é™åˆ¶ï¼Œå¦‚ï¼šç±»å‹å®å‚åªå‡†ä¼ å…¥æŸç§ç±»å‹çš„çˆ¶ç±»æˆ–æŸç§ç±»å‹çš„å­ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Info</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Number</span>&gt;&#123;    <span class="comment">// æ­¤å¤„æ³›å‹åªèƒ½æ˜¯æ•°å­—ç±»å‹</span></span><br><span class="line">    <span class="keyword">private</span> T <span class="keyword">var</span> ;        <span class="comment">// å®šä¹‰æ³›å‹å˜é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVar</span><span class="params">(T <span class="keyword">var</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.<span class="keyword">var</span> = <span class="keyword">var</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getVar</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.<span class="keyword">var</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span>&#123;    <span class="comment">// ç›´æ¥æ‰“å°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.<span class="keyword">var</span>.toString() ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo1</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">        Info&lt;Integer&gt; i1 = <span class="keyword">new</span> <span class="title class_">Info</span>&lt;Integer&gt;() ;        <span class="comment">// å£°æ˜Integerçš„æ³›å‹å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸‹é™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">lass Info&lt;T&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> T <span class="keyword">var</span> ;        <span class="comment">// å®šä¹‰æ³›å‹å˜é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVar</span><span class="params">(T <span class="keyword">var</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.<span class="keyword">var</span> = <span class="keyword">var</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getVar</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.<span class="keyword">var</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span>&#123;    <span class="comment">// ç›´æ¥æ‰“å°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.<span class="keyword">var</span>.toString() ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericsDemo21</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">        Info&lt;String&gt; i1 = <span class="keyword">new</span> <span class="title class_">Info</span>&lt;String&gt;() ;        <span class="comment">// å£°æ˜Stringçš„æ³›å‹å¯¹è±¡</span></span><br><span class="line">        Info&lt;Object&gt; i2 = <span class="keyword">new</span> <span class="title class_">Info</span>&lt;Object&gt;() ;        <span class="comment">// å£°æ˜Objectçš„æ³›å‹å¯¹è±¡</span></span><br><span class="line">        i1.setVar(<span class="string">&quot;hello&quot;</span>) ;</span><br><span class="line">        i2.setVar(<span class="keyword">new</span> <span class="title class_">Object</span>()) ;</span><br><span class="line">        fun(i1) ;</span><br><span class="line">        fun(i2) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">fun</span><span class="params">(Info&lt;? <span class="built_in">super</span> String&gt; temp)</span>&#123;    <span class="comment">// åªèƒ½æ¥æ”¶Stringæˆ–Objectç±»å‹çš„æ³›å‹ï¼ŒStringç±»çš„çˆ¶ç±»åªæœ‰Objectç±»</span></span><br><span class="line">        System.out.print(temp + <span class="string">&quot;, &quot;</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å¦‚ä½•ç†è§£Javaä¸­çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Ÿ">å¦‚ä½•ç†è§£Javaä¸­çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Ÿ</h4><p>æ³›å‹ä¸­ç±»å‹æ“¦é™¤ Javaæ³›å‹è¿™ä¸ªç‰¹æ€§æ˜¯ä»JDK 1.5æ‰å¼€å§‹åŠ å…¥çš„ï¼Œå› æ­¤<strong>ä¸ºäº†å…¼å®¹ä¹‹å‰çš„ç‰ˆæœ¬</strong>ï¼ŒJavaæ³›å‹çš„å®ç°é‡‡å–äº†â€œä¼ªæ³›å‹â€çš„ç­–ç•¥ï¼Œå³Javaåœ¨è¯­æ³•ä¸Šæ”¯æŒæ³›å‹ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µä¼šè¿›è¡Œæ‰€è°“çš„â€œç±»å‹æ“¦é™¤â€ï¼ˆType Erasureï¼‰ï¼Œå°†æ‰€æœ‰çš„<strong>æ³›å‹è¡¨ç¤ºï¼ˆå°–æ‹¬å·ä¸­çš„å†…å®¹ï¼‰éƒ½æ›¿æ¢ä¸ºå…·ä½“çš„ç±»å‹</strong>ï¼ˆå…¶å¯¹åº”çš„åŸç”Ÿæ€ç±»å‹ï¼‰ï¼Œå°±åƒå®Œå…¨æ²¡æœ‰æ³›å‹ä¸€æ ·ã€‚</p><h3 id="1-3-æ³¨è§£">1.3 æ³¨è§£</h3><h4 id="æ³¨è§£çš„ä½œç”¨ï¼Ÿ">æ³¨è§£çš„ä½œç”¨ï¼Ÿ</h4><p>æ³¨è§£æ˜¯JDK1.5ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºå¯¹ä»£ç è¿›è¡Œè¯´æ˜ï¼Œå¯ä»¥å¯¹åŒ…ã€ç±»ã€æ¥å£ã€å­—æ®µã€æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰è¿›è¡Œæ³¨è§£ã€‚å®ƒä¸»è¦çš„ä½œç”¨æœ‰ä»¥ä¸‹å››æ–¹é¢ï¼š</p><ul><li>ç”Ÿæˆæ–‡æ¡£ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®ç”Ÿæˆjavadocæ–‡æ¡£ã€‚</li><li>ç¼–è¯‘æ£€æŸ¥ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®è®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œæ£€æŸ¥éªŒè¯ã€‚</li><li>ç¼–è¯‘æ—¶åŠ¨æ€å¤„ç†ï¼Œç¼–è¯‘æ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚åŠ¨æ€ç”Ÿæˆä»£ç ã€‚</li><li>è¿è¡Œæ—¶åŠ¨æ€å¤„ç†ï¼Œè¿è¡Œæ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚ä½¿ç”¨åå°„æ³¨å…¥å®ä¾‹ã€‚</li></ul><h4 id="æ³¨è§£çš„å¸¸è§åˆ†ç±»ï¼Ÿ">æ³¨è§£çš„å¸¸è§åˆ†ç±»ï¼Ÿ</h4><ul><li><strong>Javaè‡ªå¸¦çš„æ ‡å‡†æ³¨è§£</strong>ï¼ŒåŒ…æ‹¬<code>@Override</code>ã€<code>@Deprecated</code>å’Œ<code>@SuppressWarnings</code>ï¼Œåˆ†åˆ«ç”¨äºæ ‡æ˜é‡å†™æŸä¸ªæ–¹æ³•ã€æ ‡æ˜æŸä¸ªç±»æˆ–æ–¹æ³•è¿‡æ—¶ã€æ ‡æ˜è¦å¿½ç•¥çš„è­¦å‘Šï¼Œç”¨è¿™äº›æ³¨è§£æ ‡æ˜åç¼–è¯‘å™¨å°±ä¼šè¿›è¡Œæ£€æŸ¥ã€‚</li><li><strong>å…ƒæ³¨è§£</strong>ï¼Œå…ƒæ³¨è§£æ˜¯ç”¨äºå®šä¹‰æ³¨è§£çš„æ³¨è§£ï¼ŒåŒ…æ‹¬<code>@Retention</code>ã€<code>@Target</code>ã€<code>@Inherited</code>ã€<code>@Documented</code><ul><li><code>@Retention</code>ç”¨äºæ ‡æ˜æ³¨è§£è¢«ä¿ç•™çš„é˜¶æ®µ</li><li><code>@Target</code>ç”¨äºæ ‡æ˜æ³¨è§£ä½¿ç”¨çš„èŒƒå›´</li><li><code>@Inherited</code>ç”¨äºæ ‡æ˜æ³¨è§£å¯ç»§æ‰¿</li><li><code>@Documented</code>ç”¨äºæ ‡æ˜æ˜¯å¦ç”Ÿæˆjavadocæ–‡æ¡£</li></ul></li><li><strong>è‡ªå®šä¹‰æ³¨è§£</strong>ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šä¹‰æ³¨è§£ï¼Œå¹¶å¯ç”¨å…ƒæ³¨è§£å¯¹è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ³¨è§£ã€‚</li></ul><h3 id="1-4-å¼‚å¸¸">1.4 å¼‚å¸¸</h3><h4 id="Javaå¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„">Javaå¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„?</h4><ul><li><strong>Throwable</strong> æ˜¯ Java è¯­è¨€ä¸­æ‰€æœ‰é”™è¯¯ä¸å¼‚å¸¸çš„è¶…ç±»ã€‚<ul><li><strong>Error</strong> ç±»åŠå…¶å­ç±»ï¼šç¨‹åºä¸­æ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­å‡ºç°äº†ä¸¥é‡çš„é”™è¯¯ã€‚</li><li><strong>Exception</strong> ç¨‹åºæœ¬èº«å¯ä»¥æ•è·å¹¶ä¸”å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception è¿™ç§å¼‚å¸¸åˆåˆ†ä¸ºä¸¤ç±»ï¼š<strong>è¿è¡Œæ—¶å¼‚å¸¸</strong>å’Œ<strong>ç¼–è¯‘æ—¶å¼‚å¸¸</strong>ã€‚</li></ul></li></ul><p><a href="https://imgse.com/i/pkfCtne"><img src="https://s21.ax1x.com/2024/07/08/pkfCtne.png" alt="pkfCtne.png"></a></p><ul><li><strong>è¿è¡Œæ—¶å¼‚å¸¸</strong></li></ul><p>éƒ½æ˜¯<strong>RuntimeExceptionç±»åŠå…¶å­ç±»å¼‚å¸¸</strong>ï¼Œå¦‚NullPointerException(ç©ºæŒ‡é’ˆå¼‚å¸¸)ã€IndexOutOfBoundsException(ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸)ç­‰ï¼Œè¿™äº›å¼‚å¸¸æ˜¯ä¸æ£€æŸ¥å¼‚å¸¸ï¼Œç¨‹åºä¸­å¯ä»¥é€‰æ‹©æ•è·å¤„ç†ï¼Œä¹Ÿå¯ä»¥ä¸å¤„ç†ã€‚è¿™äº›å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±<strong>ç¨‹åºé€»è¾‘é”™è¯¯å¼•èµ·</strong>çš„ï¼Œç¨‹åºåº”è¯¥ä»é€»è¾‘è§’åº¦å°½å¯èƒ½é¿å…è¿™ç±»å¼‚å¸¸çš„å‘ç”Ÿã€‚</p><p>è¿è¡Œæ—¶å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œå³ä½¿æ²¡æœ‰ç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œä¹Ÿæ²¡æœ‰ç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œä¹Ÿä¼šç¼–è¯‘é€šè¿‡ã€‚</p><ul><li><strong>éè¿è¡Œæ—¶å¼‚å¸¸</strong> ï¼ˆç¼–è¯‘å¼‚å¸¸ï¼‰</li></ul><p>æ˜¯RuntimeExceptionä»¥å¤–çš„å¼‚å¸¸ï¼Œç±»å‹ä¸Šéƒ½å±äºExceptionç±»åŠå…¶å­ç±»ã€‚ä»ç¨‹åºè¯­æ³•è§’åº¦è®²<strong>æ˜¯å¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸</strong>ï¼Œå¦‚æœä¸å¤„ç†ï¼Œç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚IOExceptionã€SQLExceptionç­‰ä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„Exceptionå¼‚å¸¸ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸è‡ªå®šä¹‰æ£€æŸ¥å¼‚å¸¸ã€‚</p><h4 id="å¯æŸ¥çš„å¼‚å¸¸ï¼ˆchecked-exceptionsï¼‰å’Œä¸å¯æŸ¥çš„å¼‚å¸¸ï¼ˆunchecked-exceptionsï¼‰åŒºåˆ«ï¼Ÿ">å¯æŸ¥çš„å¼‚å¸¸ï¼ˆchecked exceptionsï¼‰å’Œä¸å¯æŸ¥çš„å¼‚å¸¸ï¼ˆunchecked exceptionsï¼‰åŒºåˆ«ï¼Ÿ</h4><ul><li><strong>å¯æŸ¥å¼‚å¸¸</strong>ï¼ˆç¼–è¯‘å™¨è¦æ±‚å¿…é¡»å¤„ç½®çš„å¼‚å¸¸ï¼‰ï¼š</li></ul><p>æ­£ç¡®çš„ç¨‹åºåœ¨è¿è¡Œä¸­ï¼Œå¾ˆå®¹æ˜“å‡ºç°çš„ã€æƒ…ç†å¯å®¹çš„å¼‚å¸¸çŠ¶å†µã€‚å¯æŸ¥å¼‚å¸¸è™½ç„¶æ˜¯å¼‚å¸¸çŠ¶å†µï¼Œä½†åœ¨ä¸€å®šç¨‹åº¦ä¸Šå®ƒçš„å‘ç”Ÿæ˜¯<strong>å¯ä»¥é¢„è®¡</strong>çš„ï¼Œè€Œä¸”ä¸€æ—¦å‘ç”Ÿè¿™ç§å¼‚å¸¸çŠ¶å†µï¼Œå°±å¿…é¡»é‡‡å–æŸç§æ–¹å¼è¿›è¡Œå¤„ç†ã€‚</p><p>é™¤äº†RuntimeExceptionåŠå…¶å­ç±»ä»¥å¤–ï¼Œ<strong>å…¶ä»–çš„Exceptionç±»åŠå…¶å­ç±»éƒ½å±äºå¯æŸ¥å¼‚å¸¸</strong>ã€‚è¿™ç§å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œè¦ä¹ˆ<strong>ç”¨try-catchè¯­å¥æ•è·</strong>å®ƒï¼Œè¦ä¹ˆç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œå¦åˆ™ç¼–è¯‘ä¸ä¼šé€šè¿‡ã€‚</p><ul><li><strong>ä¸å¯æŸ¥å¼‚å¸¸</strong>(ç¼–è¯‘å™¨ä¸è¦æ±‚å¼ºåˆ¶å¤„ç½®çš„å¼‚å¸¸)</li></ul><p>åŒ…æ‹¬è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆRuntimeExceptionä¸å…¶å­ç±»ï¼‰å’Œé”™è¯¯ï¼ˆErrorï¼‰ã€‚</p><h4 id="throwå’Œthrowsçš„åŒºåˆ«ï¼Ÿ">throwå’Œthrowsçš„åŒºåˆ«ï¼Ÿ</h4><ul><li><strong>å¼‚å¸¸çš„ç”³æ˜(throws)</strong></li></ul><p>åœ¨Javaä¸­ï¼Œå½“å‰æ‰§è¡Œçš„è¯­å¥å¿…å±äºæŸä¸ªæ–¹æ³•ï¼ŒJavaè§£é‡Šå™¨è°ƒç”¨mainæ–¹æ³•æ‰§è¡Œå¼€å§‹æ‰§è¡Œç¨‹åºã€‚è‹¥æ–¹æ³•ä¸­å­˜åœ¨æ£€æŸ¥å¼‚å¸¸ï¼Œå¦‚æœä¸å¯¹å…¶æ•è·ï¼Œé‚£å¿…é¡»åœ¨æ–¹æ³•å¤´ä¸­æ˜¾å¼å£°æ˜è¯¥å¼‚å¸¸ï¼Œä»¥ä¾¿äºå‘ŠçŸ¥æ–¹æ³•è°ƒç”¨è€…æ­¤æ–¹æ³•æœ‰å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œå¤„ç†ã€‚ åœ¨æ–¹æ³•ä¸­å£°æ˜ä¸€ä¸ªå¼‚å¸¸ï¼Œæ–¹æ³•å¤´ä¸­ä½¿ç”¨å…³é”®å­—throwsï¼Œåé¢æ¥ä¸Šè¦å£°æ˜çš„å¼‚å¸¸ã€‚è‹¥å£°æ˜å¤šä¸ªå¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨é€—å·åˆ†å‰²ã€‚å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> <span class="keyword">throws</span> IOException, FileNotFoundException&#123;</span><br><span class="line">    <span class="comment">//something statements</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>å¼‚å¸¸çš„æŠ›å‡º(throw)</strong></li></ul><p>å¦‚æœä»£ç å¯èƒ½ä¼šå¼•å‘æŸç§é”™è¯¯ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåˆé€‚çš„å¼‚å¸¸ç±»å®ä¾‹å¹¶æŠ›å‡ºå®ƒï¼Œè¿™å°±æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">method</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(value == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ArithmeticException</span>(<span class="string">&quot;å‚æ•°ä¸èƒ½ä¸º0&quot;</span>); <span class="comment">//æŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5.0</span> / value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Java-7-çš„-try-with-resource">Java 7 çš„ try-with-resource?</h4><p>å¦‚æœä½ çš„èµ„æºå®ç°äº† AutoCloseable æ¥å£ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¯­æ³•ã€‚å¤§å¤šæ•°çš„ Java æ ‡å‡†èµ„æºéƒ½ç»§æ‰¿äº†è¿™ä¸ªæ¥å£ã€‚å½“ä½ åœ¨ try å­å¥ä¸­æ‰“å¼€èµ„æºï¼Œèµ„æºä¼šåœ¨ try ä»£ç å—æ‰§è¡Œåæˆ–å¼‚å¸¸å¤„ç†åè‡ªåŠ¨å…³é—­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">automaticallyCloseResource</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;./tmp.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);) &#123;</span><br><span class="line">        <span class="comment">// use the inputStream to read a file</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        log.error(e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        log.error(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¼‚å¸¸çš„åº•å±‚ï¼Ÿ">å¼‚å¸¸çš„åº•å±‚ï¼Ÿ</h4><p>æåˆ°JVMå¤„ç†å¼‚å¸¸çš„æœºåˆ¶ï¼Œå°±éœ€è¦æåŠException Tableï¼Œä»¥ä¸‹ç§°ä¸ºå¼‚å¸¸è¡¨ã€‚æˆ‘ä»¬æš‚ä¸”ä¸æ€¥äºä»‹ç»å¼‚å¸¸è¡¨ï¼Œå…ˆçœ‹ä¸€ä¸ªç®€å•çš„ Java å¤„ç†å¼‚å¸¸çš„å°ä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">simpleTryCatch</span><span class="params">()</span> &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       testNPE();</span><br><span class="line">   &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨javapæ¥åˆ†æè¿™æ®µä»£ç ï¼ˆéœ€è¦å…ˆä½¿ç”¨javacç¼–è¯‘ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//javap -c Main</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">simpleTryCatch</span><span class="params">()</span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method testNPE:()V</span></span><br><span class="line">       <span class="number">3</span>: goto          <span class="number">11</span></span><br><span class="line">       <span class="number">6</span>: astore_0</span><br><span class="line">       <span class="number">7</span>: aload_0</span><br><span class="line">       <span class="number">8</span>: invokevirtual #<span class="number">5</span>                  <span class="comment">// Method java/lang/Exception.printStackTrace:()V</span></span><br><span class="line">      <span class="number">11</span>: <span class="keyword">return</span></span><br><span class="line">    Exception table:</span><br><span class="line">       from    to  target type</span><br><span class="line">           <span class="number">0</span>     <span class="number">3</span>     <span class="number">6</span>   Class java/lang/Exception</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¼‚å¸¸è¡¨ä¸­åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªå¼‚å¸¸å¤„ç†è€…(Exception Handler)çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åŒ…å«å¦‚ä¸‹</p><ul><li><strong>from</strong> å¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„èµ·å§‹ç‚¹</li><li><strong>to</strong>èƒ½å‘ç”Ÿå¼‚å¸¸çš„ç»“æŸç‚¹</li><li><strong>target</strong> ä¸Šè¿°fromå’Œtoä¹‹å‰å‘ç”Ÿå¼‚å¸¸åçš„å¼‚å¸¸å¤„ç†è€…çš„ä½ç½®</li><li><strong>type</strong> å¼‚å¸¸å¤„ç†è€…å¤„ç†çš„å¼‚å¸¸çš„ç±»ä¿¡æ¯</li></ul><h3 id="1-5-åå°„">1.5 åå°„</h3><h4 id="ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ">ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</h4><p>JAVAåå°„æœºåˆ¶æ˜¯åœ¨<strong>è¿è¡ŒçŠ¶æ€</strong>ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤Ÿ<strong>çŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•</strong>ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œ<strong>éƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§</strong>ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p><p><a href="https://imgse.com/i/pkfCN0H"><img src="https://s21.ax1x.com/2024/07/08/pkfCN0H.md.png" alt="pkfCN0H.md.png"></a></p><h4 id="åå°„çš„ä½¿ç”¨ï¼Ÿ">åå°„çš„ä½¿ç”¨ï¼Ÿ</h4><p>åœ¨Javaä¸­ï¼ŒClassç±»ä¸java.lang.reflectç±»åº“ä¸€èµ·å¯¹åå°„æŠ€æœ¯è¿›è¡Œäº†å…¨åŠ›çš„æ”¯æŒã€‚åœ¨åå°„åŒ…ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ç±»ä¸»è¦æœ‰Constructorç±»è¡¨ç¤ºçš„æ˜¯Class å¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„æ„é€ æ–¹æ³•ï¼Œåˆ©ç”¨å®ƒå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºå¯¹è±¡ã€Fieldè¡¨ç¤ºClasså¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„æˆå‘˜å˜é‡ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹æˆå‘˜å˜é‡çš„å±æ€§å€¼(åŒ…å«private)ã€Methodè¡¨ç¤ºClasså¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„æˆå‘˜æ–¹æ³•ï¼Œé€šè¿‡å®ƒå¯ä»¥åŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•(åŒ…å«private)</p><ul><li>Classç±»å¯¹è±¡çš„è·å–</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">classTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// è·å–Classå¯¹è±¡çš„ä¸‰ç§æ–¹å¼</span></span><br><span class="line">        logger.info(<span class="string">&quot;æ ¹æ®ç±»å:  \t&quot;</span> + User.class);</span><br><span class="line">        logger.info(<span class="string">&quot;æ ¹æ®å¯¹è±¡:  \t&quot;</span> + <span class="keyword">new</span> <span class="title class_">User</span>().getClass());</span><br><span class="line">        logger.info(<span class="string">&quot;æ ¹æ®å…¨é™å®šç±»å:\t&quot;</span> + Class.forName(<span class="string">&quot;com.test.User&quot;</span>));</span><br><span class="line">        <span class="comment">// å¸¸ç”¨çš„æ–¹æ³•</span></span><br><span class="line">        logger.info(<span class="string">&quot;è·å–å…¨é™å®šç±»å:\t&quot;</span> + userClass.getName());</span><br><span class="line">        logger.info(<span class="string">&quot;è·å–ç±»å:\t&quot;</span> + userClass.getSimpleName());</span><br><span class="line">        logger.info(<span class="string">&quot;å®ä¾‹åŒ–:\t&quot;</span> + userClass.newInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>Constructorç±»åŠå…¶ç”¨æ³•</li><li>Fieldç±»åŠå…¶ç”¨æ³•</li><li>Methodç±»åŠå…¶ç”¨æ³•</li></ul><h4 id="getNameã€getCanonicalNameä¸getSimpleNameçš„åŒºåˆ«">getNameã€getCanonicalNameä¸getSimpleNameçš„åŒºåˆ«?</h4><ul><li>getSimpleNameï¼šåªè·å–ç±»å</li><li>getNameï¼šç±»çš„å…¨é™å®šåï¼Œjvmä¸­Classçš„è¡¨ç¤ºï¼Œå¯ä»¥ç”¨äºåŠ¨æ€åŠ è½½Classå¯¹è±¡ï¼Œä¾‹å¦‚Class.forNameã€‚</li><li>getCanonicalNameï¼šè¿”å›æ›´å®¹æ˜“ç†è§£çš„è¡¨ç¤ºï¼Œä¸»è¦ç”¨äºè¾“å‡ºï¼ˆtoStringï¼‰æˆ–logæ‰“å°ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å’ŒgetNameä¸€æ ·ï¼Œä½†æ˜¯åœ¨å†…éƒ¨ç±»ã€æ•°ç»„ç­‰ç±»å‹çš„è¡¨ç¤ºå½¢å¼å°±ä¸åŒäº†ã€‚</li></ul><h3 id="1-6-SPIæœºåˆ¶">1.6 SPIæœºåˆ¶</h3><h4 id="ä»€ä¹ˆæ˜¯SPIæœºåˆ¶ï¼Ÿ">ä»€ä¹ˆæ˜¯SPIæœºåˆ¶ï¼Ÿ</h4><p>SPIï¼ˆService Provider Interfaceï¼‰ï¼Œæ˜¯JDKå†…ç½®çš„ä¸€ç§ <strong>æœåŠ¡æä¾›å‘ç°æœºåˆ¶</strong>ï¼Œå¯ä»¥ç”¨æ¥<strong>å¯ç”¨æ¡†æ¶æ‰©å±•å’Œæ›¿æ¢ç»„ä»¶</strong>ï¼Œä¸»è¦æ˜¯è¢«æ¡†æ¶çš„å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œæ¯”å¦‚java.sql.Driveræ¥å£ï¼Œå…¶ä»–ä¸åŒå‚å•†å¯ä»¥é’ˆå¯¹åŒä¸€æ¥å£åšå‡ºä¸åŒçš„å®ç°ï¼ŒMySQLå’ŒPostgreSQLéƒ½æœ‰ä¸åŒçš„å®ç°æä¾›ç»™ç”¨æˆ·ï¼Œè€ŒJavaçš„SPIæœºåˆ¶å¯ä»¥ä¸ºæŸä¸ªæ¥å£å¯»æ‰¾æœåŠ¡å®ç°ã€‚Javaä¸­SPIæœºåˆ¶ä¸»è¦æ€æƒ³æ˜¯å°†è£…é…çš„æ§åˆ¶æƒç§»åˆ°ç¨‹åºä¹‹å¤–ï¼Œåœ¨æ¨¡å—åŒ–è®¾è®¡ä¸­è¿™ä¸ªæœºåˆ¶å°¤å…¶é‡è¦ï¼Œå…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯ <strong>è§£è€¦</strong>ã€‚</p><p><a href="https://imgse.com/i/pkfCU7d"><img src="https://s21.ax1x.com/2024/07/08/pkfCU7d.md.png" alt="pkfCU7d.md.png"></a></p><p>å½“æœåŠ¡çš„æä¾›è€…æä¾›äº†ä¸€ç§æ¥å£çš„å®ç°ä¹‹åï¼Œéœ€è¦åœ¨classpathä¸‹çš„<code>META-INF/services/</code>ç›®å½•é‡Œåˆ›å»ºä¸€ä¸ªä»¥æœåŠ¡æ¥å£å‘½åçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹å°±æ˜¯è¿™ä¸ªæ¥å£çš„å…·ä½“çš„å®ç°ç±»ã€‚å½“å…¶ä»–çš„ç¨‹åºéœ€è¦è¿™ä¸ªæœåŠ¡çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡æŸ¥æ‰¾è¿™ä¸ªjaråŒ…ï¼ˆä¸€èˆ¬éƒ½æ˜¯ä»¥jaråŒ…åšä¾èµ–ï¼‰çš„<code>META-INF/services/</code>ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­æœ‰æ¥å£çš„å…·ä½“å®ç°ç±»åï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªç±»åè¿›è¡ŒåŠ è½½å®ä¾‹åŒ–ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥æœåŠ¡äº†ã€‚JDKä¸­æŸ¥æ‰¾æœåŠ¡çš„å®ç°çš„å·¥å…·ç±»æ˜¯ï¼š<code>java.util.ServiceLoader</code>ã€‚</p><h4 id="SPIæœºåˆ¶çš„åº”ç”¨ï¼Ÿ">SPIæœºåˆ¶çš„åº”ç”¨ï¼Ÿ</h4><ul><li>SPIæœºåˆ¶ - JDBC DriverManager</li></ul><p>åœ¨JDBC4.0ä¹‹å‰ï¼Œæˆ‘ä»¬å¼€å‘æœ‰è¿æ¥æ•°æ®åº“çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šç”¨Class.forName(â€œcom.mysql.jdbc.Driverâ€)è¿™å¥å…ˆåŠ è½½æ•°æ®åº“ç›¸å…³çš„é©±åŠ¨ï¼Œç„¶åå†è¿›è¡Œè·å–è¿æ¥ç­‰çš„æ“ä½œã€‚<strong>è€ŒJDBC4.0ä¹‹åä¸éœ€è¦ç”¨Class.forName(â€œcom.mysql.jdbc.Driverâ€)æ¥åŠ è½½é©±åŠ¨ï¼Œç›´æ¥è·å–è¿æ¥å°±å¯ä»¥äº†ï¼Œç°åœ¨è¿™ç§æ–¹å¼å°±æ˜¯ä½¿ç”¨äº†Javaçš„SPIæ‰©å±•æœºåˆ¶æ¥å®ç°</strong>ã€‚</p><ul><li><p>JDBCæ¥å£å®šä¹‰</p><p>é¦–å…ˆåœ¨javaä¸­å®šä¹‰äº†æ¥å£<code>java.sql.Driver</code>ï¼Œå¹¶æ²¡æœ‰å…·ä½“çš„å®ç°ï¼Œå…·ä½“çš„å®ç°éƒ½æ˜¯ç”±ä¸åŒå‚å•†æ¥æä¾›çš„ã€‚</p></li><li><p>mysqlå®ç°</p></li></ul><p>åœ¨mysqlçš„jaråŒ…<code>mysql-connector-java-6.0.6.jar</code>ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°<code>META-INF/services</code>ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªåå­—ä¸º<code>java.sql.Driver</code>çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯<code>com.mysql.cj.jdbc.Driver</code>ï¼Œè¿™é‡Œé¢çš„å†…å®¹å°±æ˜¯é’ˆå¯¹Javaä¸­å®šä¹‰çš„æ¥å£çš„å®ç°ã€‚</p><ul><li>postgresqlå®ç°</li></ul><p>åŒæ ·åœ¨postgresqlçš„jaråŒ…<code>postgresql-42.0.0.jar</code>ä¸­ï¼Œä¹Ÿå¯ä»¥æ‰¾åˆ°åŒæ ·çš„é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯<code>org.postgresql.Driver</code>ï¼Œè¿™æ˜¯postgresqlå¯¹Javaçš„<code>java.sql.Driver</code>çš„å®ç°ã€‚</p><ul><li>ä½¿ç”¨æ–¹æ³•</li></ul><p>ä¸Šé¢è¯´äº†ï¼Œç°åœ¨ä½¿ç”¨SPIæ‰©å±•æ¥åŠ è½½å…·ä½“çš„é©±åŠ¨ï¼Œæˆ‘ä»¬åœ¨Javaä¸­å†™è¿æ¥æ•°æ®åº“çš„ä»£ç çš„æ—¶å€™ï¼Œä¸éœ€è¦å†ä½¿ç”¨<code>Class.forName(&quot;com.mysql.jdbc.Driver&quot;)</code>æ¥åŠ è½½é©±åŠ¨äº†ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:xxxx://xxxx:xxxx/xxxx&quot;</span>;</span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url,username,password);</span><br><span class="line">.....</span><br></pre></td></tr></table></figure><h4 id="SPIæœºåˆ¶çš„ç®€å•ç¤ºä¾‹ï¼Ÿ">SPIæœºåˆ¶çš„ç®€å•ç¤ºä¾‹ï¼Ÿ</h4><p>æˆ‘ä»¬ç°åœ¨éœ€è¦ä½¿ç”¨ä¸€ä¸ªå†…å®¹æœç´¢æ¥å£ï¼Œæœç´¢çš„å®ç°å¯èƒ½æ˜¯åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„æœç´¢ï¼Œä¹Ÿå¯èƒ½æ˜¯åŸºäºæ•°æ®åº“çš„æœç´¢ã€‚</p><ul><li>å…ˆå®šä¹‰å¥½æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Search</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">searchDoc</span><span class="params">(String keyword)</span>;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ–‡ä»¶æœç´¢å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileSearch</span> <span class="keyword">implements</span> <span class="title class_">Search</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">searchDoc</span><span class="params">(String keyword)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–‡ä»¶æœç´¢ &quot;</span>+keyword);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®åº“æœç´¢å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DatabaseSearch</span> <span class="keyword">implements</span> <span class="title class_">Search</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">searchDoc</span><span class="params">(String keyword)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ•°æ®æœç´¢ &quot;</span>+keyword);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>resources æ¥ä¸‹æ¥å¯ä»¥åœ¨resourcesä¸‹æ–°å»ºMETA-INF/services/ç›®å½•ï¼Œç„¶åæ–°å»ºæ¥å£å…¨é™å®šåçš„æ–‡ä»¶ï¼š<code>com.cainiao.ys.spi.learn.Search</code>ï¼Œé‡Œé¢åŠ ä¸Šæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å®ç°ç±»</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.cainiao.ys.spi.learn.FileSearch</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestCase</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        ServiceLoader&lt;Search&gt; s = ServiceLoader.load(Search.class);</span><br><span class="line">        Iterator&lt;Search&gt; iterator = s.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">           <span class="type">Search</span> <span class="variable">search</span> <span class="operator">=</span>  iterator.next();</span><br><span class="line">           search.searchDoc(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœï¼šæ–‡ä»¶æœç´¢ hello world</p><p>å¦‚æœåœ¨<code>com.cainiao.ys.spi.learn.Search</code>æ–‡ä»¶é‡Œå†™ä¸Šä¸¤ä¸ªå®ç°ç±»ï¼Œé‚£æœ€åçš„è¾“å‡ºç»“æœå°±æ˜¯ä¸¤è¡Œäº†ã€‚</p><p>è¿™å°±æ˜¯å› ä¸º<code>ServiceLoader.load(Search.class)</code>åœ¨åŠ è½½æŸæ¥å£æ—¶ï¼Œä¼šå»<code>META-INF/services</code>ä¸‹æ‰¾æ¥å£çš„å…¨é™å®šåæ–‡ä»¶ï¼Œå†æ ¹æ®é‡Œé¢çš„å†…å®¹åŠ è½½ç›¸åº”çš„å®ç°ç±»ã€‚</p><p>è¿™å°±æ˜¯spiçš„æ€æƒ³ï¼Œæ¥å£çš„å®ç°ç”±providerå®ç°ï¼Œprovideråªç”¨åœ¨æäº¤çš„jaråŒ…é‡Œçš„<code>META-INF/services</code>ä¸‹æ ¹æ®å¹³å°å®šä¹‰çš„æ¥å£æ–°å»ºæ–‡ä»¶ï¼Œå¹¶æ·»åŠ è¿›ç›¸åº”çš„å®ç°ç±»å†…å®¹å°±å¥½ã€‚</p><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">javaå…¨æ ˆçŸ¥è¯†ä½“ç³»,è¿™ç¯‡æ–‡ç« ä¸»è¦äº†è§£javaå…¨æ ˆçŸ¥è¯†ç‚¹çš„é—®é¢˜æ€»ç»“,è¿™ä¸€ç¯‡ä¸»è¦äº†è§£javaçš„åŸºç¡€çŸ¥è¯†</summary>
    
    
    
    <category term="java" scheme="https://liweierzzz.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="çŸ¥è¯†ç‚¹æ€»ç»“" scheme="https://liweierzzz.github.io/tags/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>hexoå¸¸ç”¨çš„æŒ‡ä»¤</title>
    <link href="https://liweierzzz.github.io/posts/982fc2c9.html"/>
    <id>https://liweierzzz.github.io/posts/982fc2c9.html</id>
    <published>2024-07-07T08:14:03.000Z</published>
    <updated>2024-07-10T11:27:24.145Z</updated>
    
    <content type="html"><![CDATA[<h1>hexoå¸¸ç”¨å‘½ä»¤</h1><p>æˆ‘ä¸€èˆ¬æ¥è¯´å°±ç»å¸¸ç”¨çš„å°±æ˜¯</p><ul><li>hexo clean &amp;&amp; hexo generate &amp;&amp; hexo s</li><li>hexo d éƒ¨ç½²ä¸Šçº¿</li></ul><h2 id="1-æ–‡ç« çš„ä¹¦å†™">1. æ–‡ç« çš„ä¹¦å†™</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new [layout] &lt;<span class="built_in">title</span>&gt;</span><br></pre></td></tr></table></figure><p>eg: <code>hexo new &quot;post title with whitespace&quot;</code> å…¶ä¸­ layoutä¸º_config.ymlä¸­çš„é»˜è®¤å‚æ•°å€¼ã€‚</p><ul><li><code>-p --path</code> è‡ªå®šä¹‰æ–°æ–‡ç« </li><li><code>-r --replace</code> å­˜åœ¨åŒåæ–‡ç« ï¼Œæ›¿æ¢</li><li><code>-s --slug</code> æ–‡ç« çš„slugï¼Œä½œä¸ºæ–°æ–‡ç« çš„æ–‡ä»¶åå’Œå‘å¸ƒåçš„URL</li></ul><h2 id="2-ç”Ÿæˆé™æ€æ–‡ä»¶">2. ç”Ÿæˆé™æ€æ–‡ä»¶</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">generate</span>` æˆ– `hexo g</span><br></pre></td></tr></table></figure><ul><li><code>-d æˆ–--deploy</code> æ–‡ä»¶ç”Ÿæˆåéƒ¨ç½²ç½‘ç«™</li><li><code>-w æˆ–--watch</code> ç›‘è§†æ–‡ä»¶å˜åŠ¨</li><li><code>-b æˆ–--bail</code> ç”Ÿæˆè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸åˆ™æŠ›å‡ºã€‚</li><li><code>-f æˆ–--force</code> å¼ºåˆ¶é‡æ–°ç”Ÿæˆæ–‡ä»¶</li><li><code>-c æˆ–--concurrency</code> æœ€å¤§åŒæ—¶ç”Ÿæˆæ–‡ä»¶æ•°é‡ï¼Œé»˜è®¤æ— é™åˆ¶ã€‚</li></ul><h2 id="3-å‘å¸ƒè‰ç¨¿">3. å‘å¸ƒè‰ç¨¿</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo publish [layout] <span class="tag">&lt;<span class="name">filename</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-å¯åŠ¨æœåŠ¡å™¨">4.å¯åŠ¨æœåŠ¡å™¨</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server<span class="string">` å¯åŠ¨æœåŠ¡å™¨ï¼Œctrl+c ç»“æŸï¼Œé»˜è®¤åœ°å€ä¸ºï¼š`</span>http:<span class="comment">//localhost:4000/</span></span><br></pre></td></tr></table></figure><h2 id="5-éƒ¨ç½²ç½‘ç«™">5.éƒ¨ç½²ç½‘ç«™</h2><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy` æˆ–`hexo d</span><br></pre></td></tr></table></figure><ul><li><code>-g æˆ–--generate</code> éƒ¨ç½²ä¹‹å‰å†™æˆé™æ€æ–‡ä»¶</li></ul><h2 id="6-æ¸²æŸ“æ–‡ä»¶">6.æ¸²æŸ“æ–‡ä»¶</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo</span> render &lt;file1&gt;<span class="meta"> [file2]</span></span><br></pre></td></tr></table></figure><ul><li><code>-oæˆ–--output</code> è®¾ç½®è¾“å‡ºè·¯å¾„</li></ul><h2 id="7-æ¸…é™¤ç¼“å­˜æ–‡ä»¶">7. æ¸…é™¤ç¼“å­˜æ–‡ä»¶</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br></pre></td></tr></table></figure><h2 id="8-åˆ—å‡ºç½‘ç«™èµ„æ–™">8. åˆ—å‡ºç½‘ç«™èµ„æ–™</h2><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">hexo</span> list &lt;<span class="keyword">type</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="9-æ˜¾ç¤ºè‰ç¨¿">9. æ˜¾ç¤ºè‰ç¨¿</h2><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="comment">--deaft</span></span><br></pre></td></tr></table></figure><h2 id="10-è‡ªå®šä¹‰å½“å‰å·¥ä½œç›®å½•">10. è‡ªå®šä¹‰å½“å‰å·¥ä½œç›®å½•</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="attr">--cwd</span> /path/<span class="selector-tag">to</span>/cwd</span><br></pre></td></tr></table></figure><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬æ–‡æ±‡æ€»hexoä¸€èˆ¬ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</summary>
    
    
    
    <category term="ç¼–ç¨‹ç»éªŒ" scheme="https://liweierzzz.github.io/categories/%E7%BC%96%E7%A8%8B%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="ç»éªŒåˆ†äº«" scheme="https://liweierzzz.github.io/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/"/>
    
    <category term="hexo" scheme="https://liweierzzz.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</title>
    <link href="https://liweierzzz.github.io/posts/2013454d.html"/>
    <id>https://liweierzzz.github.io/posts/2013454d.html</id>
    <published>2024-07-03T10:19:03.000Z</published>
    <updated>2024-07-04T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1>1.Markdownè¯­æ³•è‡ªå¸¦æ ¼å¼</h1><div class="note info flat"><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdownè¯­æ³•å›¾æ–‡å…¨é¢è¯¦è§£(10åˆ†é’Ÿå­¦ä¼š)</a></p></div><div class="note warning flat"><p>æ³¨æ„ï¼šæ­¤é¡µé¢å¶å°”ä¼šå­˜åœ¨CSSå†²çªé—®é¢˜!</p></div><h2 id="1-1-ä»£ç å—">1.1 ä»£ç å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-å¤šçº§æ ‡é¢˜">1.2 å¤šçº§æ ‡é¢˜</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>è§æœ¬æ–‡ç« æ ‡é¢˜!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-æ–‡å­—æ ·å¼">1.3 æ–‡å­—æ ·å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>ä¸‹åˆ’çº¿æ¼”ç¤º<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="strong">**åŠ ç²—**</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="emphasis">*æ–œä½“*</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬<span class="code">`é«˜äº®`</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬~~åˆ é™¤~~çº¿æ¼”ç¤º</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5å·å­—<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;é»‘ä½“&quot;</span>&gt;</span></span>é»‘ä½“<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>è“è‰²<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p><u>ä¸‹åˆ’çº¿æ¼”ç¤º</u></p><p>æ–‡å­—<strong>åŠ ç²—</strong>æ¼”ç¤º</p><p>æ–‡å­—<em>æ–œä½“</em>æ¼”ç¤º</p><p>æ–‡æœ¬<code>é«˜äº®</code>æ¼”ç¤º</p><p>æ–‡æœ¬<s>åˆ é™¤</s>çº¿æ¼”ç¤º</p><p><font size = 5>5å·å­—</font><br><font face="é»‘ä½“">é»‘ä½“</font><br><font color=blue>è“è‰²</font></p><table><tr><td bgcolor=MistyRose>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>ä¸Šè¿°è¦ç‚¹å¯å‚è€ƒ:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">ã€Markdownè¯­æ³•ã€‘å­—ä½“é¢œè‰²å¤§å°åŠæ–‡å­—åº•è‰²è®¾ç½®</a></p></div><h2 id="1-4-å¼•ç”¨">1.4 å¼•ç”¨</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; äºŒçº§å¼•ç”¨æ¼”ç¤º</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;å¤–é”®</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;äº‹åŠ¡</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**è¡Œçº§é”**</span>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><blockquote><p>Java<br>äºŒçº§å¼•ç”¨æ¼”ç¤º<br>MySQL</p><blockquote><p>å¤–é”®</p><p>äº‹åŠ¡</p><p><strong>è¡Œçº§é”</strong>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</p></blockquote><p>â€¦</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-åˆ†å‰²çº¿">1.5 åˆ†å‰²çº¿</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-åˆ—è¡¨-è·Ÿç©ºæ ¼éƒ½å¯ä»¥">1.6 åˆ—è¡¨(*,+,-è·Ÿç©ºæ ¼éƒ½å¯ä»¥)</h2><h3 id="1-6-1-æ— åºåˆ—è¡¨">1.6.1 æ— åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-æœ‰åºåˆ—è¡¨">1.6.2 æœ‰åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æ³¨æ„åé¢æœ‰ç©ºæ ¼</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li></li><li></li><li></li><li></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-å›¾ç‰‡">1.7 å›¾ç‰‡</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æœ¬åœ°å›¾ç‰‡</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾ç‰‡&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># åœ¨çº¿å›¾ç‰‡</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>æœ¬åœ°å›¾ç‰‡:<br><img src="/assets/pusheencode.webp" alt="ç¤ºä¾‹å›¾ç‰‡" style="zoom:50%;" /><br>åœ¨çº¿å›¾ç‰‡:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-è¡¨æ ¼">1.8 è¡¨æ ¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| é¡¹ç›®æ ‡å· | èµ„é‡‘     | å¤‡æ³¨ |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100ï¼Œ000 | æ—    |</span><br><span class="line">| 2        | 200ï¼Œ000 | æ—    |</span><br><span class="line">| 3        | 300,600  | é‡è¦ |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th>é¡¹ç›®æ ‡å·</th><th>èµ„é‡‘</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>1</td><td>100ï¼Œ000</td><td>æ— </td></tr><tr><td>2</td><td>200ï¼Œ000</td><td>æ— </td></tr><tr><td>3</td><td>300,600</td><td>é‡è¦</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-å…¬å¼">1.9 å…¬å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>$$<br>\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>2.Butterflyå¤–æŒ‚æ ‡ç­¾</h1><div class="note info flat"><p>è¿™éƒ¨åˆ†å‚è€ƒå®‰çŸ¥é±¼:<a href="https://anzhiy.cn/posts/7d58.html">åŸºäºButterflyçš„å¤–æŒ‚æ ‡ç­¾å¼•å…¥</a></p></div><h2 id="2-1-è¡Œå†…æ–‡æœ¬æ ·å¼-text">2.1 è¡Œå†…æ–‡æœ¬æ ·å¼ text</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% emp æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% wavy æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% del æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% kbd æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% psw æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å¸¦ &#123;% u ä¸‹åˆ’çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">2.</span> å¸¦ &#123;% emp ç€é‡å· %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">3.</span> å¸¦ &#123;% wavy æ³¢æµªçº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">4.</span> å¸¦ &#123;% del åˆ é™¤çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">5.</span> é”®ç›˜æ ·å¼çš„æ–‡æœ¬ &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š&#123;% psw è¿™é‡Œæ²¡æœ‰éªŒè¯ç  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><ol><li>å¸¦ <u>ä¸‹åˆ’çº¿</u> çš„æ–‡æœ¬</li><li>å¸¦ <emp>ç€é‡å·</emp> çš„æ–‡æœ¬</li><li>å¸¦ <wavy>æ³¢æµªçº¿</wavy> çš„æ–‡æœ¬</li><li>å¸¦ <del>åˆ é™¤çº¿</del> çš„æ–‡æœ¬</li><li>é”®ç›˜æ ·å¼çš„æ–‡æœ¬ <kbd>command</kbd> + <kbd>D</kbd></li><li>å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š<psw>è¿™é‡Œæ²¡æœ‰éªŒè¯ç </psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-è¡Œå†…æ–‡æœ¬-span">2.2 è¡Œå†…æ–‡æœ¬ span</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% span red, çº¢è‰² %&#125;ã€&#123;% span yellow, é»„è‰² %&#125;ã€&#123;% span green, ç»¿è‰² %&#125;ã€&#123;% span cyan, é’è‰² %&#125;ã€&#123;% span blue, è“è‰² %&#125;ã€&#123;% span gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<span class='p red'>çº¢è‰²</span>ã€<span class='p yellow'>é»„è‰²</span>ã€<span class='p green'>ç»¿è‰²</span>ã€<span class='p cyan'>é’è‰²</span>ã€<span class='p blue'>è“è‰²</span>ã€<span class='p gray'>ç°è‰²</span>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-æ®µè½æ–‡æœ¬-p">2.3 æ®µè½æ–‡æœ¬ p</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% p red, çº¢è‰² %&#125;ã€&#123;% p yellow, é»„è‰² %&#125;ã€&#123;% p green, ç»¿è‰² %&#125;ã€&#123;% p cyan, é’è‰² %&#125;ã€&#123;% p blue, è“è‰² %&#125;ã€&#123;% p gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<p class='p red'>çº¢è‰²</p>ã€<p class='p yellow'>é»„è‰²</p>ã€<p class='p green'>ç»¿è‰²</p>ã€<p class='p cyan'>é’è‰²</p>ã€<p class='p blue'>è“è‰²</p>ã€<p class='p gray'>ç°è‰²</p>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</li></ul><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-å¼•ç”¨note">2.4 å¼•ç”¨note</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">é€šç”¨é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">è¯­æ³•æ ¼å¼</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -5">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># è‡ªå¸¦icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># å¤–éƒ¨icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.è‡ªå¸¦icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / primary / success / info / warning / danger ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘ä¸æ˜¾ç¤º icon</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><p>2.å¤–éƒ¨icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / blue / pink / red / purple / orange / green ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯é…ç½®è‡ªå®šä¹‰ icon (åªæ”¯æŒ fontawesome å›¾æ ‡, ä¹Ÿå¯ä»¥é…ç½® no-icon )</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -5"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note simple"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default simple"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary simple"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success simple"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info simple"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning simple"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger simple"><p>danger æç¤ºå—æ ‡ç­¾</p></div>2.`modern`æ ·å¼<div class="note modern"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default modern"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary modern"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success modern"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info modern"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning modern"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger modern"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note disabled"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default disabled"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary disabled"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success disabled"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info disabled"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning disabled"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger disabled"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default no-icon flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary no-icon flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success no-icon flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info no-icon flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning no-icon flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger no-icon flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>2.<code>modern</code>æ ·å¼</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue no-icon flat"><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink no-icon flat"><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red no-icon flat"><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple no-icon flat"><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green no-icon flat"><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-ä¸Šæ ‡æ ‡ç­¾-tip">2.5 ä¸Šæ ‡æ ‡ç­¾ tip</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>è‡ªå®šä¹‰å›¾æ ‡</code>: æ”¯æŒfontawesomeã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;è‡ªå®šä¹‰font awesomeå›¾æ ‡&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>è‡ªå®šä¹‰font awesomeå›¾æ ‡</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-åŠ¨æ€æ ‡ç­¾-anima">2.6 åŠ¨æ€æ ‡ç­¾ anima</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><div class="note info flat"><ol><li>å°†æ‰€éœ€çš„CSSç±»æ·»åŠ åˆ°å›¾æ ‡ï¼ˆæˆ–DOMä¸­çš„ä»»ä½•å…ƒç´ ï¼‰ã€‚</li><li>å¯¹äºçˆ¶çº§æ‚¬åœæ ·å¼ï¼Œéœ€è¦ç»™ç›®æ ‡å…ƒç´ æ·»åŠ æŒ‡å®šCSSç±»ï¼ŒåŒæ—¶è¿˜è¦ç»™ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ æ·»åŠ CSSç±»<code>faa-parent animated-hover</code>ã€‚ï¼ˆè¯¦æƒ…è§ç¤ºä¾‹åŠç¤ºä¾‹æºç ï¼‰<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>å¯ä»¥é€šè¿‡ç»™ç›®æ ‡å…ƒç´ æ·»åŠ CSSç±»<code>faa-fast</code>æˆ–<code>faa-slow</code>æ¥æ§åˆ¶åŠ¨ç”»å¿«æ…¢ã€‚</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-å¤é€‰åˆ—è¡¨-checkbox">2.7 å¤é€‰åˆ—è¡¨ checkbox</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: plus, minus, times</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% checkbox checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% checkbox red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% checkbox green checked, ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, é’è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox blue checked, è“è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, å¢åŠ  %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, å‡å°‘ %&#125;</span><br><span class="line">&#123;% checkbox times red checked, å‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="checkbox" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>ç»¿è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>é»„è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>é’è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>è“è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>å¢åŠ </p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>å‡å°‘</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>å‰</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-å•é€‰åˆ—è¡¨-radio">2.8 å•é€‰åˆ—è¡¨ radio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% radio checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% radio red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% radio green, ç»¿è‰² %&#125;</span><br><span class="line">&#123;% radio yellow, é»„è‰² %&#125;</span><br><span class="line">&#123;% radio cyan, é’è‰² %&#125;</span><br><span class="line">&#123;% radio blue, è“è‰² %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="radio" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="radio" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green'><input type="radio" />            <p>ç»¿è‰²</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>é»„è‰²</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>é’è‰²</p>            </div><div class='checkbox blue'><input type="radio" />            <p>è“è‰²</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-æ—¶é—´è½´-timeline">2.9 æ—¶é—´è½´ timeline</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰[,color] %&#125;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>title</code>:æ ‡é¢˜/æ—¶é—´çº¿</li><li><code>color</code>:<code>timeline</code>é¢œè‰²:default(ç•™ç©º) / blue / pink / red / purple / orange / green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´è½´æ ·å¼,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å¦‚æœæœ‰ <span class="code">`hexo-lazyload-image`</span> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <span class="code">`lazyload.isSPA: true`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> 2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <span class="code">`use_cdn: true`</span> åˆ™éœ€è¦åˆ é™¤ã€‚</span><br><span class="line"><span class="bullet">3.</span> 2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</span><br><span class="line"><span class="bullet">4.</span> 2.x ç‰ˆæœ¬çš„ç½®é¡¶ <span class="code">`top: true`</span> æ”¹ä¸ºäº† <span class="code">`pin: true`</span>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <span class="code">`layout: page`</span> çš„é¡µé¢ã€‚</span><br><span class="line"><span class="bullet">5.</span> å¦‚æœä½¿ç”¨äº† <span class="code">`hexo-offline`</span> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å…¨å±€æœç´¢ <span class="code">`seotitle`</span> å¹¶æ›¿æ¢ä¸º <span class="code">`seo_title`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<span class="code">`group: group_name`</span> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <span class="code">`group_name`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <span class="code">`short_title`</span> å…¶æ¬¡æ˜¯ <span class="code">`title`</span>ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>æ—¶é—´è½´æ ·å¼</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>å¦‚æœæœ‰ <code>hexo-lazyload-image</code> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <code>lazyload.isSPA: true</code>ã€‚</li><li>2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <code>use_cdn: true</code> åˆ™éœ€è¦åˆ é™¤ã€‚</li><li>2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</li><li>2.x ç‰ˆæœ¬çš„ç½®é¡¶ <code>top: true</code> æ”¹ä¸ºäº† <code>pin: true</code>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <code>layout: page</code> çš„é¡µé¢ã€‚</li><li>å¦‚æœä½¿ç”¨äº† <code>hexo-offline</code> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>å…¨å±€æœç´¢ <code>seotitle</code> å¹¶æ›¿æ¢ä¸º <code>seo_title</code>ã€‚</li><li>group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<code>group: group_name</code> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <code>group_name</code>ã€‚</li><li>group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <code>short_title</code> å…¶æ¬¡æ˜¯ <code>title</code>ã€‚</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-é“¾æ¥å¡ç‰‡-link">2.10 é“¾æ¥å¡ç‰‡ link</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡é“¾æ¥ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link ç³–æœå±‹æ•™ç¨‹è´´, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="tag link"><a class="link-card" title="ç³–æœå±‹æ•™ç¨‹è´´" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">ç³–æœå±‹æ•™ç¨‹è´´</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-æŒ‰é’®-btns">2.11 æŒ‰é’® btns</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns æ ·å¼å‚æ•° %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>åœ†è§’æ ·å¼ï¼šrounded, circle</li><li>å¢åŠ æ–‡å­—æ ·å¼ï¼šå¯ä»¥åœ¨å®¹å™¨å†…å¢åŠ  <code>&lt;b&gt;</code>æ ‡é¢˜<code>&lt;/b&gt;</code>å’Œ<code>&lt;p&gt;</code>æè¿°æ–‡å­—<code>&lt;/p&gt;</code></li><li>å¸ƒå±€æ–¹å¼ï¼š<br>é»˜è®¤ä¸ºè‡ªåŠ¨å®½åº¦ï¼Œé€‚åˆè§†é‡å†…åªæœ‰ä¸€ä¸¤ä¸ªçš„æƒ…å†µã€‚</li></ol><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>wide</td><td>å®½ä¸€ç‚¹çš„æŒ‰é’®</td></tr><tr><td>fill</td><td>å¡«å……å¸ƒå±€ï¼Œè‡ªåŠ¨é“ºæ»¡è‡³å°‘ä¸€è¡Œï¼Œå¤šäº†ä¼šæ¢è¡Œ</td></tr><tr><td>center</td><td>å±…ä¸­ï¼ŒæŒ‰é’®ä¹‹é—´æ˜¯å›ºå®šé—´è·</td></tr><tr><td>around</td><td>å±…ä¸­åˆ†æ•£</td></tr><tr><td>grid2</td><td>ç­‰å®½æœ€å¤š2åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid3</td><td>ç­‰å®½æœ€å¤š3åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid4</td><td>ç­‰å®½æœ€å¤š4åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid5</td><td>ç­‰å®½æœ€å¤š5åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell ä¸‹è½½æºç , /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell æŸ¥çœ‹æ–‡æ¡£, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, ä¸“ä¸šç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, å…è´¹ç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®<div class="btns rounded grid5">            <a class="button" href='/' title='ä¸‹è½½æºç '><i class='fas fa-download'></i>ä¸‹è½½æºç </a><a class="button" href='/' title='æŸ¥çœ‹æ–‡æ¡£'><i class='fas fa-book-open'></i>æŸ¥çœ‹æ–‡æ¡£</a>          </div>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p red'>ä¸“ä¸šç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p green'>å…è´¹ç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-githubå¡ç‰‡-ghcard">2.12 githubå¡ç‰‡ ghcard</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard ç”¨æˆ·å, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% ghcard ç”¨æˆ·å/ä»“åº“, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>ä½¿ç”¨<code>,</code>åˆ†å‰²å„ä¸ªå‚æ•°ã€‚å†™æ³•ä¸ºï¼š<code>å‚æ•°å=å‚æ•°å€¼</code><br>ä»¥ä¸‹åªå†™å‡ ä¸ªå¸¸ç”¨å‚æ•°å€¼ã€‚</p><table><thead><tr><th><strong>å‚æ•°å</strong></th><th>å–å€¼</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>éšè—æŒ‡å®šç»Ÿè®¡</td></tr><tr><td>count_private</td><td>true</td><td>å°†ç§äººé¡¹ç›®è´¡çŒ®æ·»åŠ åˆ°æ€»æäº¤è®¡æ•°ä¸­</td></tr><tr><td>show_icons</td><td>true</td><td>æ˜¾ç¤ºå›¾æ ‡</td></tr><tr><td>theme</td><td>æŸ¥é˜…:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>ä¸»é¢˜</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-githubå¾½æ ‡-ghbdage">2.13 githubå¾½æ ‡ ghbdage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>left</code>ï¼šå¾½æ ‡å·¦è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ã€‚</li><li><code>right</code>: å¾½æ ‡å³è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ï¼Œ</li><li><code>logo</code>ï¼šå¾½æ ‡å›¾æ ‡ï¼Œå›¾æ ‡åç§°è¯¦è§<a href="https://simpleicons.org/">simpleicons</a>ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>color</code>ï¼šå¾½æ ‡å³è¾¹çš„é¢œè‰²ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>link</code>ï¼šæŒ‡å‘çš„é“¾æ¥ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>title</code>ï¼šå¾½æ ‡çš„é¢å¤–ä¿¡æ¯ï¼Œå¯é€‰å‚æ•°ã€‚ä¸»è¦ç”¨äºä¼˜åŒ–SEOï¼Œä½†<code>object</code>æ ‡ç­¾ä¸ä¼šåƒ<code>a</code>æ ‡ç­¾ä¸€æ ·åœ¨é¼ æ ‡æ‚¬åœæ˜¾ç¤º<code>title</code>ä¿¡æ¯ã€‚</li><li><code>option</code>ï¼šè‡ªå®šä¹‰å‚æ•°ï¼Œæ”¯æŒ<a href="https://shields.io/">shields.io</a>çš„å…¨éƒ¨APIå‚æ•°æ”¯æŒï¼Œå…·ä½“å‚æ•°å¯ä»¥å‚çœ‹ä¸Šæ–‡ä¸­çš„æ‹“å±•å†™æ³•ç¤ºä¾‹ã€‚å½¢å¼ä¸º<code>name1=value2&amp;name2=value2</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-ç½‘ç«™å¡ç‰‡-sites">2.14 ç½‘ç«™å¡ç‰‡ sites</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=ç®€çº¦é£æ ¼ %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">ç®€çº¦é£æ ¼</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-è¡Œå†…å›¾ç‰‡-inlineimage">2.15 è¡Œå†…å›¾ç‰‡ inlineimage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage å›¾ç‰‡é“¾æ¥, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é«˜åº¦</code>ï¼šheight=20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; ä¸€æ®µè¯ã€‚</span><br><span class="line"></span><br><span class="line">è¿™åˆæ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; ä¸€æ®µè¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>è¿™æ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> ä¸€æ®µè¯ã€‚</p><p>è¿™åˆæ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> ä¸€æ®µè¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-å•å¼ å›¾ç‰‡-image">2.16 å•å¼ å›¾ç‰‡ image</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image é“¾æ¥, width=å®½åº¦ï¼ˆå¯é€‰ï¼‰, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰, alt=æè¿°ï¼ˆå¯é€‰ï¼‰, bg=å ä½é¢œè‰²ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>å›¾ç‰‡å®½åº¦é«˜åº¦ï¼šwidth=300px, height=32px</li><li>å›¾ç‰‡æè¿°ï¼šalt=å›¾ç‰‡æè¿°ï¼ˆbutterflyéœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼€å¯å›¾ç‰‡æè¿°ï¼‰</li><li>å ä½èƒŒæ™¯è‰²ï¼šbg=#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>2.æŒ‡å®šå®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.æ·»åŠ æè¿°ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>2..æŒ‡å®šå®½åº¦<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚" style="width:400px;"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ" style="width:400px;"/></div><span class="image-caption">ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-éŸ³é¢‘-audio">2.17 éŸ³é¢‘ audio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio éŸ³é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-è§†é¢‘-video">2.18 è§†é¢‘ video</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video è§†é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å¯¹é½æ–¹å‘</code>ï¼šleft, center, right</li><li><code>åˆ—æ•°</code>ï¼šé€—å·åé¢ç›´æ¥å†™åˆ—æ•°ï¼Œæ”¯æŒ 1 ï½ 4 åˆ—ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.100%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.100%å®½åº¦</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%å®½åº¦<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%å®½åº¦<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-ç›¸å†Œ-gallery">2.19 ç›¸å†Œ gallery</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown åœ–ç‰‡æ ¼å¼</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>gallerygroup ç›¸å†Œå›¾åº“</li></ul><table><thead><tr><th>å‚æ•°å</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>name</td><td>å›¾åº“åå­—</td></tr><tr><td>description</td><td>å›¾åº“æè¿°</td></tr><tr><td>link</td><td>é“¾æ¥åˆ°å¯¹åº”ç›¸å†Œçš„åœ°å€</td></tr><tr><td>img-url</td><td>å›¾åº“å°é¢</td></tr></tbody></table><ul><li><p>gallery ç›¸å†Œ</p><p>åŒºåˆ«äºæ—§ç‰ˆçš„Galleryç›¸å†Œ,æ–°çš„Galleryç›¸å†Œä¼šè‡ªåŠ¨æ ¹æ®å›¾ç‰‡é•¿åº¦è¿›è¡Œæ’ç‰ˆï¼Œä¹¦å†™ä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼Œä¸markdownæ ¼å¼ä¸€æ ·ã€‚å¯æ ¹æ®éœ€è¦æ’å…¥åˆ°ç›¸åº”çš„mdã€‚æ— éœ€å†è‡ªå·±é…ç½®é•¿å®½ã€‚<strong>å»ºè®®åœ¨ç²˜è´´æ—¶æ•…æ„ä½¿ç”¨é•¿çŸ­ã€å¤§å°ã€æ¨ªç«–ä¸ä¸€çš„å›¾ç‰‡</strong>ï¼Œä¼šæœ‰æ›´å¥½çš„æ•ˆæœã€‚ï¼ˆå°ºå¯¸å®Œå…¨ç›¸åŒçš„å›¾ç‰‡åªä¼šå¹³é“ºè¾“å‡ºï¼Œæ•ˆæœå¾ˆç³Ÿç³•ï¼‰</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹ &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam å“¦å’§å“‡gundamå“’ï¼ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§ &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>å“¦å’§å“‡gundamå“’ï¼</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery ç›¸å†Œ<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt=""><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt=""></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-æŠ˜å æ¡†-folding">2.20 æŠ˜å æ¡† folding</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜ %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab å‚æ•°é…ç½® --><ol><li><p><code>é¢œè‰²</code>ï¼šblue, cyan, green, yellow, red</p></li><li><p><code>çŠ¶æ€</code>ï¼šçŠ¶æ€å¡«å†™ open ä»£è¡¨é»˜è®¤æ‰“å¼€ã€‚</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† %&#125;</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125;</span><br><span class="line">å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, æŸ¥çœ‹åµŒå¥—æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><details class="folding-tag" ><summary> æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† </summary>              <div class='content'>              <p>è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</p>              </div>            </details><details class="folding-tag" green><summary> æŸ¥çœ‹ä»£ç æµ‹è¯• </summary>              <div class='content'>              <p>å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</p>              </div>            </details><details class="folding-tag" yellow><summary> æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯• </summary>              <div class='content'>              <details class="folding-tag" blue><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-åˆ†æ -tab">2.21 åˆ†æ  tab</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>Unique name :</p><ul><li><p>é€‰é¡¹å¡å—æ ‡ç­¾çš„å”¯ä¸€åç§°ï¼Œä¸å¸¦é€—å·ã€‚</p></li><li><p>å°†åœ¨#idä¸­ç”¨ä½œæ¯ä¸ªæ ‡ç­¾åŠå…¶ç´¢å¼•å·çš„å‰ç¼€ã€‚</p></li><li><p>å¦‚æœåç§°ä¸­åŒ…å«ç©ºæ ¼ï¼Œåˆ™å¯¹äºç”Ÿæˆ#idï¼Œæ‰€æœ‰ç©ºæ ¼å°†ç”±ç ´æŠ˜å·ä»£æ›¿ã€‚</p></li><li><p>ä»…å½“å‰å¸–å­/é¡µé¢çš„URLå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼</p></li></ul></li><li><p>[index]:</p><ul><li><p>æ´»åŠ¨é€‰é¡¹å¡çš„ç´¢å¼•å·ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šï¼Œå°†é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼ˆ1ï¼‰ã€‚</p></li><li><p>å¦‚æœindexä¸º-1ï¼Œåˆ™ä¸ä¼šé€‰æ‹©ä»»ä½•é€‰é¡¹å¡ã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>å½“å‰é€‰é¡¹å¡çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œåˆ™å¸¦æœ‰åˆ¶è¡¨ç¬¦ç´¢å¼•åç¼€çš„å”¯ä¸€åç§°å°†ç”¨ä½œåˆ¶è¡¨ç¬¦çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œä½†æŒ‡å®šäº†å›¾æ ‡ï¼Œåˆ™æ ‡é¢˜å°†ä¸ºç©ºã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesomeå›¾æ ‡åç§°ï¼ˆå…¨åï¼Œçœ‹èµ·æ¥åƒâ€œ fas fa-fontâ€ï¼‰</p></li><li><p>å¯ä»¥æŒ‡å®šå¸¦ç©ºæ ¼æˆ–ä¸å¸¦ç©ºæ ¼ï¼›</p></li><li><p>ä¾‹å¦‚â€™Tab caption @iconâ€™ å’Œ â€˜Tab caption@iconâ€™.</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab ç¬¬ä¸€ä¸ªTab --&gt;</span><br><span class="line"><span class="strong">**tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab ç‚¸å¼¹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**åå­—+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">ç¬¬ä¸€ä¸ªTab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>ç‚¸å¼¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>åå­—+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-è¯—è¯æ ‡ç­¾-poem">2.22 è¯—è¯æ ‡ç­¾ poem</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><ol><li><code>title</code>ï¼šè¯—è¯æ ‡é¢˜</li><li><code>author</code>ï¼šä½œè€…ï¼Œå¯ä»¥ä¸å†™</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem æ°´è°ƒæ­Œå¤´,è‹è½¼ %&#125;</span><br><span class="line">ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚</span><br><span class="line">æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚</span><br><span class="line">ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ</span><br><span class="line">æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚</span><br><span class="line">èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚</span><br><span class="line">ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ</span><br><span class="line">äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚</span><br><span class="line">ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class='poem'><div class='poem-title'>æ°´è°ƒæ­Œå¤´</div><div class='poem-author'>è‹è½¼</div><p>ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚<br>æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚<br>ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ<br>æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚<br>èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</p><p>è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚<br>ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ<br>äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚<br>ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-é˜¿é‡Œå›¾æ ‡-icon">2.23 é˜¿é‡Œå›¾æ ‡ icon</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>icon-xxxx</code>ï¼šè¡¨ç¤ºå›¾æ ‡<code>font-class</code>,å¯ä»¥åœ¨è‡ªå·±çš„é˜¿é‡ŒçŸ¢é‡å›¾æ ‡åº“é¡¹ç›®çš„<code>font-class</code>å¼•ç”¨æ–¹æ¡ˆå†…æŸ¥è¯¢å¹¶å¤åˆ¶ã€‚</li><li><code>font-size</code>ï¼šè¡¨ç¤ºå›¾æ ‡å¤§å°ï¼Œç›´æ¥å¡«å†™æ•°å­—å³å¯ï¼Œå•ä½ä¸º<code>em</code>ã€‚å›¾æ ‡å¤§å°é»˜è®¤å€¼ä¸º<code>1em</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-ç‰¹æ•ˆæ ‡ç­¾wow">2.24 ç‰¹æ•ˆæ ‡ç­¾wow</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">å†…å®¹</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>animate</code>: åŠ¨ç”»æ ·å¼ï¼Œæ•ˆæœè¯¦è§<a href="https://animate.style/">animate.csså‚è€ƒæ–‡æ¡£</a></li><li><code>duration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>delay</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>offset</code>: é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</li><li><code>iteration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶`5s`ï¼Œé‡å¤`10`æ¬¡ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ã€‚</p></div></div><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶<code>5s</code>ï¼Œé‡å¤<code>10</code>æ¬¡ã€‚</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-è¿›åº¦æ¡-progress">2.25  è¿›åº¦æ¡ progress</h2><div class="note info flat"><p>è¿›åº¦æ¡æ ‡ç­¾å‚è€ƒ<a href="https://rongbuqiu.com/jdt.html">æ²‚ä½°å­œçŒ«-ç»™HEXOæ–‡ç« æ·»åŠ å½©è‰²è¿›åº¦æ¡</a>ã€‚<br>æºæ ·å¼æå–è‡ª<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>ä¸»é¢˜ã€‚</p></div><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>width</code>: 0åˆ°100çš„é˜¿æ‹‰ä¼¯æ•°å­—</li><li><code>color</code>: é¢œè‰²ï¼Œå–å€¼æœ‰red,yellow,green,cyan,blue,gray</li><li><code>text</code>:è¿›åº¦æ¡ä¸Šçš„æ–‡å­—å†…å®¹</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 30 yellow è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 50 green è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 70 cyan è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 90 blue è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 100 gray è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-æ³¨é‡Š-notation">2.26 æ³¨é‡Š notation</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p><code>label</code>: æ³¨é‡Šè¯æ±‡</p></li><li><p><code>text</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯• ,å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><span class='nota' data-nota='å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ '>æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯•</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-æ°”æ³¡æ³¨é‡Š-bubble">2.27 æ°”æ³¡æ³¨é‡Š bubble</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>content</code>: æ³¨é‡Šè¯æ±‡</li><li><code>notation</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</li><li><code>background-color</code>: å¯é€‰ï¼Œæ°”æ³¡èƒŒæ™¯è‰²ã€‚é»˜è®¤ä¸ºâ€œ#71a4e3â€</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„&#123;% bubble å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨,&quot;ä¾‹å¦‚ h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;ï¼Œ&#123;% bubble flexå¸ƒå±€,&quot;Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸º&quot;å¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;,&quot;#ec5830&quot; %&#125;ï¼Œ&#123;% bubble transformå˜æ¢,&quot;transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚&quot;,&quot;#1db675&quot; %&#125;ï¼Œanimationçš„&#123;% bubble è´å¡å°”é€Ÿåº¦æ›²çº¿,&quot;è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹&quot;,&quot;#de4489&quot; %&#125;å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„&#123;% bubble clip-path,&quot;clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚&quot;,&quot;#868fd7&quot; %&#125;å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„<span class="bubble-content">å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">ä¾‹å¦‚ h1 + p {margin-top:50px;}</span></span>ï¼Œ<span class="bubble-content">flexå¸ƒå±€</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸ºå¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;</span></span>ï¼Œ<span class="bubble-content">transformå˜æ¢</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚</span></span>ï¼Œanimationçš„<span class="bubble-content">è´å¡å°”é€Ÿåº¦æ›²çº¿</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹</span></span>å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚</span></span>å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-å¼•ç”¨æ–‡çŒ®-reference">2.28 å¼•ç”¨æ–‡çŒ® reference</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>referto å¼•ç”¨ä¸Šæ ‡</p><ul><li><p><code>id</code>: ä¸Šæ ‡åºå·å†…å®¹ï¼Œéœ€ä¸referfromæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç°è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li></ul></li><li><p>referfrom å¼•ç”¨å‡ºå¤„</p><ul><li><p><code>id</code>: åºå·å†…å®¹ï¼Œéœ€ä¸refertoæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç° è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li><li><p><code>url</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®é“¾æ¥ï¼Œå¯çœç•¥</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27; %&#125;ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶&#123;% referto &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27; %&#125;ï¼ŒButterflyä¸»é¢˜&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">æœ¬é¡¹ç›®å‚è€ƒäº†Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27; %&#125;çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<span class="code">`[tag].js`</span>ï¼Œå¹¶é’ˆå¯¹<span class="code">`butterfly`</span>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<span class="code">`[tag].styl`</span>ã€‚åœ¨æ­¤é¸£è°¢<span class="code">`Volantis`</span>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚</span><br><span class="line">ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£&#123;% referto &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27; %&#125;</span><br><span class="line">Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexoä¸­æ–‡æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼ŒButterflyä¸»é¢˜<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><p>æœ¬é¡¹ç›®å‚è€ƒäº†Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<code>[tag].js</code>ï¼Œå¹¶é’ˆå¯¹<code>butterfly</code>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<code>[tag].styl</code>ã€‚åœ¨æ­¤é¸£è°¢<code>Volantis</code>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚<br>ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><br>Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexoä¸­æ–‡æ–‡æ¡£</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDFå±•ç¤º">2.29 PDFå±•ç¤º</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf æ–‡ä»¶è·¯å¾„ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ–‡ä»¶è·¯å¾„</code>: å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–è€…æ˜¯åœ¨çº¿é“¾æ¥</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.æœ¬åœ°æ–‡ä»¶:åœ¨mdæ–‡ä»¶è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶å¤¹ï¼Œå…¶å†…æ”¾pdfæ–‡ä»¶åä¸ºxxx.pdfçš„æ–‡ä»¶</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.åœ¨çº¿é“¾æ¥</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>2.åœ¨çº¿é“¾æ¥(è¦æ”¾åˆ°æœ€å¤–å±‚æ‰èƒ½èµ·ä½œç”¨)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-æ’ä»¶">2.30 Hexo-tag-map æ’ä»¶</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + æ ‡ç­¾å€¼ + ç»åº¦ + çº¬åº¦ + æ–‡æœ¬ + ç¼©æ”¾ç­‰çº§ + å®½ + é«˜ + é»˜è®¤å›¾å±‚ + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th style="text-align:center">åœ°å›¾å</th><th style="text-align:center">æ ‡ç­¾å€¼ &lt;å¿…å¡«&gt;</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">ç¼©æ”¾ç­‰çº§ (é»˜è®¤ 14)</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">é»˜è®¤å›¾å±‚ (é»˜è®¤ 1)</th></tr></thead><tbody><tr><td style="text-align:center">æ··åˆåœ°å›¾</td><td style="text-align:center">map</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~7</td></tr><tr><td style="text-align:center">è°·æ­Œåœ°å›¾</td><td style="text-align:center">googleMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~20</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">é«˜å¾·åœ°å›¾</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">ç™¾åº¦åœ°å›¾</td><td style="text-align:center">baiduMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 4~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~2</td></tr><tr><td style="text-align:center">Geoq åœ°å›¾</td><td style="text-align:center">geoqMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~5</td></tr><tr><td style="text-align:center">openstreet åœ°å›¾</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">ä¸æ”¯æŒæ­¤å‚æ•°</td></tr></tbody></table><ol><li>å‚æ•°ä¹‹é—´ï¼Œç”¨è‹±æ–‡é€—å·ç›¸éš”</li><li>å‚æ•°å¿…é¡»æŒ‰ä¸Šè¿°äº‹ä¾‹é¡ºåºè¾“å…¥ï¼Œä¸å¾—ä¸ºç©º</li><li>åŒä¸€ä¸ªé¡µé¢ï¼ŒåŒä¸€ç»„ç»çº¬åº¦å€¼ï¼Œåªèƒ½æ’å…¥ä¸€ä¸ªç›¸åŒæ ‡ç­¾å€¼çš„åœ°å›¾ (è‹¥æœ‰éœ€è¦ï¼Œå¯ä»¥å°†ç¬¬äºŒä¸ªåœ°å›¾ä¸Šï¼Œç»åº¦æˆ–çº¬åº¦æœ«å°¾åˆ é™¤ä¸€ä¸¤ä¸ªæ•°)</li><li>å‚æ•°å–å€¼å¿…é¡»åœ¨ä¸Šè¿°èŒƒå›´å†…</li><li>é»˜è®¤å›¾å±‚ï¼šå³åœ°å›¾å åŠ å±‚çš„å€¼ï¼Œé»˜è®¤å¸¸è§„åœ°å›¾è¿˜æ˜¯å«æ˜Ÿåœ°å›¾ï¼Œå¯æŒ‰åœ°å›¾æ˜¾ç¤ºé¡ºåºå–å€¼</li><li>ç¼©æ”¾ç­‰çº§ï¼Œæ•°å­—è¶Šå¤§ï¼Œåœ°å›¾æ¯”ä¾‹å°ºè¶Šå°ï¼Œæ˜¾ç¤ºçš„è¶Šç²¾ç»†</li><li>é™¤æ ‡ç­¾å€¼å¤–ï¼Œå…¶ä»–å‚æ•°é€‰å¡«ï¼Œä½† æ¯ä¸ªå‚æ•°çš„å·¦è¾¹çš„å‚æ•°å¿…å¡«</li><li>è°·æ­Œåœ°å›¾éœ€è¦å¤–ç½‘æ‰èƒ½åŠ è½½æŸ¥çœ‹</li></ol><p>åæ ‡è·å–ï¼š<a href="https://lbs.amap.com/tools/picker">é«˜å¾·åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a> ã€<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">ç™¾åº¦åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"é«˜å¾·åœ°å›¾":normal,"æ™ºå›¾åœ°å›¾":normalm1,"è°·æ­Œåœ°å›¾":normalMap,"é«˜å¾·å«æ˜Ÿåœ°å›¾":imgm,"è°·æ­Œå«æ˜Ÿåœ°å›¾":satelliteMap,"é«˜å¾·å«æ˜Ÿæ ‡æ³¨":image,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"è°·æ­Œåœ°å›¾":normalMap,"è°·æ­Œå«æ˜Ÿå›¾":satelliteMap,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"æ™ºå›¾åœ°å›¾":normalm1,"åˆå¤œè“":normalm2,"ç°è‰²":normalm3,"æš–è‰²":normalm4,"æ°´ç³»":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-éšè—å—">2.31 éšè—å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>contentï¼šè¦éšè—çš„å†…å®¹</li><li>displayï¼šå±•ç¤ºå‰æŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—ï¼ˆå¯é€‰ï¼‰</li><li>bgï¼šæŒ‰é’®çš„èƒŒæ™¯é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li><li>colorï¼šæŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—çš„é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock ç‚¹æˆ‘é¢„è§ˆ, blue %&#125;</span><br><span class="line">è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">ç‚¹æˆ‘é¢„è§ˆ    </button><div class="hide-content"><p>è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://liweierzzz.github.io/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="Markdown" scheme="https://liweierzzz.github.io/tags/Markdown/"/>
    
    <category term="å¤–æŒ‚æ ‡ç­¾" scheme="https://liweierzzz.github.io/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/"/>
    
  </entry>
  
  <entry>
    <title>javaé¢è¯•æ•´ç†</title>
    <link href="https://liweierzzz.github.io/posts/acf92a4b.html"/>
    <id>https://liweierzzz.github.io/posts/acf92a4b.html</id>
    <published>2024-07-03T10:19:03.000Z</published>
    <updated>2024-07-04T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1>javaé¢è¯•é¢˜-ç¼–ç¨‹å¯¼èˆª</h1><h2 id="javaåŸºç¡€">javaåŸºç¡€</h2><h3 id="1ã€JDK-å’Œ-JRE-å’Œ-JVM-åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">1ã€JDK å’Œ JRE å’Œ JVM åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>[<img src="https://s21.ax1x.com/2024/07/05/pkRrD39.png" alt="pkRrD39.png"></p><ol><li>JDKï¼ˆJava Development Kitï¼‰ï¼š<strong>JDK æ˜¯ Java å¼€å‘â¼¯å…·åŒ…</strong>ï¼ŒåŒ…å«äº†ç¼–å†™ã€ç¼–è¯‘ã€è°ƒè¯•å’Œè¿è¡Œ Java ç¨‹åºæ‰€éœ€çš„ æ‰€æœ‰â¼¯å…·å’Œç»„ä»¶ï¼Œæ¯”å¦‚ç¼–è¯‘å™¨ï¼ˆjavacï¼‰ã€Java APIã€è°ƒè¯•â¼¯å…·ç­‰ã€‚JDK æ˜¯é’ˆå¯¹ Java å¼€å‘â¼ˆå‘˜çš„ï¼Œ<strong>å®ƒåŒ…å«äº†  JREï¼Œè¿˜æœ‰ç¼–è¯‘å™¨å’Œå…¶ä»–â¼¯å…·</strong>ï¼Œå¯ä»¥ç”¨æ¥ç¼–å†™å’Œè°ƒè¯• Java ç¨‹åºã€‚</li><li>JREï¼ˆJava Runtime Environmentï¼‰ï¼š<strong>JRE æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒ</strong>ï¼ŒåŒ…æ‹¬äº† <strong>Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰å’Œ Java æ ‡å‡†ç±» åº“ï¼ˆJava API</strong>ï¼‰ã€‚JRE æ˜¯é’ˆå¯¹ Java åº”ç”¨ç¨‹åºçš„ï¼Œå®ƒæä¾›äº†åœ¨è®¡ç®—æœºä¸Šè¿è¡Œ Java åº”ç”¨ç¨‹åºæ‰€éœ€çš„æœ€å°ç¯å¢ƒã€‚</li><li>JVMï¼ˆJava Virtual Machineï¼‰<strong>ï¼šJVM æ˜¯ Java è™šæ‹Ÿæœºï¼Œæ˜¯ Java ç¨‹åºè¿è¡Œçš„ç¯å¢ƒ</strong>ã€‚JVM è´Ÿè´£å°† Java ä»£ç è§£é‡Šæˆ– ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ä»£ç ï¼Œå¹¶åœ¨è¿è¡Œæ—¶æä¾›å¿…è¦çš„ç¯å¢ƒâ½€æŒï¼Œæ¯”å¦‚å†…å­˜ç®¡ç†ã€åƒåœ¾å›æ”¶ã€å®‰å…¨æ€§ç­‰ã€‚JVM çš„ä¸»è¦ ä½œç”¨æ˜¯<strong>å°† Java ä»£ç è½¬æ¢ä¸ºå¯ä»¥åœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„æœºå™¨ç </strong>ï¼Œå¹¶è´Ÿè´£ç¨‹åºçš„æ‰§è¡Œã€‚</li></ol><ul><li>ç»¼ä¸Šæ‰€è¿°ï¼ŒJDKã€JRE å’Œ JVM ä¹‹é—´çš„åŒºåˆ«å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š<ol><li><strong>JDK æ˜¯ Java å¼€å‘â¼¯å…·åŒ…</strong>ï¼ŒåŒ…æ‹¬äº†ç¼–è¯‘å™¨ã€Java APIã€è°ƒè¯•â¼¯å…·ç­‰ï¼Œç”¨äºå¼€å‘ Java åº”ç”¨ç¨‹åºã€‚</li><li>J<strong>RE æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒ…æ‹¬äº† Java è™šæ‹Ÿæœºå’Œ Java æ ‡å‡†ç±»åº“</strong>ï¼Œç”¨äºåœ¨è®¡ç®—æœºä¸Šè¿è¡Œ Java åº”ç”¨ç¨‹åºã€‚</li><li><strong>JVM æ˜¯ Java è™šæ‹Ÿæœºï¼Œæ˜¯ Java ç¨‹åºè¿è¡Œçš„ç¯å¢ƒï¼Œè´Ÿè´£å°† Java ä»£ç è½¬æ¢ä¸ºå¯ä»¥åœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„æœºå™¨ç </strong>ï¼Œå¹¶æ ä¾›å¿…è¦çš„ç¯å¢ƒâ½€æŒ</li></ol></li></ul><h3 id="2ã€ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ">2ã€ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li><p>å­—èŠ‚ç æ˜¯ <strong>Java ç¨‹åºç¼–è¯‘åçš„ä¸­é—´ä»£ç </strong>ï¼Œæ˜¯â¼€ç§<strong>å¯ç§»æ¤çš„â¼†è¿›åˆ¶ä»£ç </strong>ï¼Œå¯ä»¥åœ¨ä»»ä½•â½€æŒ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰çš„å¹³å° ä¸Šè¿è¡Œã€‚å­—èŠ‚ç é€šè¿‡å°† Java æºä»£ç ç¼–è¯‘ä¸ºå­—èŠ‚ç æŒ‡ä»¤åºåˆ—ï¼Œ<strong>ä½¿å¾— Java ç¨‹åºå¯ä»¥è·¨å¹³å°è¿è¡Œ</strong>ï¼Œå³ä½¿æ˜¯åœ¨ä¸åŒçš„æ“ä½œ ç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ä¸Šä¹Ÿå¯ä»¥è¿è¡Œã€‚</p></li><li><p>å­—èŠ‚ç é‡‡ç”¨ä¸­é—´ä»£ç çš„å½¢å¼ï¼Œç›¸æ¯”äºç›´æ¥å°†ç¨‹åºç¼–è¯‘ä¸ºç‰¹å®šå¹³å°ä¸Šçš„æœºå™¨ç ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š</p></li><li><p><strong>å¯ç§»æ¤æ€§</strong>ï¼šç”±äºå­—èŠ‚ç æ˜¯ä¸­é—´ä»£ç ï¼Œæ‰€ä»¥<strong>å¯ä»¥åœ¨ä»»ä½•â½€æŒ JVM çš„å¹³å°ä¸Šè¿è¡Œ</strong>ï¼Œä½¿å¾— Java ç¨‹åºå…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤æ€§ã€‚è¿™ä¹Ÿæ˜¯ Java è·¨å¹³å°çš„é‡è¦ç‰¹æ€§ä¹‹â¼€ã€‚</p></li><li><p><strong>å®‰å…¨æ€§</strong>ï¼šç”±äºå­—èŠ‚ç <strong>éœ€è¦åœ¨ JVM ä¸­è¿è¡Œ</strong>ï¼Œæ‰€ä»¥å¯ä»¥å¯¹å­—èŠ‚ç è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œä»¥ç¡®ä¿ç¨‹åºä¸ä¼šå¯¹ç³»ç»Ÿé€ æˆå¨èƒã€‚</p></li><li><p><strong>æ€§èƒ½</strong>ï¼šç”±äºå­—èŠ‚ç æ˜¯â¼€ç§<strong>ç´§å‡‘çš„â¼†è¿›åˆ¶æ ¼å¼</strong>ï¼Œç›¸æ¯”äºç›´æ¥ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œå¯ä»¥æ›´å¿«åœ°åŠ è½½å’Œä¼ è¾“ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡ŒåŠ¨æ€ä¼˜åŒ–ï¼Œ<strong>æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡</strong>ã€‚</p></li><li><p><strong>å¯è¯»æ€§</strong>ï¼šç›¸æ¯”äºç›´æ¥ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œ<strong>å­—èŠ‚ç å…·æœ‰æ›´å¥½çš„å¯è¯»æ€§</strong>ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œåæ±‡ç¼–å’Œè°ƒè¯•</p><p>å› æ­¤ï¼Œé‡‡ç”¨å­—èŠ‚ç ä½œä¸ºä¸­é—´ä»£ç çš„æœ€å¤§å¥½å¤„æ˜¯æé«˜äº† Java ç¨‹åºçš„å¯ç§»æ¤æ€§ã€å®‰å…¨æ€§ã€æ€§èƒ½å’Œå¯è¯»æ€§ã€‚è¿™ä¹Ÿæ˜¯ Java  è·¨å¹³å°å’Œå®‰å…¨æ€§ç­‰ç‰¹æ€§çš„åŸºç¡€ã€‚</p></li></ul><h3 id="3ã€Java-å’Œ-C-ã€Go-è¯­è¨€çš„åŒºåˆ«ï¼Œå„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Ÿ">3ã€Java å’Œ C++ã€Go è¯­è¨€çš„åŒºåˆ«ï¼Œå„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Ÿ</h3><p>java</p><ul><li><strong>ä¼˜ç‚¹:</strong><ul><li>ç®€å•æ˜“å­¦ä»£ç å¯è¯»æ€§å¼º</li><li>è·¨å¹³å°â¼€æ¬¡ç¼–å†™å¯ä»¥åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œ</li><li>é¢å‘å¯¹è±¡â½€æŒç»§æ‰¿ã€å¤šæ€ç­‰ç‰¹æ€§ ä¸°å¯Œçš„ç±»åº“</li><li>å¯ä»¥å¿«é€Ÿå¼€å‘åº”ç”¨ç¨‹åº</li><li>è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œå‡å°‘äº†å†…å­˜æ³„æ¼çš„å¯èƒ½æ€§</li></ul></li><li><strong>ç¼ºç‚¹</strong>:<ul><li>ç”±äºJVMçš„å­˜åœ¨ï¼Œè¿è¡Œé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢</li><li>å¯¹äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼ŒJavaçš„è¡¨ç°å¯èƒ½ä¸å¦‚C++å’ŒGo</li></ul></li></ul><p>C++</p><ul><li><strong>ä¼˜ç‚¹</strong>:<ul><li>é€Ÿåº¦å¿«ï¼Œé€‚åˆç¼–å†™éœ€è¦é«˜æ€§èƒ½çš„åº”ç”¨ç¨‹åº</li><li>åº”ç”¨å¹¿æ³›ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¸¸æˆå¼€å‘ã€æ“ä½œç³»ç»Ÿå’ŒåµŒâ¼Šå¼ç³»ç»Ÿå¼€å‘æ–¹é¢</li><li>çµæ´»æ€§é«˜ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç¡¬ä»¶å’Œå†…å­˜</li></ul></li><li><strong>ç¼ºç‚¹</strong><ul><li>å­¦ä¹ éš¾åº¦è¾ƒé«˜ï¼Œéœ€è¦æŒæ¡æŒ‡é’ˆã€å†…å­˜ç®¡ç†ç­‰åº•å±‚çŸ¥è¯†</li><li>å®¹æ˜“å‡ºç°å†…å­˜æ³„æ¼å’ŒæŒ‡é’ˆé”™è¯¯ç­‰é—®é¢˜</li><li>ç¼–å†™ä»£ç è¿‡ç¨‹ä¸­éœ€è¦æ›´å¤šçš„â¼¿åŠ¨ç®¡ç†ï¼Œç›¸æ¯” Java æ›´å®¹æ˜“å‡ºé”™</li></ul></li></ul><p>go</p><ul><li><strong>ä¼˜ç‚¹</strong>:<ul><li>é«˜å¹¶å‘ï¼Œå¤©ç”Ÿâ½€æŒåç¨‹ï¼Œèƒ½å¤Ÿè½»æ¾ç¼–å†™é«˜æ•ˆçš„å¹¶å‘ç¨‹åº</li><li>ç®€å•æ˜“å­¦ï¼Œè¯­æ³•ç®€æ´ï¼Œä¸Šâ¼¿å®¹æ˜“</li><li>é™æ€ç±»å‹è¯­è¨€ï¼Œå¯ä»¥é¿å…â¼€äº›æ½œåœ¨çš„è¿è¡Œæ—¶é”™è¯¯</li><li>å¿«é€Ÿç¼–è¯‘ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºå’Œéƒ¨ç½²åº”ç”¨ç¨‹åº</li></ul></li><li><strong>ç¼ºç‚¹</strong>:<ul><li>ç¼ºä¹ä¸°å¯Œçš„ç±»åº“ï¼Œä¸ Java å’Œ C++ ç›¸æ¯”æœ‰äº›ä¸è¶³</li><li>åœ¨â¼€äº›æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ä¸­å¯èƒ½ä¸å¦‚ C++ è¡¨ç°</li><li>è¯­è¨€æœ¬èº«è¿˜æ¯”è¾ƒå¹´è½»ï¼Œç›¸å…³ç”Ÿæ€å’Œâ¼¯å…·è¿˜éœ€è¦è¿›â¼€æ­¥å®Œå–„</li></ul></li></ul><p>ä½¿ç”¨åœºæ™¯:</p><p>JAVA</p><ul><li>é€‚åˆå¼€å‘<strong>ä¼ä¸šçº§åº”ç”¨ç¨‹åº</strong>ã€åç«¯æœåŠ¡ç­‰</li></ul><p>C++</p><ul><li>é€‚åˆå¼€å‘éœ€è¦<strong>é«˜æ€§èƒ½å’Œé«˜å¯é æ€§</strong>çš„åº”ç”¨ç¨‹åºï¼Œç‰¹åˆ«æ˜¯åœ¨æ¸¸æˆå¼€å‘ã€æ“ä½œç³»ç»Ÿå’ŒåµŒâ¼Šå¼ç³»ç»Ÿå¼€å‘æ–¹é¢ã€‚</li></ul><p>GO</p><ul><li>é€‚åˆå¼€å‘<strong>é«˜å¹¶å‘çš„åç«¯æœåŠ¡</strong>ã€å¾®æœåŠ¡ã€å®¹å™¨åŒ–åº”ç”¨ç¨‹åºç­‰</li></ul><h3 id="4ã€JDK-åŠ¨æ€ä»£ç†å’Œ-CGLIB-åŠ¨æ€ä»£ç†çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ">4ã€JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>JDKå’ŒCGLibåŠ¨æ€ä»£ç†åŒºåˆ«</p><ol><li>JDKåŠ¨æ€ä»£ç†å…·ä½“å®ç°åŸç†</li></ol><ul><li>é€šè¿‡å®ç° <strong>InvocationHandler</strong> æ¥â¼åˆ›å»ºè‡ªâ¼°çš„<strong>è°ƒç”¨å¤„ç†å™¨</strong>ï¼›</li><li>é€šè¿‡ä¸º Proxy ç±»æŒ‡å®š ClassLoader å¯¹è±¡å’Œâ¼€ç»„ interface æ¥åˆ›å»ºåŠ¨æ€ä»£ç†ï¼›</li><li>é€šè¿‡åå°„æœºåˆ¶è·å–<strong>åŠ¨æ€ä»£ç†ç±»çš„æ„é€ å‡½æ•°</strong>ï¼Œå…¶å”¯â¼€å‚æ•°ç±»å‹å°±æ˜¯è°ƒç”¨å¤„ç†å™¨æ¥â¼ç±»å‹ï¼›</li><li>é€šè¿‡<strong>æ„é€ å‡½æ•°åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹</strong>ï¼Œæ„é€ æ—¶è°ƒç”¨å¤„ç†å™¨å¯¹è±¡ä½œä¸ºå‚æ•°å‚â¼Šï¼›</li></ul><p>JDK åŠ¨æ€ä»£ç†æ˜¯<strong>é¢å‘æ¥å£çš„ä»£ç†æ¨¡å¼</strong>ï¼Œå¦‚æœè¢«ä»£ç†ç›®æ ‡æ²¡æœ‰æ¥â¼é‚£ä¹ˆ Spring ä¹Ÿâ½†èƒ½ä¸ºâ¼’ï¼ŒSpring é€šè¿‡ Java çš„åå°„ æœºåˆ¶ç”Ÿäº§è¢«ä»£ç†æ¥â¼çš„æ–°çš„åŒ¿åå®ç°ç±»ï¼Œé‡å†™äº†å…¶ä¸­ AOP çš„å¢å¼ºæ–¹æ³•ã€‚</p><ol start="2"><li>CGLibåŠ¨æ€ä»£ç†</li></ol><p>åˆ©ç”¨ ASM å¼€æºåŒ…ï¼Œå¯¹ä»£ç†å¯¹è±¡ç±»çš„ class æ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œé€šè¿‡ä¿®æ”¹å…¶å­—èŠ‚ç ç”Ÿæˆâ¼¦ç±»æ¥å¤„ç†ã€‚</p><ol start="3"><li>ä¸¤è€…å¯¹æ¯”ï¼š</li></ol><p>JDK åŠ¨æ€ä»£ç†æ˜¯é¢å‘æ¥å£çš„ã€‚ CGLib åŠ¨æ€ä»£ç†æ˜¯é€šè¿‡å­—èŠ‚ç åº•å±‚ç»§æ‰¿è¦ä»£ç†ç±»æ¥å®ç°ï¼Œå› æ­¤å¦‚æœè¢«ä»£ç†ç±»è¢« final å…³é”®å­—æ‰€ä¿®é¥°ï¼Œä¼šå¤±è´¥ã€‚ å¦‚æœè¦è¢«ä»£ç†çš„å¯¹è±¡æ˜¯ä¸ªå®ç°ç±»ï¼Œé‚£ä¹ˆ Spring ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†æ¥å®Œæˆæ“ä½œï¼ˆSpirng é»˜è®¤é‡‡ç”¨ JDK åŠ¨æ€ä»£ç†å® ç°æœºåˆ¶ï¼‰ï¼› å¦‚æœè¦è¢«ä»£ç†çš„å¯¹è±¡ä¸æ˜¯ä¸ªå®ç°ç±»ï¼Œé‚£ä¹ˆ Spring ä¼šå¼ºåˆ¶ä½¿ç”¨ CGLib æ¥å®ç°åŠ¨æ€ä»£ç†ã€‚</p><h3 id="5ã€Java-ä¸­-final-å…³é”®å­—æœ‰ä»€ä¹ˆç”¨">5ã€Java ä¸­ final å…³é”®å­—æœ‰ä»€ä¹ˆç”¨</h3><p>åœ¨ Java ä¸­ï¼Œfinal å…³é”®å­—ç”¨äºè¡¨ç¤ºâ¼€ä¸ªä¸å¯å˜çš„å¸¸é‡æˆ–â¼€ä¸ªä¸å¯å˜çš„å˜é‡ã€‚</p><p>åœ¨ Java ä¸­ï¼Œfinal å…³é”®å­—å¯ä»¥ä¿®é¥°ç±»ã€æ–¹æ³•å’Œå˜é‡ï¼Œä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>final ä¿®é¥°ç±»ï¼Œè¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚final ç±»ä¸­çš„æ–¹æ³•é»˜è®¤éƒ½æ˜¯ final çš„ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</li><li>final ä¿®é¥°æ–¹æ³•ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</li><li>final ä¿®é¥°å˜é‡ï¼Œè¡¨ç¤ºè¯¥å˜é‡åªèƒ½è¢«èµ‹å€¼â¼€æ¬¡ã€‚final ä¿®é¥°çš„å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶æˆ–æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œä¸”ä¸èƒ½å† è¢«ä¿®æ”¹ã€‚å¸¸ç”¨äºå®šä¹‰å¸¸é‡</li></ul><p>å¦å¤–ï¼Œä½¿ç”¨ final ä¿®é¥°çš„å˜é‡åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šäº†å…¶å€¼ï¼Œå› æ­¤åœ¨è¿è¡Œæ—¶è®¿é—®æ—¶æ¯”é final å˜é‡æ›´å¿«ã€‚</p><p>ä½¿ç”¨ final å…³é”®å­—å¯ä»¥å¸¦æ¥â¼€äº›å¥½å¤„ï¼Œä¾‹å¦‚ï¼š</p><ul><li>å®‰å…¨æ€§ï¼šå°†å˜é‡å£°æ˜ä¸º final å¯ä»¥é˜²â½Œå®ƒè¢«æ”¹å˜ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ã€‚</li><li>å¯è¯»æ€§ï¼šå°†å¸¸é‡å£°æ˜ä¸º final å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œå› ä¸ºå¸¸é‡çš„å€¼ä¸ä¼šè¢«ä¿®æ”¹ã€‚</li><li>ä¼˜åŒ–ï¼šfinal å˜é‡åœ¨ç¼–è¯‘æ—¶è¢«è½¬æ¢æˆå¸¸é‡ï¼Œè¿™å¯ä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚</li></ul><h3 id="6ã€Java-ä¸­-hashCode-å’Œ-equals-æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬å’Œ-å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">6ã€Java ä¸­ hashCode å’Œ equals æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬å’Œ == å„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>[<img src="https://s21.ax1x.com/2024/07/05/pkRrcB6.png" alt="pkRrcB6.png"></p><h3 id="7ã€ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿè¯´è¯´åå°„æœºåˆ¶çš„ä¼˜ç¼ºç‚¹ã€åº”ç”¨åœºæ™¯">7ã€ä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿè¯´è¯´åå°„æœºåˆ¶çš„ä¼˜ç¼ºç‚¹ã€åº”ç”¨åœºæ™¯?</h3><p>Javaçš„åå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶è·å¾—ç±»çš„ä¿¡æ¯ï¼Œåˆ›å»ºç±»çš„å¯¹è±¡ï¼Œè°ƒç”¨å…¶ä¸­çš„æ–¹æ³•å’Œå±æ€§ã€‚</p><p>ä¼˜ç‚¹</p><ul><li>å¯ä»¥åŠ¨æ€çš„è·å–ç±»ä¿¡æ¯ã€‚</li><li>å¯ä»¥åŠ¨æ€çš„åˆ›å»ºç±»å¯¹è±¡ã€‚</li><li>å¯ä»¥åŠ¨æ€çš„è°ƒç”¨ç±»å¯¹è±¡çš„æ–¹æ³•ä»¥åŠå±æ€§ã€‚</li></ul><p>ç¼ºç‚¹:</p><ul><li>ä¸å®‰å…¨ï¼Œåå°„èƒ½å¤Ÿè·å–æ‰€æœ‰ç±»å¯¹è±¡ï¼ŒåŒ…æ‹¬ç§æœ‰çš„ï¼Œç ´åäº†ç¨‹åºçš„å°è£…æ€§ã€‚</li><li>æ•ˆç‡ä½ï¼Œåå°„çš„æ•ˆç‡è¾ƒä½ã€‚</li></ul><p>åº”ç”¨åœºæ™¯:</p><ul><li>åŠ¨æ€ä»£ç†ï¼Œå› ä¸ºä¸ç¡®å®šéœ€è¦ä»£ç†çš„ç±»ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡åå°„åŠ¨æ€çš„è·å–</li><li>RPC æ¡†æ¶ï¼ŒRPC æ¡†æ¶å°±æ˜¯åŠ¨æ€çš„ç”Ÿæˆç±»å¯¹è±¡ï¼Œç„¶åè°ƒç”¨æ–¹æ³•çš„ã€‚</li></ul><h3 id="8ã€Java-è®¿é—®ä¿®é¥°ç¬¦-publicã€privateã€protectedï¼Œä»¥åŠæ— ä¿®é¥°ç¬¦ï¼ˆé»˜-è®¤ï¼‰çš„åŒºåˆ«ï¼Ÿ">8ã€Java è®¿é—®ä¿®é¥°ç¬¦ publicã€privateã€protectedï¼Œä»¥åŠæ— ä¿®é¥°ç¬¦ï¼ˆé»˜ è®¤ï¼‰çš„åŒºåˆ«ï¼Ÿ</h3><p>[<img src="https://s21.ax1x.com/2024/07/05/pkRrgHK.png" alt="pkRrgHK.png"></p><h3 id="9ã€String-å’Œ-StringBufferã€StringBuilder-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ">9ã€String å’Œ StringBufferã€StringBuilder çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>String å’Œ StringBuffer/StringBuilder æ˜¯ Java ä¸­ä¸¤ç§ä¸åŒçš„å­—ç¬¦ä¸²å¤„ç†æ–¹å¼ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äº String æ˜¯<strong>ä¸å¯å˜çš„ å¯¹è±¡</strong>ï¼Œè€Œ StringBuffer å’Œ StringBuilder åˆ™æ˜¯<strong>å¯å˜çš„å¯¹è±¡ã€‚</strong></li><li>String å¯¹è±¡<strong>â¼€æ—¦è¢«åˆ›å»ºï¼Œå°±ä¸å¯ä¿®æ”¹</strong>ï¼Œä»»ä½•çš„å­—ç¬¦ä¸²æ“ä½œéƒ½ä¼šè¿”å›â¼€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œè¿™å¯èƒ½å¯¼è‡´<strong>é¢‘ç¹çš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯å½±å“æ€§èƒ½</strong>ã€‚è€Œ StringBuffer å’Œ StringBuilder å…è®¸è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œæä¾›äº†â¼€ç§<strong>æ›´é«˜æ•ˆ</strong>çš„å­—ç¬¦ä¸²å¤„ç†æ–¹å¼ã€‚</li><li>StringBuffer å’Œ StringBuilder çš„ä¸»è¦åŒºåˆ«åœ¨äº<strong>çº¿ç¨‹å®‰å…¨æ€§å’Œæ€§èƒ½æ–¹é¢</strong>ã€‚StringBuffer æ˜¯<strong>çº¿ç¨‹å®‰å…¨çš„</strong>ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å’Œä¿®æ”¹ã€‚è€Œ StringBuilder <strong>ä¸æ˜¯çº¿ç¨‹å®‰å…¨</strong>çš„ï¼Œé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒä¸‹çš„å­—ç¬¦ä¸²å¤„ç†ï¼Œä½†æ˜¯ç›¸æ¯”äº StringBufferï¼Œ<strong>StringBuilder å…·æœ‰æ›´é«˜çš„æ€§èƒ½</strong>ã€‚</li><li>å› æ­¤ï¼Œå½“å­—ç¬¦ä¸²å¤„ç†éœ€è¦<strong>é¢‘ç¹ä¿®æ”¹</strong>æ—¶ï¼Œå»ºè®®ä½¿ç”¨ StringBuffer æˆ– StringBuilderï¼›è€Œå½“å­—ç¬¦ä¸²å¤„ç†<strong>ä¸éœ€è¦ä¿®æ”¹</strong>æ—¶ï¼Œ å¯ä»¥ä½¿ç”¨ Stringã€‚</li></ul><p><img src="https://s21.ax1x.com/2024/07/05/pkRrsj1.png" alt="pkRrsj1.png"></p><h3 id="10ã€ä»€ä¹ˆæ˜¯-Java-å†…éƒ¨ç±»ï¼Ÿå†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº›-ï¼Ÿå†…éƒ¨ç±»æœ‰å“ªäº›ä¼˜ç‚¹å’Œåº”ç”¨åœºæ™¯ï¼Ÿ">10ã€ä»€ä¹ˆæ˜¯ Java å†…éƒ¨ç±»ï¼Ÿå†…éƒ¨ç±»çš„åˆ†ç±»æœ‰å“ªäº› ï¼Ÿå†…éƒ¨ç±»æœ‰å“ªäº›ä¼˜ç‚¹å’Œåº”ç”¨åœºæ™¯ï¼Ÿ</h3><p><img src="https://s21.ax1x.com/2024/07/05/pkRr49H.png" alt="pkRr49H.png"></p><p><strong>åˆ›å»ºä¸è·å–</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/ <span class="number">1</span>ã€ç§æœ‰å†…éƒ¨ç±» =&gt; åœ¨å¤–éƒ¨ç±»ä¸­ç¼–å†™æ–¹æ³•ï¼Œå¯¹å¤–æä¾›å†…éƒ¨ç±»å¯¹è±¡</span><br><span class="line"><span class="comment">// å®šä¹‰æ–¹æ³•ï¼ˆå¤–éƒ¨ç±»ä¸­ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> Inner <span class="title function_">getInstance</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Inner</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="type">Outer</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer</span>();</span><br><span class="line"> <span class="type">Object</span> <span class="variable">i</span> <span class="operator">=</span> o.getInstance();</span><br><span class="line"> <span class="comment">// 2. â¾®ç§æœ‰å†…éƒ¨ç±» =&gt; ç›´æ¥åˆ›å»ºæˆå‘˜å†…éƒ¨ç±»</span></span><br><span class="line"><span class="comment">// å¤–éƒ¨ç±»å.å†…éƒ¨ç±»å å¯¹è±¡å = new å¤–éƒ¨ç±»å¯¹è±¡.new å†…éƒ¨ç±»å¯¹è±¡;</span></span><br><span class="line"> Outer.<span class="type">Inner</span> <span class="variable">oi</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer</span>().<span class="keyword">new</span> <span class="title class_">Inner</span>()</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹</p><ul><li>å¯ä»¥éšè—å®ç°ç»†èŠ‚ã€‚</li><li>ä¾¿äºç¼–å†™å’Œç»´æŠ¤ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>ä½¿ç”¨å†…éƒ¨ç±»è§£å†³ Javaå•ç»§æ‰¿é—®é¢˜</li><li>å¯ä»¥æ›´æ¢çš„å¯¹å¤–éƒ¨ç±»è¿›è¡Œæ‰©å±•</li><li>æ³¨ï¼šJDK16 ä¹‹å‰æˆå‘˜å†…éƒ¨ç±»â¾¥ä¸èƒ½å®šä¹‰é™æ€å˜é‡</li></ul><h2 id="MySqlæ•°æ®åº“">MySqlæ•°æ®åº“</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Ÿè®²â¼€ä¸‹äº‹åŠ¡çš„-ACID-ç‰¹æ€§ï¼Ÿ">1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“äº‹åŠ¡ï¼Ÿè®²â¼€ä¸‹äº‹åŠ¡çš„ ACID ç‰¹æ€§ï¼Ÿ</h3><p>æ•°æ®åº“äº‹åŠ¡æ˜¯æŒ‡æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ä¸­çš„â¼€ä¸ªæ“ä½œåºåˆ—ï¼Œè¿™äº›æ“ä½œå¿…é¡»ä½œä¸ºâ¼€ä¸ªä¸å¯åˆ†å‰²çš„å•å…ƒæ‰§è¡Œï¼Œå³è¦ ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚äº‹åŠ¡é€šå¸¸æ¶‰åŠåˆ°å¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œã€‚ äº‹åŠ¡çš„ ACID ç‰¹æ€§æŒ‡å››ä¸ªå…³é”®ç‰¹å¾ï¼š<strong>åŸå­æ€§</strong>ï¼ˆAtomicityï¼‰ã€<strong>â¼€è‡´æ€§</strong>ï¼ˆConsistencyï¼‰ã€<strong>éš”ç¦»æ€§</strong>ï¼ˆIsolationï¼‰å’Œ<strong>æŒä¹… æ€§</strong>ï¼ˆDurabilityï¼‰</p><ul><li><p><strong>åŸå­æ€§</strong></p><p>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯â¼€ä¸ª<strong>ä¸å¯å†åˆ†å‰²çš„â¼¯ä½œå•å…ƒ</strong>ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚å¯é‡‡ç”¨â€œAå‘Bè½¬è´¦â€è¿™ä¸ª ä¾‹â¼¦æ¥è¯´æ˜è§£é‡Šã€‚ åœ¨ DBMS ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹<strong>â¼€æ¡ SQL å°±æ˜¯â¼€ä¸ªå•ç‹¬äº‹åŠ¡</strong>ï¼Œäº‹åŠ¡æ˜¯è‡ªåŠ¨æäº¤çš„ã€‚åªæœ‰æ˜¾å¼çš„ä½¿ç”¨ start transaction å¼€å¯â¼€ä¸ªäº‹åŠ¡ï¼Œæ‰èƒ½å°†â¼€ä¸ªä»£ç å—æ”¾åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œã€‚</p></li><li><p><strong>ä¸€è‡´æ€§</strong></p><p>â¼€è‡´æ€§æ˜¯æŒ‡åœ¨<strong>äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´å</strong>ã€‚è¿™æ˜¯è¯´æ•°æ®åº“äº‹åŠ¡ä¸<strong>èƒ½ç ´åå…³ç³»æ•°æ®çš„å®Œæ•´æ€§ä»¥åŠä¸šåŠ¡é€»è¾‘ä¸Šçš„â¼€è‡´æ€§</strong>ã€‚ å¦‚ A ç»™ B è½¬è´¦ï¼Œä¸è®ºè½¬è´¦çš„äº‹åŠ¡æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå…¶ä¸¤è€…çš„å­˜æ¬¾æ€»é¢ä¸å˜ï¼ˆè¿™æ˜¯ä¸šåŠ¡é€»è¾‘çš„â¼€è‡´æ€§ï¼Œâ¾„äºæ•°æ®åº“å…³ ç³»çº¦æŸçš„å®Œæ•´æ€§å°±æ›´å¥½ç†è§£äº†ï¼‰ã€‚</p></li><li><p><strong>éš”ç¦»æ€§</strong></p><p><strong>å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®æ—¶ï¼Œäº‹åŠ¡ä¹‹é—´æ˜¯éš”ç¦»çš„</strong>ï¼Œâ¼€ä¸ªäº‹åŠ¡ä¸åº”è¯¥å½±å“å…¶å®ƒäº‹åŠ¡è¿è¡Œæ•ˆæœã€‚</p><p>åœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼Œå½“<strong>ä¸åŒçš„äº‹åŠ¡åŒæ—¶æ“çºµç›¸åŒçš„æ•°æ®æ—¶</strong>ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰<strong>å„è‡ªçš„å®Œæ•´æ•°æ®ç©ºé—´</strong>ã€‚ç”±å¹¶å‘äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹<strong>å¿…é¡»ä¸ä»»ä½•å…¶ä»–å¹¶å‘äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹éš”ç¦»</strong>ã€‚äº‹åŠ¡æŸ¥çœ‹æ•°æ®æ›´æ–°æ—¶ï¼Œæ•°æ®æ‰€å¤„çš„çŠ¶æ€è¦ä¹ˆæ˜¯å¦â¼€äº‹åŠ¡ä¿®æ”¹å®ƒä¹‹å‰çš„çŠ¶ æ€ï¼Œè¦ä¹ˆæ˜¯å¦â¼€äº‹åŠ¡ä¿®æ”¹å®ƒä¹‹åçš„çŠ¶æ€ï¼Œäº‹åŠ¡<strong>ä¸ä¼šæŸ¥çœ‹åˆ°ä¸­é—´çŠ¶æ€çš„æ•°æ®</strong>ã€‚</p><p>äº‹åŠ¡æœ€å¤æ‚é—®é¢˜éƒ½æ˜¯ç”±äº‹åŠ¡éš”ç¦»æ€§å¼•èµ·çš„ã€‚å®Œå…¨çš„éš”ç¦»æ€§æ˜¯ä¸ç°å®çš„ï¼Œå®Œå…¨çš„éš”ç¦»æ€§è¦æ±‚æ•°æ®åº“åŒâ¼€æ—¶é—´åªæ‰§è¡Œâ¼€ æ¡äº‹åŠ¡ï¼Œè¿™æ ·ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚</p><p><strong>æœ‰å››ç§éš”ç¦»çº§åˆ«ï¼š</strong></p><ul><li><p>ç¬¬â¼€ç§éš”ç¦»çº§åˆ«**ï¼šRead uncommitted(è¯»æœªæäº¤)**</p><p>è§£å†³äº†æ›´æ–°ä¸¢å¤±ï¼Œä½†è¿˜æ˜¯å¯èƒ½ä¼šå‡ºç°è„è¯»</p></li><li><p>ç¬¬â¼†ç§éš”ç¦»çº§åˆ«ï¼š<strong>Read committed(è¯»æäº¤)</strong></p><p>è§£å†³äº†æ›´æ–°ä¸¢å¤±å’Œè„è¯»é—®é¢˜</p></li><li><p>ç¬¬ä¸‰ç§éš”ç¦»çº§åˆ«ï¼š<strong>Repeatable read(å¯é‡å¤è¯»å–)</strong></p><p>è§£å†³äº†æ›´æ–°ä¸¢å¤±ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ã€ä½†æ˜¯è¿˜ä¼šå‡ºç°å¹»è¯»</p></li><li><p>ç¬¬å››ç§éš”ç¦»çº§åˆ«ï¼š<strong>Serializable(å¯åºåŒ–)</strong></p><p>è§£å†³äº†æ›´æ–°ä¸¢å¤±ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»(è™šè¯»)</p></li></ul></li><li><p><strong>æŒä¹…æ€§</strong></p><p>è¿™æ˜¯æœ€å¥½ç†è§£çš„â¼€ä¸ªç‰¹æ€§ï¼šæŒä¹…æ€§ï¼Œæ„å‘³ç€åœ¨äº‹åŠ¡å®Œæˆä»¥åï¼Œè¯¥äº‹åŠ¡æ‰€å¯¹æ•°æ®åº“<strong>æ‰€ä½œçš„æ›´æ”¹ä¾¿æŒä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¹‹ä¸­</strong>ï¼Œå¹¶ä¸ä¼šè¢«å›æ»šã€‚ï¼ˆå®Œæˆçš„äº‹åŠ¡æ˜¯ç³»ç»Ÿæ°¸ä¹…çš„éƒ¨åˆ†ï¼Œå¯¹ç³»ç»Ÿçš„å½±å“æ˜¯æ°¸ä¹…æ€§çš„ï¼Œè¯¥ä¿®æ”¹å³ä½¿å‡ºç°è‡´å‘½çš„ç³»ç»Ÿæ•… éšœä¹Ÿå°†â¼€ç›´ä¿æŒï¼‰</p></li></ul><h3 id="2ã€MySQL-æ—¥å¿—æœ‰äº†è§£è¿‡å—ï¼Ÿbinlogã€redologã€undolog-åˆ†åˆ«æœ‰ä»€ä¹ˆä½œ-ç”¨ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">2ã€MySQL æ—¥å¿—æœ‰äº†è§£è¿‡å—ï¼Ÿbinlogã€redologã€undolog åˆ†åˆ«æœ‰ä»€ä¹ˆä½œ ç”¨ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>MySQL æ˜¯â¼€æ¬¾æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ï¼Œå…¶æ—¥å¿—æ˜¯å…¶å…³é”®åŠŸèƒ½ä¹‹â¼€ã€‚MySQL åŒ…æ‹¬ä¸‰ç§ç±»å‹çš„æ—¥å¿—ï¼Œåˆ†åˆ«æ˜¯ binlogã€ redolog å’Œ undologï¼Œå®ƒä»¬åˆ†åˆ«æœ‰ä¸åŒçš„ä½œç”¨å’Œç‰¹ç‚¹ã€‚</p><ul><li><p><strong>binlog</strong></p><p>æ˜¯ MySQL ä¸­çš„â¼†è¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼Œç”¨äºè®°å½• MySQL æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰<strong>æ›´æ–°å’Œä¿®æ”¹æ“ä½œ</strong>ã€‚å®ƒå¯ä»¥è®°å½•æ‰€æœ‰çš„ <strong>DDLå’Œ DML</strong>æ“ä½œï¼ŒåŒ…æ‹¬å¯¹è¡¨ç»“æ„çš„æ›´æ”¹ã€æ•°æ®çš„æ’â¼Šã€ä¿®æ”¹ã€åˆ é™¤ç­‰ç­‰ã€‚<strong>binlogæ˜¯åœ¨äº‹åŠ¡æäº¤åç”Ÿæˆçš„</strong>ï¼Œå› æ­¤å¯ä»¥ç”¨äºæ¢å¤ æ•°æ®åº“ã€‚</p></li><li><p><strong>redolog</strong></p><p>ç”¨äº<strong>æ¢å¤æ•°æ®</strong>ï¼Œä¿è¯æ•°æ®çš„<strong>â¼€è‡´æ€§å’ŒæŒä¹…æ€§</strong>ã€‚å½“ MySQL å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œ redolog ä¼šå°†è¿™äº›æ“ä½œ<strong>è®°å½•ä¸‹æ¥ï¼Œå¹¶å†™â¼Šç£ç›˜</strong>ã€‚è¿™æ ·ï¼Œå½“ MySQL å‘ç”Ÿå®•æœºæˆ–å´©æºƒæ—¶ï¼Œé€šè¿‡é‡æ”¾ redolog å°±å¯ ä»¥æ¢å¤æ•°æ®ã€‚</p></li><li><p><strong>undolog</strong></p><p>ç”¨äº<strong>å›æ»šæ“ä½œ</strong>ã€‚å½“ MySQL <strong>å‘ç”Ÿäº‹åŠ¡å›æ»šæ—¶ï¼Œundolog ä¼šè®°å½•è¿™äº›æ“ä½œå¹¶å°†å…¶å†™â¼Šç£ç›˜</strong>ã€‚è¿™æ ·ï¼Œå½“ MySQL éœ€è¦å›æ»šæ—¶ï¼Œé€šè¿‡é‡æ”¾ undolog å°±å¯ä»¥å›æ»šäº‹åŠ¡ã€‚</p></li></ul><p>åŒºåˆ«</p><ul><li>ç›¸åŒç‚¹:<ul><li>binlog å’Œ redolog éƒ½æ˜¯ MySQL ä¸­çš„<strong>â¼†è¿›åˆ¶æ—¥å¿—</strong>ã€‚</li></ul></li><li>ä¸åŒç‚¹<ul><li>binlog æ˜¯ MySQL è®°å½•æ‰€æœ‰çš„æ“ä½œï¼Œè€Œredolog åˆ™æ˜¯ç”¨äºä¿è¯æ•°æ®çš„â¼€è‡´æ€§å’ŒæŒä¹…æ€§ã€‚</li><li>binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œredolog æ˜¯ç‰©ç†æ—¥å¿—ã€‚</li><li>binlog è®°å½•çš„æ˜¯SQLè¯­å¥ï¼Œè€Œredolog è®°å½•çš„æ˜¯æ•°æ®é¡µçš„ä¿®æ”¹ã€‚</li><li>ä»¥ binlog å¯ä»¥è·¨å¹³å°ä½¿ç”¨ï¼Œè€Œredolog ä¸èƒ½ã€‚</li><li>undolog æ˜¯ç”¨äºå›æ»šæ“ä½œçš„ï¼Œè€Œredolog æ˜¯ç”¨äºæ¢å¤æ•°æ®çš„ã€‚</li></ul></li></ul><h3 id=""></h3><h3 id="3ã€æ•°æ®åº“ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Œä»€ä¹ˆåœºæ™¯é€‚åˆä½¿ç”¨ç´¢å¼•ï¼Ÿ">3ã€æ•°æ®åº“ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Œä»€ä¹ˆåœºæ™¯é€‚åˆä½¿ç”¨ç´¢å¼•ï¼Ÿ</h3><p>æ•°æ®åº“ç´¢å¼•æ˜¯â¼€ç§æ•°æ®ç»“æ„ï¼Œå°±åƒä¹¦çš„ç›®å½•â¼€æ ·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½åˆ°æƒ³è¦çš„æ•°æ®ã€‚<br>ä¼˜ç‚¹</p><ul><li>å¯ä»¥<strong>æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡</strong>ï¼Œ<strong>é™ä½æ•°æ®åº“çš„IOæˆæœ¬</strong>ï¼Œç±»ä¼¼äºä¹¦çš„ç›®å½•ã€‚</li><li>é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½äº†CPUçš„æ¶ˆè€—ã€‚</li></ul><p>ç¼ºç‚¹</p><ul><li>éœ€è¦å ç”¨ç‰©ç†ç©ºé—´ï¼Œæ•°é‡è¶Šå¤§ï¼Œå ç”¨ç©ºé—´è¶Šå¤§ã€‚</li><li>ç´¢å¼•è™½ç„¶ä¼šæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œä½†æ˜¯<strong>ä¼šé™ä½æ›´æ–°è¡¨çš„æ•ˆç‡</strong>ã€‚æ¯”å¦‚æ¯æ¬¡å¯¹è¡¨è¿›è¡Œå¢åˆ æ”¹æ“ä½œï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜æœ‰ä¿å­˜æˆ–è€…æ›´æ–°å¯¹åº”çš„ç´¢å¼•æ–‡ä»¶ã€‚</li></ul><p>ä»€ä¹ˆåœºæ™¯é€‚åˆä½¿ç”¨ç´¢å¼•ï¼Ÿ</p><ul><li>é¢‘ç¹ä½¿ç”¨çš„åˆ—ï¼Œä¸»é”®ã€å¤–é”®ã€‚</li><li>å­—æ®µæœ‰å”¯â¼€æ€§é™åˆ¶çš„ï¼Œæ¯”å¦‚å•†å“ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨å”¯â¼€ç´¢å¼•ã€‚</li><li>ç»å¸¸ç”¨äº WHERE æŸ¥è¯¢æ¡ä»¶çš„å­—æ®µï¼Œè¿™æ ·èƒ½å¤Ÿæé«˜æ•´ä¸ªè¡¨çš„æŸ¥è¯¢é€Ÿåº¦ï¼Œå¦‚æœæŸ¥è¯¢æ¡ä»¶ä¸æ˜¯â¼€ä¸ªå­—æ®µï¼Œå¯ä»¥å»ºè”åˆç´¢å¼•ã€‚</li><li>ç»å¸¸ç”¨äº GROUP BY å’Œ ORDER BY çš„å­—æ®µï¼Œè¿™æ ·åœ¨æŸ¥è¯¢çš„æ—¶å€™å°±ä¸éœ€è¦å†å»åšâ¼€æ¬¡æ’åºäº†ï¼Œå› ä¸ºæˆ‘ä»¬éƒ½å·²ç»çŸ¥é“äº†å»ºç«‹ç´¢å¼•ä¹‹ååœ¨ B+Tree ä¸­çš„è®°å½•éƒ½æ˜¯æ’åºå¥½çš„</li></ul><p>ä»€ä¹ˆæ—¶å€™ä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼Ÿ</p><ul><li><strong>WHERE æ¡ä»¶</strong>ï¼Œ<strong>GROUP BY</strong>ï¼Œ<strong>ORDER BY</strong> â¾¥ç”¨ä¸åˆ°çš„å­—æ®µï¼Œç´¢å¼•çš„ä»·å€¼æ˜¯å¿«é€Ÿå®šä½ï¼Œå¦‚æœèµ·ä¸åˆ°å®šä½çš„å­—æ®µ é€šå¸¸æ˜¯ä¸éœ€è¦åˆ›å»ºç´¢å¼•çš„ï¼Œå› ä¸ºç´¢å¼•æ˜¯ä¼šå ç”¨ç‰©ç†ç©ºé—´çš„ã€‚</li><li>å­—æ®µä¸­<strong>å­˜åœ¨å¤§é‡é‡å¤æ•°æ®ï¼Œä¸éœ€è¦åˆ›å»ºç´¢å¼•</strong>ï¼Œæ¯”å¦‚æ€§åˆ«å­—æ®µï¼Œåªæœ‰ç”·å¥³ï¼Œå¦‚æœæ•°æ®åº“è¡¨ä¸­ï¼Œç”·å¥³çš„è®°å½•åˆ†å¸ƒå‡åŒ€ï¼Œé‚£ä¹ˆâ½†è®ºæœç´¢å“ªä¸ªå€¼éƒ½å¯èƒ½å¾—åˆ°â¼€åŠçš„æ•°æ®ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œè¿˜ä¸å¦‚ä¸è¦ç´¢å¼•ï¼Œå› ä¸º MySQL è¿˜æœ‰â¼€ä¸ªæŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨å‘ç°æŸä¸ªå€¼å‡ºç°åœ¨è¡¨çš„æ•°æ®è¡Œä¸­çš„ç™¾åˆ†æ¯”å¾ˆé«˜çš„æ—¶å€™ï¼Œå®ƒâ¼€èˆ¬ä¼šå¿½ç•¥ç´¢å¼•ï¼Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚</li><li>è¡¨æ•°æ®å¤ªå°‘çš„æ—¶å€™ï¼Œä¸éœ€è¦åˆ›å»ºç´¢å¼•ã€‚</li><li>ç»å¸¸æ›´æ–°çš„å­—æ®µä¸ç”¨åˆ›å»ºç´¢å¼•ï¼Œæ¯”å¦‚ä¸è¦å¯¹ç”µå•†é¡¹ç›®çš„ç”¨æˆ·ä½™é¢å»ºç«‹ç´¢å¼•ï¼Œå› ä¸ºç´¢å¼•å­—æ®µé¢‘ç¹ä¿®æ”¹ï¼Œç”±äºè¦ç»´æŠ¤B+Treeçš„æœ‰åºæ€§ï¼Œé‚£ä¹ˆå°±éœ€è¦é¢‘ç¹çš„é‡å»ºç´¢å¼•ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¼šå½±å“æ•°æ®åº“æ€§èƒ½çš„ã€‚</li></ul><h3 id="4ã€ä½ æ˜¯æ€ä¹ˆåš-MySQLæ•°æ®å¤‡ä»½çš„ï¼Ÿæ¯”å¦‚æ€ä¹ˆæ¢å¤åŠä¸ªæœˆå‰çš„æ•°æ®ï¼Ÿ">4ã€ä½ æ˜¯æ€ä¹ˆåš MySQLæ•°æ®å¤‡ä»½çš„ï¼Ÿæ¯”å¦‚æ€ä¹ˆæ¢å¤åŠä¸ªæœˆå‰çš„æ•°æ®ï¼Ÿ</h3><p>MySQL æ•°æ®å¤‡ä»½æœ‰å¤šç§æ–¹æ³•ï¼ŒåŒ…æ‹¬<strong>é€»è¾‘å¤‡ä»½ã€ç‰©ç†å¤‡ä»½ã€å…¨å¤‡ä»½å’Œå¢é‡å¤‡ä»½</strong>ã€‚å¦‚æœä½ æƒ³è¦æ¢å¤åŠä¸ªæœˆå‰çš„æ•°æ®ï¼Œä½ éœ€è¦å…ˆç¡®ä¿ä½ æœ‰åŠä¸ªæœˆå‰çš„å¤‡ä»½æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ç›¸åº”çš„â¼¯å…·æˆ–å‘½ä»¤ è¿›è¡Œè¿˜åŸã€‚</p><p><strong>é€»è¾‘å¤‡ä»½</strong></p><p>é€»è¾‘å¤‡ä»½æ˜¯ä½¿ç”¨ SQL è¯­å¥æ¥å¯¼å‡ºå’Œå¯¼â¼Šæ•°æ®åº“çš„æ•°æ®çš„æ–¹æ³•ã€‚</p><p>ä¼˜ç‚¹ï¼šæ˜¯ç®€å•æ˜“ç”¨ï¼Œå¯ä»¥è·¨å¹³å°å’Œå­˜å‚¨å¼•æ“ï¼Œå¯ä»¥éƒ¨åˆ†å¤‡ä»½å’Œæ¢å¤ã€‚</p><p>ç¼ºç‚¹ï¼šé€Ÿåº¦æ…¢ï¼Œå ç”¨ç©ºé—´å¤§ï¼Œå¯èƒ½å½±å“æ•°æ®åº“æ€§èƒ½ã€‚</p><ol><li>MySQL æä¾›äº†â¼€ä¸ªåŸç”Ÿçš„é€»è¾‘å¤‡ä»½â¼¯å…·å«åš mysqldumpã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å¤‡ä»½æ•´ä¸ªæ•°æ®åº“å®ä¾‹ã€å•ä¸ªæ•°æ®åº“æˆ– å•å¼ è¡¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦å¤‡ä»½â¼€ä¸ªå« ytt çš„æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œçª—â¼è¾“â¼Šï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump <span class="operator">-</span>u ç”¨æˆ·å <span class="operator">-</span>p å¯†ç  <span class="comment">--database ytt &gt; ytt.sql</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å¦‚æœä½ æƒ³è¦æ¢å¤è¿™ä¸ªæ–‡ä»¶åˆ°æ•°æ®åº“ä¸­ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œçª—â¼è¾“â¼Šï¼š</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u ç”¨æˆ·å -<span class="selector-tag">p</span> å¯†ç  &lt; ytt<span class="selector-class">.sql</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šæ‰§è¡Œ SQL æ–‡ä»¶ä¸­çš„è¯­å¥ï¼Œå°†æ•°æ®è¿˜åŸåˆ°æ•°æ®åº“ä¸­ã€‚</p><p><strong>ç‰©ç†å¤‡ä»½</strong></p><p>ç‰©ç†å¤‡ä»½æ˜¯ç›´æ¥æ‹·è´æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶ã€‚</p><p>ä¼˜ç‚¹ï¼š<strong>é€Ÿåº¦å¿«ï¼Œå ç”¨ç©ºé—´å°</strong>ï¼Œä¸å½±å“æ•°æ®åº“æ€§èƒ½ã€‚</p><p>ç¼ºç‚¹ï¼šæ¢å¤å¤æ‚ï¼Œéœ€è¦å…³é—­æ•°æ®åº“æœåŠ¡ï¼Œå¯èƒ½å¯¼è‡´<strong>æ•°æ®ä¸â¼€è‡´</strong>ã€‚</p><p>MySQL æœ‰â¼€ä¸ªå¼€æºçš„ç‰©ç†çƒ­å¤‡â¼¯å…·å«åš Percona XtraBackupã€‚å®ƒå¯ä»¥åœ¨ä¸é”è¡¨çš„æƒ…å†µä¸‹å¤‡ä»½ InnoDBã€XtraDB  å’Œ MyISAM å­˜å‚¨å¼•æ“çš„è¡¨ï¼Œå¹¶ä¸”æ”¯æŒå¢é‡å¤‡ä»½ã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å¤‡ä»½æ•´ä¸ªæ•°æ®åº“å®ä¾‹æˆ–å•ä¸ªæ•°æ®åº“ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦å…¨é‡å¤‡ä»½â¼€ä¸ªå« ytt çš„æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œçª—â¼è¾“â¼Šï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">innobackupex <span class="attribute">--user</span>=ç”¨æˆ·å <span class="attribute">--password</span>=å¯†ç  <span class="attribute">--databases</span>=<span class="string">&quot;ytt&quot;</span> /backup</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³è¦æ¢å¤è¿™ä¸ªç›®å½•åˆ°æ•°æ®åº“ä¸­ï¼Œä½ éœ€è¦å…ˆå‡†å¤‡å¥½æ•°æ®æ–‡ä»¶ï¼Œç„¶åæ‹·è´åˆ°å¯¹åº”çš„æ•°æ®ç›®å½•ä¸­ï¼Œå¹¶æ›´æ”¹æƒé™å’Œæ‰€æœ‰è€…ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">innobackupex</span> --apply-log /backup/<span class="number">2023</span>-<span class="number">02</span>-<span class="number">27</span>_00-<span class="number">00</span>-<span class="number">00</span> cp -r /backup/<span class="number">2023</span>-<span class="number">02</span>-<span class="number">27</span>_00-<span class="number">00</span></span><br><span class="line"><span class="attribute">00</span>/* /var/lib/mysql chown -R mysql:mysql /var/lib/mysql</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œåœ¨æ¢å¤ä¹‹å‰ï¼Œä½ éœ€è¦åœæ­¢MySQL æœåŠ¡ï¼Œå¹¶ç¡®ä¿æ•°æ®ç›®å½•ä¸ºç©ºã€‚</p><p><strong>å…¨å¤‡ä»½å’Œå¢é‡å¤‡ä»½</strong></p><p>å…¨å¤‡ä»½æ˜¯æŒ‡å¤‡ä»½æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä¸ç®¡æ•°æ®æ˜¯å¦æœ‰å˜åŒ–ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯æ¢å¤ç®€å•ï¼Œä¸éœ€è¦å…¶ä»–æ–‡ä»¶ã€‚å®ƒçš„ç¼ºç‚¹æ˜¯å ç”¨ç©ºé—´å¤§ï¼Œè€—æ—¶é•¿ï¼Œå½±å“æ•°æ®åº“æ€§èƒ½ã€‚</p><p>å¢é‡å¤‡ä»½æ˜¯æŒ‡åªå¤‡ä»½ä¸Šæ¬¡å…¨å¤‡ä»½æˆ–å¢é‡å¤‡ä»½åå‘ç”Ÿå˜åŒ–çš„æ•°æ®ï¼Œéœ€è¦å¼€å¯ binlog æ—¥å¿—åŠŸèƒ½. å®ƒçš„ä¼˜ç‚¹æ˜¯å ç”¨ç©ºé—´å°ï¼Œè€—æ—¶çŸ­ï¼Œä¸å½±å“æ•°æ®åº“æ€§èƒ½ï¼Œå®ƒçš„ç¼ºç‚¹æ˜¯æ¢å¤å¤æ‚ï¼Œéœ€è¦ä¾èµ– binlog æ—¥å¿—æ–‡ä»¶å’Œå…¨å¤‡ä»½æ–‡ä»¶ã€‚</p><h3 id="5ã€â¼€æ¡-SQL-è¯­å¥åœ¨-MySQL-ä¸­çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"><strong>5ã€â¼€æ¡ SQL è¯­å¥åœ¨ MySQL ä¸­çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</strong></h3><p>[<img src="https://s21.ax1x.com/2024/07/05/pkRrf4e.png" alt="pkRrf4e.png"></p><p>[<img src="https://s21.ax1x.com/2024/07/05/pkRrWND.png" alt="pkRrWND.png"></p><ul><li><strong>è¿æ¥å™¨</strong>ï¼šå®¢æˆ·ç«¯é¦–å…ˆè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¦‚æœæ²¡é€šè¿‡ç›´æ¥è¿”å›ã€‚</li><li><strong>æŸ¥è¯¢ç¼“å­˜</strong>ï¼šå¦‚æœèº«ä»½éªŒè¯ä¸é€šè¿‡åˆ™æŸ¥è¯¢ç¼“å­˜ã€‚ç¼“å­˜è¿™ä¸ªåŸç†å¾ˆå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯æŠŠå¸¸ç”¨çš„æ•°æ®æ”¾åˆ°æ›´é«˜æ•ˆçš„åœ°æ–¹ä¾¿äº æŸ¥è¯¢ã€‚ æŸ¥è¯¢ç¼“å­˜ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå°±æ˜¯æ¯å½“æ•°æ®æ›´æ”¹çš„æ—¶å€™å°±è¦é‡æ–°è®¾ç½®ç¼“å­˜ï¼Œ<strong>åœ¨ MySQL8.0 å·²ç»å°†æŸ¥è¯¢ç¼“å­˜å»æ‰</strong>ã€‚</li><li><strong>åˆ†æå™¨ï¼š<strong>åˆ†æå™¨</strong>å…ˆä¼šåšâ€œè¯æ³•åˆ†æâ€</strong>ã€‚æŠŠä½ è¾“â¼Šçš„å†…å®¹è¿›è¡Œè¯†åˆ«ï¼ŒçŸ¥é“å­—ç¬¦åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆå«ä¹‰<strong>ç„¶åè¿›è¡Œè¯­æ³•åˆ†æ</strong>ï¼Œå¦‚æœä½ çš„ SQL è¯­å¥ä¸ç¬¦åˆ MySQL è¯­æ³•å°±ä¼šæ”¶åˆ°é”™è¯¯æé†’ã€‚</li><li><strong>ä¼˜åŒ–å™¨ï¼š<strong>ä¼˜åŒ–å™¨ä½œç”¨å°±æ˜¯å†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼Œå†³å®š join è¡¨çš„è¿æ¥é¡ºåºã€‚ ä¼˜åŒ–å™¨ä¼šé€‰æ‹©å®ƒ</strong>è‡ªå·±è®¤ä¸ºæœ€é«˜æ•ˆçš„æ–¹æ¡ˆ</strong>ï¼Œ (ä¹Ÿä»£è¡¨å®ƒä¸â¼€å®šèƒ½é€‰æ‹©å‡ºæœ€ä¼˜çš„æ–¹æ¡ˆ)ã€‚</li><li>**æ‰§è¡Œå™¨ï¼š**æ‰§è¡Œå™¨è¿˜æ˜¯å…ˆä¼šåˆ¤æ–­æœ‰æ²¡æœ‰æ‰§è¡Œçš„æƒé™ï¼Œå¦‚æœæœ‰æƒé™çš„è¯æ‰ä¼šæ‰§è¡Œä¸‹â¼€æ­¥ã€‚éå†æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œå¹¶æŠŠç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ul><h3 id="6ã€MySQL-ä¸­çš„ç´¢å¼•æ˜¯æ€ä¹ˆå®ç°çš„ï¼ŸB-æ ‘æ˜¯ä»€ä¹ˆï¼ŒB-æ ‘å’Œ-B-æ ‘çš„åŒºåˆ«ï¼Œ-ä¸ºä»€ä¹ˆ-MySQL-è¦ç”¨-B-æ ‘ï¼Ÿ">6ã€MySQL ä¸­çš„ç´¢å¼•æ˜¯æ€ä¹ˆå®ç°çš„ï¼ŸB+ æ ‘æ˜¯ä»€ä¹ˆï¼ŒB æ ‘å’Œ B+ æ ‘çš„åŒºåˆ«ï¼Œ ä¸ºä»€ä¹ˆ MySQL è¦ç”¨ B+ æ ‘ï¼Ÿ</h3><p>MySQL ä¸­çš„ç´¢å¼•é‡‡ç”¨B+æ ‘å®ç°ã€‚</p><p>B+æ ‘æ˜¯â¼€ç§å¤šè·¯æœç´¢æ ‘ï¼Œæ˜¯å¯¹Bæ ‘çš„â¼€ç§æ”¹è¿›ã€‚</p><p>Bæ ‘å’ŒB+æ ‘çš„ä¸»è¦åŒºåˆ«åœ¨äº :</p><ul><li><p>B+æ ‘<strong>åªå­˜å‚¨æ•°æ®çš„ç´¢å¼•ä¿¡æ¯</strong>ï¼Œå¹¶ä¸”æŠŠå¶å­èŠ‚ç‚¹å­˜å‚¨åœ¨åŒâ¼€å±‚ä¸Šï¼Œä¸­é—´èŠ‚ç‚¹åªèµ·åˆ°ç´¢å¼•ä½œç”¨ï¼ŒæŸ¥è¯¢æ—¶åªéœ€è¦éå†â¼€æ¬¡æ ‘å°±èƒ½æ‰¾åˆ°ç›®æ ‡æ•°æ®,å› æ­¤B+æ ‘<strong>å…·æœ‰æ›´å¥½çš„æŸ¥è¯¢æ€§èƒ½å’Œæ›´å°‘çš„ç£ç›˜I/Oæ¬¡æ•°</strong>ï¼ŒB+æ ‘çš„å¶â¼¦èŠ‚ç‚¹éƒ½è¿æ¥æˆ äº†â¼€ä¸ªæœ‰åºçš„é“¾è¡¨ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ç­‰æ“ä½œã€‚é€‚åˆäºæ•°æ®åº“ç­‰å­˜å‚¨å¤§é‡æ•°æ®çš„åœºæ™¯ã€‚</p></li><li><p>Bæ ‘æ˜¯â¼€ç§<strong>å¹³è¡¡æ ‘</strong>ï¼Œå®ƒçš„æ¯ä¸ªèŠ‚ç‚¹<strong>éƒ½å­˜å‚¨æœ‰åºçš„å…³é”®å­—</strong>ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°ç›®ä»‹äºm/2å’Œmä¹‹é—´ã€‚Bæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹<strong>æ—¢å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨ç´¢å¼•ä¿¡æ¯</strong>ï¼Œå› æ­¤Bæ ‘å¯ä»¥å‡å°‘I/Oæ¬¡æ•°ï¼Œé€‚åˆäºæ–‡ä»¶ç³»ç»Ÿç­‰å­˜å‚¨å¤§é‡æ•°æ®çš„åœºæ™¯ã€‚ä½†æ˜¯Bæ ‘çš„<strong>æŸ¥è¯¢æ€§èƒ½ç›¸å¯¹è¾ƒä½</strong>ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯èƒ½å­˜å‚¨æ•°æ®ï¼ŒæŸ¥è¯¢æ—¶éœ€è¦éå†å¤šä¸ªèŠ‚ç‚¹æ‰èƒ½æ‰¾åˆ°ç›®æ ‡æ•°æ®ã€‚</p><p>åœ¨MySQLä¸­ä½¿ç”¨B+æ ‘ä½œä¸ºç´¢å¼•çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯å› ä¸ºB**+æ ‘çš„æŸ¥è¯¢æ€§èƒ½å¥½ã€â½€æŒèŒƒå›´æŸ¥è¯¢ã€â½€æŒæ•°æ®åˆ†é¡µ**ç­‰æ“ä½œï¼Œé€‚ç”¨äºå­˜å‚¨æµ·é‡æ•°æ®çš„åœºæ™¯ã€‚æ­¤å¤–ï¼ŒB+æ ‘çš„ç´¢å¼•ç»“æ„ç›¸å¯¹ç®€å•ï¼Œæ˜“äºå®ç°å’Œç»´æŠ¤ï¼Œèƒ½å¤Ÿæ»¡è¶³é«˜å¹¶å‘ã€é«˜å¯ç”¨æ€§çš„æ•°æ®åº“è¦æ±‚</p></li></ul><h3 id="7ã€MySQL-äº‹åŠ¡æœ‰å“ªäº›éš”ç¦»çº§åˆ«ã€åˆ†åˆ«æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œä»¥åŠ-MySQL-çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><strong>7ã€MySQL äº‹åŠ¡æœ‰å“ªäº›éš”ç¦»çº§åˆ«ã€åˆ†åˆ«æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œä»¥åŠ MySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3><ul><li><strong>è¯»æœªæäº¤</strong>ï¼ˆRead Uncommittedï¼‰ï¼šäº‹åŠ¡<strong>å¯ä»¥è¯»å–æœªæäº¤çš„æ•°æ®</strong>ï¼Œå¯èƒ½<strong>ä¼šè¯»åˆ°è„æ•°æ®ï¼Œä¼šå¯¼è‡´å¹»è¯»ã€ä¸å¯é‡ å¤è¯»ã€è„è¯»</strong>ç­‰é—®é¢˜ï¼›</li><li><strong>è¯»å·²æäº¤</strong>ï¼ˆRead Committedï¼‰ï¼šåªèƒ½è¯»å–<strong>å·²ç»æäº¤çš„æ•°æ®</strong>ï¼Œå¯ä»¥é¿å…è„è¯»é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½ä¼š<strong>é‡åˆ°ä¸å¯é‡å¤è¯»ã€å¹»è¯»</strong>é—®é¢˜ã€‚</li><li><strong>å¯é‡å¤è¯»</strong>ï¼ˆRepeatable Readï¼‰ï¼šä¿è¯<strong>åŒâ¼€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒâ¼€æ•°æ®çš„ç»“æœæ˜¯â¼€è‡´</strong>çš„ï¼Œé¿å…äº†è„è¯»å’Œä¸å¯é‡å¤è¯»é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šé‡åˆ°<strong>å¹»è¯»</strong>é—®é¢˜ã€‚</li><li><strong>åºåˆ—åŒ–</strong>ï¼ˆSerializableï¼‰ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå¯ä»¥é¿å…æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†æ˜¯å¹¶å‘æ€§èƒ½éå¸¸ä½ï¼Œå¼€é”€å¾ˆå¤§ã€‚</li></ul><p>MySQL çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯<strong>å¯é‡å¤è¯»</strong>ï¼ˆRepeatable Readï¼‰ã€‚</p><ul><li><strong>è„è¯»</strong>ï¼š<strong>â¼€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦â¼€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®</strong>ã€‚</li><li><strong>ä¸å¯é‡å¤è¯»ï¼šåŒâ¼€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»å–åŒâ¼€æ•°æ®å¾—åˆ°ä¸åŒç»“æœã€‚</strong></li><li><strong>å¹»è¯»ï¼šæŒ‡åŒâ¼€ä¸ªäº‹åŠ¡å‰åè¯»å–çš„æ•°æ®é›†åˆä¸â¼€è‡´ã€‚</strong></li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240601143307012.png" alt="image-20240601143307012"></p><h3 id="8ã€æ„å‘é”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯è¡¨çº§é”è¿˜æ˜¯è¡Œçº§é”ï¼Ÿ">8ã€æ„å‘é”æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯è¡¨çº§é”è¿˜æ˜¯è¡Œçº§é”ï¼Ÿ</h3><p>åœ¨ä½¿ç”¨ InnoDB å¼•æ“çš„è¡¨â¾¥æ—¶å¯¹æŸäº›è®°å½•åŠ ä¸Š**ã€Œå…±äº«é”ã€<strong>ä¹‹å‰ï¼Œéœ€è¦å…ˆåœ¨è¡¨çº§åˆ«åŠ ä¸Šâ¼€ä¸ª</strong>ã€Œæ„å‘å…±äº«é”ã€**</p><p>åœ¨ä½¿ç”¨ InnoDB å¼•æ“çš„è¡¨â¾¥æ—¶å¯¹æŸäº›è®°å½•åŠ ä¸Š**ã€Œç‹¬å é”ã€<strong>ä¹‹å‰ï¼Œéœ€è¦å…ˆåœ¨è¡¨çº§åˆ«åŠ ä¸Šâ¼€ä¸ª</strong>ã€Œæ„å‘ç‹¬å é”ã€**</p><p>ä¹Ÿå°±æ˜¯ï¼Œå½“æ‰§è¡Œæ’â¼Šã€æ›´æ–°ã€åˆ é™¤æ“ä½œï¼Œéœ€è¦å…ˆå¯¹è¡¨åŠ ä¸Š**ã€Œæ„å‘ç‹¬å é”ã€**ï¼Œç„¶åå¯¹è¯¥è®°å½•åŠ ç‹¬å é”ã€‚</p><p><strong>æ„å‘é”çš„ä½œç”¨</strong></p><p>æ„å‘å…±äº«é”å’Œæ„å‘ç‹¬å é”æ˜¯è¡¨çº§é”ï¼Œä¸ä¼šå’Œè¡Œçº§çš„å…±äº«é”å’Œç‹¬å é”å‘ç”Ÿå†²çªï¼Œè€Œä¸”æ„å‘é”ä¹‹é—´ä¹Ÿä¸ä¼šå‘ç”Ÿå†²çªï¼Œåªä¼šå’Œå…±äº«è¡¨é”ï¼ˆlock tables â€¦ readï¼‰å’Œç‹¬å è¡¨é”ï¼ˆlock tables â€¦ writeï¼‰å‘ç”Ÿå†²çªã€‚</p><p>è¡¨é”å’Œè¡Œé”æ˜¯æ»¡è¶³è¯»è¯»å…±äº«ã€è¯»å†™äº’æ–¥ã€å†™å†™äº’æ–¥çš„ã€‚</p><p><strong>ä½œç”¨ï¼šä¸ºäº†å¿«é€Ÿåˆ¤æ–­è¡¨é‡Œæ˜¯å¦æœ‰è®°å½•è¢«åŠ é”</strong></p><p>æ„å‘é”æ˜¯è¡¨çº§åˆ«é”</p><h3 id="9ã€MVCC-æ˜¯ä»€ä¹ˆï¼ŸInnoDB-æ˜¯å¦‚ä½•å®ç°-MVCC-æœºåˆ¶çš„ï¼Ÿ">9ã€MVCC æ˜¯ä»€ä¹ˆï¼ŸInnoDB æ˜¯å¦‚ä½•å®ç° MVCC æœºåˆ¶çš„ï¼Ÿ</h3><p>MVCC æ˜¯æŒ‡<strong>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</strong>ï¼ˆMultiversion Concurrency Controlï¼‰ï¼Œæ˜¯â¼€ç§<strong>å¹¶å‘æ§åˆ¶æœºåˆ¶</strong>ï¼Œå¸¸ç”¨äºæ•°æ®åº“ç³»ç»Ÿ ä¸­ï¼Œç”¨äº<strong>å®ç°äº‹åŠ¡çš„å¹¶å‘æ§åˆ¶</strong>ã€‚å®ƒå…è®¸åœ¨<strong>åŒâ¼€æ—¶é—´å¤šä¸ªäº‹åŠ¡å¯¹åŒâ¼€ä¸ªæ•°æ®é›†åˆè¿›è¡Œè¯»å–æ“ä½œ</strong>ï¼ŒåŒæ—¶é˜²æ­¢æ•°æ®ä¸â¼€è‡´å’Œå…¶ä»–å¹¶å‘é—®é¢˜ã€‚</p><p>InnoDB æ˜¯ MySQL ä¸­æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ä¹‹â¼€ï¼Œå®ƒçš„ MVCC å®ç°æ˜¯é€šè¿‡<strong>åœ¨æ¯è¡Œè®°å½•ä¸­æ·»åŠ ä¸¤ä¸ªéšè—çš„åˆ—</strong>ï¼Œåˆ†åˆ«è®°å½•<strong>è¡Œçš„åˆ›å»ºæ—¶é—´å’Œè¿‡æœŸæ—¶é—´</strong>ï¼Œä»¥æ­¤æ¥åˆ¤æ–­äº‹åŠ¡å¯¹è¯¥è¡Œè®°å½•çš„å¯è§æ€§ã€‚å½“â¼€ä¸ªäº‹åŠ¡éœ€è¦è¯»å–â¼€è¡Œè®°å½•æ—¶ï¼ŒInnoDB é¦–å…ˆ è¯»å–è¿™è¡Œè®°å½•çš„åˆ›å»ºæ—¶é—´å’Œè¿‡æœŸæ—¶é—´ï¼Œå¹¶æ ¹æ®è¿™äº›ä¿¡æ¯åˆ¤æ–­è¯¥è¡Œè®°å½•æ˜¯å¦å¯é”®ã€‚å¦‚æœåˆ›å»ºæ—¶é—´æ—©äºå½“å‰äº‹åŠ¡çš„å¼€å§‹æ—¶é—´ï¼Œä¸”è¿‡æœŸæ—¶é—´æ™šäºå½“å‰äº‹åŠ¡çš„å¼€å§‹æ—¶é—´ï¼Œé‚£ä¹ˆè¯¥è¡Œè®°å½•å¯¹å½“å‰äº‹åŠ¡å¯è§ã€‚</p><p>åœ¨ InnoDB ä¸­ï¼ŒMVCC ä¸»è¦æ˜¯é€šè¿‡å®ç°ä»¥ä¸‹å‡ ä¸ªæœºåˆ¶æ¥å®ç°çš„ï¼š</p><ul><li><strong>äº‹åŠ¡ç‰ˆæœ¬å·ï¼š<strong>æ¯ä¸ªäº‹åŠ¡éƒ½æœ‰â¼€ä¸ª</strong>å”¯â¼€çš„ç‰ˆæœ¬å·</strong>ï¼Œç”¨æ¥æ ‡è¯†è¯¥äº‹åŠ¡çš„åˆ›å»ºæ—¶é—´ã€‚</li><li><strong>è¯»å–è§†å›¾ï¼š<strong>æ¯ä¸ªäº‹åŠ¡åœ¨</strong>å¼€å§‹æ—¶éƒ½ä¼šåˆ›å»ºâ¼€ä¸ªè¯»å–è§†å›¾</strong>ï¼Œè®°å½•è¯¥äº‹åŠ¡å¼€å§‹æ—¶é—´å’Œå…¶ä»–ä¿¡æ¯ã€‚åœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œæ‰€æœ‰è¯»å–æ“ä½œéƒ½è¦æ£€æŸ¥è¯¥è§†å›¾ï¼Œä»¥ç¡®å®šè¯»å–å“ªäº›ç‰ˆæœ¬çš„æ•°æ®ã€‚</li><li>undo æ—¥å¿—ï¼šåœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œå¦‚æœå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆä¼šå…ˆå°†åŸå§‹æ•°æ®å¤åˆ¶â¼€ä»½åˆ° undo â½‡å¿—ä¸­ã€‚è¿™æ ·ï¼Œ åœ¨å›æ»šæ“ä½œæ—¶å°±å¯ä»¥ä½¿ç”¨ undo â½‡å¿—ä¸­çš„æ•°æ®æ¥è¿˜åŸåŸå§‹æ•°æ®ã€‚</li><li>å¿«ç…§è¯»å–ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œäº‹åŠ¡éœ€è¦è¯»å–â¼€ä¸ªæ•°æ®çš„å†å²ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯å½“å‰ç‰ˆæœ¬ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨å¿«ç…§è¯»å–æ¥å®ç°ï¼Œå³åœ¨è¯»å–æ—¶æ ¹æ®äº‹åŠ¡å¼€å§‹æ—¶é—´å’Œ undo â½‡å¿—æ¥è¯»å–å†å²ç‰ˆæœ¬çš„æ•°æ®ã€‚</li></ul><h3 id="10ã€è¦†ç›–ç´¢å¼•å’Œè”åˆç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿè®²â¼€ä¸‹ç´¢å¼•çš„æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‚"><strong>10ã€è¦†ç›–ç´¢å¼•å’Œè”åˆç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿè®²â¼€ä¸‹ç´¢å¼•çš„æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‚</strong></h3><p><strong>è¦†ç›–ç´¢å¼•</strong></p><ul><li>æ˜¯æŒ‡ SQL ä¸­ æŸ¥è¯¢ çš„æ‰€æœ‰å­—æ®µï¼Œåœ¨ç´¢å¼• <strong>B+ Tree çš„å¶å­èŠ‚ç‚¹</strong>ä¸Šéƒ½èƒ½æ‰¾å¾—åˆ°çš„é‚£äº›ç´¢å¼•ï¼Œä»â¼†çº§ç´¢å¼•ä¸­æŸ¥è¯¢å¾—åˆ°è®°å½•ï¼Œè€Œä¸éœ€è¦é€šè¿‡<strong>èšç°‡ç´¢å¼•</strong>æŸ¥è¯¢è·å¾—ï¼Œå¯ä»¥<strong>é¿å…å›è¡¨</strong>çš„æ“ä½œã€‚</li></ul><p><strong>è”åˆç´¢å¼•</strong></p><ul><li>é€šè¿‡å°†<strong>å¤šä¸ªå­—æ®µç»„åˆæˆâ¼€ä¸ªç´¢å¼•</strong>ï¼Œè¯¥ç´¢å¼•å°±è¢«ç§°ä¸ºè”åˆç´¢å¼•ã€‚</li></ul><p><strong>æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™</strong></p><ul><li>è”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œ<strong>åœ¨é‡åˆ°èŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ &gt;ã€&lt;ï¼‰çš„æ—¶å€™ï¼Œå°±ä¼šåœâ½ŒåŒ¹é…</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>èŒƒå›´æŸ¥è¯¢çš„å­—æ®µå¯ä»¥ç”¨åˆ°è”åˆç´¢å¼•</strong>ï¼Œä½†æ˜¯åœ¨èŒƒå›´<strong>æŸ¥è¯¢å­—æ®µçš„åé¢çš„å­—æ®µâ½†æ³•ç”¨åˆ°è”åˆç´¢å¼•</strong>ã€‚æ³¨æ„ï¼Œå¯¹äº &gt;=ã€&lt;=ã€BETWEENã€ like å‰ç¼€åŒ¹é…çš„èŒƒå›´æŸ¥è¯¢ï¼Œå¹¶ä¸ä¼šåœâ½ŒåŒ¹é…ã€‚</li></ul><h3 id="11ã€ä»€ä¹ˆæ˜¯-MySQL-æ‰§è¡Œè®¡åˆ’ï¼Ÿå¦‚ä½•è·å–æ‰§è¡Œè®¡åˆ’å¹¶å¯¹å…¶è¿›è¡Œåˆ†æï¼Ÿ">11ã€ä»€ä¹ˆæ˜¯ MySQL æ‰§è¡Œè®¡åˆ’ï¼Ÿå¦‚ä½•è·å–æ‰§è¡Œè®¡åˆ’å¹¶å¯¹å…¶è¿›è¡Œåˆ†æï¼Ÿ</h3><p>MySQL æ‰§è¡Œè®¡åˆ’æ˜¯ MySQL <strong>æŸ¥è¯¢ä¼˜åŒ–å™¨åˆ†æ SQL æŸ¥è¯¢æ—¶ç”Ÿæˆçš„â¼€ä»½è¯¦ç»†è®¡åˆ’</strong>ï¼ŒåŒ…æ‹¬è¡¨<strong>å¦‚ä½•è¿æ¥ã€æ˜¯å¦èµ°ç´¢å¼•ã€è¡¨æ‰«æè¡Œæ•°</strong>ç­‰ã€‚é€šè¿‡è¿™ä»½æ‰§è¡Œè®¡åˆ’ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æè¿™æ¡ SQL æŸ¥è¯¢ä¸­å­˜åœ¨çš„é—®é¢˜ï¼ˆå¦‚æ˜¯å¦å‡ºç°å…¨è¡¨æ‰«æï¼‰ï¼Œä»è€Œè¿›è¡Œé’ˆå¯¹ä¼˜åŒ–ã€‚</p><ul><li><p>idï¼šSELECT æŸ¥è¯¢çš„åºåˆ—å·ï¼Œè¡¨ç¤ºæ‰§è¡Œselectå­å¥çš„é¡ºåºï¼ˆid ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºä»ä¸Šåˆ°ä¸‹ï¼›id ä¸åŒï¼Œå€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼›å¦‚æœæ˜¯å¹¶é›†ç»“æœï¼Œåˆ™ id å€¼ä¸º NULL</p></li><li><p>select_typeï¼šæŸ¥è¯¢ç±»å‹ï¼Œæ¥åŒºåˆ†ç®€å•æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰ã€‚å¸¸è§çš„ç±»å‹æœ‰ï¼š</p><ul><li>SIMPLEï¼šç®€å•æŸ¥è¯¢ï¼Œä¸åŒ…å«è¡¨è¿æ¥æˆ–å­æŸ¥è¯¢</li><li>PRIMARYï¼šä¸»æŸ¥è¯¢ï¼Œå¤–å±‚çš„æŸ¥è¯¢</li><li>SUBQUERYï¼šå­æŸ¥è¯¢ä¸­ç¬¬â¼€ä¸ª SELECT</li><li>UNIONï¼šUNION åé¢çš„ SELECT æŸ¥è¯¢è¯­å¥</li><li>UNION RESULTï¼šUNION åˆå¹¶çš„ç»“æœ</li></ul></li><li><p>tableï¼šæŸ¥è¯¢ç”¨åˆ°çš„è¡¨å</p></li><li><p>partitionsï¼šåŒ¹é…çš„åˆ†åŒºï¼Œæ²¡æœ‰åˆ†åŒºçš„è¡¨ä¸º NULL</p></li><li><p>type â˜…ï¼šè¿æ¥çš„ç±»å‹ï¼Œå¸¸è§çš„ç±»å‹æœ‰ï¼ˆæ€§èƒ½ä»å¥½åˆ°å·®ï¼‰ï¼š</p><ul><li><p>systemï¼šå­˜å‚¨å¼•æ“èƒ½å¤Ÿç›´æ¥çŸ¥é“è¡¨çš„è¡Œæ•°ï¼ˆå¦‚ MyISAMï¼‰å¹¶ä¸”åªæœ‰â¼€è¡Œæ•°æ®</p></li><li><p>constï¼šé€šè¿‡ç´¢å¼•â¼€æ¬¡æ‰¾åˆ°ï¼Œé€šå¸¸åœ¨ç”¨ä¸»é”®æˆ–å”¯â¼€ç´¢å¼•æ—¶å‡ºç°</p></li><li><p>eq_refï¼šç”¨ä¸»é”®æˆ–å”¯â¼€ç´¢å¼•å­—æ®µä½œä¸ºè¿æ¥è¡¨æ¡ä»¶</p></li><li><p>refï¼šç”¨æ™®é€šç´¢å¼•çš„å­—æ®µä½œä¸ºè¿æ¥è¡¨æ¡ä»¶</p></li><li><p>rangeï¼šå¯¹ç´¢å¼•åˆ—è¿›è¡ŒèŒƒå›´æŸ¥è¯¢</p></li><li><p>indexï¼šåˆ©ç”¨ç´¢å¼•æ‰«æå…¨è¡¨</p></li><li><p>allï¼šå…¨è¡¨æ‰«æ</p></li></ul></li><li><p>possible_keysï¼šå¯èƒ½ç”¨åˆ°çš„ç´¢å¼•</p></li><li><p>key â˜…ï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼Œæ²¡æœ‰ä½¿ç”¨ä¸º NULL</p></li><li><p>key_lenï¼šç´¢å¼•å­—æ®µçš„æœ€å¤§é•¿åº¦ï¼Œåœ¨æ»¡è¶³éœ€æ±‚ä¸‹è¶ŠçŸ­è¶Šå¥½</p></li><li><p>refï¼šå½“ä½¿ç”¨ç´¢å¼•ç­‰å€¼æŸ¥è¯¢æ—¶ï¼Œä¸ç´¢å¼•ä½œæ¯”è¾ƒçš„åˆ—æˆ–å¸¸é‡</p></li><li><p>rows â˜…ï¼šé¢„è®¡æ‰«æçš„è¡Œæ•°ï¼Œå€¼è¶Šå¤§ï¼ŒæŸ¥è¯¢æ€§èƒ½è¶Šå·®</p></li><li><p>filteredï¼šè¡¨ç¤ºè¿”å›ç»“æœçš„è¡Œæ•°å éœ€è¯»å–è¡Œæ•°çš„ç™¾åˆ†æ¯”</p></li><li><p>Extra â˜…ï¼šæœ‰å…³æŸ¥è¯¢æ‰§è¡Œçš„å…¶ä»–ä¿¡æ¯</p><ul><li>using indexï¼šä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä¸ç”¨å›è¡¨æŸ¥è¯¢</li><li>using whereï¼šä½¿ç”¨ where â¼¦å¥æ¥è¿‡æ»¤ç»“æœé›†</li><li>using temporaryï¼šä½¿ç”¨åˆ°ä¸´æ—¶è¡¨æ¥å­˜å‚¨ä¸­é—´ç»“æœï¼Œå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜</li><li>using filesortï¼šæŸ¥è¯¢éœ€è¦è¿›è¡Œæ–‡ä»¶æ’åºæ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜</li><li>using index conditionï¼šå…ˆæ ¹æ®èƒ½ç”¨ç´¢å¼•çš„æ¡ä»¶è·å–ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¡Œï¼Œç„¶ååœ¨æ ¹æ®å…¶ä»–æ¡ä»¶å»è¿‡æ»¤æ•°æ®ã€‚</li></ul></li></ul><h3 id="12ã€MySQL-æ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“ï¼Ÿé»˜è®¤ä½¿ç”¨å“ªä¸ªï¼ŸMyISAM-å’Œ-InnoDB-å¼•-æ“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ">12ã€MySQL æ”¯æŒå“ªäº›å­˜å‚¨å¼•æ“ï¼Ÿé»˜è®¤ä½¿ç”¨å“ªä¸ªï¼ŸMyISAM å’Œ InnoDB å¼• æ“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ</h3><p>MySQL â½€æŒå¤šç§å­˜å‚¨å¼•æ“ï¼ŒåŒ…æ‹¬ <strong>InnoDBã€MyISAMã€MEMORYã€CSV</strong> ç­‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL ä½¿ç”¨çš„å­˜å‚¨å¼• æ“æ˜¯ InnoDBã€‚</p><p>MyISAM å’Œ <strong>InnoDB</strong> æ˜¯ <strong>MySQL</strong> ä¸­ æœ€å¸¸ç”¨ çš„ä¸¤ç§å­˜å‚¨å¼•æ“ï¼Œå®ƒä»¬æœ‰ä»¥ä¸‹<strong>åŒºåˆ«</strong>ï¼š</p><ul><li><strong>é”å®šæ–¹å¼ä¸åŒ</strong>ï¼šMyISAM ä½¿ç”¨<strong>è¡¨çº§é”å®š</strong>ï¼Œè€Œ InnoDB ä½¿ç”¨<strong>è¡Œçº§é”å®š</strong>ã€‚åœ¨å¹¶å‘è®¿é—®æ—¶ï¼ŒInnoDB çš„é”å®šæ–¹å¼æ›´åŠ ç²¾ç»†ï¼Œå¯ä»¥é¿å…é”å®šæ•´ä¸ªè¡¨ï¼Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚</li><li><strong>æ•°æ®å®Œæ•´æ€§ä¸åŒ</strong>ï¼šMyISAM <strong>ä¸æ”¯æŒäº‹åŠ¡å’Œå¤–é”®çº¦æŸ</strong>ï¼Œè€Œ InnoDB <strong>â½€æŒäº‹åŠ¡å’Œå¤–é”®çº¦æŸ</strong>ï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„å®Œæ•´ æ€§å’Œâ¼€è‡´æ€§ã€‚</li><li><strong>è¯»å†™æ€§èƒ½ä¸åŒï¼š<strong>MyISAM çš„</strong>è¯»å†™æ€§èƒ½ç›¸å¯¹è¾ƒé«˜*é«˜ï¼Œé€‚åˆäº</strong>è¯»å¯†é›†å‹<strong>åº”ç”¨ï¼›è€Œ InnoDB çš„</strong>å†™æ€§èƒ½ç›¸å¯¹è¾ƒé«˜**ï¼Œé€‚åˆäºå†™å¯†é›†å‹åº”ç”¨ã€‚</li><li><strong>ç©ºé—´åˆ©ç”¨ç‡ä¸åŒï¼šMyISAM ä¸â½€æŒè¡Œçº§åˆ«çš„å­˜å‚¨</strong>ï¼Œå­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡è¾ƒä½ï¼›è€Œ InnoDB â½€æŒè¡Œçº§åˆ«çš„å­˜å‚¨ï¼Œå­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡æ›´é«˜ã€‚</li></ul><p>é€‰æ‹©åº”ç”¨åœºæ™¯ï¼š</p><ul><li>å¦‚æœåº”ç”¨ä¸»è¦æ˜¯<strong>è¯»æ“ä½œ</strong>ï¼Œå¯ä»¥è€ƒè™‘é€‰æ‹© MyISAM å¼•æ“ï¼Œä»¥æé«˜è¯»å–æ€§èƒ½ã€‚</li><li>å¦‚æœåº”ç”¨ä¸»è¦æ˜¯<strong>å†™æ“ä½œæˆ–éœ€è¦â½€æŒäº‹åŠ¡å’Œå¤–é”®çº¦æŸ</strong>ï¼Œå¯ä»¥è€ƒè™‘é€‰æ‹© InnoDB å¼•æ“ï¼Œä»¥ä¿è¯<strong>æ•°æ®çš„å®Œæ•´æ€§å’Œâ¼€è‡´æ€§</strong>ã€‚</li><li>å¦‚æœéœ€è¦<strong>é«˜æ€§èƒ½å’Œé«˜å¯ç”¨æ€§</strong>ï¼Œå¯ä»¥è€ƒè™‘é€‰æ‹©ä½¿ç”¨ <strong>MySQL é›†ç¾¤</strong>æˆ–ä½¿ç”¨å¤šä¸ªå‰¯æœ¬å®ä¾‹ï¼Œå¹¶å°†æ•°æ®åˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚</li></ul><h2 id="Spring-æ¡†æ¶">Spring æ¡†æ¶</h2><h3 id="1ã€Spring-æ¡†æ¶æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨-Spring-æ¡†æ¶æœ‰å“ªäº›å¥½å¤„ï¼Ÿ">1ã€Spring æ¡†æ¶æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨ Spring æ¡†æ¶æœ‰å“ªäº›å¥½å¤„ï¼Ÿ</h3><p>ä»‹ç»</p><blockquote><p>Spring æ¡†æ¶æ˜¯â¼€ä¸ªå¼€æºçš„ Java åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œç”¨äºæ„å»ºä¼ä¸šçº§åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†å…¨é¢çš„åŸºç¡€è®¾æ–½â½€æŒï¼ŒåŒ…æ‹¬<strong>æ§åˆ¶åè½¬ï¼ˆIoCï¼‰</strong>ã€<strong>ä¾èµ–æ³¨â¼Š</strong>ï¼ˆDIï¼‰ã€**AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰**ç­‰åŠŸèƒ½ï¼Œä½¿å¼€å‘è€…å¯ä»¥æ›´åŠ ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œè€Œä¸å¿…å¤„ç†åº•å±‚çš„æ¡†æ¶ä»£ç ã€‚</p></blockquote><ul><li>Spring æ¡†æ¶ç”±å¤šä¸ªæ¨¡å—ç»„æˆï¼Œå…¶ä¸­æ ¸å¿ƒæ¨¡å—æ˜¯ Spring Frameworkï¼Œå®ƒæä¾›äº†è®¸å¤šå¸¸ç”¨çš„å·¥å…·å’ŒæœåŠ¡</li></ul><p>Spring æ¡†æ¶çš„ä¸»è¦ä¼˜ç‚¹å…·ä½“å¦‚ä¸‹ï¼š</p><ul><li><strong>æ–¹ä¾¿è§£è€¦</strong>ï¼Œç®€åŒ–å¼€å‘ã€‚ Spring å°±æ˜¯â¼€ä¸ªå¤§å·¥å‚ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»çš„ç»´æŠ¤äº¤ç»™ Spring ç®¡ç†ã€‚</li><li>æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ã€‚ Spring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆå¦‚ Struts2ã€Hibernateã€MyBatis ç­‰ï¼‰çš„ç›´æ¥æ”¯æŒã€‚</li><li>é™ä½ Java EE API çš„ä½¿ç”¨éš¾åº¦ã€‚ Spring å¯¹ Java EE å¼€å‘ä¸­éå¸¸éš¾ç”¨çš„â¼€äº› APIï¼ˆJDBCã€JavaMailã€è¿œç¨‹è°ƒç”¨ç­‰ï¼‰éƒ½æä¾›äº†å°è£…ï¼Œä½¿è¿™äº› API åº”ç”¨çš„ éš¾åº¦å¤§å¤§é™ä½ã€‚</li><li>æ–¹ä¾¿ç¨‹åºçš„æµ‹è¯•ã€‚ Spring â½€æŒ JUnitï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æ–¹ä¾¿åœ°æµ‹è¯• Spring ç¨‹åºã€‚AOP ç¼–ç¨‹çš„â½€æŒã€‚</li><li>Spring <strong>æä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹</strong>ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªå’Œè¿è¡Œç›‘æ§ç­‰åŠŸèƒ½ã€‚</li><li><strong>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ</strong>ã€‚ åªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— é¡»â¼¿åŠ¨ç¼–ç¨‹ã€‚</li></ul><h3 id="-2"></h3><h3 id="2ã€Spring-çš„ä¸¤å¤§æ ¸å¿ƒæ¦‚å¿µæ˜¯ä»€ä¹ˆï¼Ÿç®€å•è®²â¼€ä¸‹ä½ å¯¹å®ƒä»¬çš„ç†è§£">2ã€Spring çš„ä¸¤å¤§æ ¸å¿ƒæ¦‚å¿µæ˜¯ä»€ä¹ˆï¼Ÿç®€å•è®²â¼€ä¸‹ä½ å¯¹å®ƒä»¬çš„ç†è§£</h3><p>IOC:</p><ul><li>IOC(Inverse Of Controll,æ§åˆ¶åè½¬)ï¼šå°±æ˜¯åŸæ¥ä»£ç é‡Œé¢éœ€è¦è‡ªå·±æ‰‹åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œä¾èµ–ï¼Œåè½¬ç»™Springæ¥å¸®å¿™å®ç°ã€‚æˆ‘ä»¬éœ€è¦<strong>åˆ›å»ºâ¼€ä¸ªå®¹å™¨</strong>ï¼ŒåŒæ—¶<strong>éœ€è¦â¼€ç§æè¿°</strong>æ¥è®©å®¹å™¨çŸ¥é“è¦åˆ›å»ºçš„å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</li><li>åœ¨Springä¸­<strong>BeanFactoryå°±æ˜¯IOCå®¹å™¨</strong>ï¼Œåœ¨Springåˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºå®¹å™¨ï¼Œå¹¶å°†éœ€è¦åˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡çš„å…³ç³» ï¼ˆxmlï¼Œæ³¨è§£ï¼‰é€šè¿‡<strong>BeanDefinitionReaderåŠ è½½åˆ°BeanDefinitionä¸­å¹¶ä¿å­˜åœ¨BeanDefinitionMapä¸­</strong>ï¼Œç„¶åå† ç”±IOCå®¹å™¨åˆ›å»ºbeanå¯¹è±¡.</li></ul><p>ä¸¤ç§beançš„æ³¨å†Œæ–¹å¼</p><ul><li>é€šè¿‡**@Bean+@Configuration**çš„æ–¹å¼ç›´æ¥å®šä¹‰è¦åˆ›å»ºçš„å¯¹è±¡ä¸å¯¹è±¡çš„å…³ç³»</li><li>é€šè¿‡**@Componentå®šä¹‰ç±»**ï¼Œè¿™ç§æ–¹å¼å¿…é¡»ä½¿ç”¨@ComponetScanå®šä½Beanæ‰«æè·¯å¾„</li></ul><p>AOP</p><ul><li>AOP åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆoopï¼‰æ€æƒ³ä¸­ï¼Œæˆ‘ä»¬å°†äº‹ç‰©çºµå‘æŠ½æˆâ¼€ä¸ªä¸ªçš„å¯¹è±¡ã€‚è€Œåœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†â¼€ä¸ªä¸ªçš„å¯¹è±¡æŸäº›ç±»ä¼¼çš„æ–¹é¢æ¨ªå‘æŠ½æˆâ¼€ä¸ªåˆ‡é¢ï¼Œå¯¹è¿™ä¸ªåˆ‡é¢è¿›è¡Œâ¼€äº›å¦‚æƒé™æ§åˆ¶ã€äº‹ç‰©ç®¡ç†ï¼Œè®°å½•æ—¥å¿—ç­‰å…¬ç”¨æ“ä½œå¤„ç†çš„è¿‡ç¨‹å°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ€æƒ³ã€‚<strong>AOPåº•å±‚æ˜¯åŠ¨æ€ä»£ç†</strong>ï¼Œå¦‚æœæ˜¯<strong>æ¥å£é‡‡ç”¨JDK åŠ¨æ€ä»£ç†</strong>ï¼Œå¦‚æœæ˜¯ç±»é‡‡ç”¨<strong>CGLIBæ–¹å¼å®ç°åŠ¨æ€ä»£ç†</strong>ã€‚</li></ul><h3 id="-3"></h3><h3 id="3ã€ä»€ä¹ˆæ˜¯-IOCï¼Œç®€å•è®²â¼€ä¸‹-Spring-IOC-çš„å®ç°æœºåˆ¶ï¼Ÿ">3ã€ä»€ä¹ˆæ˜¯ IOCï¼Œç®€å•è®²â¼€ä¸‹ Spring IOC çš„å®ç°æœºåˆ¶ï¼Ÿ</h3><p>IOC:</p><ul><li>IOC(Inverse Of Controll,æ§åˆ¶åè½¬)ï¼šå°±æ˜¯åŸæ¥ä»£ç é‡Œé¢éœ€è¦è‡ªå·±æ‰‹åŠ¨åˆ›å»ºçš„å¯¹è±¡ï¼Œä¾èµ–ï¼Œåè½¬ç»™Springæ¥å¸®å¿™å®ç°ã€‚æˆ‘ä»¬éœ€è¦<strong>åˆ›å»ºâ¼€ä¸ªå®¹å™¨</strong>ï¼ŒåŒæ—¶<strong>éœ€è¦â¼€ç§æè¿°</strong>æ¥è®©å®¹å™¨çŸ¥é“è¦åˆ›å»ºçš„å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</li></ul><p>ä¸¤ç§beançš„æ³¨å†Œæ–¹å¼</p><ul><li>é€šè¿‡**@Bean+@Configuration**çš„æ–¹å¼ç›´æ¥å®šä¹‰è¦åˆ›å»ºçš„å¯¹è±¡ä¸å¯¹è±¡çš„å…³ç³»</li><li>é€šè¿‡**@Componentå®šä¹‰ç±»**ï¼Œè¿™ç§æ–¹å¼å¿…é¡»ä½¿ç”¨@ComponetScanå®šä½Beanæ‰«æè·¯å¾„</li></ul><p>IOCçš„åˆ›å»º:</p><ul><li>åœ¨Springä¸­<strong>BeanFactoryå°±æ˜¯IOCå®¹å™¨</strong>ï¼Œåœ¨Springåˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºå®¹å™¨ï¼Œå¹¶å°†éœ€è¦åˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡çš„å…³ç³» ï¼ˆxmlï¼Œæ³¨è§£ï¼‰é€šè¿‡<strong>BeanDefinitionReaderåŠ è½½åˆ°BeanDefinitionä¸­å¹¶ä¿å­˜åœ¨BeanDefinitionMapä¸­</strong>ï¼Œç„¶åå† ç”±IOCå®¹å™¨åˆ›å»ºbeanå¯¹è±¡ã€‚</li></ul><p>Beançš„ç”Ÿå‘½å‘¨æœŸ</p><ul><li>**bean çš„å®ä¾‹åŒ–ï¼š**spring å¯åŠ¨å,ä¼šæŸ¥æ‰¾å’ŒåŠ è½½éœ€è¦è¢« spring ç®¡ç†çš„ Bean,å¹¶ä¸”å®ä¾‹åŒ–</li><li><strong>bean çš„å±æ€§æ³¨å…¥(bean çš„åˆå§‹åŒ–)</strong>ï¼šbeanè¢«å®ä¾‹åŒ–åå°† Bean çš„å¼•ç”¨å’Œå€¼æ³¨â¼Šåˆ° beançš„å±æ€§ä¸­<ul><li><strong>æŸ¥çœ‹æ˜¯å¦è°ƒç”¨â¼€äº› aware æ¥â¼</strong>,æ¯”å¦‚ BeanFactoryAware,BeanFactoryAware,ApplicationContextAware  æ¥â¼,åˆ†åˆ«ä¼šå°† Bean çš„åå­—,BeanFactory å®¹å™¨å®ä¾‹,ä»¥åŠ Bean æ‰€åœ¨çš„ä¸Šä¸‹æ–‡å¼•ç”¨ä¼ â¼Šç»™ Beanã€‚</li><li>åœ¨åˆå§‹åŒ–ä¹‹å‰,ä¼š**æŸ¥çœ‹æ˜¯å¦è°ƒç”¨äº† BeanPostProcessor çš„é¢„åˆå§‹åŒ–æ–¹æ³•,**å¯ä»¥å¯¹ bean è¿›è¡Œæ‰©å±•ã€‚</li><li><strong>è°ƒç”¨InitializingBean çš„ afterPropertiesSet()æ–¹æ³•</strong>ï¼šå¦‚æœ Bean å®ç°äº† InitializingBean æ¥â¼ï¼Œspring å°†è°ƒç”¨ä»–ä»¬çš„afterPropertiesSet()æ–¹æ³•ï¼Œç±»ä¼¼çš„ï¼Œå¦‚æœ Bean ä½¿ç”¨ init-method ç”Ÿå‘½äº†åˆå§‹åŒ–æ–¹æ³•çš„è¯ï¼Œ è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚</li><li><strong>åˆå§‹åŒ–æˆåŠŸä¹‹å,ä¼šæŸ¥çœ‹æ˜¯å¦è°ƒç”¨ BeanPostProcessor çš„åˆå§‹åŒ–åçš„æ–¹æ³•</strong>ï¼šå¦‚æœ Bean å®ç°äº†  BeanPostProcessor æ¥â¼ï¼Œspring å°±å°†è°ƒç”¨ä»–ä»¬çš„ postprocessAfterInitialization()æ–¹æ³•ã€‚å¯ä»¥å¯¹ bean  è¿›è¡Œæ‰©å±•ã€‚</li></ul></li><li><strong>beançš„æ­£å¸¸ä½¿ç”¨</strong>ï¼šå¯ä»¥è¢«åº”ç”¨ç¨‹åºæ­£å¸¸ä½¿ç”¨äº†,ä»–ä»¬å°†é©»ç•™åœ¨ä¸Šä¸‹æ–‡ä¸­,ç›´åˆ°åº”ç”¨çš„ä¸Šä¸‹æ–‡è¢«é”€æ¯ã€‚</li><li><strong>beançš„é”€æ¯ï¼š**<strong>è°ƒç”¨ DisposableBean çš„destory()æ–¹æ³•</strong>ï¼šå¦‚æœ Bean å®ç° DisposableBean æ¥â¼ï¼Œspring å°†ç”¨ ä»–çš„ destory()æ–¹æ³•ï¼Œç›¸åŒçš„ï¼Œå¦‚æœ Bean ä½¿ç”¨äº† destory-method ç”Ÿå‘½é”€æ¯æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚(ä½†ç”± äº bean ä¹Ÿåˆ†ä¸ºå•ä¾‹å’Œå¤šä¾‹,å•ä¾‹ <strong>bean ä¼šéšç€ IOC å®¹å™¨çš„é”€æ¯è€Œé”€æ¯</strong>,å¤šä¾‹çš„ bean ä¸ä¼šéšç€ IOC å®¹å™¨çš„é”€æ¯ è€Œé”€æ¯,ä»–æ˜¯</strong>é€šè¿‡ JVM â¾¥é¢çš„åƒåœ¾å›æ”¶å™¨è´Ÿè´£å›æ”¶**ï¼‰</li></ul><h3 id="4ã€Spring-æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ">4ã€Spring æ¡†æ¶ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ</h3><ul><li>**å•ä¾‹æ¨¡å¼:**Spring çš„ <strong>Bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼</strong>ï¼Œé€šè¿‡ Spring å®¹å™¨ç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¿è¯æ¯ä¸ª Bean <strong>åªè¢«åˆ›å»ºâ¼€æ¬¡</strong>ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­é‡ç”¨ã€‚</li><li><strong>å·¥å‚æ¨¡å¼ï¼š<strong>Spring ä½¿ç”¨å·¥å‚æ¨¡å¼</strong>é€šè¿‡ BeanFactory å’Œ ApplicationContext åˆ›å»ºå¹¶ç®¡ç† Bean å¯¹è±¡</strong>ã€‚</li><li>**ä»£ç†æ¨¡å¼ï¼š**Spring AOP åŸºäºåŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œä½¿ç”¨ä»£ç†æ¨¡å¼å®ç°åˆ‡é¢ç¼–ç¨‹ï¼Œæä¾›äº†å¯¹ AOP ç¼–ç¨‹çš„â½€æŒã€‚</li><li>**è§‚å¯Ÿè€…æ¨¡å¼ï¼š**Spring ä¸­çš„äº‹ä»¶æœºåˆ¶åŸºäºè§‚å¯Ÿè€…æ¨¡å¼ï¼Œé€šè¿‡ ApplicationEventPublisher å‘å¸ƒäº‹ä»¶ï¼Œç”±  ApplicationListener ç›‘å¬äº‹ä»¶ï¼Œå®ç°äº†å¯¹è±¡é—´çš„æ¾è€¦åˆã€‚</li><li><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong>ï¼šSpring ä¸­çš„ JdbcTemplate ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†â¼€äº›å›ºå®šçš„æµç¨‹å°è£…åœ¨çˆ¶ç±»ä¸­ï¼Œå­ç±»åª éœ€å®ç°â¼€äº›æŠ½è±¡æ–¹æ³•å³å¯ã€‚</li><li>**ç­–ç•¥æ¨¡å¼ï¼š**Spring ä¸­çš„ HandlerInterceptor å’Œ HandlerExecutionChain ä½¿ç”¨äº†ç­–ç•¥æ¨¡å¼ï¼Œå…è®¸å¼€å‘è€…è‡ªå®šä¹‰å¤„ç†å™¨æ‹¦æˆªå™¨ï¼ŒæŒ‰ç…§â¼€å®šé¡ºåºæ‰§è¡Œã€‚</li><li>**è´£ä»»é“¾æ¨¡å¼ï¼š**Spring ä¸­çš„è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨ä½¿ç”¨äº†è´£ä»»é“¾æ¨¡å¼ï¼Œå¤šä¸ªè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨æŒ‰ç…§â¼€å®šé¡ºåºæ‰§è¡Œï¼Œæ¯ä¸ªè¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨å¯ä»¥æ‹¦æˆªè¯·æ±‚æˆ–è€…å“åº”å¹¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚</li></ul><h3 id="5ã€Springã€SpringMVCã€SpringBoot-ä¸‰è€…ä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ">5ã€Springã€SpringMVCã€SpringBoot ä¸‰è€…ä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</h3><ul><li>Spring æ˜¯â¼€ä¸ª <strong>Java çš„è½»é‡çº§åº”ç”¨æ¡†æ¶</strong>ï¼Œæä¾›äº†åŸºäº <strong>IoC å’Œ AOP</strong> çš„æ”¯æŒï¼Œç”¨äºæ„å»ºä¼ä¸šçº§åº”ç”¨ã€‚Spring æœ‰å¤š ä¸ªæ¨¡å—ï¼ŒåŒ…æ‹¬ Spring Coreã€Spring Contextã€Spring JDBCã€Spring Web ç­‰ï¼Œæ¯ä¸ªæ¨¡å—æä¾›äº†ä¸åŒçš„åŠŸèƒ½ã€‚</li><li>SpringMVC <strong>æ˜¯ Spring æ¡†æ¶çš„â¼€éƒ¨åˆ†</strong>ï¼Œæ˜¯<strong>åŸºäº MVC è®¾è®¡æ¨¡å¼çš„ Web æ¡†æ¶</strong>ï¼Œç”¨äºæ„å»º Web åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†<strong>æ§åˆ¶å™¨ã€è§†å›¾è§£æå™¨ã€æ•°æ®ç»‘å®šã€å¼‚å¸¸å¤„ç†</strong>ç­‰åŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘ Web åº”ç”¨å˜å¾—æ›´åŠ ç®€å•ã€‚SpringMVC è¿˜â½€æŒ  RESTful æ¶æ„ã€‚</li><li>SpringBoot æ˜¯<strong>åŸºäº Spring æ¡†æ¶çš„â¼€ä¸ªå¼€å‘æ¡†æ¶</strong>ï¼Œç”¨äºå¿«é€Ÿæ„å»ºç‹¬ç«‹çš„ã€ç”Ÿäº§çº§åˆ«çš„ Spring åº”ç”¨ç¨‹åºã€‚å®ƒ<strong>é€šè¿‡è‡ªåŠ¨é…ç½®å’Œçº¦å®šä¼˜äºé…ç½®çš„æ–¹å¼</strong>ï¼Œç®€åŒ–äº† Spring åº”ç”¨ç¨‹åºçš„é…ç½®å’Œå¼€å‘è¿‡ç¨‹ã€‚SpringBoot é›†æˆäº†å¾ˆå¤šå¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“å’Œâ¼¯å…·ï¼Œä¾‹å¦‚ Spring Dataã€Spring Securityã€Thymeleafã€Logback ç­‰ï¼Œå¯ä»¥æå¤§åœ°æé«˜å¼€å‘æ•ˆ ç‡ã€‚</li></ul><p>å› æ­¤ï¼ŒSpringBoot å¯ä»¥çœ‹ä½œæ˜¯<strong>åœ¨ Spring çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è‡ªåŠ¨é…ç½®å’Œçº¦å®šä¼˜äºé…ç½®çš„æ–¹å¼ï¼Œæä¾›äº†æ›´åŠ ç®€å•ã€å¿«é€Ÿ çš„å¼€å‘ä½“éªŒ</strong>ã€‚è€Œ SpringMVC åˆ™æ˜¯ Spring æ¡†æ¶ä¸­ç”¨äºæ„å»º Web åº”ç”¨ç¨‹åºçš„æ¨¡å—ã€‚</p><h3 id="6ã€æœ‰å“ªäº›æ³¨è§£å¯ä»¥æ³¨å…¥Beanï¼Ÿ-Autowired-å’Œ-Resource-çš„åŒºåˆ«ï¼Ÿ">6ã€æœ‰å“ªäº›æ³¨è§£å¯ä»¥æ³¨å…¥Beanï¼Ÿ@Autowired å’Œ @Resource çš„åŒºåˆ«ï¼Ÿ</h3><p>å“ªäº›å¯ä»¥æ³¨å…¥bean</p><ul><li>@Autowiredï¼šè‡ªåŠ¨æ³¨å…¥ï¼Œ<strong>æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…</strong>ï¼Œå¦‚æœæœ‰å¤šä¸ªåŒç±»å‹çš„ Beanï¼Œåˆ™éœ€è¦é€šè¿‡ @Qualifier æŒ‡å®šå…·ä½“ çš„ Beanã€‚</li><li>@Resourceï¼šJava è‡ªå¸¦çš„æ³¨å…¥æ–¹å¼ï¼Œ<strong>æŒ‰ç…§åç§°è‡ªåŠ¨è£…é…</strong>ï¼Œé»˜è®¤æ˜¯æŒ‰ç…§å±æ€§åç§°è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœéœ€è¦æŒ‰ç…§ Bean  çš„åç§°è¿›è¡ŒåŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨ @Resource(name=â€œbeanNameâ€)ã€‚</li><li>@Injectï¼šå’Œ @Autowired ç±»ä¼¼ï¼Œä¹Ÿæ˜¯æŒ‰ç…§ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œä½†æ˜¯ <strong>@Inject æ³¨è§£æ˜¯ JSR-330 æä¾›çš„</strong>ï¼Œè€Œ  @Autowired æ³¨è§£æ˜¯ Spring æ¡†æ¶æä¾›çš„ã€‚</li><li>@Valueï¼šç”¨äºæ³¨å…¥é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§å€¼ï¼Œå¯ä»¥æŒ‡å®šé»˜è®¤å€¼</li><li>@Componentï¼šç”¨äº<strong>å£°æ˜â¼€ä¸ª Bean</strong>ï¼Œä½œç”¨ç±»ä¼¼äº XML ä¸­çš„  æ ‡ç­¾ã€‚</li></ul><p>æ³¨â¼Š Bean çš„æ—¶å€™æœ€å¥½ä½¿ç”¨æ¥â¼ç±»å‹ä½œä¸ºæ³¨â¼Šå¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥é¿å…å› ä¸ºå…·ä½“å®ç°ç±»å˜æ›´å¯¼è‡´æ³¨â¼Šå¤± è´¥çš„é—®é¢˜</p><h3 id="7ã€Spring-å¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼ŒThreadLocal-ä½ äº†è§£è¿‡å—ï¼Ÿ">7ã€Spring å¦‚ä½•å¤„ç†çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼ŒThreadLocal ä½ äº†è§£è¿‡å—ï¼Ÿ</h3><ul><li><p><strong>åŒæ­¥å…³é”®å­— synchronizedï¼š<strong>ä½¿ç”¨synchronized å…³é”®å­—å¯ä»¥</strong>å¯¹å…±äº«èµ„æºè¿›è¡ŒåŠ é”</strong>ï¼Œä»è€Œ<strong>ä¿è¯å¤šçº¿ç¨‹è®¿é—®æ—¶çš„åŒæ­¥æ€§</strong>ã€‚ä½†æ˜¯ï¼Œsynchronized <strong>å¯¹æ€§èƒ½</strong>ä¼šäº§ç”Ÿâ¼€å®šçš„å½±å“ï¼Œå¹¶ä¸”å®¹<strong>æ˜“å¯¼è‡´æ­»é”</strong>ç­‰é—®é¢˜ã€‚</p></li><li><p><strong>Lock æ¥å£ï¼š<strong>Lock æ¥å£æä¾›äº†æ¯”synchronized æ›´åŠ çµæ´»çš„åŠ é”æ–¹å¼ï¼Œå¹¶ä¸”å¯</strong>ä»¥é˜²æ­¢æ­»é”é—®é¢˜</strong>çš„å‘ç”Ÿã€‚ä½†æ˜¯ï¼Œ Lock æ¥â¼çš„<strong>ä½¿ç”¨ç›¸å¯¹è¾ƒå¤æ‚</strong>ï¼Œéœ€è¦â¼¿åŠ¨è¿›è¡ŒåŠ é”å’Œè§£é”æ“ä½œã€‚</p></li><li><p><strong>ThreadLocal ç±»</strong>ï¼šThreadLocal ç±»æä¾›äº†<strong>çº¿ç¨‹æœ¬åœ°å˜é‡</strong>çš„åŠŸèƒ½ï¼Œå¯ä»¥è®©æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„<strong>å˜é‡å‰¯æœ¬</strong>ï¼Œä»è€Œé¿å…äº†å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„<strong>å…±äº«é—®é¢˜</strong>ã€‚ä½†æ˜¯ï¼ŒThreadLocal ç±»çš„ä½¿ç”¨éœ€è¦<strong>æ³¨æ„å†…å­˜æ³„æ¼é—®é¢˜</strong>ã€‚</p></li></ul><p>å…³äºThreadLocal</p><ul><li><p>ThreadLocal æ˜¯ Java ä¸­çš„<strong>â¼€ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡</strong>ï¼Œå®ƒå¯ä»¥ä¸ºæ¯ä¸ª<strong>çº¿ç¨‹</strong>æä¾›â¼€ä¸ª<strong>ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬</strong>ï¼Œé¿å…äº†å¤šçº¿ç¨‹ä¹‹é—´çš„<strong>æ•°æ®å…±äº«å’Œæ•°æ®ç«äº‰é—®é¢˜</strong>ã€‚</p></li><li><p>ThreadLocal <strong>å¯ä»¥åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­å­˜å‚¨â¼€ä¸ªå¯¹è±¡</strong>ï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹<strong>åªèƒ½è®¿é—®è‡ªâ¼°</strong>çš„å¯¹è±¡ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ä¸­çš„å¯¹ è±¡ã€‚</p></li><li><p>ThreadLocal ä¸»è¦ç”¨äº<strong>è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ï¼Œä¾‹å¦‚åœ¨ Web åº”ç”¨ä¸­ï¼Œå¯ä»¥ä½¿<strong>ç”¨ ThreadLocal å­˜å‚¨ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯</strong>ï¼Œè¿™ æ ·æ¯ä¸ªçº¿ç¨‹å°±å¯ä»¥ç‹¬ç«‹åœ°è®¿é—®è‡ªå·±çš„ä¼šè¯ä¿¡æ¯ï¼Œé¿å…äº†å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„<strong>æ•°æ®å…±äº«å’Œæ•°æ®ç«äº‰é—®é¢˜</strong>ã€‚</p></li><li><p>åœ¨ Spring ä¸­ï¼ŒThreadLocal é€šå¸¸ç”¨äº<strong>å­˜å‚¨å’Œä¼ é€’â¼€äº›ä¸çº¿ç¨‹ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</strong>ï¼Œä¾‹å¦‚<strong>å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€è¯·æ±‚ çš„ IP åœ°å€</strong>ç­‰ã€‚å¯ä»¥å°† ThreadLocal å¯¹è±¡å®šä¹‰ä¸ºâ¼€ä¸ª Beanï¼Œç„¶ååœ¨éœ€è¦ä½¿ç”¨æ—¶æ³¨â¼Šåˆ°å…¶ä»– Bean ä¸­ä½¿ç”¨ã€‚</p></li></ul><h3 id="8ã€Spring-ä¸­çš„-BeanFactory-å’Œ-ApplicationContext-æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ">8ã€Spring ä¸­çš„ BeanFactory å’Œ ApplicationContext æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ</h3><p>BeanFactory æ˜¯ Spring å®¹å™¨çš„è¶…çº§æ¥â¼ã€‚ApplicationContext æ˜¯ BeanFactory çš„<strong>å­æ¥â¼</strong></p><p><a href="https://bu.dusays.com/2024/07/05/6687bc4e38b53.png"><img src="https://bu.dusays.com/2024/07/05/6687bc4e38b53.png" alt="image-20240605111144655.png"></a></p><p>åŒºåˆ«</p><ul><li>BeanFactory æ˜¯ <strong>Spring æ¡†æ¶çš„åŸºç¡€è®¾æ–½</strong>ï¼Œç”¨äºç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ–å…³ç³»ï¼Œæä¾›äº† IoC å’Œ DI åŠŸèƒ½ã€‚ <strong>ApplicationContext æ˜¯ BeanFactory çš„æ‰©å±•</strong>ï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œä¾‹å¦‚å›½é™…åŒ–â½€æŒã€AOP â½€æŒç­‰ã€‚</li><li>BeanFactory <strong>æ˜¯å»¶è¿ŸåŠ è½½çš„</strong>ï¼Œå³åªæœ‰åœ¨<strong>è·å– Bean æ—¶æ‰ä¼šè¿›è¡Œå®ä¾‹åŒ–</strong>ï¼Œå¯ä»¥å‡å°‘ç³»ç»Ÿèµ„æºçš„å ç”¨ã€‚è€Œ  <strong>ApplicationContext åœ¨å¯åŠ¨æ—¶ä¼šâ½´å³åŠ è½½æ‰€æœ‰çš„ Bean</strong>ï¼Œå¯¼è‡´å¯åŠ¨æ—¶é—´è¾ƒé•¿ã€‚</li><li>BeanFactory <strong>æ˜¯å•ä¾‹æ¨¡å¼</strong>ï¼Œå³åœ¨æ•´ä¸ªåº”ç”¨ä¸­åªæœ‰â¼€ä¸ª BeanFactory å®ä¾‹ã€‚è€Œ ApplicationContext å¯ä»¥<strong>æœ‰å¤šä¸ªå®ä¾‹</strong>ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡â½—å­å®¹å™¨çš„æ–¹å¼ç»„ç»‡èµ·æ¥ï¼Œæ–¹ä¾¿æ¨¡å—åŒ–å¼€å‘ã€‚</li></ul><p>è”ç³»</p><ul><li>BeanFactory å’Œ ApplicationContext <strong>éƒ½æ˜¯ç”¨äºç®¡ç† Spring Bean çš„å®¹å™¨</strong>ï¼Œå¯ä»¥ç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ– å…³ç³»ï¼Œæä¾›äº† <strong>IoC å’Œ DI</strong> åŠŸèƒ½ã€‚</li><li>ApplicationContext <strong>æ˜¯ BeanFactory çš„æ‰©å±•</strong>ï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œä¾‹å¦‚å›½é™…åŒ–â½€æŒã€AOP â½€æŒç­‰ï¼ŒåŒæ—¶<strong>ä¹Ÿæ”¯æŒ BeanFactory çš„æ‰€æœ‰åŠŸèƒ½</strong>ã€‚</li><li>BeanFactory å’Œ ApplicationContext <strong>éƒ½å¯ä»¥ç®¡ç†å•ä¾‹ Bean å’ŒåŸå‹ Bean</strong>ï¼Œå¯ä»¥<strong>æ§åˆ¶ Bean çš„ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</li></ul><h3 id="9ã€è®²â¼€è®²-Spring-æ¡†æ¶ä¸­-Bean-çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ"><strong>9ã€è®²â¼€è®² Spring æ¡†æ¶ä¸­ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ</strong></h3><p>beançš„ç”Ÿå‘½å‘¨æœŸæœ‰äº”ä¸ªé˜¶æ®µ</p><ul><li>åˆ›å»ºå‰å‡†å¤‡ï¼šä¸»è¦æ˜¯æ‰«æ s<strong>pring ä¸­çš„ä¸Šä¸‹æ–‡å’Œé…ç½®</strong>ï¼ˆè§£æå’ŒæŸ¥æ‰¾ï¼‰bean çš„â¼€äº›æ‰©å±•é…ç½®ã€‚</li><li>åˆ›å»ºå®ä¾‹ï¼šåœ¨è¿™ä¸ªé˜¶æ®µ<strong>è°ƒç”¨ bean çš„æ„é€ å™¨è¿›è¡Œå®ä¾‹çš„åˆ›å»º</strong>ã€‚è¿™æ˜¯<strong>é€šè¿‡åå°„è¿›è¡Œå®ä¾‹çš„åˆ›å»º</strong>çš„ï¼Œå¹¶ä¸”ä¼šæ‰«æå’Œè§£æ bean çš„â¼€äº›å±æ€§ã€‚</li><li>ä¾èµ–æ³¨å…¥ï¼šå®ä¾‹åŒ–çš„ bean å¯èƒ½ä¾èµ–å…¶ä»–çš„ beanï¼Œè¿™ä¸ªé˜¶æ®µå°±æ˜¯<strong>æ³¨å…¥å®ä¾‹çš„ bean ä¾èµ–çš„ bean</strong>ï¼Œå¦‚ç”¨æ³¨è§£  @Autowired è¿›è¡Œä¾èµ–çš„æ³¨â¼Šã€‚</li><li>å®¹å™¨ç¼“å­˜ï¼šè¿™ä¸ªé˜¶æ®µä¸­ï¼Œ<strong>å°†å®ä¾‹åŒ–çš„ bean æ”¾â¼Šå®¹å™¨å’Œ spring çš„ç¼“å­˜ä¸­</strong>ï¼Œæ­¤æ—¶å¼€å‘è€…å¯ä»¥ä½¿ç”¨å®ä¾‹åŒ–çš„ beanã€‚</li><li>é”€æ¯å®ä¾‹ï¼šå½“ spring çš„ä¸Šä¸‹æ–‡å…³é—­æ—¶ï¼Œè¿™äº›ä¸Šä¸‹æ–‡çš„ bean ä¹Ÿä¼šè¢«é”€æ¯ã€‚</li></ul><p><a href="https://bu.dusays.com/2024/07/05/6687bc4e6a54e.png"><img src="https://bu.dusays.com/2024/07/05/6687bc4e6a54e.png" alt="image-20240605111603743.png"></a></p><h3 id="10ã€Spring-æ”¯æŒå“ªå‡ ç§äº‹åŠ¡ç®¡ç†ç±»å‹ï¼ŒSpring-çš„äº‹åŠ¡å®ç°æ–¹å¼å’Œå®ç°åŸç†æ˜¯ï¼Ÿ">10ã€Spring æ”¯æŒå“ªå‡ ç§äº‹åŠ¡ç®¡ç†ç±»å‹ï¼ŒSpring çš„äº‹åŠ¡å®ç°æ–¹å¼å’Œå®ç°åŸç†æ˜¯ï¼Ÿ</h3><ul><li><p>**ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼š**åœ¨ä»£ç ä¸­æ˜¾å¼åœ°ç¼–å†™äº‹åŠ¡ç®¡ç†ç›¸å…³ä»£ç ï¼Œå¦‚å¼€å¯äº‹åŠ¡ã€æäº¤äº‹åŠ¡ã€å›æ»šäº‹åŠ¡ç­‰ã€‚</p></li><li><p><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼š<strong>ä½¿ç”¨ <strong>AOP æŠ€æœ¯</strong>ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡é…</strong>ç½®è¿›è¡Œå£°æ˜</strong>ï¼Œä»è€Œå®ç°å¯¹äº‹åŠ¡ç®¡ç†çš„æ§åˆ¶ã€‚</p></li><li><p><strong>æ³¨è§£å¼äº‹åŠ¡ç®¡ç†ï¼šåŸºäºå£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡çš„ç®¡ç†ã€‚</p></li></ul><p>Spring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼Œspring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚çœŸæ­£çš„æ•°æ®åº“å±‚çš„<strong>äº‹åŠ¡æäº¤å’Œå›æ»šæ˜¯é€šè¿‡binlog æˆ–è€… redolog å®ç°</strong>çš„ã€‚</p><ul><li><strong>äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransaction Managerï¼‰</strong>ï¼šSpring äº‹åŠ¡ç®¡ç†å™¨æ˜¯äº‹åŠ¡çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒè´Ÿè´£ç®¡ç†äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸå’Œäº‹åŠ¡çš„çŠ¶æ€ã€‚Spring äº‹åŠ¡ç®¡ç†å™¨æä¾›äº†å¤šç§å®ç°ï¼ŒåŒ…æ‹¬ JDBCã€Hibernateã€JPAã€JTA ç­‰ï¼Œå¼€å‘â¼ˆå‘˜å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥é€‰æ‹©é€‚åˆçš„äº‹åŠ¡ç®¡ç†å™¨ã€‚</li><li><strong>äº‹åŠ¡ä»£ç†ï¼ˆTransaction Proxyï¼‰</strong>ï¼šSpring ä½¿ç”¨ä»£ç†æ¨¡å¼æ¥å®ç°äº‹åŠ¡ç®¡ç†ï¼Œå³é€šè¿‡ä»£ç†å¯¹è±¡æ¥æ‹¦æˆªè¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ï¼Œä»¥å®ç°äº‹åŠ¡çš„å¼€å¯ã€æäº¤æˆ–å›æ»šç­‰æ“ä½œã€‚Spring äº‹åŠ¡ä»£ç†æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šåŸºäº <strong>AOP çš„ä»£ç† å’ŒåŸºäºåŠ¨æ€ä»£ç†</strong>çš„ä»£ç†ã€‚</li><li><strong>äº‹åŠ¡åˆ‡é¢ï¼ˆTransaction Aspectï¼‰</strong>ï¼šSpring äº‹åŠ¡åˆ‡é¢æ˜¯â¼€ç»„<strong>é€šçŸ¥ï¼ˆAdviceï¼‰å’Œåˆ‡ç‚¹</strong>ï¼ˆPointcutï¼‰çš„ç»„åˆï¼Œç”¨äºå®šä¹‰äº‹åŠ¡çš„è¡Œä¸ºï¼Œä¾‹å¦‚äº‹åŠ¡çš„å¼€å¯ã€æäº¤æˆ–å›æ»šç­‰æ“ä½œã€‚Spring äº‹åŠ¡åˆ‡é¢å¯ä»¥åŸºäº<strong>æ³¨è§£æˆ– XML é…ç½®</strong>æ¥å®ç°ï¼Œå¼€å‘â¼ˆå‘˜å¯ä»¥æ ¹æ®è‡ªâ¼°çš„éœ€æ±‚æ¥é€‰æ‹©é€‚åˆçš„æ–¹å¼ã€‚</li><li>äº‹åŠ¡åŒæ­¥å™¨ï¼ˆTransaction Synchronizationï¼‰ï¼šSpring äº‹åŠ¡åŒæ­¥å™¨ç”¨äºç®¡ç†äº‹åŠ¡çš„æäº¤æˆ–å›æ»šæ—¶éœ€è¦æ‰§è¡Œçš„â¼€äº›æ“ä½œï¼Œä¾‹å¦‚æ¸…ç†ç¼“å­˜ã€é‡Šæ”¾èµ„æºç­‰ã€‚Spring äº‹åŠ¡åŒæ­¥å™¨é€šè¿‡ Synchronization æ¥â¼å’Œ  TransactionSynchronizationManager ç±»æ¥å®ç°ï¼Œå¯ä»¥å®ç°å¯¹äº‹åŠ¡çš„åç½®å¤„ç†ã€‚</li></ul><h3 id="11ã€ä»€ä¹ˆæ˜¯-Spring-çš„ä¾èµ–æ³¨å…¥ï¼Œä¾èµ–æ³¨å…¥çš„åŸºæœ¬åŸåˆ™ä»¥åŠå¥½å¤„ï¼Ÿ">11ã€ä»€ä¹ˆæ˜¯ Spring çš„ä¾èµ–æ³¨å…¥ï¼Œä¾èµ–æ³¨å…¥çš„åŸºæœ¬åŸåˆ™ä»¥åŠå¥½å¤„ï¼Ÿ</h3><p>ä¾èµ–æ³¨â¼Šï¼ˆDependency Injectionï¼Œç®€ç§° DIï¼‰æ˜¯ Spring æ¡†æ¶ä¸­çš„â¼€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äº<strong>å®ç°æ§åˆ¶åè½¬</strong>ï¼ˆInversion  of Controlï¼Œç®€ç§° IoCï¼‰ã€‚å®ƒæ˜¯â¼€ç§å°†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ä»ç¡¬ç¼–ç ä¸­è§£è€¦çš„æ–¹æ³•ã€‚é€šè¿‡ä¾èµ–æ³¨å…¥ï¼ŒSpring æ¡†æ¶å¯ä»¥åœ¨è¿è¡Œæ—¶<strong>è‡ªåŠ¨ä¸ºç±»çš„å±æ€§ã€æ„é€ å‡½æ•°æˆ–æ–¹æ³•å‚æ•°æä¾›æ‰€éœ€çš„ä¾èµ–å¯¹è±¡</strong>ï¼Œä»è€Œå®ç°å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆã€‚</p><p>åŸåˆ™</p><ul><li>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ã€‚å®ƒä»¬éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</li><li>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–å…·ä½“å®ç°ã€‚å…·ä½“å®ç°åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</li></ul><p>å¥½å¤„</p><ul><li><p>çµæ´»æ€§ï¼šé€šè¿‡ä¾èµ–æ³¨å…¥ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ä¸å†ç”±ç¨‹åºå‘˜â¼¿åŠ¨æ§åˆ¶ï¼Œè€Œæ˜¯ç”± Spring å®¹å™¨åŠ¨æ€åœ°ç»´æŠ¤ï¼Œå¯ä»¥çµæ´»åœ°ç»„åˆå’Œåˆ‡æ¢ä¸åŒçš„å¯¹è±¡å®ç°ã€‚</p></li><li><p>å¯æµ‹è¯•æ€§ï¼šä¾èµ–æ³¨å…¥å¯ä»¥ä½¿å„ä¸ªå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»æ›´åŠ æ¾æ•£ï¼Œæ–¹ä¾¿è¿›è¡Œå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ã€‚</p></li><li><p>å¯æ‰©å±•æ€§ï¼šä¾èµ–æ³¨å…¥å°†å„ä¸ªå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»è§£è€¦ï¼Œæ–¹ä¾¿å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å±•å’Œå‡çº§ã€‚</p></li><li><p>å¯ç»´æŠ¤æ€§ï¼šä¾èµ–æ³¨å…¥å¯ä»¥å‡å°‘é‡å¤ä»£ç ï¼Œé™ä½äº†ä»£ç çš„å¤æ‚åº¦ï¼Œä½¿ä»£ç æ›´åŠ æ˜“äºç»´æŠ¤å’Œä¿®æ”¹ã€‚</p></li></ul><h3 id="12ã€ä»€ä¹ˆæ˜¯-AOPï¼Ÿæœ‰å“ªäº›å®ç°-AOP-çš„æ–¹å¼ï¼ŸSpring-AOP-å’Œ-AspectJ-AOP-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">12ã€ä»€ä¹ˆæ˜¯ AOPï¼Ÿæœ‰å“ªäº›å®ç° AOP çš„æ–¹å¼ï¼ŸSpring AOP å’Œ AspectJ  AOP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>AOPï¼šAspect Orlented Programming é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼›</p><p>å®ç°åŒºåˆ«ï¼š</p><ul><li><strong>Spring AOP æ˜¯åŸºäºåŠ¨æ€ä»£ç†å®ç°çš„</strong>ï¼Œé€šè¿‡ JDK åŠ¨æ€ä»£ç†æˆ– CGLIB ä»£ç†æ¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œåªèƒ½ç”¨äºæ–¹æ³•çº§åˆ«çš„ æ‹¦æˆªå’Œå¤„ç†ï¼Œåœ¨è¿è¡Œæ—¶ç»‡å…¥ã€‚</li><li><strong>AspectJ AOP æ˜¯â¼€ä¸ªæ›´åŠ å®Œæ•´çš„ AOP æ¡†æ¶ï¼ŒåŸºäºå­—èŠ‚ç æ“ä½œ</strong>ï¼Œâ½€æŒæ›´å¤šçš„åˆ‡é¢è¡¨è¾¾å¼å’Œåˆ‡é¢ç±»å‹ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸã€ç±»åŠ è½½æœŸè¿›è¡Œç»‡â¼Šï¼Œæ€§èƒ½æ›´åŠ é«˜æ•ˆ</li></ul><p>å®ç°æ–¹å¼ï¼š</p><ul><li>é™æ€ä»£ç†ï¼šâ¼¿åŠ¨ç¼–å†™ä»£ç†ç±»ï¼Œå®ç°å¢å¼ºé€»è¾‘ã€‚éœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡ç±»ç¼–å†™ä»£ç†ç±»ï¼Œä»£ç é‡å¤§</li><li>JDK åŠ¨æ€ä»£ç†ï¼šåˆ©ç”¨åå°„æœºåˆ¶ç”Ÿæˆä»£ç†ç±»ï¼Œåªèƒ½ç”¨äºå®ç°äº†æ¥â¼çš„ç±»</li><li>CGLIB åŠ¨æ€ä»£ç†ï¼šåˆ©ç”¨å­—èŠ‚ç ç”Ÿæˆç›®æ ‡ç±»çš„â¼¦ç±»ï¼ˆå³ä»£ç†ç±»ï¼‰ï¼Œå¯ä»¥ä»£ç†æœªå®ç°æ¥â¼çš„ç±»</li><li>AspectJ AOPï¼šä½¿ç”¨ AspectJ åœ¨ç¼–è¯‘æœŸæˆ–ç±»åŠ è½½æœŸå¯¹ç›®æ ‡ç±»è¿›è¡Œç»‡â¼Š</li></ul><p><a href="https://bu.dusays.com/2024/07/05/6687bc4e64110.png"><img src="https://bu.dusays.com/2024/07/05/6687bc4e64110.png" alt="image-20240606162009787.png"></a></p><h2 id="Redisç¼“å­˜">Redisç¼“å­˜</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯-Redisï¼ŸRedis-æœ‰å“ªäº›ç‰¹ç‚¹ï¼ŸRedis-æœ‰å“ªäº›å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼Ÿ">1ã€ä»€ä¹ˆæ˜¯ Redisï¼ŸRedis æœ‰å“ªäº›ç‰¹ç‚¹ï¼ŸRedis æœ‰å“ªäº›å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼Ÿ</h3><p>Redis æ˜¯åŸºäºå†…å­˜çš„é”®å€¼å‹ï¼ˆkey - valueï¼‰çš„ NoSQL æ•°æ®åº“ï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰ã€‚key â¼€èˆ¬æ˜¯ String ç±»å‹ï¼Œè€Œ  value zæ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬<strong>Stringã€Hashã€Listã€Setã€SortedSet</strong> è¿™äº”ç§åŸºæœ¬ç±»å‹ï¼Œæ­¤å¤–è¿˜æœ‰ GEOã€ BitMapã€HyperLogLog ç­‰å…¶ä»–ç±»å‹ã€‚</p><p>redisæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ</p><ul><li>è¯»å†™æ€§èƒ½ä¼˜å¼‚<ul><li>åŸºäºå†…å­˜ï¼Œå†…å­˜çš„è®¿é—®é€Ÿåº¦æ˜¯æ¯”ç£ç›˜å¿«å¾ˆå¤šçš„</li><li>é‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸éœ€è¦è€ƒè™‘é”çš„é—®é¢˜ã€‚</li><li>ä½¿ç”¨ IO å¤šè·¯å¤ç”¨æ¨¡å‹ï¼Œè®© Redis ä¸éœ€è¦åˆ›å»ºé¢å¤–çš„çº¿ç¨‹æ¥ç›‘å¬å®¢æˆ·ç«¯çš„å¤§é‡è¯·æ±‚ï¼Œå‡å°‘æ€§èƒ½çš„æ¶ˆè€—ã€‚</li><li>å†…ç½®äº†å¤šç§ä¼˜åŒ–è¿‡çš„æ•°æ®ç»“æ„å®ç°</li></ul></li><li>æ‰€æœ‰æ“ä½œå‘½ä»¤éƒ½æ˜¯åŸå­æ€§çš„</li><li>â½€æŒäº‹åŠ¡<ul><li>å…è®¸å¤šä¸ªå‘½ä»¤æŒ‰é¡ºåºæ‰§è¡Œå¹¶ä¸ä¼šè¢«æ‰“æ–­</li><li>ä¸â½€æŒå›æ»š</li></ul></li><li>æ”¯æŒæ•°æ®æŒä¹…åŒ–<ul><li>RDBï¼šé€šè¿‡åˆ›å»ºå¿«ç…§æ¥è·å¾—å­˜å‚¨åœ¨å†…å­˜â¾¥é¢çš„æ•°æ®åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„å‰¯æœ¬</li><li>AOFï¼šæ‰§è¡Œå®Œæ›´æ”¹æ•°æ®çš„å‘½ä»¤åï¼Œä¼šå°†è¯¥å‘½ä»¤è®°å½•åˆ°æ—¥å¿—ä¸­</li></ul></li><li>â½€æŒåˆ†å¸ƒå¼éƒ¨ç½²</li></ul><hr><p>Redisæœ‰å“ªäº›å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼Ÿ</p><ul><li>æ•°æ®ç¼“å­˜<ul><li>å°†çƒ­ç‚¹æ•°æ®ç¼“å­˜åˆ° Redisï¼Œæé«˜æ•°æ®è¯»å–å’Œç³»ç»Ÿå“åº”é€Ÿåº¦ã€‚</li><li>å°†ç”¨æˆ·å‡­è¯ï¼ˆå¦‚ tokenï¼‰å­˜â¼Š Redisï¼Œå®ç°å•ç‚¹ç™»å½•ã€‚</li></ul></li><li>åˆ†å¸ƒå¼é”<ul><li>åˆ©ç”¨ Redis çš„ setnx å‘½ä»¤å®ç°äº’æ–¥ï¼Œå¯¹äº setnx å‘½ä»¤ï¼Œå¦‚æœ key ä¸å­˜åœ¨åˆ™ä¼šè®¾ç½® key çš„å€¼å¹¶è¿”å› 1ï¼Œå¦ åˆ™ç›´æ¥è¿”å› 0ã€‚</li><li>å› æ­¤ï¼Œå¯ä»¥é€šè¿‡ setnx å‘½ä»¤å»å°è¯•è·å–é”ï¼Œè·å–é”æˆåŠŸæ‰èƒ½ç»§ç»­æ‰§è¡Œç›¸åº”ä¸šåŠ¡ã€‚</li><li>æ­¤å¤–ï¼Œè¿˜å¾—ç»™é”è®¾ç½®â¼€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œé˜²â½Œç³»ç»Ÿå‡ºç°é—®é¢˜å¯¼è‡´é”â½†æ³•é‡Šæ”¾ã€‚</li><li>å¦‚æœéœ€è¦æ›´å¤æ‚çš„éœ€æ±‚ï¼Œå¯ä»¥é‡‡ç”¨ Redissonï¼Œå®ƒâ¾¥é¢æä¾›äº†å¤šç§åˆ†å¸ƒå¼é”çš„å®ç°ã€‚</li></ul></li><li>é™æ—¶ä¸šåŠ¡çš„è¿ç”¨<ul><li>Redis ä¸­å¯ä»¥ä½¿ç”¨ <strong>expire å‘½ä»¤è®¾ç½®â¼€ä¸ªé”®çš„ç”Ÿå­˜æ—¶é—´</strong>ï¼Œåˆ°æ—¶é—´å Redis ä¼šåˆ é™¤å®ƒã€‚åˆ©ç”¨è¿™â¼€ç‰¹æ€§å¯ä»¥è¿ç”¨åœ¨é™æ—¶çš„ä¼˜æƒ æ´»åŠ¨ä¿¡æ¯ã€â¼¿æœºéªŒè¯ç ç­‰ä¸šåŠ¡åœºæ™¯ã€‚</li></ul></li><li>å…¨å±€å”¯â¼€ID<ul><li>Redis ç”±äº incrby å‘½ä»¤å¯ä»¥å®ç°åŸâ¼¦æ€§çš„é€’å¢ï¼Œæ‰€ä»¥å¯ä»¥<strong>ç”¨äºå”¯â¼€åˆ†å¸ƒå¼åºåˆ—å·çš„ç”Ÿæˆ</strong>ã€‚</li></ul></li><li>æ¶ˆæ¯é˜Ÿåˆ—<ul><li>åŸºäº List å®ç°ï¼šåˆ©ç”¨ LPUSH å’Œ RPOPï¼›</li><li>åŸºäº PUB/SUB å®ç°ï¼›</li><li>åŸºäº Stream å®ç°ã€‚</li></ul></li><li>å…±åŒå…³æ³¨<ul><li>ç”±äº Set â½€æŒäº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å…±åŒå…³æ³¨ã€å…±åŒçˆ±å¥½ç­‰åŠŸèƒ½ã€‚</li></ul></li><li>æ’è¡Œæ¦œ<ul><li>ç”±äº SortedSet æ˜¯â½€æŒæ’åºçš„ï¼Œå¯ä»¥ç”¨äºå„ç§æ’è¡Œæ¦œçš„åœºæ™¯ã€‚</li></ul></li><li>ç»Ÿè®¡æ´»è·ƒç”¨æˆ·<ul><li>åˆ©ç”¨ BitMapï¼Œä»¥â½‡æœŸä¸º keyï¼Œç”¨æˆ· ID ä¸º offsetï¼Œå½“â½‡æ´»è·ƒè¿‡å°±è®¾ç½®ä¸º 1ã€‚</li></ul></li><li>é¡µé¢ç»Ÿè®¡UV<ul><li>å°†è®¿é—®æŒ‡å®šé¡µé¢çš„æ¯ä¸ªç”¨æˆ· ID æ·»åŠ åˆ° HyperLogLog ä¸­ï¼Œè°ƒç”¨ PFCOUNT è·å–ã€‚</li></ul></li></ul><p>å› ä¸º<strong>æˆ‘çš„é¡¹ç›®ä¸­ä¹Ÿæœ‰ä½¿ç”¨åˆ°Redis</strong>ï¼Œåœ¨è¿™é‡Œå¤§èƒ†çŒœæµ‹â¼€ä¸‹é¢è¯•å®˜ä¼šé—®åˆ°ï¼š åœ¨ä½ çš„é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨Redisçš„ï¼Ÿ</p><ul><li>åœ¨æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨ Redis é…åˆ Spring çš„ redis-sessionï¼Œå°†ç”¨æˆ·çš„ç™»å½•æ€å­˜å…¥ redisï¼Œå®ç°å•ç‚¹ç™»å½•ã€‚</li><li>å¯¹äºç³»ç»Ÿçš„é¦–é¡µï¼Œä¸ºäº†åŠ å¿«å“åº”é€Ÿåº¦ï¼Œè®¾ç½®å®šæ—¶ä»»åŠ¡å°†é¦–é¡µæ•°æ®ç¼“å­˜åˆ° Redisä¸­ï¼Œé¿å…äº†é¦–é¡µåŠ è½½è¿‡æ…¢ç”¨æˆ·ä½“éªŒå·®çš„æƒ…å†µã€‚</li><li>å¯¹äºç”¨æˆ·åŠ â¼Šé˜Ÿä¼çš„é™åˆ¶ï¼Œä½¿ç”¨ Redisson ä½œåˆ†å¸ƒå¼é”ï¼Œé˜²â½Œäº†ç”¨æˆ·æ¶æ„è¯·æ±‚åŠ â¼Šè¶…å‡ºé™åˆ¶æ•°é‡çš„é˜Ÿä¼ã€‚</li></ul><h3 id="2ã€è®²â¼€ä¸‹-Redis-çš„å•çº¿ç¨‹æ¨¡å‹ï¼ŒIO-å¤šè·¯å¤ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ">2ã€è®²â¼€ä¸‹ Redis çš„å•çº¿ç¨‹æ¨¡å‹ï¼ŒIO å¤šè·¯å¤ç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li>Redis æ˜¯â¼€æ¬¾åŸºäºå†…å­˜çš„é«˜æ€§èƒ½é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œé‡‡ç”¨<strong>å•çº¿ç¨‹æ¨¡å‹</strong>çš„è®¾è®¡ã€‚åœ¨ Redis ä¸­ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½æ˜¯ç”±â¼€ä¸ªå•çº¿ç¨‹æ¥å¤„ç†çš„ï¼Œè¿™ä¸ª<strong>å•çº¿ç¨‹ä¸æ–­åœ°ä»å®¢æˆ·ç«¯å¥—æ¥å­—ä¸­è¯»å–å‘½ä»¤è¯·æ±‚</strong>ï¼Œå¹¶å°†å‘½ä»¤è¯·æ±‚<strong>æ”¾â¼Šâ¼€ä¸ªè¯·æ±‚é˜Ÿåˆ—</strong>ä¸­ã€‚æ¥ ç€ï¼ŒRedis çš„äº‹ä»¶å¤„ç†å™¨ä¼šæŒ‰ç…§â¼€å®šçš„è§„åˆ™é€‰æ‹©â¼€ä¸ªè¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œä¹‹åå°†å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ul><p>å•çº¿ç¨‹æ¨¡å‹çš„ä¼˜ç‚¹æ˜¯å¯ä»¥<strong>é¿å…å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶çš„ç«äº‰å’Œæ­»é”é—®é¢˜</strong>ï¼Œç®€åŒ–äº†ç³»ç»Ÿçš„è®¾è®¡å’Œè°ƒè¯•ã€‚æ­¤å¤–ï¼Œç”± äº Redis çš„å†…å­˜è®¿é—®é€Ÿåº¦éå¸¸å¿«ï¼Œå› æ­¤å•çº¿ç¨‹å¤„ç†è¯·æ±‚ä¹Ÿèƒ½å¤Ÿä¿è¯è¶³å¤Ÿçš„æ€§èƒ½ã€‚</p><p>IOå¤šè·¯å¤ç”¨ï¼š</p><ul><li>â¼€ä¸ªçº¿ç¨‹ä¸­åŒæ—¶ç›‘å¬å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œâ¼€æ—¦æŸä¸ªæ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼Œå°±â½´å³å¤„ç†å¯¹åº”çš„äº‹ä»¶ã€‚åœ¨  Redis ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯åŸºäº epoll çš„ IO å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œå¯ä»¥å®ç°é«˜æ•ˆçš„äº‹ä»¶ç›‘å¬å’Œå“åº”ã€‚</li><li>åœ¨ Redis ä¸­ï¼Œå®¢æˆ·ç«¯çš„è¯·æ±‚æ˜¯ç”±â¼€ä¸ªå•çº¿ç¨‹æ¥å¤„ç†çš„ï¼Œè€ŒIO æ“ä½œå´æ˜¯é€šè¿‡ epoll å¤šè·¯å¤ç”¨æŠ€æœ¯å®ç°çš„ã€‚è¿™ç§è®¾è®¡æ–¹å¼æ—¢èƒ½å……åˆ†åˆ©ç”¨ CPU çš„è®¡ç®—èƒ½åŠ›ï¼Œåˆèƒ½å¤Ÿä¿è¯è¶³å¤Ÿçš„ IO å¤„ç†èƒ½åŠ›ï¼Œä»è€Œå®ç°äº†é«˜æ•ˆçš„é”®å€¼å­˜å‚¨æœåŠ¡ã€‚</li></ul><h3 id="3ã€Redis-åŸºç¡€ç±»å‹ä¸­çš„-String-åº•å±‚å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ">3ã€Redis åŸºç¡€ç±»å‹ä¸­çš„ String åº•å±‚å®ç°æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>String åº•å±‚å®ç°æ˜¯ <strong>SDSï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€å­—ç¬¦ä¸²</strong>ã€‚</p><p>Rediså½“ä¸­çš„åŠ¨æ€å­—ç¬¦ä¸²ä¸»è¦æ˜¯å¯¹Cè¯­è¨€ä¸­çš„åšäº†â¼€ä¸ªå°è£…ï¼Œä½¿å¾—SDSå…·<strong>æœ‰åŠ¨æ€æ‰©å®¹ã€O(1)å¤æ‚åº¦çš„é•¿åº¦è®¡ç®—</strong>çš„ç‰¹ç‚¹ã€‚</p><p>å¹¶ä¸”é¿å…äº†Cå­—ç¬¦ä¸²ç¼“å†²åŒºæº¢å‡ºï¼ˆCå­—ç¬¦ä¸²ä¸è®°å½•è‡ªèº«é•¿åº¦ï¼‰ã€‚</p><p>å½“ SDS API éœ€è¦å¯¹ SDS è¿›è¡Œä¿®æ”¹æ—¶ï¼ŒAPI ä¼šå…ˆæ£€æŸ¥ SDS çš„ç©ºé—´æ˜¯å¦æ»¡è¶³ä¿®æ”¹æ‰€éœ€çš„è¦æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³çš„è¯ï¼ŒAPI ä¼šè‡ªåŠ¨å°† SDS çš„ç©ºé—´æ‰©å±•è‡³æ‰§è¡Œä¿®æ”¹æ‰€éœ€çš„å¤§å°ã€‚</p><p>SDSä¸»è¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ul><li>len å®é™…ä½¿ç”¨é•¿åº¦</li><li>free bufæ•°ç»„ä¸­æœªä½¿ç”¨å­—èŠ‚çš„æ•°é‡</li><li>char buf[] ç”¨äºä¿å­˜å­—ç¬¦ä¸²</li></ul><h3 id="4ã€å¦‚ä½•ä½¿ç”¨Redis-å®ç°â¼€ä¸ªæ’è¡Œæ¦œï¼Ÿ">4ã€å¦‚ä½•ä½¿ç”¨Redis å®ç°â¼€ä¸ªæ’è¡Œæ¦œï¼Ÿ</h3><p>Redis å®ç°æ’è¡Œæ¦œæ˜¯ Redis ä¸­â¼€ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ï¼Œä¸»è¦ä½¿ç”¨çš„æ˜¯ ZSet è¿›è¡Œå®ç°ï¼Œä¸‹é¢æ˜¯ä¸ºä»€ä¹ˆé€‰ç”¨ ZSetï¼š</p><ul><li><strong>æœ‰åºæ€§</strong>ï¼šæ’è¡Œæ¦œè‚¯å®šéœ€è¦å®ç°â¼€ä¸ªæ’åºçš„åŠŸèƒ½ï¼Œåœ¨ Redis ä¸­æœ‰åºçš„æ•°æ®ç»“æ„æœ‰ List å’Œ ZSetï¼›</li><li><strong>æ”¯æŒåˆ†æ•°æ“ä½œ</strong>ï¼šZSet å¯ä»¥å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œååˆ†è´´åˆæ’è¡Œæ¦œä¸­ç”¨æˆ·åˆ†æ•°åŠ¨æ€å˜åŒ–çš„åœºæ™¯ï¼Œ è€Œ List å¹¶ä¸èƒ½é’ˆå¯¹åˆ†æ•°è¿›è¡Œæ“ä½œï¼Œåªæœ‰å…¶ä¸­çš„ value è¿›è¡Œæ“ä½œï¼›</li><li>**æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼š**ZSet å¯ä»¥æŒ‰ç…§åˆ†æ•°è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œå¦‚æ’è¡Œæ¦œä¸­çš„ Top10 éœ€æ±‚å°±å¯é€šè¿‡è¯¥ç‰¹æ€§è¿›è¡Œå®ç°ï¼›</li><li>**æ”¯æŒå»é‡ï¼š**ç”±äº ZSet å±äº Set çš„ç‰¹æ®Šæ•°æ®ç»“æ„ï¼Œå› æ­¤åŒæ ·æ‹¥æœ‰ Set ä¸å¯é‡å¤çš„ç‰¹æ€§ï¼Œå¯¹äºæ’è¡Œæ¦œä¸­ä¸å¯å‡ºç°é‡å¤é¡¹çš„éœ€æ±‚ä¹Ÿååˆ†è´´åˆï¼Œè€Œ List åªèƒ½æ‰‹åŠ¨å»é‡ã€‚</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ZADD scores <span class="number">95</span> &quot;ç‹äº”&quot;</span><br><span class="line">ZADD scores <span class="number">92</span> &quot;èµµå…­&quot;</span><br><span class="line"> # æŸ¥è¯¢æ’åå‰<span class="number">3</span>çš„å­¦ç”Ÿä¿¡æ¯</span><br><span class="line">ZRANGE scores <span class="number">0</span> <span class="number">2</span> WITHSCORES</span><br><span class="line"> # æŸ¥è¯¢æ’åå‰<span class="number">3</span>çš„æ‰“å°</span><br><span class="line"><span class="number">1</span>) &quot;ç‹äº”&quot;</span><br><span class="line"> <span class="number">2</span>) &quot;95&quot;</span><br><span class="line"> <span class="number">3</span>) &quot;èµµå…­&quot;</span><br><span class="line"> <span class="number">4</span>) &quot;92&quot;</span><br><span class="line"> <span class="number">5</span>) &quot;å¼ ä¸‰&quot;</span><br><span class="line"> <span class="number">6</span>) &quot;90&quot;</span><br><span class="line"> # åˆ é™¤å­¦ç”Ÿâ€œæå››â€çš„æˆç»©ä¿¡æ¯</span><br><span class="line">ZREM scores &quot;æå››&quot;</span><br></pre></td></tr></table></figure><p>åœ¨springBootæ•´åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ å­¦ç”Ÿæˆç»©</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addScore</span><span class="params">(String name, <span class="type">int</span> score)</span> &#123;</span><br><span class="line">    redisTemplate.opsForZSet().add(<span class="string">&quot;scores&quot;</span>, name, score);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// æŸ¥è¯¢æ’åå‰Nçš„å­¦ç”Ÿæˆç»©</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map.Entry&lt;String, Double&gt;&gt; getTopScores(<span class="type">int</span> n) &#123;</span><br><span class="line">    <span class="keyword">return</span> redisTemplate.opsForZSet().reverseRangeWithScores(<span class="string">&quot;scores&quot;</span>, <span class="number">0</span>, n - <span class="number">1</span>)</span><br><span class="line">            .stream()</span><br><span class="line">            .map(tuple -&gt; <span class="keyword">new</span> <span class="title class_">AbstractMap</span>.SimpleEntry&lt;&gt;(tuple.getValue(), </span><br><span class="line">tuple.getScore()))</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// åˆ é™¤æŸä¸ªå­¦ç”Ÿçš„æˆç»©</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeScore</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    redisTemplate.opsForZSet().remove(<span class="string">&quot;scores&quot;</span>, name);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€Redis-çš„æŒä¹…åŒ–æœºåˆ¶æœ‰å“ªäº›ï¼Ÿè¯´è¯´å„è‡ªçš„ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯ï¼Ÿ">5ã€Redis çš„æŒä¹…åŒ–æœºåˆ¶æœ‰å“ªäº›ï¼Ÿè¯´è¯´å„è‡ªçš„ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯ï¼Ÿ</h3><p>redisä¸­çš„æŒä¹…åŒ–ä¸»è¦åˆ†ä¸ºRDBå’ŒAOF</p><p>RDBï¼š</p><ul><li><strong>RDB æŒä¹…åŒ–æœºåˆ¶ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹æ•°æ®é›†åšå¿«ç…§ï¼Œå°†å¿«ç…§å­˜å‚¨åˆ°ç£ç›˜ä¸­ã€‚</strong></li><li>RDB çš„ä¼˜ç¼ºç‚¹ï¼šå¯¹äº<strong>æ•°æ®æ¢å¤é€Ÿåº¦æ¯”è¾ƒå¿«</strong>ï¼ŒåŒæ—¶å­˜<strong>å‚¨çš„æ–‡ä»¶ä¹Ÿæ¯”AOF</strong> å°ï¼Œç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå‡ºç°<strong>æ•°æ®ä¸¢å¤±</strong>çš„æƒ…å†µï¼Œå› ä¸ºå¿«ç…§çš„<strong>æ—¶é—´é—´éš”è¶Šé•¿</strong>ï¼Œæ•°æ®ä¸¢å¤±çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚ã€</li></ul><p>AOF</p><ul><li>AOF æŒä¹…åŒ–æœºåˆ¶åˆ™ä¼šå°†<strong>æ¯â¼€æ¬¡çš„å†™æ“ä½œéƒ½è¿½åŠ åˆ°â¼€ä¸ªæ–‡ä»¶</strong>ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯ AOF æ–‡ä»¶ã€‚</li><li>AOF æ–‡ä»¶ä¿å­˜äº† Redis æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ‰€æœ‰å†™å‘½ä»¤ï¼Œå½“ Redis é‡å¯æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ AOF æ–‡ä»¶é‡å»ºæ•°æ®é›†ã€‚ AOF çš„ä¼˜ç¼ºç‚¹ï¼š<strong>æ•°æ®ä¸¢å¤±çš„å¯èƒ½æ€§æ¯” RDB ä½ï¼Œç¼ºç‚¹æ˜¯æ–‡ä»¶æ¯” RDB å¤§ï¼Œæ¢å¤é€Ÿåº¦æ¯”è¾ƒæ…¢</strong>ã€‚</li></ul><p>RDB+AOFæ··åˆä½¿ç”¨</p><p>åœ¨æ··åˆæŒä¹…åŒ–æœºåˆ¶ä¸­ï¼Œä½¿ç”¨ <strong>AOF æŒä¹…åŒ–æœºåˆ¶ä¿å­˜æ¯æ¬¡å†™æ“ä½œï¼Œä½¿ç”¨ RDB æŒä¹…åŒ–æœºåˆ¶ä¿å­˜æŒ‡å®šæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§</strong>ï¼Œ ä»¥æ­¤æ¥è¾¾åˆ°æ•°æ®æ¢å¤é€Ÿåº¦å’Œæ•°æ®å®Œæ•´æ€§çš„å¹³è¡¡ã€‚</p><p>åº”ç”¨åœºæ™¯</p><ul><li>RDB é€‚åˆç”¨äº<strong>æ•°æ®é›†æ¯”è¾ƒå¤§ï¼Œæ•°æ®æ¢å¤é€Ÿåº¦æ¯”è¾ƒå¿«</strong>çš„åœºæ™¯ï¼Œä¾‹å¦‚å¤‡ä»½ã€ç¾éš¾æ¢å¤ç­‰ï¼›</li><li>AOF é€‚åˆç”¨äº<strong>æ•°æ®é›†æ¯”è¾ƒå¤§ï¼Œæ•°æ®å®Œæ•´æ€§æ¯”è¾ƒé‡è¦</strong>çš„åœºæ™¯ï¼Œä¾‹å¦‚â¾¦èã€ç”µå•†ç­‰è¡Œä¸šã€‚</li></ul><h3 id="6ã€å¦‚ä½•ç”¨Redis-å®ç°åˆ†å¸ƒå¼-Sessionï¼Ÿ">6ã€å¦‚ä½•ç”¨Redis å®ç°åˆ†å¸ƒå¼ Sessionï¼Ÿ</h3><p>åˆ†å¸ƒå¼ session æŒ‡åœ¨<strong>å¤šä¸ªæœåŠ¡å™¨é—´å…±äº« session</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ redis æ¥å­˜å‚¨ session æ¥å®ç°è¯¥åŠŸèƒ½ã€‚ åœ¨ redis ä¸­æˆ‘ä»¬<strong>é€šå¸¸ä½¿ç”¨ Hash æ¥å­˜å‚¨ session</strong>ã€‚</p><p>å…·ä½“æ­¥éª¤</p><ul><li>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œå°† Session å­˜åˆ° redis ä¸­</li><li>å°†keyè®¾ç½®ä¸ºâ¼€ä¸ªå…¨å±€ idï¼Œæ ¼å¼å¯ä»¥é‡‡ç”¨â€œsession:tokenâ€ï¼Œå…¶ä¸­ token ä¸º sessiond çš„å”¯â¼€æ ‡è¯†ã€‚</li><li>å°† session çš„å”¯â¼€æ ‡è¯† token ä»¥ cookie çš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯åœ¨åç»­è¯·æ±‚ä¸­éƒ½ä¼šæºå¸¦è¿™ä¸ª cookieã€‚</li><li>åç»­è¯·æ±‚ä¸­ï¼ŒæœåŠ¡å™¨æ‹¿åˆ°å®¢æˆ·ç«¯ä¼ æ¥çš„ cookieï¼Œå¹¶æ ¹æ®å®ƒçš„å€¼ï¼Œä¹Ÿå°±æ˜¯ tokenï¼Œå» redis æ‰¾å¯¹åº”çš„ session  æ•°æ®ã€‚</li><li>ç”¨æˆ·é€€å‡ºç™»å½•åï¼Œå°† session åˆ é™¤ã€‚</li></ul><h3 id="7ã€è®²â¼€ä¸‹-Redis-ä¸­çš„å†…å­˜æ·˜æ±°æœºåˆ¶ã€æœ‰å“ªäº›å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ">7ã€è®²â¼€ä¸‹ Redis ä¸­çš„å†…å­˜æ·˜æ±°æœºåˆ¶ã€æœ‰å“ªäº›å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Ÿ</h3><p>Redis ä¸­çš„å†…å­˜æ·˜æ±°æœºåˆ¶åŒ…æ‹¬</p><ul><li>**å®šæœŸåˆ é™¤ï¼š**Redis å¯ä»¥è®¾ç½®â¼€ä¸ªå®šæ—¶å™¨ï¼Œå®šæœŸæ‰«æé”®ç©ºé—´ä¸­çš„é”®ï¼Œå¹¶åˆ é™¤å·²ç»è¿‡æœŸçš„é”®ã€‚</li><li><strong>æƒ°æ€§åˆ é™¤ï¼š<strong>å½“â¼€ä¸ªé”®è¿‡æœŸæ—¶ï¼ŒRedis ä¸ä¼šâ½´å³åˆ é™¤è¯¥é”®ï¼Œè€Œæ˜¯ç­‰åˆ°è¯¥é”®</strong>è¢«è®¿é—®æ—¶å†åˆ é™¤</strong>ã€‚</li><li><strong>å†…å­˜æ·˜æ±°ç­–ç•¥</strong>ï¼šå½“ Redis å†…å­˜å ç”¨è¾¾åˆ°ä¸Šé™æ—¶ï¼Œä¼šæ ¹æ®<strong>å†…å­˜æ·˜æ±°ç­–ç•¥æ¥é€‰æ‹©â¼€äº›é”®è¿›è¡Œåˆ é™¤</strong>ï¼Œä»¥è…¾å‡ºæ›´å¤šçš„ å†…å­˜ç©ºé—´ã€‚</li></ul><p>redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥åŒ…æ‹¬</p><ul><li>**noevictionï¼š**ç¦â½Œåˆ é™¤é”®ï¼Œå³ä¸åšä»»ä½•æ“ä½œã€‚</li><li><strong>allkeys-lruï¼š<strong>ä»æ‰€æœ‰çš„é”®ä¸­é€‰æ‹©</strong>æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é”®</strong>è¿›è¡Œåˆ é™¤ã€‚</li><li><strong>allkeys-randomï¼š<strong>ä»æ‰€æœ‰çš„é”®ä¸­</strong>éšæœºé€‰æ‹©â¼€äº›é”®</strong>è¿›è¡Œåˆ é™¤ã€‚</li><li>**volatile-lruï¼š**ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®ä¸­é€‰æ‹©æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é”®è¿›è¡Œåˆ é™¤ã€‚</li><li>**volatile-randomï¼š**ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®ä¸­éšæœºé€‰æ‹©â¼€äº›é”®è¿›è¡Œåˆ é™¤ã€‚</li><li>**volatile-ttlï¼š**ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®ä¸­é€‰æ‹©å‰©ä½™æ—¶é—´æœ€çŸ­çš„é”®è¿›è¡Œåˆ é™¤ã€‚</li></ul><h3 id="8ã€Redis-6-0-ä¹‹åä¸ºä½•å¼•â¼Šäº†å¤šçº¿ç¨‹ï¼Ÿ6-0-ä¹‹å‰ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ">8ã€Redis 6.0 ä¹‹åä¸ºä½•å¼•â¼Šäº†å¤šçº¿ç¨‹ï¼Ÿ6.0 ä¹‹å‰ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ</h3><p>åœ¨ Redis 6.0 ä¹‹å‰ï¼ŒRedis æ˜¯<strong>å•çº¿ç¨‹çš„</strong>ï¼Œè¿™æ˜¯å› ä¸º Redis çš„<strong>ä¸»è¦ç“¶é¢ˆæ˜¯åœ¨ CPU ä¸Š</strong>ã€‚ä½†æ˜¯éšç€ç¡¬ä»¶çš„å‘å±•ï¼Œç°ä»£æœåŠ¡ å™¨çš„ CPU æ ¸å¿ƒæ•°å·²ç»è¾¾åˆ°äº†å‡ åä¸ªï¼Œè¿™å°±å¯¼è‡´ <strong>Redis å•çº¿ç¨‹æ¨¡å‹æ— æ³•å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„æ€§èƒ½</strong>ã€‚å› æ­¤ï¼ŒRedis  6.0 å¼•â¼Šäº†å¤šçº¿ç¨‹ï¼Œä»¥æé«˜ Redis åœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šçš„æ€§èƒ½ã€‚</p><p>åœ¨6.0ä¹‹å‰ä¸ç”¨å¤šçº¿ç¨‹çš„åŸå› </p><ul><li>Redis <strong>å•çº¿ç¨‹æ¨¡å‹ç›¸å¯¹ç®€å•</strong>ï¼Œå®¹æ˜“ç»´æŠ¤å’Œè°ƒè¯•ï¼Œä»£ç é€»è¾‘ä¹Ÿæ¯”è¾ƒæ¸…æ™°ã€‚</li><li>Redis çš„<strong>ä¸»è¦ç“¶é¢ˆåœ¨äº CPUï¼Œè€Œä¸æ˜¯ I/O</strong>ï¼Œå› æ­¤é‡‡ç”¨å¤šçº¿ç¨‹æ¨¡å‹å¹¶ä¸èƒ½æ˜¾è‘—æé«˜æ€§èƒ½ã€‚</li><li>Redis æ˜¯â¼€ä¸ª<strong>å†…å­˜å‹æ•°æ®åº“</strong>ï¼Œå®ƒçš„æ€§èƒ½ä¸»è¦å—åˆ° <strong>CPU å’Œå†…å­˜å¸¦å®½</strong>çš„é™åˆ¶ã€‚é‡‡ç”¨å¤šçº¿ç¨‹æ¨¡å‹ä¼š<strong>å¢åŠ çº¿ç¨‹ä¹‹é—´çš„ç«äº‰å’Œé”</strong>ç­‰å¼€é”€ï¼Œåè€Œå¯èƒ½é™ä½ Redis çš„æ€§èƒ½ã€‚</li></ul><h3 id="9ã€Redis-æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼ŸåŸºç¡€æ•°æ®ç»“æ„æœ‰å‡ ç§ï¼Ÿä½ è¿˜çŸ¥é“å“ªäº›-Redis-çš„é«˜çº§æ•°æ®ç»“æ„ï¼Ÿ">9ã€Redis æœ‰å“ªäº›æ•°æ®ç±»å‹ï¼ŸåŸºç¡€æ•°æ®ç»“æ„æœ‰å‡ ç§ï¼Ÿä½ è¿˜çŸ¥é“å“ªäº› Redis  çš„é«˜çº§æ•°æ®ç»“æ„ï¼Ÿ</h3><p>åŸºç¡€ï¼š</p><p><a href="https://bu.dusays.com/2024/07/05/6687bc4e7c40b.png"><img src="https://bu.dusays.com/2024/07/05/6687bc4e7c40b.png" alt="image-20240610141542391.png"></a></p><p>é«˜çº§ï¼š</p><p><a href="https://bu.dusays.com/2024/07/05/6687bc4e62281.png"><img src="https://bu.dusays.com/2024/07/05/6687bc4e62281.png" alt="image-20240610141606414.png"></a></p><h3 id="10ã€Redis-ä¸ºä»€ä¹ˆå¿«ï¼Ÿ">10ã€Redis ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h3><ul><li><p><strong>å†…å­˜å­˜å‚¨</strong>ï¼šRedis çš„æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œç›¸æ¯”äºç¡¬ç›˜å­˜å‚¨çš„æ•°æ®åº“ï¼Œå†…å­˜å­˜å‚¨é€Ÿåº¦æ›´å¿«ã€‚</p></li><li><p><strong>å•çº¿ç¨‹æ¨¡å‹ï¼š<strong>Redis ä½¿ç”¨å•çº¿ç¨‹æ¨¡å‹å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œé¿å…äº†</strong>å¤šçº¿ç¨‹ä¹‹é—´çš„çº¿ç¨‹åˆ‡æ¢å’Œç«äº‰ç­‰å¼€é”€</strong>ï¼Œæé«˜äº†å¤„ç†è¯·æ±‚çš„æ•ˆç‡ã€‚</p></li><li><p><strong>éé˜»å¡ I/O</strong>ï¼šRedis ä½¿ç”¨<strong>éé˜»å¡ I/O å¤„ç†ç½‘ç»œé€šä¿¡</strong>ï¼Œå½“â¼€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ°æ¥æ—¶ï¼ŒRedis ä¸ä¼šâ¼€ç›´ç­‰å¾…å®¢æˆ·ç«¯çš„å“åº”ï¼Œè€Œæ˜¯ä¼šå…ˆå¤„ç†å…¶å®ƒçš„è¯·æ±‚ï¼Œè¿™æ ·å°±é¿å…äº† I/O é˜»å¡å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p></li><li><p>**ç²¾ç®€é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼š**Redis å†…ç½®äº†å¤šç§é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œå¦‚å“ˆå¸Œè¡¨ã€è·³è¡¨ç­‰ï¼Œè¿™äº›æ•°æ®ç»“æ„çš„å®ç°éå¸¸ç²¾ç®€é«˜æ•ˆï¼Œå‡å°‘äº† Redis å¯¹å†…å­˜å’Œ CPU çš„å ç”¨ï¼Œä»è€Œæé«˜äº† Redis çš„æ€§èƒ½ã€‚</p></li><li><p><strong>æŒä¹…åŒ–ç­–ç•¥</strong>ï¼šRedis æ”¯æŒå¤šç§æŒä¹…åŒ–ç­–ç•¥ï¼Œå¦‚ RDBï¼ˆå¿«ç…§ï¼‰å’Œ AOFï¼ˆè¿½åŠ å¼æ–‡ä»¶ï¼‰ç­‰ï¼Œè¿™äº›ç­–ç•¥å¯ä»¥å°†å†…å­˜ ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ï¼Œä»¥ä¿è¯æ•°æ®çš„<strong>æŒä¹…æ€§å’Œå®‰å…¨æ€§</strong>ã€‚åŒæ—¶ï¼ŒRedis å¯ä»¥å°†æ•°æ®ä»¥å‹ç¼©çš„æ–¹å¼å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­ï¼Œå‡å°‘äº†ç¡¬ç›˜çš„å ç”¨ï¼Œæé«˜äº†æ•°æ®çš„è¯»å†™é€Ÿåº¦ã€‚</p></li></ul><h3 id="11ã€å¦‚ä½•ä½¿ç”¨-Redis-å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ">11ã€å¦‚ä½•ä½¿ç”¨ Redis å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ</h3><p>rediså®ç°åˆ†å¸ƒå¼é”çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>é€šè¿‡ redis æä¾›çš„ <strong>setnx è¿›è¡Œå®ç°</strong>ï¼Œå¾€ redis ä¸­ä½¿ç”¨ setnx æ’â¼Š key æ—¶ï¼Œå¦‚æœ key å­˜åœ¨ï¼Œåˆ™è¿”å› 0ï¼Œå¯ä»¥é€šè¿‡ æ’â¼Š key çš„è¿”å›å€¼è¿›è¡Œåˆ¤æ–­æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚</li><li>é€šè¿‡ä½¿ç”¨ Redissionï¼ˆå®¢æˆ·ç«¯ï¼‰æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚å¯ä»¥è°ƒç”¨ Redission æä¾›çš„ apiï¼Œå³ lock()ï¼Œunlock()æ–¹æ³•è¿› è¡ŒåŠ é”å’Œé”çš„é‡Šæ”¾ã€‚æ­¤å¤–ï¼Œ Redission è¿˜æä¾›äº† <strong>watchdogï¼Œå³çœ‹é—¨ç‹—ï¼Œæ¥å¯¹åŠ é”çš„ key æ¯éš” 10 så¯¹è¯¥ key  è¿›è¡Œç»­æ—¶</strong>ï¼Œï¼ˆä»è€Œé¿å…é”çš„è¿‡æœŸï¼‰ã€‚</li><li>Redission çš„æ‰€æœ‰æŒ‡ä»¤æ˜¯é€šè¿‡ lua è„šæœ¬è¿›è¡Œå®ç°çš„ï¼Œlua è„šæœ¬å¯ä»¥ä¿è¯æ‰€æœ‰æŒ‡ä»¤æ‰§è¡Œçš„åŸå­æ€§</li></ul><h3 id="12ã€å¦‚ä½•ç”¨-Redis-ä¸­çš„-HyperLogLog-ç»Ÿè®¡é¡µé¢-UV">12ã€å¦‚ä½•ç”¨ Redis ä¸­çš„ HyperLogLog ç»Ÿè®¡é¡µé¢ UV?</h3><ul><li>**åˆ›å»ºâ¼€ä¸ª HyperLogLog æ•°æ®ç»“æ„ï¼š**ä½¿ç”¨ Redis çš„ PFADD å‘½ä»¤åˆ›å»ºâ¼€ä¸ª HyperLogLog æ•°æ®ç»“æ„ï¼Œç”¨äºè®°å½• æ‰€æœ‰è®¿é—®è¿‡è¯¥é¡µé¢çš„ç”¨æˆ·çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºâ¼€ä¸ªåä¸º â€œpage_uvâ€ çš„ HyperLogLogï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PFADD page_uv user1 user2 user3</span><br></pre></td></tr></table></figure><ul><li>**ç»Ÿè®¡ HyperLogLog çš„åŸºæ•°ï¼š**ä½¿ç”¨ Redis çš„ PFCOUNT å‘½ä»¤å¯ä»¥ç»Ÿè®¡ HyperLogLog çš„åŸºæ•°ï¼Œå³è®¿é—®è¿‡è¯¥â»šé¢ çš„å”¯â¼€ç”¨æˆ·æ•°ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥ç»Ÿè®¡åä¸º â€œpage_uvâ€ çš„ HyperLogLog çš„åŸºæ•°ï¼š</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PFCOUNT page_uv</span></span><br></pre></td></tr></table></figure><ul><li>**å®šæœŸåˆå¹¶ HyperLogLogï¼š**ä¸ºäº†ä¿è¯ç»Ÿè®¡ç»“æœçš„å‡†ç¡®æ€§ï¼Œéœ€è¦å®šæœŸåˆå¹¶å¤šä¸ª HyperLogLogã€‚ä½¿ç”¨ Redis çš„  PFMERGE å‘½ä»¤å¯ä»¥å°†å¤šä¸ª HyperLogLog åˆå¹¶ä¸ºâ¼€ä¸ª HyperLogLogã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥å°†åä¸º  â€œpage_uv1â€ å’Œ â€œpage_uv2â€ çš„ HyperLogLog åˆå¹¶ä¸ºâ¼€ä¸ªåä¸º â€œpage_uvâ€ çš„ HyperLogLogï¼š</li></ul><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PFMERGE page_uv page_uv1 page_uv2</span><br></pre></td></tr></table></figure><h2 id="è®¡ç®—æœºç½‘ç»œ">è®¡ç®—æœºç½‘ç»œ</h2><h3 id="1ã€ç®€è¿°è®¡ç®—æœºç½‘ç»œä¸ƒå±‚æ¨¡å‹å’Œå„è‡ªçš„ä½œç”¨ï¼Ÿ">1ã€ç®€è¿°è®¡ç®—æœºç½‘ç»œä¸ƒå±‚æ¨¡å‹å’Œå„è‡ªçš„ä½œç”¨ï¼Ÿ</h3><p>è®¡ç®—æœºç½‘ç»œä¸ƒå±‚æ¨¡å‹æ˜¯â¼€ä¸ªæŠŠ<strong>ç½‘ç»œé€šä¿¡åè®®åˆ†ä¸ºä¸ƒä¸ªå±‚æ¬¡çš„æ ‡å‡†æ¨¡å‹</strong>ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†<strong>è®©è®¡ç®—æœºç½‘ç»œçš„è®¾è®¡å’Œç®¡ç†æ›´åŠ çµæ´»å’Œæ¨¡å—åŒ–</strong>ã€‚è¿™ä¸ªæ¨¡å‹è¢«ç§°ä¸ºOSIæ¨¡å‹ï¼ˆOpen System Interconnection Modelï¼‰ï¼Œå®ƒç”±å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ ï¼ˆISOï¼‰äº1984å¹´å‘å¸ƒï¼Œæ˜¯â¼€ä¸ªå¼€æ”¾çš„æ ‡å‡†æ¨¡å‹ã€‚</p><p>æ¯ä¸ªå±‚æ¬¡éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹åŠŸèƒ½å’Œè´£ä»»ï¼Œè¿™ç§åˆ†å±‚çš„æ–¹å¼ä½¿å¾—æ¯ä¸ªå±‚æ¬¡éƒ½å¯ä»¥ç‹¬ç«‹â¼¯ä½œï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿå¾ˆå¥½åœ°åè°ƒä¸Šä¸‹å±‚ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè€Œä¸éœ€è¦ä¾èµ–äºå…¶ä»–å±‚æ¬¡çš„å®ç°ç»†èŠ‚ã€‚ä»¥ä¸‹æ˜¯æ¯ä¸ªå±‚æ¬¡çš„å…·ä½“åŠŸèƒ½å’Œè´£ä»»ï¼š</p><ul><li><strong>ç‰©ç†å±‚ï¼š<strong>ä¸»è¦è´Ÿè´£é€šè¿‡</strong>ç‰©ç†åª’ä»‹ä¼ è¾“æ¯”ç‰¹æµ</strong>ã€‚ç‰©ç†å±‚è§„å®šäº†ç‰©ç†è¿æ¥çš„è§„èŒƒï¼ŒåŒ…æ‹¬ç”µç¼†çš„ç±»å‹ã€æ¥å£çš„è§„èŒƒç­‰ã€‚</li><li><strong>æ•°æ®é“¾è·¯å±‚ï¼š<strong>ä¸»è¦è´Ÿè´£æŠŠ</strong>æ•°æ®åˆ†æˆæ•°æ®å¸§è¿›è¡Œä¼ è¾“</strong>ï¼Œå¹¶å¯¹é”™è¯¯è¿›è¡Œæ£€æµ‹å’Œçº æ­£ã€‚æ•°æ®é“¾è·¯å±‚è¿˜è´Ÿè´£ç‰©ç†åœ°å€çš„åˆ†é…ã€æ•°æ®æµé‡æ§åˆ¶ã€é”™è¯¯æ ¡éªŒç­‰ã€‚</li><li><strong>ç½‘ç»œå±‚ï¼š<strong>ä¸»è¦è´Ÿè´£</strong>æ•°æ®åœ¨ç½‘ç»œä¸­çš„ä¼ è¾“</strong>ï¼ŒåŒ…æ‹¬è·¯ç”±é€‰æ‹©ã€åˆ†ç»„è½¬å‘ã€æ•°æ®æŠ¥æ–‡çš„å°è£…ç­‰ã€‚ç½‘ç»œå±‚è¿˜å¤„ç†æ•°æ®åŒ…çš„å¯»å€å’Œæ§åˆ¶æµé‡ç­‰ã€‚</li><li><strong>ä¼ è¾“å±‚ï¼š<strong>ä¸»è¦è´Ÿè´£</strong>æ•°æ®ä¼ è¾“çš„å¯é æ€§å’Œæµé‡æ§åˆ¶ç­‰</strong>ï¼ŒåŒæ—¶è¿˜åŒ…æ‹¬åˆ†æ®µã€ç»„è£…ã€è¿æ¥å»ºâ½´å’Œæ–­å¼€ç­‰åŠŸèƒ½ã€‚ä¼ è¾“å±‚ çš„æœ€é‡è¦çš„ä¸¤ä¸ªåè®®æ˜¯ TCP å’Œ UDPã€‚</li><li><strong>ä¼šè¯å±‚ï¼š<strong>ä¸»è¦</strong>è´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢ä¼šè¯ï¼Œæä¾›ä¼šè¯æ§åˆ¶å’ŒåŒæ­¥ç­‰æœåŠ¡</strong>ã€‚ä¼šè¯å±‚è¿˜è´Ÿè´£å¤„ç†å¤šä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ çš„æ•°æ®äº¤æ¢ã€‚</li><li><strong>è¡¨ç¤ºå±‚ï¼š<strong>ä¸»è¦</strong>è´Ÿè´£æ•°æ®æ ¼å¼è½¬æ¢ã€åŠ å¯†è§£å¯†ã€å‹ç¼©è§£å‹ç­‰æœåŠ¡</strong>ã€‚è¡¨ç¤ºå±‚ä½¿å¾—åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®æ ¼å¼å’Œç¼–ç ï¼ŒåŒæ—¶è¿˜æä¾›äº†æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ä¿æŠ¤ç­‰æœåŠ¡ã€‚</li><li><strong>åº”ç”¨å±‚ï¼š<strong>ä¸»è¦</strong>æä¾›å„ç§æœåŠ¡å’Œåº”ç”¨ç¨‹åº</strong>ï¼Œå¦‚ç”µå­é‚®ä»¶ã€æ–‡ä»¶ä¼ è¾“ã€è¿œç¨‹ç™»å½•ã€Web æµè§ˆç­‰ã€‚åº”ç”¨å±‚æœåŠ¡å¯ä»¥ä½¿ç”¨ä¸åŒçš„åè®®å®ç°ï¼Œå¦‚ HTTPã€SMTPã€FTPã€TELNET ç­‰</li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240612115959575.png" alt="image-20240612115959575"></p><h3 id="2ã€HTTP-æ˜¯å“ªâ¼€å±‚çš„åè®®ï¼Ÿç®€è¿°å®ƒçš„ä½œç”¨ï¼Ÿ"><strong>2ã€HTTP æ˜¯å“ªâ¼€å±‚çš„åè®®ï¼Ÿç®€è¿°å®ƒçš„ä½œç”¨ï¼Ÿ</strong></h3><ul><li>HTTPï¼ˆHypertext Transfer Protocolï¼‰æ˜¯<strong>åº”ç”¨å±‚åè®®</strong>ï¼Œæ˜¯äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„åè®®ä¹‹â¼€ã€‚å®ƒåŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å‹ï¼Œé€šè¿‡åœ¨<strong>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ–‡æœ¬æ•°æ®æ¥è¿›è¡Œé€šä¿¡</strong>ã€‚HTTPé€šå¸¸ä½¿ç”¨TCPä½œä¸ºä¼ è¾“å±‚åè®®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ TLS/SSLè¿›è¡ŒåŠ å¯†ã€‚</li><li>HTTPçš„ä½œç”¨ï¼šæ˜¯å®šä¹‰äº†<strong>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ–¹å¼</strong>ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥å‘æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œå¹¶ä¸”æœåŠ¡å™¨å¯ä»¥å‘å®¢ æˆ·ç«¯å‘é€å“åº”ç»“æœã€‚HTTPä½¿ç”¨<strong>URL</strong>ï¼ˆUniform Resource Locatorï¼‰æ¥å®šä½èµ„æºï¼Œé€šè¿‡<strong>è¯·æ±‚æ–¹æ³•</strong>ï¼ˆå¦‚GETã€POSTã€ PUTã€DELETEç­‰ï¼‰æ¥æè¿°å¯¹èµ„æºçš„æ“ä½œï¼Œé€šè¿‡è¯·æ±‚å¤´å’Œå“åº”å¤´æ¥ä¼ é€’é™„åŠ ä¿¡æ¯ï¼Œå¦‚ç¼–ç æ ¼å¼ã€å†…å®¹ç±»å‹ã€Cookie ç­‰</li></ul><p>ä¸»è¦ç‰¹ç‚¹</p><ul><li><strong>ç®€å•æ˜“ç”¨ï¼š<strong>HTTP åè®®é‡‡ç”¨</strong>æ–‡æœ¬æ ¼å¼ä¼ è¾“æ•°æ®</strong>ï¼Œæ˜“äºäººç±»é˜…è¯»å’Œç¼–å†™ï¼Œä½¿ç”¨ç®€å•ã€‚</li><li><strong>æ— çŠ¶æ€ï¼š<strong>HTTP æ˜¯â¼€ç§</strong>æ— çŠ¶æ€åè®®ï¼Œæ¯æ¬¡è¯·æ±‚å’Œå“åº”ä¹‹é—´ç›¸äº’ç‹¬ç«‹</strong>ï¼ŒæœåŠ¡å™¨ä¸ä¼šä¿å­˜ä»»ä½•å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯éœ€è¦è‡ªè¡Œç»´æŠ¤ä¼šè¯çŠ¶æ€ã€‚</li><li><strong>å¯æ‰©å±•æ€§ï¼š<strong>HTTP å…è®¸</strong>é€šè¿‡æ‰©å±•å¤´éƒ¨ä¿¡æ¯å’Œè¯·æ±‚æ–¹æ³•ç­‰æ–¹å¼è¿›è¡Œæ‰©å±•</strong>ï¼Œæ”¯æŒè‡ªå®šä¹‰æ•°æ®ä¼ è¾“æ ¼å¼å’Œåè®®ã€‚</li><li><strong>éè¿æ¥å‹ï¼š<strong>HTTP æ˜¯â¼€ç§</strong>éè¿æ¥å‹åè®®ï¼Œæ¯ä¸ªè¯·æ±‚å’Œå“åº”ä¹‹é—´ç›¸äº’ç‹¬ç«‹</strong>ï¼Œä¸å­˜åœ¨é•¿æœŸçš„è¿æ¥çŠ¶æ€ã€‚</li></ul><h3 id="3ã€HTTP-æœ‰å“ªäº›å¸¸è§çš„çŠ¶æ€ç ï¼Ÿ">3ã€HTTP æœ‰å“ªäº›å¸¸è§çš„çŠ¶æ€ç ï¼Ÿ</h3><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240612120838109.png" alt="image-20240612120838109"></p><ul><li>1xxï¼šæç¤ºä¿¡æ¯ï¼Œä¸­é—´çŠ¶æ€ï¼Œå®é™…ç”¨åˆ°çš„æ¯”è¾ƒå°‘</li><li>2xxï¼šè¡¨ç¤ºæœåŠ¡å™¨æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯çš„è¯·æ±‚<ul><li>200 OK</li><li>204 No Content ä¹Ÿæ˜¯æˆåŠŸï¼Œä½†å“åº”å¤´<strong>æ²¡æœ‰ body ä¿¡æ¯</strong></li><li>206 Partial Content <strong>åˆ†å—ä¸‹è½½ï¼Œæ–­ç‚¹ç»­ä¼ </strong>ï¼Œè¡¨ç¤ºè¿”å›çš„ body åªæ˜¯â¼€éƒ¨åˆ†</li></ul></li><li>3xxï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„è¯·æ±‚èµ„æºå‘ç”Ÿäº†å˜åŠ¨ï¼Œéœ€è¦å®¢æˆ·ç«¯ç”¨æ–°çš„ URL é‡æ–°å‘é€è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯<strong>é‡å®šå‘</strong>ã€‚<ul><li>301 Moved Permanently <strong>æ°¸ä¹…é‡å®šå‘</strong>ï¼Œè¯·æ±‚çš„èµ„æºä¸å­˜åœ¨äº†</li><li>302 Found <strong>ä¸´æ—¶é‡å®šå‘</strong>ï¼Œè¯·æ±‚èµ„æºè¿˜åœ¨</li><li>304 Not Modified ä¸å…·æœ‰è·³è½¬çš„å«ä¹‰ï¼Œ<strong>ç¼“å­˜é‡å®šå‘</strong>ï¼Œç”¨äºç¼“å­˜æ§åˆ¶ã€‚</li></ul></li><li>4xxï¼šå®¢æˆ·ç«¯å‘é€çš„æŠ¥æ–‡æœ‰è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†<ul><li>400 Bad Request <strong>å®¢æˆ·ç«¯è¯·æ±‚</strong>çš„æŠ¥æ–‡æœ‰é”™è¯¯</li><li>403 Forbidden æœåŠ¡å™¨ç¦æ­¢è®¿é—®ã€‚</li><li>404 Not Found æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨</li></ul></li><li>5xxï¼šå®¢æˆ·ç«¯è¯·æ±‚æŠ¥æ–‡æ­£ç¡®ï¼Œä½†æ˜¯æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ï¼Œå±äºæœåŠ¡ç«¯çš„é”™è¯¯ç <ul><li>500 Internal Server Error æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</li><li>501 Not Implemented è¯·æ±‚çš„åŠŸèƒ½è¿˜ä¸â½€æŒï¼Œå³å°†å¼€ä¸šæ•¬è¯·æœŸå¾…</li><li>502 Bad Gateway æœåŠ¡å™¨ä½œä¸ºâ½¹å…³å’Œä»£ç†è¿”å›çš„é”™è¯¯ç </li><li>503 Service Unavaliable æœåŠ¡å™¨å¾ˆå¿™</li></ul></li></ul><h3 id="4ã€TCP-å’Œ-UDP-åè®®æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ">4ã€TCP å’Œ UDP åè®®æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ</h3><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240613121901134.png" alt="image-20240613121901134"></p><h3 id="5ã€HTTP-åè®®ä¸­-GET-å’Œ-POST-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ">5ã€HTTP åè®®ä¸­ GET å’Œ POST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ</h3><ul><li><p><strong>å‚æ•°ä¼ é€’æ–¹å¼ä¸åŒ</strong></p><ul><li>GET è¯·æ±‚å‚æ•°æ˜¯åœ¨ <strong>URL ä¸­ä»¥é”®å€¼å¯¹</strong>çš„å½¢å¼ä¼ é€’çš„</li><li>è€Œ POST è¯·æ±‚å‚æ•°æ˜¯åœ¨<strong>è¯·æ±‚ä½“ä¸­ä»¥é”®å€¼å¯¹</strong>çš„å½¢å¼ä¼ é€’çš„ã€‚</li></ul></li><li><p><strong>å‚æ•°ä¼ é€’å¤§å°ä¸åŒ</strong></p><ul><li>å› ä¸º <strong>URL é•¿åº¦æœ‰é™åˆ¶</strong>ï¼Œä¸åŒçš„æµè§ˆå™¨å’ŒæœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„ é™åˆ¶ä¸åŒï¼Œâ¼€èˆ¬ä¸º 2048 ä¸ªå­—ç¬¦</li><li>è€Œ POST è¯·æ±‚å‚æ•°<strong>æ²¡æœ‰å¤§å°é™åˆ¶</strong>ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»¥è¯·æ±‚ä½“çš„å½¢å¼ä¼ é€’çš„ã€‚</li></ul></li><li><p><strong>å®‰å…¨æ€§ä¸åŒ</strong></p><ul><li>GET è¯·æ±‚çš„å‚æ•°æ˜¯<strong>æ˜æ–‡ä¼ è¾“</strong>çš„ï¼Œå› ä¸º<strong>å‚æ•°åœ¨ URL</strong> ä¸­ï¼Œå¦‚æœæ¶‰åŠæ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ï¼‰ï¼Œå®¹æ˜“è¢«çªƒå–æˆ–æš´éœ² åœ¨æµè§ˆå™¨å†å²è®°å½•ã€ä»£ç†æœåŠ¡å™¨æ—¥å¿—ç­‰åœ°æ–¹ã€‚</li><li>è€Œ POST è¯·æ±‚çš„<strong>å‚æ•°åœ¨è¯·æ±‚ä½“ä¸­ä¼ è¾“</strong>ï¼Œç›¸å¯¹å®‰å…¨â¼€äº›ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦æ³¨æ„<strong>å‚æ•°åŠ å¯†å’Œé˜²â½Œ CSRF æ”»å‡»</strong>ç­‰é—® é¢˜</li></ul></li><li><p><strong>GET å’Œ POST é€‚ç”¨çš„åœºæ™¯ä¸åŒï¼š</strong></p><ul><li>GET è¯·æ±‚é€‚ç”¨äº<strong>è·å–æ•°æ®ï¼Œå¦‚æµç½‘é¡µ</strong>ã€æœç´¢ç­‰ã€‚å› ä¸º GET è¯·æ±‚å‚æ•°ä»¥æ˜æ–‡å½¢å¼ä¼ è¾“ï¼Œå®¹æ˜“è¢«æ‹¦æˆªå’Œç¯¡ æ”¹ï¼Œæ‰€ä»¥ä¸é€‚ç”¨äºæäº¤æ•æ„Ÿä¿¡æ¯çš„æ“ä½œã€‚</li><li>POST è¯·æ±‚é€‚<strong>ç”¨äºæäº¤æ•°æ®ï¼Œå¦‚ç™»å½•ã€æ³¨å†Œã€å‘å¸ƒå†…å®¹</strong>ç­‰ã€‚å› ä¸º POST è¯·æ±‚å‚æ•°åœ¨è¯·æ±‚ä½“ä¸­ä¼ è¾“ï¼Œç›¸å¯¹ å®‰å…¨â¼€äº›ï¼Œå¯ä»¥æäº¤æ•æ„Ÿä¿¡æ¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å‚æ•°åŠ å¯†å’Œé˜²â½Œ CSRF æ”»å‡»ç­‰é—®é¢˜ã€‚</li></ul></li></ul><h3 id="6ã€ç®€è¿°-TCP-ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹çš„æµç¨‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ">6ã€ç®€è¿° TCP ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹çš„æµç¨‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</h3><p>ä¸‰æ¬¡æ¡â¼¿çš„è¿‡ç¨‹å¦‚ä¸‹</p><ul><li>ç¬¬â¼€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ SYN æŠ¥æ–‡ï¼Œè¯·æ±‚å»ºç«‹è¿æ¥ã€‚</li><li>ç¬¬â¼†æ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡ï¼Œå‘å®¢æˆ·ç«¯å‘é€ SYN+ACK æŠ¥æ–‡ï¼Œè¡¨ç¤ºå¯ä»¥å»ºç«‹è¿æ¥ã€‚</li><li>ç¬¬ä¸‰æ¬¡æ¡â¼¿ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ SYN+ACK æŠ¥æ–‡ï¼Œå‘æœåŠ¡å™¨å‘é€ ACK æŠ¥æ–‡ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å»ºâ½´ã€‚</li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240613122639879.png" alt="image-20240613122639879"></p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼š</strong></p><p>ä¸‰æ¬¡æ¡â¼¿çš„ç›®çš„æ˜¯ä¸ºäº†ç¡®è®¤åŒæ–¹çš„æ”¶å‘èƒ½â¼’å’ŒåŒæ­¥åˆå§‹åºåˆ—å·ã€‚</p><p>å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹å¦‚ä¸‹</p><ul><li><p>ç¬¬â¼€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ FIN æŠ¥æ–‡ï¼Œè¯·æ±‚å…³é—­è¿æ¥ã€‚</p></li><li><p>ç¬¬â¼†æ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ FIN æŠ¥æ–‡ï¼Œå‘å®¢æˆ·ç«¯å‘é€ ACK æŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°å…³é—­è¯·æ±‚ã€‚</p></li><li><p>ç¬¬ä¸‰æ¬¡æŒ¥â¼¿ï¼šæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€ FIN æŠ¥æ–‡ï¼Œè¯·æ±‚å…³é—­è¿æ¥ã€‚</p></li><li><p>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ FIN æŠ¥æ–‡ï¼Œå‘æœåŠ¡å™¨å‘é€ ACK æŠ¥æ–‡ï¼Œè¡¨ç¤ºæ”¶åˆ°å…³é—­è¯·æ±‚ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240613122843281.png" alt="image-20240613122843281"></p></li></ul><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</strong></p><p>å››æ¬¡æŒ¥æ‰‹çš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯<strong>æ•°æ®çš„å®Œæ•´æ€§å’Œå¯é æ€§</strong>ã€‚åœ¨å…³é—­è¿æ¥ä¹‹å‰ï¼ŒåŒæ–¹éœ€è¦ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½å·²ç»ä¼ è¾“å®Œæ¯•ï¼Œå›  æ­¤éœ€è¦é€šè¿‡å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹è¿›è¡Œç¡®è®¤å’Œå¤„ç†ã€‚</p><p><strong>æ€»ç»“ï¼šä¸‰æ¬¡æ¡â¼¿çš„æœ¬è´¨æ˜¯ç¡®è®¤é€šä¿¡åŒæ–¹æ”¶å‘æ•°æ®çš„èƒ½â¼’ ï¼Œå››æ¬¡æŒ¥â¼¿çš„ç›®çš„æ˜¯å…³é—­â¼€ä¸ªè¿æ¥ã€‚</strong></p><h2 id="æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯è¿›ç¨‹å’Œçº¿ç¨‹ï¼Ÿå®ƒä»¬æœ‰å“ªäº›åŒºåˆ«å’Œè”ç³»ï¼Ÿ">1ã€ä»€ä¹ˆæ˜¯è¿›ç¨‹å’Œçº¿ç¨‹ï¼Ÿå®ƒä»¬æœ‰å“ªäº›åŒºåˆ«å’Œè”ç³»ï¼Ÿ</h3><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯æŒ‡â¼€ä¸ªæ­£åœ¨æ‰§è¡Œä¸­çš„ç¨‹åºï¼Œè€Œçº¿ç¨‹æ˜¯è¿›ç¨‹çš„â¼€éƒ¨åˆ†ï¼Œæ˜¯â¼€ä¸ªç¨‹åºä¸­æ‰§è¡Œçš„ä»£ç ç‰‡æ®µã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240614104819769.png" alt="image-20240614104819769"></p><h3 id="2ã€æ­»é”æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é¢„é˜²å’Œé¿å…æ­»é”ï¼Ÿ">2ã€æ­»é”æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é¢„é˜²å’Œé¿å…æ­»é”ï¼Ÿ</h3><p>æ­»é”æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹ä¸ºäº†<strong>ä¿æŠ¤ä¸¤ä¸ªä¸åŒçš„å…±äº«èµ„æºè€Œä½¿ç”¨äº†ä¸¤ä¸ªäº’æ–¥é”</strong>ï¼Œå¦‚æœåº”ç”¨ä¸å½“ï¼Œä¼šé€ æˆä¸¤ä¸ªçº¿ç¨‹<strong>éƒ½åœ¨ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”</strong>ï¼Œæ²¡æœ‰å¤–åŠ›çš„ä½œç”¨ä¸‹ï¼Œè¿™äº›çº¿ç¨‹ä¼šâ¼€ç›´äº’ç›¸ç­‰å¾…ï¼Œå°±æ²¡åŠæ³•ç»§ç»­è¿è¡Œï¼Œè¿™å°±æ˜¯å‘ç”Ÿäº†æ­»é”ã€‚</li></ul><p>äº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶</p><ul><li><strong>äº’æ–¥æ¡ä»¶</strong>ï¼šå¤šä¸ªçº¿ç¨‹ä¸èƒ½åŒæ—¶ä½¿ç”¨â¼€ä¸ªèµ„æºã€‚</li><li><strong>æŒæœ‰å¹¶ç­‰å¾…æ¡ä»¶</strong>ï¼šçº¿ç¨‹Aåœ¨ç­‰å¾…èµ„æº2çš„åŒæ—¶å¹¶ä¸ä¼šé‡Šæ”¾è‡ªå·±å·²ç»æŒæœ‰çš„èµ„æº1ã€‚</li><li><strong>ä¸å¯å‰¥å¤ºæ¡ä»¶</strong>ï¼šåœ¨è‡ªå·±ä½¿ç”¨ä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–ã€‚</li><li><strong>ç¯è·¯ç­‰å¾…æ¡ä»¶</strong>ï¼šä¸¤ä¸ªçº¿ç¨‹è·å–èµ„æºçš„é¡ºåºæ„æˆäº†ç¯å½¢é“¾</li></ul><p>é¢„é˜²å’Œé¿å…æ­»é”çš„æªæ–½</p><ul><li><strong>é¿å…èµ„æºç‹¬å </strong>ï¼šå°½é‡é¿å…â¼€ä¸ªè¿›ç¨‹åœ¨è·å¾—äº†æŸäº›èµ„æºå<strong>å†æ¬¡è¯·æ±‚å…¶ä»–èµ„æº</strong>ï¼Œè€Œåº”è¯¥å°†æ‰€æœ‰éœ€è¦çš„èµ„æºâ¼€æ¬¡æ€§ç”³è¯·åˆ°ä½ã€‚</li><li><strong>é¿å…èµ„æºæŒæœ‰å’Œç­‰å¾…</strong>ï¼šå½“â¼€ä¸ªè¿›ç¨‹å ç”¨äº†â¼€äº›èµ„æºå¹¶ç­‰å¾…å¦â¼€äº›èµ„æºæ—¶ï¼Œå…¶ä»–è¿›ç¨‹å°±â½†æ³•ä½¿ç”¨è¿™äº›èµ„æºï¼Œå®¹æ˜“å¼•å‘æ­»é”ã€‚å› æ­¤<strong>å°½å¯èƒ½å‡å°‘èµ„æºæŒæœ‰å’Œç­‰å¾…æ—¶é—´</strong>ã€‚</li><li>**é¿å…èµ„æºäº’æ–¥ï¼š**æœ‰äº›èµ„æºåœ¨åŒâ¼€æ—¶é—´åªèƒ½è¢«â¼€ä¸ªè¿›ç¨‹å ç”¨ï¼Œæ¯”å¦‚æ‰“å°æœºã€ç£å¸¦æœºç­‰ï¼Œéœ€è¦é‡‡ç”¨â¼€äº›æŠ€æœ¯â¼¿æ®µæ¥é¿å…èµ„æºäº’æ–¥çš„é—®é¢˜ã€‚</li><li><strong>å¼•â¼Šèµ„æºå‰¥å¤ºç­–ç•¥</strong>ï¼šå½“â¼€ä¸ªè¿›ç¨‹è¯·æ±‚çš„èµ„æºè¢«å…¶ä»–è¿›ç¨‹å ç”¨æ—¶ï¼Œå¯ä»¥é‡‡å–<strong>å‰¥å¤ºèµ„æºçš„ç­–ç•¥</strong>ï¼Œå³<strong>æš‚åœå ç”¨è¯¥èµ„æºçš„è¿›ç¨‹</strong>ï¼Œç›´åˆ°è¯¥èµ„æºè¢«é‡Šæ”¾åå†æ¢å¤è¯¥è¿›ç¨‹çš„æ‰§è¡Œã€‚</li><li><strong>å¼•â¼Šè¿›ç¨‹æŠ¢å ç­–ç•¥</strong>ï¼šå½“â¼€ä¸ªè¿›ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿æ—¶ï¼Œå¯ä»¥é‡‡å–æŠ¢å å…¶èµ„æºçš„ç­–ç•¥ï¼Œå³ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œå¼ºåˆ¶é‡Šæ”¾å…¶å ç”¨çš„èµ„æºã€‚</li></ul><p>ä¾‹â¼¦1ï¼šçº¿ç¨‹ä¹‹é—´å¦‚ä½•é¿å…æ­»é”</p><ul><li>çº¿ç¨‹Aå’Œçº¿ç¨‹Bè·å–èµ„æºçš„é¡ºåºè¦â¼€æ ·</li><li>çº¿ç¨‹ A æ˜¯å…ˆå°è¯•è·å–èµ„æº Aï¼Œç„¶åå°è¯•è·å–èµ„æº B çš„æ—¶å€™</li><li>çº¿ç¨‹ B åŒæ ·ä¹Ÿæ˜¯å…ˆå°è¯•è·å–èµ„æº Aï¼Œç„¶åå°è¯•è·å–èµ„æº B</li><li>çº¿ç¨‹ A å’Œ çº¿ç¨‹ B æ€»æ˜¯ä»¥ç›¸åŒçš„é¡ºåºç”³è¯·è‡ªå·±æƒ³è¦çš„èµ„æºã€‚</li></ul><p>ä¾‹â¼¦2ï¼šMySQL å¦‚ä½•é¿å…æ­»é”</p><ul><li>è®¾ç½®äº‹åŠ¡ç­‰å¾…é”çš„è¶…æ—¶æ—¶é—´</li><li>å¼€å¯ä¸»åŠ¨æ­»é”æ£€æµ‹</li></ul><h3 id="3ã€çº¿ç¨‹é—´æœ‰å“ªäº›é€šä¿¡æ–¹å¼ï¼Ÿ">3ã€çº¿ç¨‹é—´æœ‰å“ªäº›é€šä¿¡æ–¹å¼ï¼Ÿ</h3><ul><li>**å…±äº«å†…å­˜ï¼š**å¤šä¸ªçº¿ç¨‹å…±äº«åŒâ¼€å—å†…å­˜ç©ºé—´ï¼Œé€šè¿‡å¯¹å†…å­˜çš„è¯»å†™æ“ä½œå®ç°çº¿ç¨‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚å¯ä»¥ä½¿ç”¨synchronized å…³é”®å­—æˆ– Lock æ¥â¼ç­‰æœºåˆ¶æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</li><li>**æ¶ˆæ¯é˜Ÿåˆ—ï¼š**â¼€ä¸ªçº¿ç¨‹å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ”¾â¼Šâ¼€æ¡æ¶ˆæ¯ï¼Œå¦â¼€ä¸ªçº¿ç¨‹ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ã€‚</li><li>**ç®¡é“ï¼š**ç®¡é“æ˜¯â¼€ç§ç‰¹æ®Šçš„æµï¼Œç”¨äºåœ¨çº¿ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®ã€‚Java ä¸­çš„ PipedInputStream å’Œ PipedOutputStream ç±» å°±æ˜¯ç®¡é“çš„å®ç°ã€‚</li><li><strong>ä¿¡å·ï¼ˆSignalï¼‰</strong>ï¼šä¿¡å·æ˜¯â¼€ç§å¼‚æ­¥é€šä¿¡æ–¹å¼ï¼Œè¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œä¼šæ ¹æ®ä¿¡å·çš„ç±»å‹åšå‡ºç›¸åº”çš„å¤„ç†ã€‚</li><li><strong>RPCè°ƒç”¨</strong>ï¼šè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æ˜¯â¼€ç§è·¨ç½‘ç»œè¿›è¡Œçš„è¿œç¨‹è°ƒç”¨ï¼Œå¯ä»¥å®ç°åœ¨ä¸åŒçš„çº¿ç¨‹æˆ–æœºå™¨ä¹‹é—´è¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚</li></ul><h3 id="4ã€ä»€ä¹ˆæ˜¯é›¶æ‹·è´ï¼Ÿè¯´â¼€è¯´ä½ å¯¹é›¶æ‹·è´çš„ç†è§£ï¼Ÿ">4ã€ä»€ä¹ˆæ˜¯é›¶æ‹·è´ï¼Ÿè¯´â¼€è¯´ä½ å¯¹é›¶æ‹·è´çš„ç†è§£ï¼Ÿ</h3><p>é›¶æ‹·è´ï¼ˆZero-Copyï¼‰æ˜¯â¼€ç§é«˜æ•ˆçš„æ•°æ®ä¼ è¾“æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å°†æ•°æ®<strong>ä»å†…æ ¸ç©ºé—´ç›´æ¥ä¼ è¾“åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ç©ºé—´</strong>ä¸­ï¼Œ é¿å…äº†ä¸å¿…è¦çš„æ•°æ®æ‹·è´ï¼Œä»è€Œæé«˜äº†æ•°æ®ä¼ è¾“çš„æ•ˆç‡å’Œæ€§èƒ½ã€‚</p><p>ä¼ ç»Ÿï¼š</p><p>ä¼ ç»Ÿçš„æ•°æ®ä¼ è¾“æ–¹å¼ä¸­ï¼Œå½“åº”ç”¨ç¨‹åºéœ€è¦ä»ç£ç›˜ã€ç½‘ç»œç­‰å¤–éƒ¨è®¾å¤‡ä¸­è¯»å–æ•°æ®æ—¶ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦å…ˆå°†æ•°æ®ä»å¤–éƒ¨ è®¾å¤‡æ‹·è´åˆ°å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºï¼Œç„¶åå†å°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ç©ºé—´ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è¿›è¡Œä¸¤æ¬¡æ•°æ®æ‹·è´ï¼Œæµªè´¹äº†å¤§é‡çš„ CPU æ—¶é—´å’Œå†…å­˜å¸¦å®½ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240615190415375.png" alt="image-20240615190415375"></p><p>é›¶æ‹·è´</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240615190429383.png" alt="image-20240615190429383"></p><p>æ•°æ®å¯ä»¥<strong>ç›´æ¥ä»å¤–éƒ¨è®¾å¤‡å¤åˆ¶åˆ°åº”ç”¨ç¨‹åºçš„å†…å­˜ç©ºé—´ä¸­ï¼Œé¿å…äº†ä¸­é—´çš„å†…æ ¸ç©ºé—´ç¼“å†²åŒºï¼Œå‡å°‘äº†ä¸å¿…è¦çš„æ•°æ®æ‹·è´</strong>ï¼Œæé«˜äº†æ•°æ®ä¼ è¾“çš„æ•ˆç‡å’Œæ€§èƒ½ã€‚</p><h2 id="åˆ†å¸ƒå¼">åˆ†å¸ƒå¼</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ï¼Ÿ">1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ï¼Ÿ</h3><ul><li><p>åˆ†å¸ƒå¼æ˜¯æŒ‡åœ¨å¤šå°è®¡ç®—æœºä¸ŠååŒâ¼¯ä½œçš„ç³»ç»Ÿï¼Œè¿™äº›<strong>è®¡ç®—æœºé€šè¿‡ç½‘ç»œè¿æ¥åœ¨â¼€èµ·ï¼Œå…±åŒå®Œæˆâ¼€ä¸ªä»»åŠ¡</strong>ã€‚</p></li><li><p>åˆ†å¸ƒå¼ç³»ç»Ÿèƒ½å¤Ÿæœ‰æ•ˆåœ°è§£å†³å•å°è®¡ç®—æœºå¤„ç†èƒ½åŠ›ä¸è¶³ã€ç³»ç»Ÿå®¹æ˜“å®•æœºã€æ•°æ®å­˜å‚¨å®¹é‡æœ‰é™ç­‰é—®é¢˜ï¼ŒåŒæ—¶èƒ½å¤Ÿæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€å¯ç”¨æ€§å’Œæ€§èƒ½ï¼Œé€‚ç”¨äºæ•°æ®é‡è¾ƒå¤§ã€å¹¶å‘é‡é«˜ã€è®¿é—®é¢‘ç¹çš„åœºæ™¯ã€‚</p></li><li><p>åˆ†å¸ƒå¼ç³»ç»Ÿè¿˜å¯ä»¥é€šè¿‡æ¨ªå‘æ‰©å±•çš„æ–¹å¼æé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯é æ€§ï¼ŒåŒæ—¶é™ä½å•ç‚¹æ•…éšœçš„é£é™©ï¼Œæé«˜äº†ç³»ç»Ÿçš„å¯ä¼¸ç¼©æ€§ï¼Œæ–¹ä¾¿è¿›è¡Œå‡çº§å’Œç»´æŠ¤ã€‚</p></li></ul><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºæ•°æ®å’Œè®¡ç®—ä»»åŠ¡è¢«åˆ†å¸ƒåœ¨å¤šå°è®¡ç®—æœºä¸Šï¼Œä¸åŒè®¡ç®—æœºä¹‹é—´éœ€è¦è¿›è¡Œé€šä¿¡å’Œåè°ƒï¼Œå› æ­¤éœ€è¦è§£å†³åˆ†å¸ƒå¼â¼€è‡´æ€§ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœæ¢å¤ã€æ•°æ®å…±äº«å’Œå®‰å…¨ç­‰é—®é¢˜ï¼ŒåŒæ—¶éœ€è¦è€ƒè™‘æ•°æ®çš„â¼€è‡´æ€§å’Œå¯é æ€§ã€‚å› æ­¤ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°æ¯”å•æœºç³»ç»Ÿæ›´åŠ å¤æ‚å’Œå›°éš¾ï¼Œéœ€è¦è€ƒè™‘åˆ°å¤šä¸ªå› ç´ çš„ç»¼åˆå½±å“ã€‚</p><h3 id="2ã€ä»€ä¹ˆæ˜¯ç½‘å…³ï¼Œç½‘å…³æœ‰å“ªäº›ä½œç”¨ï¼Ÿ">2ã€ä»€ä¹ˆæ˜¯ç½‘å…³ï¼Œç½‘å…³æœ‰å“ªäº›ä½œç”¨ï¼Ÿ</h3><p>ç½‘å…³ï¼ˆGatewayï¼‰æ˜¯è¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªä¸åŒç½‘ç»œçš„è®¾å¤‡ï¼Œå¯ä»¥å®ç°<strong>åè®®çš„è½¬æ¢ã€æ•°æ®çš„è½¬å‘å’Œå®‰å…¨ç­–ç•¥</strong>çš„å®ç°ç­‰åŠŸèƒ½ã€‚ç®€å•æ¥è¯´ï¼Œç½‘å…³æ˜¯<strong>è®¾å¤‡ä¸è·¯ç”±å™¨ä¹‹é—´çš„æ¡¥æ¢</strong>ï¼Œç”±å®ƒå°†ä¸åŒçš„ç½‘ç»œé—´è¿›è¡Œè®¿é—®çš„æ§åˆ¶ï¼Œè½¬æ¢ï¼Œäº¤æ¥ç­‰ç­‰ã€‚ å¸¸è§çš„ç½‘å…³æœ‰<strong>åº”ç”¨ç½‘å…³ã€åè®®ç½‘å…³ã€å®‰å…¨ç½‘å…³</strong>ç­‰ã€‚</p><p>ç½‘å…³çš„ä½œç”¨</p><ul><li><strong>å®ç°åè®®çš„è½¬æ¢</strong>ï¼šä¸åŒç½‘ç»œä¹‹é—´é€šå¸¸ä½¿ç”¨ä¸åŒçš„åè®®ï¼Œé€šè¿‡ç½‘å…³å¯ä»¥å®ç°åè®®çš„è½¬æ¢ï¼Œä½¿å¾—ä¸åŒç½‘ç»œä¹‹é—´èƒ½å¤Ÿç›¸äº’é€šä¿¡ã€‚</li><li><strong>æä¾›æ•°æ®è½¬å‘åŠŸèƒ½</strong>ï¼šç½‘å…³å¯ä»¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€è·¯ç”±ã€è½¬å‘ç­‰å¤„ç†ï¼Œç¡®ä¿æ•°æ®çš„å¯é ä¼ è¾“ã€‚</li><li><strong>å®ç°å®‰å…¨ç­–ç•¥</strong>ï¼šç½‘å…³å¯ä»¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€è®¤è¯ã€æˆæƒç­‰æ“ä½œï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚</li><li>**æä¾›ç¼“å­˜åŠŸèƒ½ï¼š**ç½‘å…³å¯ä»¥å°†â¼€éƒ¨åˆ†æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œæé«˜æ•°æ®çš„è®¿é—®é€Ÿåº¦å’Œå“åº”æ€§èƒ½ã€‚</li><li>**æ”¯æŒè´Ÿè½½å‡è¡¡ï¼š**ç½‘å…³å¯ä»¥å°†è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå®ç°è´Ÿè½½å‡è¡¡ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</li><li><strong>å®ç°è®¿é—®æ§åˆ¶</strong>ï¼šç½‘å…³å¯ä»¥å¯¹è®¿é—®è¿›è¡Œæ§åˆ¶ï¼Œé˜²æ­¢æœªæˆæƒçš„è®¿é—®å’Œæ”»å‡»ï¼Œæé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</li></ul><h3 id="3ã€Dubbo-æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦äº†è§£è¿‡å®ƒçš„æ¶æ„è®¾è®¡ï¼Ÿ">3ã€Dubbo æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦äº†è§£è¿‡å®ƒçš„æ¶æ„è®¾è®¡ï¼Ÿ</h3><p>Apache Dubbo æ˜¯â¼€æ¬¾<strong>é«˜æ€§èƒ½çš„ Java RPC æ¡†æ¶</strong>ã€‚å…¶å‰èº«æ˜¯é˜¿â¾¥å·´å·´å…¬å¸å¼€æºçš„â¼€ä¸ªé«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æº Java  RPC æ¡†æ¶ï¼Œå¯ä»¥å’Œ Spring æ¡†æ¶â½†ç¼é›†æˆã€‚</p><p><strong>ä»€ä¹ˆæ˜¯RPC ï¼Ÿ</strong></p><p>RPC å…¨ç§°ä¸º remote procedure callï¼Œå³<strong>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</strong></p><p>æ¯”å¦‚ä¸¤å°æœåŠ¡å™¨ A å’Œ Bï¼ŒA æœåŠ¡å™¨ä¸Šéƒ¨ç½²â¼€ä¸ªåº”ç”¨ï¼ŒB æœåŠ¡å™¨ä¸Šéƒ¨ç½²â¼€ä¸ªåº”ç”¨ï¼ŒA æœåŠ¡å™¨ä¸Šçš„åº”ç”¨æƒ³è°ƒç”¨B æœåŠ¡å™¨ ä¸Šçš„åº”ç”¨æä¾›çš„æ–¹æ³•ï¼Œç”±äºä¸¤ä¸ªåº”ç”¨ä¸åœ¨â¼€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ç½‘ç»œæ¥è¡¨è¾¾è°ƒç”¨çš„è¯­ä¹‰å’Œä¼ è¾¾è°ƒç”¨çš„æ•°æ®ã€‚</p><p>Dubboæ¶æ„å›¾</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240616151207120.png" alt="image-20240616151207120"></p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240616151219081.png" alt="image-20240616151219081"></p><p><strong>è°ƒç”¨å…³ç³»è¯´æ˜</strong></p><ul><li>1.æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li><li>2.æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li><li>3.æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li><li>4.æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li><li>5.æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰â¼€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦â¼€å°è°ƒç”¨ã€‚</li><li>6.æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€â¼€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li></ul><h3 id="4ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çš„-CAP-ç†è®ºï¼Ÿ">4ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çš„ CAP ç†è®ºï¼Ÿ</h3><p>åˆ†å¸ƒå¼çš„ CAP ç†è®ºæ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ<strong>â¼€è‡´æ€§ï¼ˆConsistencyï¼‰</strong>ã€**å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ ï¼ˆPartition Toleranceï¼‰**è¿™ä¸‰ä¸ªæŒ‡æ ‡â½†æ³•åŒæ—¶æ»¡è¶³çš„é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼š</p><ul><li>**â¼€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼š**æŒ‡å¤šä¸ªå‰¯æœ¬ä¹‹é—´æ•°æ®ä¿æŒâ¼€è‡´ï¼Œå³åœ¨â¼€ä¸ªå‰¯æœ¬ä¸Šçš„å†™æ“ä½œä¼šç«‹å³åŒæ­¥åˆ°å…¶ä»–æ‰€æœ‰å‰¯æœ¬ï¼Œæ‰€æœ‰å‰¯æœ¬çš„æ•°æ®éƒ½æ˜¯æœ€æ–°çš„ï¼Œ<strong>ä¿æŒå¼ºâ¼€è‡´æ€§</strong>ã€‚</li><li><strong>å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰</strong>ï¼šæŒ‡ç³»ç»Ÿåœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œ<strong>å³ç³»ç»Ÿéšæ—¶èƒ½å¤Ÿå“åº”ç”¨æˆ·è¯·æ±‚</strong>ï¼Œä¸ä¼šå› ä¸ºèŠ‚ç‚¹æ•…éšœæˆ–å…¶ä»–åŸå› è€Œå¯¼è‡´æœåŠ¡ä¸­æ–­ã€‚</li><li><strong>åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰</strong>ï¼šæŒ‡ç³»ç»Ÿåœ¨å‡ºç°<strong>ç½‘ç»œåˆ†åŒºï¼ˆèŠ‚ç‚¹ä¹‹é—´å¤±å»è”ç³»</strong>ï¼‰æ—¶ï¼Œä»èƒ½å¤Ÿç»§ç»­â¼¯ä½œï¼Œä¿è¯æ•°æ®çš„â¼€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚</li></ul><p>CAP ç†è®ºæŒ‡å‡ºï¼Œâ¼€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿ<strong>åªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­çš„ä¸¤ä¸ªæŒ‡æ ‡ï¼Œæ— æ³•åŒæ—¶æ»¡è¶³ä¸‰ä¸ª</strong>ã€‚</p><p>ç„¶è€Œå®é™…ä¸Šï¼Œ<strong>åˆ†åŒºå®¹é”™æ€§æ˜¯â¼€å®šè¦æ»¡è¶³çš„</strong>ï¼Œå› ä¸ºä¸å¯èƒ½åªè¦å‡ºç°åˆ†åŒºé—®é¢˜æ—¶æ•´ä¸ªç³»ç»Ÿå°±å®Œå…¨æ— æ³•ä½¿ç”¨ã€‚å› æ­¤ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„æ˜¯å½“å‡ºç°åˆ†åŒºé—®é¢˜æ—¶ï¼Œé€‰æ‹©çš„æ˜¯<strong>â¼€è‡´æ€§è¿˜æ˜¯å¯ç”¨æ€§</strong>ï¼Œ<strong>å³ CP è¿˜æ˜¯ AP</strong>ã€‚</p><ul><li><strong>CP æ¶æ„ï¼š<strong>å½“ç³»ç»Ÿå‡ºç°åˆ†åŒºæ•…éšœæ—¶ï¼Œå®¢æˆ·ç«¯å‘é€çš„ä»»æ„è¯·æ±‚éƒ½ä¼šè¢«å¡æ­»æˆ–è¶…æ—¶ï¼Œä¿è¯</strong>æ•°æ®çš„å¼ºâ¼€è‡´æ€§</strong>ã€‚å¦‚  Zookeeperã€‚</li><li><strong>AP æ¶æ„ï¼š<strong>å½“ç³»ç»Ÿå‡ºç°åˆ†åŒºæ•…éšœæ—¶ï¼Œå®¢æˆ·ç«¯</strong>ä¾æ—§èƒ½è·å–æ•°æ®</strong>ï¼Œä½†æœ‰çš„æ˜¯æ–°æ•°æ®ï¼Œæœ‰çš„æ˜¯æ—§æ•°æ®ã€‚å¦‚ Eurekaã€‚</li></ul><h3 id="5ã€ä»€ä¹ˆæ˜¯-RPCï¼Ÿç›®å‰æœ‰å“ªäº›å¸¸è§çš„-RPC-æ¡†æ¶ï¼Ÿå®ç°-RPC-æ¡†æ¶çš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ">5ã€ä»€ä¹ˆæ˜¯ RPCï¼Ÿç›®å‰æœ‰å“ªäº›å¸¸è§çš„ RPC æ¡†æ¶ï¼Ÿå®ç° RPC æ¡†æ¶çš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>RPC æ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRemote Procedure Callï¼‰çš„ç¼©å†™ï¼Œæ˜¯â¼€ç§é€šè¿‡ç½‘ç»œä»è¿œç¨‹è®¡ç®—æœºç¨‹åºä¸Šè¯·æ±‚æœåŠ¡ï¼Œè€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®ã€‚</p><p>RPC çš„ä¸»è¦åŠŸèƒ½ç›®æ ‡æ˜¯è®©æ„å»ºåˆ†å¸ƒå¼è®¡ç®—/åº”ç”¨æ›´åŠ å®¹æ˜“ï¼Œåœ¨æä¾›å¼ºå¤§çš„è¿œç¨‹è°ƒç”¨èƒ½åŠ›æ—¶ä¸æŸå¤±æœ¬åœ°è°ƒç”¨çš„è¯­ä¹‰ç®€æ´æ€§ã€‚</p><p><strong>å¸¸è§çš„RPCæ¡†æ¶</strong></p><ul><li>gRPCï¼šæ˜¯ç”± Google å¼€å‘çš„â¼€ä¸ªåŸºäº HTTP/2å’ŒProtocol Buffers çš„é«˜æ€§èƒ½ã€è·¨è¯­è¨€çš„ RPC æ¡†æ¶ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ï¼šjavaã€C++ã€Python ç­‰</li><li>Dubboï¼šæ˜¯ç”±é˜¿é‡Œå·´å·´å¼€å‘çš„â¼€ä¸ªåŸºäº java çš„é«˜æ€§èƒ½ã€è½»é‡çº§çš„ RPC æ¡†æ¶ï¼Œæ”¯æŒå¤šç§åè®®å’Œæ³¨å†Œä¸­å¿ƒï¼Œå¦‚ï¼š zookeeperã€Nacos ç­‰ç­‰ã€‚</li><li>Thriftï¼šæ˜¯ç”± FaceBook å¼€å‘çš„â¼€ä¸ªåŸºäºâ¼†è¿›åˆ¶åè®®å’Œå¤šç§ä¼ è¾“å±‚çš„ RPC æ¡†æ¶ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚ï¼š javaã€c++ã€Python ç­‰</li></ul><p>RPCæ¡†æ¶çš„æ ¸å¿ƒåŸç†</p><p>RPC æ¡†æ¶çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡ä»£ç†ã€åºåˆ—åŒ–ã€ç½‘ç»œä¼ è¾“ã€ååºåˆ—åŒ–ã€åå°„ç­‰æŠ€æœ¯ï¼Œå®ç°è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„é€æ˜åŒ–ã€‚æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å®¢æˆ·ç«¯é€šè¿‡ä»£ç†å¯¹è±¡ï¼ˆProxyï¼‰è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œä»£ç†å¯¹è±¡å°†è°ƒç”¨ä¿¡æ¯ï¼ˆæ¯”å¦‚æ–¹æ³•åã€å‚æ•°ç­‰ï¼‰è¿›è¡Œåºåˆ—åŒ– ï¼ˆSerialzationï¼‰ï¼Œè½¬æ¢æˆå­—èŠ‚æµï¼›</li><li>å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œä¼ è¾“ï¼ˆTransportï¼‰å°†åºåˆ—åŒ–åšçš„å­—èŠ‚æµå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°å­—èŠ‚æµåè¿›è¡Œååºåˆ—åŒ– ï¼ˆDeserializationï¼‰ï¼Œè¿˜åŸæˆè°ƒç”¨ä¿¡æ¯ã€‚</li><li>æœåŠ¡ç«¯é€šè¿‡åå°„ï¼ˆReflectionï¼‰æ ¹æ®è°ƒç”¨ä¿¡æ¯æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡ä¿¡æ¯ï¼ˆServiceï¼‰å’Œæ–¹æ³•ï¼ˆMethodï¼‰ï¼Œå¹¶æ‰§è¡Œæ–¹ æ³•ï¼Œå¾—åˆ°è¿”å›ç»“æœã€‚</li><li>æœåŠ¡ç«¯å°†è¿”å›ç»“æœè¿›è¡Œåºåˆ—åŒ–ï¼Œè½¬æ¢æˆå­—èŠ‚æµï¼Œé€šè¿‡ç½‘ç»œä¼ è¾“å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°å­—èŠ‚æµåï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œè¿˜åŸæˆè¿”å›ç»“æœã€‚</li><li>å®¢æˆ·ç«¯é€šè¿‡ä»£ç†å¯¹è±¡è¿”å›ç»“æœç»™è°ƒç”¨è€…ï¼Œå®Œæˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€‚</li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240616152727468.png" alt="image-20240616152727468"></p><h3 id="6ã€ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒï¼Ÿå¦‚ä½•å®ç°â¼€ä¸ªæ³¨å†Œä¸­å¿ƒï¼Ÿ">6ã€ä»€ä¹ˆæ˜¯æ³¨å†Œä¸­å¿ƒï¼Ÿå¦‚ä½•å®ç°â¼€ä¸ªæ³¨å†Œä¸­å¿ƒï¼Ÿ</h3><p>æ³¨å†Œä¸­å¿ƒæ˜¯æœåŠ¡å®ä¾‹ä¿¡æ¯çš„å­˜å‚¨ä»“åº“ï¼Œä¹Ÿæ˜¯æœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…è¿›è¡Œäº¤äº’çš„æ¡¥æ¢ã€‚å®ƒä¸»è¦æä¾›äº†<strong>æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°</strong>è¿™ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ã€‚åœ¨â¼€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸åŒçš„æœåŠ¡ä¼šä»¥å¾®æœåŠ¡çš„å½¢å¼è¿è¡Œåœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œå®ƒä»¬éœ€è¦ç›¸äº’é€šä¿¡ä»¥å®Œæˆä¸šåŠ¡é€»è¾‘ã€‚è€Œæ³¨å†Œä¸­å¿ƒåˆ™å……å½“äº†æœåŠ¡ä¹‹é—´çš„â€œé»„é¡µâ€ï¼Œè®°å½•äº†æ‰€æœ‰å¯ç”¨çš„æœåŠ¡åŠå…¶ç½‘ç»œåœ°å€ï¼Œæ–¹ä¾¿å…¶ä»–æœåŠ¡è¿›è¡ŒæŸ¥æ‰¾å’Œè°ƒç”¨ã€‚</p><p>å½“â¼€ä¸ªæ–°çš„æœåŠ¡å¯åŠ¨æ—¶ï¼Œå®ƒä¼šå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„ç½‘ç»œåœ°å€å’Œâ¼€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼ˆä¾‹å¦‚æœåŠ¡åç§°ã€ç‰ˆæœ¬å·ã€å¥åº·çŠ¶æ€ç­‰ï¼‰ï¼Œæ³¨å†Œä¸­å¿ƒä¼šå°†è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨è‡ªå·±çš„æ•°æ®ä¸­å¿ƒä¸­ã€‚å½“å…¶ä»–æœåŠ¡éœ€è¦è°ƒç”¨è¿™ä¸ªæ–°æœåŠ¡æ—¶ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æ¥è·å–è¯¥æœåŠ¡çš„åœ°å€å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼Œç„¶åä¸è¯¥æœåŠ¡å»ºç«‹ç½‘ç»œè¿æ¥ã€‚ å¸¸è§çš„æ³¨å†Œä¸­å¿ƒåŒ…æ‹¬ ZooKeeperã€Consulã€Eureka ã€Nacos ç­‰ç­‰</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240617202218429.png" alt="image-20240617202218429"></p><p><strong>å¦‚ä½•å®ç°ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒ</strong></p><ol><li>è®¾è®¡æ•°æ®æ¨¡å‹ï¼šè®¾è®¡æ³¨å†Œä¸­å¿ƒçš„æ•°æ®æ¨¡å‹ï¼ŒåŒ…æ‹¬æœåŠ¡çš„å…ƒæ•°æ®ä¿¡æ¯ã€æœåŠ¡å®ä¾‹çš„ç½‘ç»œåœ°å€ç­‰ã€‚</li><li>å®ç°æœåŠ¡æ³¨å†Œï¼šå½“æœåŠ¡å¯åŠ¨æ—¶ï¼Œå®ƒéœ€è¦å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„å…ƒæ•°æ®ä¿¡æ¯å’Œç½‘ç»œåœ°å€ã€‚å¯ä»¥é€šè¿‡ REST APIã€ RPC ç­‰æ–¹å¼å®ç°æœåŠ¡çš„æ³¨å†Œã€‚</li><li>å®ç°æœåŠ¡å‘ç°ï¼šå½“â¼€ä¸ªæœåŠ¡éœ€è¦è°ƒç”¨å…¶ä»–æœåŠ¡æ—¶ï¼Œå®ƒéœ€è¦å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢ç›®æ ‡æœåŠ¡çš„ç½‘ç»œåœ°å€ã€‚å¯ä»¥é€šè¿‡REST APIã€RPC ç­‰æ–¹å¼å®ç°æœåŠ¡çš„å‘ç°ã€‚</li><li>å®ç°å¥åº·æ£€æŸ¥ï¼šä¸ºäº†ä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ï¼Œæ³¨å†Œä¸­å¿ƒéœ€è¦å®šæœŸæ£€æŸ¥æœåŠ¡å®ä¾‹çš„å¥åº·çŠ¶å†µï¼Œå¹¶å°†ä¸å¥åº·çš„å®ä¾‹ä»æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤ã€‚</li><li>å®ç°é«˜å¯ç”¨ï¼šæ³¨å†Œä¸­å¿ƒæ˜¯â¼€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œéœ€è¦ä¿è¯é«˜å¯ç”¨æ€§ã€‚å¯ä»¥é‡‡ç”¨ä¸»ä»å¤åˆ¶ã€é›†ç¾¤ç­‰æ–¹å¼å® ç°æ³¨å†Œä¸­å¿ƒçš„é«˜å¯ç”¨æ€§ã€‚</li><li>å®ç°å®‰å…¨æœºåˆ¶ï¼šæ³¨å†Œä¸­å¿ƒæ¶‰åŠåˆ°æœåŠ¡çš„å…ƒæ•°æ®ä¿¡æ¯å’Œç½‘ç»œåœ°å€ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦é‡‡å–åˆé€‚çš„å®‰å…¨æªæ–½ã€‚</li></ol><h3 id="7ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çš„-BASE-ç†è®ºï¼Œå®ƒä¸-CAP-ç†è®ºæœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ">7ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼çš„ BASE ç†è®ºï¼Œå®ƒä¸ CAP ç†è®ºæœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ</h3><p>BASE ç†è®ºæ˜¯å¯¹ CAP ç†è®ºçš„å»¶ä¼¸ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å³ä½¿æ— æ³•åšåˆ°å¼ºâ¼€è‡´æ€§ï¼ˆStrong Consistencyï¼ŒCAP çš„â¼€è‡´æ€§å°±æ˜¯å¼º â¼€è‡´æ€§ï¼‰ï¼Œä½†åº”ç”¨å¯ä»¥é‡‡ç”¨é€‚åˆçš„æ–¹å¼è¾¾åˆ°æœ€ç»ˆâ¼€è‡´æ€§ï¼ˆEventual Consitencyï¼‰ã€‚</p><ul><li>Basically Availableï¼ˆåŸºæœ¬å¯ç”¨ï¼‰ï¼šåˆ†å¸ƒå¼åŒå†å‡ºç°ä¸å¯é¢„çŸ¥æ•…éšœçš„æ—¶å€™ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ã€‚</li><li>Soft stateï¼ˆè½¯çŠ¶æ€ï¼‰ï¼šè½¯çŠ¶æ€ä¹Ÿç§°å¼±çŠ¶æ€ï¼Œå’Œç¡¬çŠ¶æ€ç›¸å¯¹ï¼Œæ˜¯æŒ‡å…è®¸ç³»ç»Ÿä¸­çš„æ•°æ®å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œå¹¶è®¤ä¸ºè¯¥ä¸­é—´çŠ¶æ€çš„å­˜åœ¨ä¸ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“å¯ç”¨æ€§ï¼Œå³å…è®¸ç³»ç»Ÿåœ¨ä¸åŒèŠ‚ç‚¹çš„æ•°æ®å‰¯æœ¬ä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥çš„è¿‡ç¨‹å­˜åœ¨å»¶æ—¶ã€‚</li><li>Eventually consistentï¼ˆæœ€ç»ˆâ¼€è‡´æ€§ï¼‰ï¼šæœ€ç»ˆâ¼€è‡´æ€§å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®å‰¯æœ¬ï¼Œåœ¨ç»è¿‡â¼€æ®µæ—¶é—´ä¸Šçš„åŒæ­¥åï¼Œæœ€ç»ˆèƒ½å¤Ÿè¾¾åˆ°â¼€ä¸ªâ¼€è‡´çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæœ€ç»ˆâ¼€è‡´æ€§çš„æœ¬è´¨æ˜¯éœ€è¦ç³»ç»Ÿä¿è¯æœ€ç»ˆæ•°æ®èƒ½å¤Ÿè¾¾åˆ°â¼€è‡´ï¼Œè€Œä¸éœ€è¦å®æ—¶ä¿è¯ç³»ç»Ÿæ•°æ®çš„å¼ºâ¼€è‡´æ€§ã€‚</li></ul><p><strong>CAP ä¸ BASE å…³ç³»</strong></p><p>BASEæ˜¯å¯¹ CAP ä¸­â¼€è‡´æ€§å’Œå¯ç”¨æ€§æƒè¡¡çš„ç»“æœï¼Œå…¶æ¥æºäºå¯¹å¤§è§„æ¨¡äº’è”ç½‘ç³»ç»Ÿåˆ†å¸ƒå¼å®è·µçš„ç»“è®ºï¼Œæ˜¯åŸºäºCAPå®šç†é€æ­¥æ¼”åŒ–è€Œæ¥çš„ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯å³ä½¿æ— æ³•åšåˆ°å¼ºâ¼€è‡´æ€§ï¼ˆStrong consistencyï¼‰ï¼Œæ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯å¯¹ CAP ä¸­ APæ–¹æ¡ˆçš„â¼€ä¸ªè¡¥å……ã€‚å…¶åŸºæœ¬æ€è·¯å°±æ˜¯ï¼šé€šè¿‡ä¸šåŠ¡ï¼Œç‰ºç‰²å¼ºâ¼€è‡´æ€§è€Œè·å¾—å¯ç”¨æ€§ï¼Œå¹¶å…è®¸æ•°æ®åœ¨â¼€æ®µæ—¶é—´å†…æ˜¯ä¸â¼€è‡´çš„ï¼Œä½†æ˜¯æœ€ç»ˆè¾¾åˆ°â¼€è‡´æ€§çŠ¶æ€ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240617203016971.png" alt="image-20240617203016971"></p><h2 id="æ¶ˆæ¯é˜Ÿåˆ—">æ¶ˆæ¯é˜Ÿåˆ—</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ">1ã€ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</h3><p>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯â¼€ç§ç”¨äºå¼‚æ­¥é€šä¿¡çš„æœºåˆ¶ï¼Œç”¨äºåœ¨ä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—é€šå¸¸ç”±æ¶ˆæ¯<strong>ç”Ÿäº§è€…ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œæ¶ˆæ¯æ¶ˆè´¹è€…</strong>ä¸‰éƒ¨åˆ†ç»„æˆã€‚</p><p>æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè€Œæ¶ˆæ¯æ¶ˆè´¹è€…åˆ™ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—è´Ÿè´£å­˜å‚¨å’Œç®¡ç†æ¶ˆæ¯ï¼Œç¡®ä¿æ¶ˆæ¯ä¼ é€’çš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—è¿˜ä¼šæä¾›â¼€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚æ¶ˆæ¯è¿‡æ»¤ã€æ¶ˆæ¯è·¯ç”±ã€æ¶ˆæ¯æŒä¹…åŒ–ç­‰ã€‚</p><p><strong>æ¶ˆæ¯é˜Ÿåˆ—çš„ç‰¹ç‚¹</strong>ï¼š</p><ul><li><strong>å¼‚æ­¥é€šä¿¡</strong>ï¼šæ¶ˆæ¯ç”Ÿäº§è€…å’Œæ¶ˆæ¯æ¶ˆè´¹è€…ä¹‹é—´é‡‡ç”¨å¼‚æ­¥é€šä¿¡æ¨¡å¼ï¼Œå‘é€æ–¹æ— éœ€ç­‰å¾…æ¥æ”¶æ–¹çš„å“åº”å³å¯ç»§ç»­æ‰§è¡Œã€‚</li><li><strong>è§£è€¦åˆ</strong>ï¼šæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å°†æ¶ˆæ¯ç”Ÿäº§è€…å’Œæ¶ˆæ¯æ¶ˆè´¹è€…è§£è€¦åˆï¼Œä½¿å¾—å®ƒä»¬ä¹‹é—´çš„å…³ç³»æ›´åŠ çµæ´»ã€‚</li><li>**å¯é æ€§ï¼š**æ¶ˆæ¯é˜Ÿåˆ—é€šå¸¸ä¼šæä¾›â¼€äº›ä¿è¯æ¶ˆæ¯ä¼ é€’å¯é æ€§çš„æœºåˆ¶ï¼Œå¦‚æ¶ˆæ¯æŒä¹…åŒ–ã€é‡è¯•æœºåˆ¶ç­‰ã€‚</li><li><strong>ç¼“å†²</strong>ï¼šæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ç¼“å†²æ¥è‡ªå¤šä¸ªæ¶ˆæ¯ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œä½¿å¾—æ¶ˆæ¯æ¶ˆè´¹è€…å¯ä»¥æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥è¿›è¡Œæ¶ˆè´¹ï¼Œä»è€Œæœ‰æ•ˆåœ°å¹³è¡¡ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„å¤„ç†é€Ÿåº¦ã€‚</li></ul><p>æ¶ˆæ¯é˜Ÿåˆ—çš„åº”ç”¨ï¼š</p><ul><li><strong>å¼‚æ­¥ä»»åŠ¡å¤„ç†</strong>ï¼šé€šè¿‡å°†ä»»åŠ¡å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå¼‚æ­¥å¤„ç†ä»»åŠ¡ï¼Œæé«˜ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å’Œååé‡ã€‚</li><li>**è§£è€¦åˆç³»ç»Ÿï¼š**å°†ä¸åŒçš„ä¸šåŠ¡é€»è¾‘æ‹†åˆ†æˆä¸åŒçš„æœåŠ¡ï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å®ç°æœåŠ¡ä¹‹é—´çš„é€šä¿¡ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</li><li>**æµé‡å‰Šå³°ï¼š**å°†æµé‡é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—åˆ†æ•£åˆ°ä¸åŒçš„æœåŠ¡ä¸­ï¼Œé¿å…å•ä¸ªæœåŠ¡è¢«é«˜å¹¶å‘æµé‡æ‰“å®ã€‚</li><li>**æ—¥å¿—æ”¶é›†ï¼š**é€šè¿‡å°†æ—¥å¿—æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå°†æ—¥å¿—æ”¶é›†å’Œåˆ†æä¸ä¸šåŠ¡é€»è¾‘è§£è€¦åˆï¼Œæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>**åº”ç”¨è§£è€¦ï¼š**å°†ä¸åŒçš„åº”ç”¨ç¨‹åºé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé›†æˆï¼Œå®ç°åº”ç”¨ä¹‹é—´çš„è§£è€¦åˆå’Œæ•°æ®äº¤æ¢ã€‚</li></ul><h3 id="2ã€æœ‰å“ªäº›ä¸»æµçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒä»¬åˆ†åˆ«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ã€å„è‡ªçš„é€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ">2ã€æœ‰å“ªäº›ä¸»æµçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒä»¬åˆ†åˆ«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ã€å„è‡ªçš„é€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240618115738636.png" alt="image-20240618115738636"></p><h3 id="3ã€æœ‰å“ªäº›å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹ï¼Ÿåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ">3ã€æœ‰å“ªäº›å¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹ï¼Ÿåˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ</h3><ul><li><strong>ç‚¹å¯¹ç‚¹æ¨¡å‹ï¼ˆPoint-to-Point Modelï¼‰ï¼š<strong>è¿™ç§æ¨¡å‹ä¸­ï¼Œ<strong>æ¶ˆæ¯ç”Ÿäº§è€…</strong>å°†æ¶ˆæ¯å‘é€åˆ°</strong>â¼€ä¸ªé˜Ÿåˆ—</strong>ä¸­ï¼Œ<strong>æ¶ˆæ¯æ¶ˆè´¹è€…</strong>ä»è¯¥é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚â¼€<strong>ä¸ªæ¶ˆæ¯åªä¼šè¢«â¼€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶</strong>ï¼Œæ¶ˆè´¹è€…åœ¨å¤„ç†å®Œæ¶ˆæ¯ä¹‹åä¼šä»é˜Ÿåˆ—ä¸­åˆ é™¤å®ƒã€‚è¿™ç§æ¨¡å‹é€‚ç”¨äºéœ€è¦ä¿è¯<strong>æ¶ˆæ¯åªè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†çš„åœºæ™¯</strong>ï¼Œä¾‹å¦‚<strong>è®¢å•ç³»ç»Ÿã€æ—¥å¿—å¤„ç†</strong>ç­‰ã€‚</li><li><strong>å‘å¸ƒ-è®¢é˜…æ¨¡å‹ï¼ˆPublish-Subscribe Model</strong>ï¼‰ï¼šè¿™ç§æ¨¡å‹ä¸­ï¼Œ<strong>æ¶ˆæ¯ç”Ÿäº§è€…</strong>å°†æ¶ˆæ¯å‘é€åˆ°<strong>â¼€ä¸ªä¸»é¢˜ï¼ˆTopic</strong>ï¼‰ ä¸­ï¼Œå¤š<strong>ä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…</strong>å¯ä»¥<strong>è®¢é˜…</strong>è¯¥ä¸»é¢˜å¹¶æ¥æ”¶åˆ°æ‰€æœ‰çš„æ¶ˆæ¯ã€‚<strong>æ¯ä¸ªæ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶</strong>ï¼Œæ¶ˆè´¹è€…åœ¨å¤„ç†å®Œ æ¶ˆæ¯ä¹‹åä¸ä¼šä»ä¸»é¢˜ä¸­åˆ é™¤å®ƒã€‚è¿™ç§æ¨¡å‹é€‚ç”¨äºéœ€è¦å°†<strong>æ¶ˆæ¯å¹¿æ’­ç»™å¤šä¸ªæ¶ˆè´¹è€…çš„åœºæ™¯</strong>ï¼Œä¾‹å¦‚<strong>æ–°é—»è®¢é˜…ã€å®æ—¶æ•°æ®åˆ†æ</strong>ç­‰ã€‚</li><li><strong>è¯·æ±‚-åº”ç­”æ¨¡å‹ï¼ˆRequest-Response Modelï¼‰</strong>ï¼šè¿™ç§æ¨¡å‹ä¸­ï¼Œ<strong>æ¶ˆæ¯ç”Ÿäº§è€…</strong>å‘é€â¼€ä¸ªè¯·æ±‚æ¶ˆæ¯åˆ°â¼€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œ <strong>æ¶ˆæ¯æ¶ˆè´¹è€…</strong>ä»è¯¥é˜Ÿåˆ—ä¸­æ¥æ”¶è¯·æ±‚å¹¶è¿”å›â¼€ä¸ªå“åº”æ¶ˆæ¯ã€‚<strong>â¼€ä¸ªè¯·æ±‚åªä¼šè¢«â¼€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶å¹¶å¤„ç†</strong>ï¼Œå¤„ç†å®Œæˆåè¿” å›å“åº”æ¶ˆæ¯ç»™æ¶ˆæ¯ç”Ÿäº§è€…ã€‚è¿™ç§æ¨¡å‹é€‚ç”¨äºéœ€è¦<strong>è¯·æ±‚-å“åº”æ¨¡å¼</strong>çš„åœºæ™¯ï¼Œä¾‹å¦‚<strong>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€å¾®æœåŠ¡é€šä¿¡</strong>ç­‰ã€‚</li><li><strong>æ¨æ‹‰æ¨¡å‹ï¼ˆPush-Pull Modelï¼‰</strong>ï¼šè¿™ç§æ¨¡å‹ä¸­ï¼Œ<strong>æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯æ¨é€åˆ°â¼€ä¸ªé˜Ÿåˆ—ä¸­</strong>ï¼Œ<strong>æ¶ˆæ¯æ¶ˆè´¹è€…</strong>ä»è¯¥é˜Ÿåˆ—ä¸­<strong>æ‹‰å–æ¶ˆæ¯</strong>ã€‚æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œæ¶ˆè´¹è€…æŒ‰éœ€ä»é˜Ÿåˆ—ä¸­æ‹‰å–æ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚è¿™ç§æ¨¡å‹é€‚ç”¨äºéœ€è¦<strong>çµæ´»æ§åˆ¶æ¶ˆæ¯æ¶ˆè´¹é€Ÿåº¦çš„åœºæ™¯</strong>ï¼Œä¾‹å¦‚<strong>æ•°æ®é‡‡é›†ã€è§†é¢‘æµä¼ è¾“</strong>ç­‰ã€‚</li></ul><p>å¯ä»¥å°†ç‚¹å¯¹ç‚¹æ¨¡å‹å’Œè¯·æ±‚-åº”ç­”æ¨¡å‹ç»“åˆä½¿ç”¨ï¼Œå®ç°å¼‚æ­¥çš„ RPC è°ƒç”¨ã€‚å¦å¤–ï¼Œåœ¨é€‰æ‹©æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘ æ¶ˆæ¯ä¼ è¾“çš„å¯é æ€§ã€é¡ºåºæ€§ã€å»¶è¿Ÿç­‰å› ç´ ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</h2><h3 id="1ã€è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦å­¦ä¹ å’Œä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼Ÿ">1ã€è®¾è®¡æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦å­¦ä¹ å’Œä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼Ÿ</h3><p>è®¾è®¡æ¨¡å¼ï¼šæ˜¯â¼€å¥—ç»è¿‡åå¤ä½¿ç”¨çš„ä»£ç è®¾è®¡ç»éªŒï¼Œç›®çš„æ˜¯ä¸ºäº†é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚</p><p>é¡¹ç›®ä¸­åˆç†åœ°è¿ç”¨è®¾è®¡æ¨¡å¼å¯ä»¥å®Œç¾è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œæ¯ç§æ¨¡å¼åœ¨ç°å®ä¸­éƒ½æœ‰ç›¸åº”çš„åŸç†æ¥ä¸ä¹‹å¯¹åº”ï¼Œæ¯ç§æ¨¡å¼æè¿° äº†â¼€ä¸ªåœ¨æˆ‘ä»¬å‘¨å›´ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œè¿™ä¹Ÿæ˜¯å®ƒèƒ½è¢«å¹¿æ³›åº”ç”¨çš„åŸå› </p><p>è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼š</p><ul><li><strong>åˆ›å»ºå‹æ¨¡å¼</strong>ï¼šå…±5ç§ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€‚</li><li><strong>ç»“æ„å‹æ¨¡å¼</strong>ï¼šå…±7ç§ï¼šé€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€‚</li><li>**è¡Œä¸ºå‹æ¨¡å¼ï¼š**å…±11ç§ï¼šç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€‚</li></ul><h3 id="2ã€ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿä½¿ç”¨å•ä¾‹æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿæœ‰å“ªäº›å¸¸ç”¨çš„å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼ï¼Ÿå„è‡ªçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ">2ã€ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿä½¿ç”¨å•ä¾‹æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿæœ‰å“ªäº›å¸¸ç”¨çš„å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼ï¼Ÿå„è‡ªçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å•ä¾‹æ¨¡å¼æ˜¯â¼€ç§<strong>åˆ›å»ºå‹è®¾è®¡æ¨¡å¼</strong>ï¼Œå®ƒç¡®ä¿<strong>â¼€ä¸ªç±»åªæœ‰â¼€ä¸ªå®ä¾‹</strong>ï¼Œå¹¶æä¾›â¼€ä¸ªå…¨å±€è®¿é—®ç‚¹æ¥è®¿é—®è¯¥å®ä¾‹ã€‚å•ä¾‹æ¨¡å¼çš„ç›®çš„æ˜¯<strong>ç¡®ä¿ç±»çš„â¼€ä¸ªå”¯â¼€å®ä¾‹</strong>ï¼Œå› æ­¤å…¶ä»–ç±»å¯ä»¥è½»æ¾åœ°ä»â¼€ä¸ªå¯çŸ¥çš„åœ°æ–¹è®¿é—®å®ƒã€‚</p><p>å•ä¾‹æ¨¡å¼æœ‰ä»¥ä¸‹å¥½å¤„</p><ul><li>**èŠ‚çœç³»ç»Ÿèµ„æºï¼š**åœ¨ç³»ç»Ÿä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªå®ä¾‹ä¼šé€ æˆèµ„æºæµªè´¹ï¼Œè€Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥å‡å°‘è¿™ç§æµªè´¹ã€‚</li><li><strong>ç®€åŒ–äº†å¯¹è±¡è®¿é—®</strong>ï¼šå•ä¾‹æ¨¡å¼æä¾›äº†â¼€ä¸ª<strong>å…¨å±€çš„è®¿é—®ç‚¹</strong>ï¼Œå› æ­¤å¯ä»¥ç®€åŒ–è®¿é—®è¿‡ç¨‹ã€‚</li></ul><p>å¸¸è§çš„å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼</p><ul><li><strong>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ï¼š<strong>åœ¨ç±»</strong>åŠ è½½</strong>æ—¶åˆ›å»ºå•ä¾‹å¯¹è±¡ã€‚ç¼ºç‚¹æ˜¯<strong>ä¸æ”¯æŒå»¶è¿ŸåŠ è½½</strong>ã€‚</li><li><strong>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</strong>ï¼šåœ¨<strong>ç¬¬â¼€æ¬¡ä½¿ç”¨</strong>æ—¶æ‰åˆ›å»ºå•ä¾‹å¯¹è±¡ã€‚ç¼ºç‚¹æ˜¯<strong>éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ã€‚</li><li><strong>åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼ï¼š<strong>åœ¨</strong>ç¬¬â¼€æ¬¡ä½¿ç”¨æ—¶</strong>åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<strong>åŒé‡æ£€æŸ¥é”</strong>å®šæ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</li><li><strong>æšä¸¾å•ä¾‹æ¨¡å¼ï¼š<strong>åœ¨æšä¸¾ç±»å‹ä¸­åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œå¯ä»¥</strong>é˜²æ­¢åå°„å’Œåºåˆ—åŒ–æ”»å‡»</strong>ã€‚</li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240619193225873.png" alt="image-20240619193225873"></p><p>åº”ç”¨åœºæ™¯</p><ul><li><strong>æ•°æ®åº“è¿æ¥æ± ï¼š<strong>é€šè¿‡</strong>å•ä¾‹æ¨¡å¼</strong>ï¼Œå¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸­åªæœ‰â¼€ä¸ªæ•°æ®åº“è¿æ¥æ± ã€‚</li><li>**æ—¥å¿—è®°å½•å™¨ï¼š**å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼è®°å½•ç³»ç»Ÿæ—¥å¿—ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸­åªæœ‰â¼€ä¸ªæ—¥å¿—è®°å½•å™¨ã€‚</li><li><strong>é…ç½®æ–‡ä»¶ç®¡ç†å™¨ï¼š<strong>å¯ä»¥ä½¿ç”¨</strong>å•ä¾‹æ¨¡å¼</strong>æ¥<strong>ç®¡ç†åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶</strong>ï¼Œè¿™æ ·å¯ä»¥é¿å…é‡å¤è¯»å–é…ç½®æ–‡ä»¶çš„å¼€é”€ã€‚</li><li><strong>çº¿ç¨‹æ± ï¼š<strong>å¯ä»¥ä½¿ç”¨</strong>å•ä¾‹æ¨¡å¼</strong>æ¥ç¡®ä¿ç³»ç»Ÿä¸­åªæœ‰â¼€ä¸ªçº¿ç¨‹æ± ã€‚</li></ul><h3 id="4ã€ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼ï¼Ÿä½¿ç”¨å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå·¥å‚æ¨¡å¼æœ‰å“ªäº›åˆ†ç±»ï¼Ÿå„è‡ªçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ">4ã€ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼ï¼Ÿä½¿ç”¨å·¥å‚æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå·¥å‚æ¨¡å¼æœ‰å“ªäº›åˆ†ç±»ï¼Ÿå„è‡ªçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å·¥å‚æ¨¡å¼</p><ul><li>æŠŠå¯¹è±¡çš„æ„é€ äº¤ç»™â¼€ä¸ªç±»,è¿™æ ·åœ¨å¯¹è±¡æ„é€ è¿‡ç¨‹ä¸­,è°ƒç”¨è€…ä¸éœ€è¦çŸ¥é“å¯¹è±¡çš„äº§ç”Ÿè¿‡ç¨‹ã€‚é™ä½äº†ä»£ç çš„è€¦åˆåº¦ï¼ŒåŒæ—¶ä½“ç°äº†é¢å‘å¯¹è±¡çš„å°è£…çš„ç‰¹å¾ã€‚</li><li>å¥½å¤„<ul><li>æ¾è€¦åˆ</li><li>å°è£…</li><li>å¯æ‹“å±•</li><li>å¤ç”¨</li></ul></li></ul><p>åˆ†ç±»</p><ul><li><p><strong>ç®€å•å·¥å‚æ¨¡å¼ ï¼ˆâ¼€ä¸ªå·¥å‚ç”Ÿäº§æ‰€æœ‰çš„å¯¹è±¡ ï¼‰</strong></p><ul><li>å¦‚æœå®ƒè´Ÿè´£çš„å¯¹è±¡å¤ªå¤šï¼Œç®€å•å·¥å‚å®¹æ˜“åºå¤§ï¼Œå˜æˆè¶…çº§ç±»ã€‚</li><li>ç®€å•â¼¯â¼šçš„æ‹“å±•æ˜¯ç«–å‘æ‹“å±•ï¼ˆæ‹“å±•éœ€è¦è®¿é—®â¼¯â¼šå†…éƒ¨ï¼ŒèŒè´£ä¸å¤Ÿå•â¼€ï¼‰</li><li>å› æ­¤ï¼Œä»–é€‚åˆåœ¨â€™ç®€å•åœºæ™¯â€™ - å¯¹è±¡å°‘ä¸”å›ºå®š</li></ul></li><li><p><strong>å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆä¸€ä¸ªå·¥å‚ä¸€ä¸ªå¯¹è±¡ï¼‰</strong></p><ul><li>å·¥å‚æ–¹æ³•æ˜¯æ¨ªå‘æ‹“å±•ï¼Œç”±äºå·¥å‚å¯¹è±¡1å¯¹1ï¼Œè€¦åˆåº¦æ²¡æœ‰ä»»ä½•å‡å°‘ï¼Œè¦ç”Ÿäº§ç±»å°±è¦çŸ¥é“é‚£ä¸ªå¯¹åº”çš„å·¥å‚ã€‚</li><li>å½“éœ€è¦ç”Ÿäº§æ–°çš„äº§å“æ—¶ï¼Œâ½†éœ€æ›´æ”¹æ—¢æœ‰çš„å·¥å‚ï¼Œåªéœ€è¦æ·»åŠ æ–°çš„å·¥å‚å³å¯ã€‚ä¿æŒäº†é¢å‘å¯¹è±¡çš„å¯æ‰©å±•æ€§(çºµå‘ï¼Œæ¨ªå‘éƒ½å¾ˆä¸é”™)ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li><li>å› æ­¤ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼é€‚ç”¨äºå¯¹è±¡å¤šè€Œä¸”å¯èƒ½å¢åŠ çš„åœºæ™¯ã€‚</li></ul></li><li><p><strong>æŠ½è±¡å·¥å‚æ¨¡å¼ ï¼ˆ æŠ½è±¡æ¥å£å·¥å‚å®ç° ï¼‰</strong></p><ul><li>æŠ½è±¡å·¥å‚æ˜¯å®šä¹‰äº†â¼€ä¸ªæ¥å£ï¼Œç„¶åç”±å…·ä½“å·¥å‚å»å®ç°æŠ½è±¡æ–¹æ³•ï¼Œçªå‡ºç‰¹ç‚¹å°±æ˜¯è¿ç”¨äº†å¤šæ€ï¼Œè€¦åˆå¤Ÿæ¾ã€‚</li><li>ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨æ¥å£ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæ— è®ºæ˜¯æ¨ªå‘æ‹“å±•æ€§è¿˜æ˜¯æ¾è€¦åˆéƒ½å¾ˆå¥½ï¼Œä½†æ˜¯â¼€æ—¦æ¥å£æœ‰æ–°çš„åŠŸèƒ½å¢åŠ ï¼Œ æ‰€æœ‰çš„å·¥å‚å®ç°éƒ½éœ€è¦çºµå‘æ‹“å±•ã€‚å³æ¨ªå‘æ‹“å±•èƒ½â¼’å¼ºï¼Œä½†æ˜¯çºµå‘æ‹“å±•èƒ½â¼’=0</li><li>å› æ­¤ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼é€‚åˆäº§å“æ—ï¼ˆå³æœ‰ç›¸ä¼¼å±æ€§ï¼‰çš„ç”Ÿäº§</li></ul></li></ul><h2 id="å¹¶å‘ç¼–ç¨‹">å¹¶å‘ç¼–ç¨‹</h2><h3 id="1ã€å¹¶å‘å’Œå¹¶è¡Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸåŒæ­¥å’Œå¼‚æ­¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ">1ã€å¹¶å‘å’Œå¹¶è¡Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸåŒæ­¥å’Œå¼‚æ­¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620104952051.png" alt="image-20240620104952051"></p><h3 id="2ã€ä»€ä¹ˆæ˜¯-BIOã€NIOã€AIOï¼Ÿ">2ã€ä»€ä¹ˆæ˜¯ BIOã€NIOã€AIOï¼Ÿ</h3><p>BIOã€NIOã€AIO éƒ½æ˜¯ Java ä¸­ç½‘ç»œç¼–ç¨‹çš„ I/O æ¨¡å‹ã€‚</p><ul><li>BIOï¼ˆBlocking IO ï¼‰æ˜¯JDK1.4ä¹‹å‰çš„ä¼ ç»ŸIOæ¨¡å‹ï¼Œç‰¹ç‚¹å°±æ˜¯<strong>åŒæ­¥é˜»å¡ç­‰å¾…æ•°æ®</strong>ï¼Œç›´åˆ°æ•°æ®è¯»å–å®Œæ¯•æ‰ä¼šè¿”å›ç»“æœï¼Œ çº¿ç¨‹ä¼šâ¼€ç›´é˜»å¡åœ¨ read/write æ–¹æ³•ä¸Šï¼Œä¸èƒ½å¤„ç†å…¶ä»–çš„ IO è¯·æ±‚ï¼Œå®ƒçš„å¹¶<strong>å‘æ€§èƒ½æ¯”è¾ƒå·®</strong>ã€‚</li><li>NIOï¼ˆNon-Blocking IOï¼‰æ˜¯Java 1.4 ä¹‹åæ–°å¢çš„ IO æ¨¡å‹ï¼Œå®ƒâ½€æŒ<strong>åŒæ­¥éé˜»å¡å¼çš„ IO æ“ä½œ</strong>ã€‚NIO é‡‡ç”¨äº†å¤š<strong>è·¯å¤ç”¨å™¨</strong>æ¥å¤„ç† IO è¯·æ±‚ï¼Œé€šè¿‡â¼€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ª IO è¯·æ±‚ï¼Œå®ç°äº†é«˜å¹¶å‘å¤„ç†ã€‚NIO ä¸»è¦æœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šSelectorã€ Channelã€Bufferã€‚Selector è´Ÿè´£ç›‘å¬å¤šä¸ª Channel ä¸Šçš„äº‹ä»¶ï¼ŒChannel å¯ä»¥ç†è§£ä¸ºå¯¹åŸå§‹ IO çš„å°è£…ï¼ŒBuffer åˆ™ æ˜¯å¯¹æ•°æ®çš„å°è£…ã€‚</li><li>AIOï¼ˆAsynchronous IOï¼‰æ˜¯Java 1.7 ä¹‹åæ–°å¢çš„ IO æ¨¡å‹ï¼Œå®ƒâ½€æŒ<strong>å¼‚æ­¥éé˜»å¡ IO æ“ä½œ</strong>ã€‚ä¸ NIO ä¸åŒçš„æ˜¯ï¼ŒAIO åœ¨ è¿›è¡Œè¯»å†™æ“ä½œæ—¶ä¸éœ€è¦åƒ NIO â¼€æ ·â¼€ç›´è½®è¯¢ï¼Œè€Œæ˜¯é€šè¿‡å›è°ƒå‡½æ•°çš„æ–¹å¼åœ¨æ•°æ®å‡†å¤‡å¥½åé€šçŸ¥åº”ç”¨ç¨‹åºè¿›è¡Œæ•°æ®çš„è¯»å–ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œæé«˜ååé‡ã€‚ä½†æ˜¯ AIO åœ¨å¤„ç†<strong>å°æ–‡ä»¶å’Œå°æ•°æ®é‡æ—¶çš„æ€§èƒ½å¹¶ä¸å¦‚ NIO</strong>ã€‚</li></ul><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620105909560.png" alt="image-20240620105909560"></p><h3 id="3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆï¼Œçº¿ç¨‹æœ‰å‡ ç§çŠ¶æ€ï¼Œä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿ">3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆï¼Œçº¿ç¨‹æœ‰å‡ ç§çŠ¶æ€ï¼Œä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿ</h3><p>ä»ä¼ ç»Ÿæ“ä½œç³»ç»Ÿå±‚é¢ï¼Œçº¿ç¨‹æœ‰äº”å¤§åŸºæœ¬çŠ¶æ€ï¼ŒåŒ…æ‹¬ï¼š<strong>åˆ›å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡å’Œç»ˆæ­¢çŠ¶æ€</strong>ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620110002639.png" alt="image-20240620110002639"></p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620110013914.png" alt="image-20240620110013914"></p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620110025500.png" alt="image-20240620110025500"></p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240620110034664.png" alt="image-20240620110034664"></p><p><strong>ä¸Šä¸‹æ–‡åˆ‡æ¢:</strong></p><p>æŒ‡å°†å½“å‰çº¿ç¨‹çš„çŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œå¹¶å°† CPU èµ„æºåˆ‡æ¢åˆ°å¦â¼€ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œçš„è¿‡ç¨‹ï¼Œé€šå¸¸ç”±æ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†å’Œæ§åˆ¶çš„ã€‚éœ€è¦æ³¨æ„ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢éœ€è¦èŠ±è´¹â¼€å®šçš„æ—¶é—´å’Œç³»ç»Ÿèµ„æºï¼Œçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°è¦å°½é‡å‡å°‘ï¼Œä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><h3 id="4ã€synchronized-å…³é”®å­—æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ">4ã€synchronized å…³é”®å­—æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><ul><li>synchronized æ˜¯ Java ä¸­çš„â¼€ä¸ªå…³é”®å­—ï¼Œç”¨äºå®<strong>ç°çº¿ç¨‹åŒæ­¥</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œsynchronized ç”¨äº<strong>ä¿®é¥°æ–¹æ³•æˆ–ä»£ç å—</strong>ï¼Œ ä½¿å¾—<strong>åŒâ¼€æ—¶åˆ»åªèƒ½æœ‰â¼€ä¸ªçº¿ç¨‹è®¿é—®è¢«ä¿®é¥°çš„ä»£ç </strong>ï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…å½“å‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰èƒ½è®¿é—®ã€‚</li><li>synchronized ä¸»è¦ç”¨äºè§£å†³<strong>å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«èµ„æºæ—¶</strong>å‡ºç°çš„<strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ã€‚</li><li>å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®â¼€ä¸ªå…±äº«èµ„æºï¼Œå°±ä¼šå‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹è¿™ä¸ªèµ„æºçš„æƒ…å†µï¼Œä»è€Œå¯¼è‡´æ•°æ®ä¸â¼€è‡´ç­‰é—®é¢˜ã€‚ è€Œä½¿ç”¨synchronized å¯ä»¥ä¿è¯<strong>åŒâ¼€æ—¶åˆ»åªæœ‰â¼€ä¸ªçº¿ç¨‹è®¿é—®è¯¥èµ„æº</strong>ï¼Œä»è€Œé¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li><li>synchronized çš„ä½œç”¨ä¸ä»…é™äºçº¿ç¨‹åŒæ­¥ï¼Œå®ƒè¿˜å¯ä»¥ä¿è¯<strong>å¯è§æ€§å’Œæœ‰åºæ€§</strong>ï¼Œå³ä¿è¯åœ¨åŒâ¼€ä¸ªé”ä¸Šï¼Œâ¼€ä¸ªçº¿ç¨‹<strong>ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ä¹‹åï¼Œå¦â¼€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„å€¼ï¼Œå¹¶ä¸”åœ¨å¤šä¸ªçº¿ç¨‹æ‰§è¡Œé¡ºåºä¸Šä¿è¯äº†â¼€è‡´æ€§ã€‚</strong></li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ synchronized ä¼šå¸¦æ¥â¼€å®šçš„<strong>æ€§èƒ½æŸå¤±</strong>ï¼Œå› ä¸º<strong>æ¯æ¬¡è¿›â¼ŠåŒæ­¥å—æ—¶éƒ½éœ€è¦è·å¾—é”</strong>ï¼Œè¿™ä¼šå¢åŠ çº¿ç¨‹çš„ç­‰å¾…æ—¶é—´å’Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚åŒæ—¶ï¼Œå¦‚æœåŒæ­¥å—çš„<strong>ä»£ç æ‰§è¡Œæ—¶é—´å¾ˆçŸ­</strong>ï¼Œä¹Ÿä¼šå¢åŠ ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚å› æ­¤ï¼Œéœ€ è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨ synchronizedã€‚</li></ul><h2 id="ç³»ç»Ÿè®¾è®¡">ç³»ç»Ÿè®¾è®¡</h2><h3 id="1ã€å¦‚ä½•è®¾è®¡â¼€ä¸ªç‚¹èµç³»ç»Ÿï¼Ÿ">1ã€å¦‚ä½•è®¾è®¡â¼€ä¸ªç‚¹èµç³»ç»Ÿï¼Ÿ</h3><p><strong>ä»éœ€æ±‚ä¸Šé¢</strong></p><ul><li>ç‚¹èµç±»åˆ«ï¼šå¸–å­ã€è¯„è®ºã€or å…¶ä»–ã€‚</li><li>ç‚¹èµé™åˆ¶<ul><li>ä»…ç™»å½•ç”¨æˆ·è¿˜æ˜¯æ¸¸å®¢éƒ½å¯ä»¥ç‚¹èµï¼Ÿ</li><li>å¯ä»¥â½†é™ç‚¹èµè¿˜æ˜¯æ¯ä¸ªç”¨æˆ·ä»…é™ç‚¹1æ¬¡ï¼Ÿ</li></ul></li><li>ç‚¹èµæ˜¯å¦é€šçŸ¥ç”¨æˆ·<ul><li>é€šçŸ¥é¢‘ç‡ï¼šæ¯æ¬¡ç‚¹èµéƒ½é€šçŸ¥ 1 æ¬¡ï¼Œè¿˜æ˜¯æ»¡ 5 æ¬¡åˆå¹¶é€šçŸ¥1 æ¬¡</li><li>é€šçŸ¥æ ·å¼ï¼šç‚¹èµå¸–å­å’Œç‚¹èµè¯„è®ºï¼Œé€šçŸ¥çš„å†…å®¹è¦æ€ä¹ˆåŒºåˆ†æ˜¾ç¤º</li></ul></li></ul><p><strong>ä»æ•°æ®åº“è®¾è®¡ä¸Š</strong></p><ul><li>ç‚¹èµæ•°é‡ï¼šæ˜¯å•ç‹¬ä¸€å¼ è¡¨ï¼Ÿè¿˜æ˜¯åœ¨å¸–â¼¦è¡¨ç›´æ¥åŠ â¼€ä¸ªå­—æ®µï¼Ÿ<ul><li>ï¼ˆå‰è€…çš„å¥½å¤„æ˜¯ï¼Œè¿™æ ·å¦‚æœä¾‹å¦‚æœ‰å…¶ä»–ç±»åˆ«çš„å†…å®¹éœ€è¦åŠ ç‚¹èµåŠŸèƒ½ï¼Œå°±ä¸ç”¨å†ä¿®æ”¹æ•°æ®åº“ï¼Œåè€…çš„å¥½å¤„ æ˜¯åå°ç»Ÿè®¡åŠŸèƒ½æ–¹ä¾¿æŸ¥æ•°æ®ï¼Œä¸éœ€è¦æŸ¥ä¸¤å¼ è¡¨ï¼‰</li></ul></li><li>ç‚¹èµè®°å½•è¡¨ï¼šè®°å½•ç‚¹èµæ“ä½œè®°å½•ï¼Œå“ªä¸ªç”¨æˆ·ç‚¹èµäº†å“ªä¸ªå¸–å­ã€‚</li></ul><p><strong>ä»æ€§èƒ½è®¾è®¡è€ƒè™‘</strong></p><ul><li>ç‚¹èµæ˜¯ä¸ªé«˜é¢‘æ“ä½œï¼Œè‚¯å®šä¸èƒ½æ¯æ¬¡éƒ½ç›´æ¥æ“ä½œæ•°æ®åº“ï¼Œéœ€è¦åŠ â¼€å±‚ç¼“å­˜</li><li>æ˜¯å•ç‹¬ç‹¬ç«‹â¼€ä¸ªkeyï¼Œå¦‚ {post_id}_like_num è®°å½•</li><li>è¿˜æ˜¯éšç€è·Ÿå…¶ä»–æ•°é‡å­—æ®µï¼Œâ¼€èµ·æ„é€ â¼€ä¸ªkey å¦‚ {post_info}_num â¼€ä¸ªhashå­—æ®µ</li><li>è¿™é‡Œçš„è®¾è®¡ä¼šå½±å“å¦‚ä½•ä¿æŒæ•°æ®åº“å’Œç¼“å­˜â¼€è‡´æ€§çš„é—®é¢˜</li></ul><p><strong>ä¸€è‡´æ€§è€ƒè™‘</strong></p><ul><li>çœ‹æ˜¯å¦éœ€è¦å¼ºâ¼€è‡´æ€§ï¼Œå¦‚æœä¸éœ€è¦çš„è¯ï¼Œå°±ä¸éœ€è¦åŠ é”ï¼Œè¿™æ ·å¯ä»¥å‡è½»å®ç°è´Ÿæ‹…å’Œæé«˜â¼€å®šçš„ç³»ç»Ÿæ€§èƒ½ã€‚</li></ul><h3 id="2ã€å¦‚ä½•åœ¨-10-äº¿ä¸ªæ•°æ®ä¸­æ‰¾åˆ°æœ€å¤§çš„-1-ä¸‡ä¸ªï¼Ÿï¼ˆæç¤ºï¼šæœ€å°å †ï¼‰ã€‚">2ã€å¦‚ä½•åœ¨ 10 äº¿ä¸ªæ•°æ®ä¸­æ‰¾åˆ°æœ€å¤§çš„ 1 ä¸‡ä¸ªï¼Ÿï¼ˆæç¤ºï¼šæœ€å°å †ï¼‰ã€‚</h3><p>ä½¿ç”¨æœ€å°å †æ¥è§£å†³:</p><p>ä½¿ç”¨æœ€å°å †æ¥è§£å†³: â¾¸å…ˆï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ 10 äº¿ä¸ªæ•°æ®åˆ’åˆ†æˆå¤šä¸ªå°æ•°æ®å—ï¼Œæ¯ä¸ªå°æ•°æ®å—åŒ…å« 1 ä¸‡ä¸ªæ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥éå†è¿™äº›å°æ•°æ®å—ï¼Œå¯¹äºæ¯ä¸ªå°æ•°æ®å—ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºâ¼€ä¸ªå¤§å°ä¸º 1 ä¸‡çš„æœ€å°å †ã€‚å½“éå†åˆ°â¼€ä¸ªæ–°çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒ ä¸æœ€å°å †çš„å †é¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¿™ä¸ªæ•°æ®æ¯”å †é¡¶å…ƒç´ å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠå †é¡¶å…ƒç´ åˆ é™¤ï¼Œå¹¶æŠŠè¿™ä¸ªæ•°æ®æ’â¼Šåˆ° æœ€å°å †ä¸­ã€‚è¿™æ ·ï¼Œå½“æˆ‘ä»¬éå†å®Œæ‰€æœ‰çš„å°æ•°æ®å—ä¹‹åï¼Œæœ€å°å †ä¸­å­˜å‚¨çš„å°±æ˜¯æœ€å¤§çš„ 1 ä¸‡ä¸ªæ•°æ®äº†ã€‚</p><p>å…·ä½“å®ç°è¿‡ç¨‹å¦‚ä¸‹</p><ul><li>åˆå§‹åŒ–â¼€ä¸ªå¤§å°ä¸º 1 ä¸‡çš„æœ€å°å †ï¼ŒæŠŠç¬¬â¼€ä¸ªå°æ•°æ®å—çš„æ•°æ®æ’â¼Šåˆ°å †ä¸­ã€‚</li><li>è¯»å–ä¸‹â¼€ä¸ªå°æ•°æ®å—çš„æ•°æ®ï¼ŒæŠŠè¿™äº›æ•°æ®ä¾æ¬¡ä¸æœ€å°å †çš„å †é¡¶å…ƒç´ è¿›è¡Œæ¯”è¾ƒã€‚<ul><li>å¦‚æœæ•°æ®æ¯”å †é¡¶å…ƒç´ å¤§ï¼Œé‚£ä¹ˆåˆ é™¤å †é¡¶å…ƒç´ ï¼Œå¹¶æŠŠè¿™ä¸ªæ•°æ®æ’â¼Šåˆ°å †ä¸­ã€‚</li><li>å¦‚æœæ•°æ®æ¯”å †é¡¶å…ƒç´ å°ï¼Œé‚£ä¹ˆå¿½ç•¥è¿™ä¸ªæ•°æ®ã€‚</li></ul></li><li>é‡å¤æ­¥éª¤ 2 ç›´åˆ°æ‰€æœ‰çš„å°æ•°æ®å—éƒ½è¢«éå†å®Œã€‚ 2. æœ€ç»ˆï¼Œæœ€å°å †ä¸­å­˜å‚¨çš„å°±æ˜¯æœ€å¤§çš„ 1 ä¸‡ä¸ªæ•°æ®ã€‚</li></ul><p>è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(NlogK)ï¼Œå…¶ä¸­ N æ˜¯æ•°æ®æ€»æ•°ï¼ŒK æ˜¯éœ€è¦æ‰¾åˆ°çš„æœ€å¤§çš„æ•°æ®æ•°é‡ã€‚å› ä¸ºæœ€å°å †çš„å¤§å°æ˜¯ å›ºå®šçš„ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸æ•°æ®æ€»æ•° N æ²¡æœ‰å…³ç³»ï¼Œåªä¸éœ€è¦æ‰¾åˆ°çš„æ•°æ®æ•°é‡ K æœ‰å…³ç³»ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿ æ‰¾åˆ°æœ€å¤§çš„ 1 ä¸‡ä¸ªæ•°æ®ï¼Œè€Œä¸”å¯ä»¥å¤„ç†â¾®å¸¸å¤§çš„æ•°æ®é›†ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240624211246198.png" alt="image-20240624211246198"></p><h3 id="3ã€æœ‰å‡ å°æœºå™¨å­˜å‚¨ç€å‡ äº¿çš„æ·˜å®æœç´¢æ—¥å¿—ï¼Œå‡è®¾ä½ åªæœ‰â¼€å°-2g-çš„ç”µè„‘ï¼Œ-å¦‚ä½•é€‰å‡ºæœç´¢çƒ­åº¦æœ€é«˜çš„â¼—ä¸ªå…³é”®è¯ï¼Ÿ">3ã€æœ‰å‡ å°æœºå™¨å­˜å‚¨ç€å‡ äº¿çš„æ·˜å®æœç´¢æ—¥å¿—ï¼Œå‡è®¾ä½ åªæœ‰â¼€å° 2g çš„ç”µè„‘ï¼Œ å¦‚ä½•é€‰å‡ºæœç´¢çƒ­åº¦æœ€é«˜çš„â¼—ä¸ªå…³é”®è¯ï¼Ÿ</h3><ul><li><p>å¯¹äº <strong>top k ç±»æ–‡æœ¬é—®é¢˜</strong>ï¼Œé€šå¸¸æ¯”è¾ƒå¥½çš„æ–¹æ¡ˆæ˜¯**ã€åˆ†æ²»+hash/trie æ ‘+å°é¡¶å †ã€‘<strong>ï¼Œå³å…ˆæŒ‰ç…§ hash æ–¹æ³•æŠŠæ•°æ®é›†åˆ†è§£æˆå¤šä¸ª</strong>å°æ•°æ®é›†ï¼Œ<strong>ç„¶åä½¿ç”¨ trie æ ‘æˆ–è€… hash ç»Ÿè®¡æ¯ä¸ª</strong>å°æ•°æ®é›†ä¸­çš„è¯é¢‘**ï¼Œéšåç”¨<strong>å°é¡¶å †</strong>æ±‚å‡º<strong>æ¯ä¸ªæ•°æ®é›†ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å‰ K ä¸ªæ•°</strong>ï¼Œæœ€ååœ¨æ‰€æœ‰ top K ä¸­æ±‚å‡ºæœ€ç»ˆçš„ top Kã€‚</p></li><li><p><strong>æ‹†åˆ†æˆ n å¤šä¸ªæ–‡ä»¶</strong>ï¼šä»¥<strong>â¾¸å­—æ¯åŒºåˆ†</strong>ï¼Œä¸åŒâ¾¸å­—æ¯æ”¾åœ¨ä¸åŒæ–‡ä»¶ï¼Œå¦‚æœæŸä¸ªæ–‡ä»¶é•¿åº¦ä»è¿‡é•¿ï¼Œç»§ç»­<strong>æŒ‰ç…§æ¬¡â¾¸å­—æ¯</strong>è¿›è¡Œæ‹†åˆ†ã€‚è¿™æ ·â¼€æ¥ï¼Œæ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸ªæ•°æ®é•¿åº¦åŸºæœ¬ç›¸åŒä¸”â¾¸å­—æ¯ç›¸åŒï¼Œå°±èƒ½ä¿è¯æ•°æ®è¢«ç‹¬ç«‹çš„åˆ†ä¸ºäº† n ä¸ªæ–‡ä»¶ï¼Œä¸”å„ä¸ªæ–‡ä»¶ä¸­ä¸å­˜åœ¨å…³é”®è¯çš„äº¤é›†ã€‚</p></li></ul><p>**åˆ†åˆ«è¯é¢‘ç»Ÿè®¡ï¼š**å¯¹äºæ¯ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ hash æˆ–è€… Trie æ ‘è¿›è¡Œè¿›è¡Œè¯é¢‘ç»Ÿè®¡.ã€‚</p><p><strong>å°é¡¶å †æ’åº</strong>ï¼šä¾æ¬¡å¤„ç†æ¯ä¸ªæ–‡ä»¶ï¼Œå¹¶é€æ¸æ›´æ–°æœ€å¤§çš„â¼—ä¸ªè¯</p><h2 id="JVM">JVM</h2><h3 id="1ã€è¯·ä½ ä»‹ç»ä¸‹-JVM-å†…å­˜æ¨¡å‹ï¼Œåˆ†ä¸ºå“ªäº›åŒºåŸŸï¼Ÿå„åŒºåŸŸçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ">1ã€è¯·ä½ ä»‹ç»ä¸‹ JVM å†…å­˜æ¨¡å‹ï¼Œåˆ†ä¸ºå“ªäº›åŒºåŸŸï¼Ÿå„åŒºåŸŸçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240629205643935.png" alt="image-20240629205643935"></p><p>å †ï¼š</p><ul><li>å †æ˜¯è¿è¡Œæ—¶æ•°æ®åŒºï¼Œæ‰€æœ‰ç±»çš„å®ä¾‹å’Œæ•°ç»„éƒ½æ˜¯åœ¨å †ä¸Šåˆ†é…å†…å­˜ã€‚å®ƒåœ¨ JVM å¯åŠ¨çš„æ—¶å€™è¢«åˆ›å»ºã€‚å¯¹è±¡æ‰€å çš„å † å†…å­˜æ˜¯ç”±è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿä¹Ÿå°±æ˜¯åƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚</li></ul><p>è™šæ‹Ÿæœºæ ˆï¼š</p><ul><li>æ¯ä¸ªçº¿ç¨‹è¿è¡Œæ—¶æ‰€éœ€è¦çš„å†…å­˜ï¼Œç§°ä¸ºè™šæ‹Ÿæœºæ ˆ æ¯ä¸ªæ ˆç”±å¤šä¸ªæ ˆå¸§ï¼ˆFrameï¼‰ç»„æˆï¼Œå¯¹åº”ç€æ¯æ¬¡æ–¹æ³•è°ƒ ç”¨æ—¶æ‰€å ç”¨çš„å†…å­˜ æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰â¼€ä¸ªæ´»åŠ¨æ ˆå¸§ï¼Œå¯¹åº”ç€å½“å‰æ­£åœ¨æ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•ã€‚</li></ul><p>æœ¬åœ°æ–¹æ³•æ ˆï¼š</p><ul><li>ä¸è™šæ‹Ÿæœºæ ˆå‘æŒ¥çš„ä½œç”¨ç›¸ä¼¼ï¼Œç›¸æ¯”äºè™šæ‹Ÿæœºæ ˆä¸ºJavaæ–¹æ³•æœåŠ¡ï¼Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºè™šæ‹Ÿæœºä½¿ç”¨çš„Nativeæ–¹æ³•æœåŠ¡ï¼Œ æ‰§è¡Œæ¯ä¸ªæœ¬åœ°æ–¹æ³•çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºâ¼€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ•°æ ˆï¼ŒåŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•å‡ºâ¼ç­‰ä¿¡æ¯ã€‚</li></ul><p>ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰</p><ul><li>ç¨‹åºè®¡æ•°å™¨åŒºåŸŸæ˜¯â¼€å—è¾ƒå°çš„åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨çº¿ç¨‹çš„æ¯ä¸ªæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªâ¼°çš„ç¨‹åºè®¡æ•°å™¨</li></ul><p>æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ï¼š</p><ul><li>æ–¹æ³•åŒºæ˜¯å¯æä¾›å„æ¡çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å­˜å‚¨äº†æ¯â¼€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ï¼Œè¿˜åŒ…æ‹¬â¼€äº›åœ¨ç±»ã€å®ä¾‹ã€æ¥â¼åˆå§‹ åŒ–æ—¶ç”¨åˆ°çš„ç‰¹æ®Šæ–¹æ³•ã€‚åœ¨JDK1.8ä¹‹å‰çš„ç‰ˆæœ¬â¾¥ï¼Œä»£è¡¨JVMçš„â¼€å—åŒºåŸŸã€‚åœ¨1.8ç‰ˆæœ¬ä»¥åï¼Œè¿™å—åŒºåŸŸçš„åå­—æ”¹ äº†ï¼Œå«åšâ€œMatespaceâ€</li></ul><h3 id="2ã€ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ">2ã€ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p><strong>åŒäº²å§”æ´¾æ¨¡å¼ï¼ˆ<strong>Parent-Delegate Modelï¼‰æ˜¯ <strong>Java ç±»åŠ è½½å™¨</strong>ï¼ˆClassLoaderï¼‰åœ¨</strong>åŠ è½½ç±»</strong>æ—¶æ‰€é‡‡ç”¨çš„â¼€ç§<strong>è®¾è®¡æ¨¡å¼</strong>ã€‚</p><p>è¿™ç§æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå½“â¼€ä¸ª<strong>ç±»åŠ è½½å™¨</strong>æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼Œâ¾¸å…ˆ<strong>ä¸ä¼šå°è¯•è‡ªâ¼°åŠ è½½è¿™ä¸ªç±»</strong>ï¼Œè€Œæ˜¯å°†è¯·æ±‚<strong>å§”æ´¾ç»™å…¶â½—ç±»åŠ è½½å™¨</strong>ã€‚ä¾æ¬¡é€’å½’ï¼Œç›´åˆ°æœ€é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼›<strong>å¦‚æœâ½—ç±»åŠ è½½å™¨â½†æ³•åŠ è½½è¯¥ ç±»ï¼Œâ¼¦ç±»åŠ è½½å™¨æ‰å°è¯•è‡ªâ¼°å»åŠ è½½ã€‚</strong></p><p><strong>ä½œç”¨</strong>ï¼š</p><ul><li><strong>é¿å…é‡å¤åŠ è½½ç±»</strong>ï¼šå¦‚æœâ¼€ä¸ªç±»å·²ç»è¢«æŸä¸ªç±»åŠ è½½å™¨åŠ è½½è¿‡äº†ï¼Œé‚£ä¹ˆå…¶ä»–ç±»åŠ è½½å™¨å°±ä¸éœ€è¦å†æ¬¡åŠ è½½è¯¥ç±»ï¼Œå› ä¸º ç±»çš„å®šä¹‰åªéœ€è¦åŠ è½½â¼€æ¬¡å°±å¯ä»¥äº†ã€‚</li><li><strong>ç¡®ä¿ç±»çš„å”¯â¼€æ€§</strong>ï¼šé€šè¿‡åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå¯ä»¥ä¿è¯ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½åŒâ¼€ä¸ªç±»æ—¶ï¼Œå¾—åˆ°çš„éƒ½æ˜¯åŒâ¼€ä¸ª Class å¯¹ è±¡ï¼Œä»è€Œä¿è¯äº†ç±»çš„å”¯â¼€æ€§ã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šé€šè¿‡åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå¯ä»¥ä¿è¯æ ¸å¿ƒ Java API ä¸ä¼šè¢«â¾®æ³•æ›¿æ¢ï¼Œä»è€Œæé«˜äº† Java åº”ç”¨çš„å®‰å…¨æ€§ã€‚</li></ul><h3 id="3ã€å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•æœ‰â¼ç§ç±»å‹ï¼Ÿä»–ä»¬å¯¹åº”çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ">3ã€å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•æœ‰â¼ç§ç±»å‹ï¼Ÿä»–ä»¬å¯¹åº”çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼š</strong></p><ul><li><p><strong>Mark-Sweepï¼ˆæ ‡è®°-æ¸…é™¤ï¼‰ç®—æ³•</strong></p><p>æ ‡è®°-æ¸…é™¤ç®—æ³•åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šæ ‡è®°é˜¶æ®µå’Œæ¸…é™¤é˜¶æ®µã€‚æ ‡è®°é˜¶æ®µçš„ä»»åŠ¡æ˜¯é¦–å…ˆé€šè¿‡å¯è¾¾æ€§åˆ†æï¼Œæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œæ¸…é™¤é˜¶æ®µå°±æ˜¯å›æ”¶è¢«æ ‡è®°çš„å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ã€‚</p><p>ä¼˜ç‚¹ï¼šé€Ÿåº¦è¾ƒå¿«ï¼›ç¼ºç‚¹ï¼šå†…å­˜ä¸è¿ç»­ï¼Œä¼šé€ æˆå†…å­˜ç¢ç‰‡ï¼Œç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´åç»­è¿‡ç¨‹ä¸­éœ€è¦ä¸ºå¤§å¯¹è±¡åˆ†é…ç©º é—´æ—¶â½†æ³•æ‰¾åˆ°è¶³å¤Ÿçš„ç©ºé—´è€Œæå‰è§¦å‘æ–°çš„â¼€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240701171619848.png" alt="image-20240701171619848"></p></li><li><p><strong>Copingï¼ˆå¤åˆ¶ï¼‰ç®—æ³•</strong></p><p>ä¸ºäº†è§£å†³Mark-Sweepç®—æ³•çš„ç¼ºé™·ï¼Œä»–å°†å¯ç”¨å†…å­˜æŒ‰ç…§å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨â¼€å—ã€‚å½“è¿™â¼€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦â¼€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨çš„å†…å­˜ç©ºé—´â¼€æ¬¡æ¸…ç†æ‰ï¼Œè¿™æ ·â¼€æ¥å°± ä¸å®¹æ˜“å‡ºç°å†…å­˜ç¢â½šçš„é—®é¢˜ã€‚</p><p>è¿™ç§ç®—æ³•è™½ç„¶å®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆä¸”ä¸å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢â½šï¼Œä½†æ˜¯å´å¯¹å†…å­˜ç©ºé—´çš„ä½¿ç”¨åšå‡ºäº†é«˜æ˜‚çš„ä»£ä»·ï¼Œå› ä¸º èƒ½å¤Ÿä½¿ç”¨çš„å†…å­˜ç¼©å‡åˆ°åŸæ¥çš„â¼€åŠã€‚å¾ˆæ˜¾ç„¶ï¼ŒCopyingç®—æ³•çš„æ•ˆç‡è·Ÿå­˜æ´»å¯¹è±¡çš„æ•°ç›®å¤šå°‘æœ‰å¾ˆå¤§çš„å…³ç³»ï¼Œå¦‚æœ å­˜æ´»å¯¹è±¡å¾ˆå¤šï¼Œé‚£ä¹ˆCopyingç®—æ³•çš„æ•ˆç‡å°†ä¼šå¤§å¤§é™ä½ã€‚</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240701171720555.png" alt="image-20240701171720555"></p></li><li><p><strong>Mark-Compactï¼ˆæ ‡è®°-æ•´ç†ï¼‰ç®—æ³•ï¼ˆå‹ç¼©ç®—æ³•ï¼‰</strong></p><p>ä¸ºäº†è§£å†³Copyingç®—æ³•çš„ç¼ºé™·ï¼Œå……åˆ†åˆ©ç”¨å†…å­˜ç©ºé—´ï¼Œæå‡ºäº†Mark-Compactç®—æ³•ã€‚è¯¥ç®—æ³•æ ‡è®°é˜¶æ®µå’ŒMarkSweepâ¼€æ ·ï¼Œä½†æ˜¯åœ¨å®Œæˆæ ‡è®°ä¹‹åï¼Œä»–ä¸æ˜¯ç›´æ¥æ¸…ç†å¯å›æ”¶å¯¹è±¡ï¼Œè€Œæ˜¯å°†å­˜æ´»å¯¹è±¡éƒ½å‘â¼€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç† æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜</p><p><img src="C:%5CUsers%5CThinkBook%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240701171804805.png" alt="image-20240701171804805"></p></li><li><p><strong>Generation Collectionï¼ˆåˆ†ä»£æ”¶é›†ï¼‰ç®—æ³•</strong></p><ul><li><p>åˆ†ä»£æ”¶é›†ç®—æ³•æ˜¯ç›®å‰å¤§éƒ¨åˆ†JVMçš„åƒåœ¾å›æ”¶å™¨é‡‡ç”¨çš„ç®—æ³•ã€‚ä»–çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»çš„ç”Ÿå‘½å‘¨æœŸå°†å†…å­˜åˆ’åˆ†ä¸ºè‹¥â¼²ä¸ªä¸åŒçš„åŒºåŸŸã€‚â¼€èˆ¬æƒ…å†µä¸‹å°†å †åŒºåˆ’åˆ†ä¸º<strong>è€å¹´ä»£ï¼ˆTenured Generationï¼‰å’Œæ–°ç”Ÿä»£</strong>ï¼ˆYoung Generationï¼‰ï¼Œè€å¹´ä»£çš„ç‰¹ç‚¹æ˜¯æ¯æ¬¡åƒåœ¾å›æ”¶æ—¶ï¼Œåªæœ‰å°‘æ•°å¯¹è±¡éœ€è¦è¢«å›æ”¶ï¼Œè€Œæ–°ç”Ÿä»£çš„ç‰¹ç‚¹æ˜¯æ¯æ¬¡åƒåœ¾å› æ”¶æ—¶éƒ½æœ‰å¤§é‡çš„å¯¹è±¡éœ€è¦è¢«å›æ”¶ã€‚</p></li><li><p>ç›®å‰å¤§éƒ¨åˆ†åƒåœ¾å›æ”¶å™¨å¯¹äº<strong>æ–°ç”Ÿä»£éƒ½é‡‡å–å¤åˆ¶ç®—æ³•</strong>ï¼Œå› ä¸ºæ–°ç”Ÿä»£ä¸­æ¯æ¬¡åƒåœ¾å›æ”¶éƒ½è¦å›æ”¶å¤§éƒ¨åˆ†å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å¤åˆ¶çš„æ“ä½œæ¬¡æ•°è¾ƒå°‘ï¼Œä½†å®é™…ä¸Šä¸æ˜¯æŒ‰ç…§1ï¼š1çš„æ¯”ä¾‹æ¥åˆ’åˆ†æ–°ç”Ÿä»£çš„ç©ºé—´ï¼Œâ¼€èˆ¬æ¥è¯´æ˜¯å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸º<strong>â¼€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´</strong>ï¼Œæ¯æ¬¡ä½¿ç”¨Edenç©ºé—´å’Œå…¶ä¸­çš„â¼€å—Survivorç©ºé—´ã€‚å½“æ–°ç”Ÿä»£çš„Eden Spaceå’ŒFrom Spaceç©ºé—´ä¸è¶³æ—¶å°±ä¼šå‘ç”Ÿâ¼€æ¬¡GCï¼Œè¿›è¡ŒGCåï¼ŒEden Spaceå’ŒFrom SpaceåŒºçš„å­˜ æ´»å¯¹è±¡ä¼šè¢«æŒªåˆ°To Spaceï¼Œç„¶åå°†Eden Spaceå’ŒFrom Spaceè¿›è¡Œæ¸…ç†ã€‚å¦‚æœTo Spaceâ½†æ³•è¶³å¤Ÿå­˜å‚¨æŸä¸ªå¯¹è±¡ï¼Œåˆ™å°†è¿™ä¸ªå¯¹è±¡<strong>å­˜å‚¨åˆ°è€ç”Ÿä»£</strong>ã€‚åœ¨è¿›è¡ŒGCåï¼Œä½¿ç”¨çš„ä¾¿æ˜¯Eden Spaceå’ŒTo Spaceäº†ï¼Œå¦‚æ­¤åå¤å¾ªç¯ã€‚å½“å¯¹ è±¡åœ¨SurvivoråŒºèº²è¿‡â¼€æ¬¡GCåï¼Œå…¶å¹´é¾„å°±ä¼š+1ã€‚é»˜è®¤æƒ…å†µä¸‹å¹´é¾„åˆ°è¾¾15çš„å¯¹è±¡ä¼šè¢«ç§»åˆ°è€å¹´ä»£ä¸­ã€‚</p></li><li><p>è€Œç”±äºâ½¼å¹´ä»£çš„ç‰¹ç‚¹æ˜¯æ¯æ¬¡å›æ”¶éƒ½åªå›æ”¶å°‘é‡å¯¹è±¡ï¼Œâ¼€èˆ¬ä½¿â½¤çš„æ˜¯<strong>æ ‡è®°-æ•´ç†ç®—æ³•ï¼ˆå‹ç¼©æ³•ï¼‰</strong>ï¼Œå½“â½¼å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œä¼šå…ˆå°è¯•è§¦å‘ minor gcï¼Œå¦‚æœä¹‹åç©ºé—´ä»ä¸è¶³ï¼Œé‚£ä¹ˆè§¦å‘ full gcï¼ŒSTWçš„æ—¶é—´æ›´â»“</p></li></ul></li></ul><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>æ–‡ç« ç»“æŸï¼</p></div></div>]]></content>
    
    
    <summary type="html">ğŸ‘æœ¬æ–‡æ€»ç»“äº†ç¼–ç¨‹å¯¼èˆªé‡Œé¢javaé¢è¯•ç›¸å…³çš„é¢˜ç›®</summary>
    
    
    
    <category term="é¢è¯•" scheme="https://liweierzzz.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
    <category term="java" scheme="https://liweierzzz.github.io/tags/java/"/>
    
    <category term="é¢è¯•æ•´ç†" scheme="https://liweierzzz.github.io/tags/%E9%9D%A2%E8%AF%95%E6%95%B4%E7%90%86/"/>
    
  </entry>
  
</feed>
